---
title: "Deploy to AWS ECS with AWS CodePipeline"
sidebarTitle: "Setup"
---

## Pre-requisites

### Terraform

This document assumes you're using Terraform to modify and deploy your AWS instructure. If you're
not using Terraform yet, you can set it up by reading [this document](production/deploying-to-cloud/using-terraform).

This document also assumes that you have already set up your ECS cluster, services, and tasks.
* If you are not using ECS to run Mage, then this document will not apply for you.
  You can submit a feature request in our [Slack channel](https://www.mage.ai/chat) if you want Mage to
  support deploying to your infrastructure through AWS CodePipeline.
* If you have not set up your ECS yet, you can check out [this document](https://docs.mage.ai/production/deploying-to-cloud/aws/setup#deploy-to-ecs-cluster)
  to set it up with Terraform.

## Setting up AWS CodePipeline pipeline with Terraform

Use Terraform scripts in [aws-code-pipeline](https://github.com/mage-ai/mage-ai-terraform-templates/tree/master/aws-code-pipeline)
folder to provision resources for AWS CodePipeline.

---

### Terraform plan

You can run the following command to see all the resources that will be created
by Terraform:

```bash
cd aws
terraform plan
```

---

### 1. Environment variables

If you don’t have the AWS CLI installed, you’ll need to create this file:
`~/.aws/credentials`.

In that file, add the following values:

```
[default]
aws_access_key_id = XXX
aws_secret_access_key = XXX
```

Alternatively, you can install the AWS CLI by following 
[Amazon’s instructions](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html).

---

### 2. Customize Terraform variables


