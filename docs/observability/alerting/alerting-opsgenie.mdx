---
title: "Alerting status updates in Opsgenie"
sidebarTitle: "Opsgenie"
description: "Get status updates in Opsgenie."
icon: "cauldron"
---

<img
  alt="Opsgenie"
  src="https://logotyp.us/files/opsgenie.svg"
  width="300"
/>

## Overview of steps

1. Set up Api Integration for Opsgenie
2. Update Mage project settings

---

## Set up Api Integration for Opsgenie

Follow these
[instructions on Opsgenie](https://support.atlassian.com/opsgenie/docs/create-a-default-api-integration/)
to setup an API Integration in your account.

---

## Update Mage project settings

Once youâ€™ve set up API Integration for Opsgenie, you should have an API Key that Opsgenie
provides.

Follow these steps to add that Opsgenie Configuration to your project settings:

1. Open the Mage tool in your browser (e.g. http://localhost:6789/).
2. Open a pipeline and start editing it (e.g.
   http://localhost:6789/pipelines/example_pipeline/edit).
3. In your left sidebar in the file browser, scroll all the way down and click
   on a file named `metadata.yaml`.
4. In the `metadata.yaml` file, add a section with the following
   configuration or update the existing `notification_config` section:

    ```yaml
    notification_config:
      alert_on:
        - trigger_failure
        - trigger_passed_sla
    ```

    If you omit the `alert_on` section it will default to `trigger_failure` and `trigger_passed_sla`.

    Options:

    - `trigger_failure`: alert when a run of a trigger fails
    - `trigger_success`: alert when a run of a trigger succeeds
    - `trigger_passed_sla`: alert when a run of a trigger passes sla

5. In the `metadata.yaml` file, add the following values:

    ```yaml
    notification_config:
      alert_on:
        ...
      opsgenie_config:
        url: "https://api.eu.opsgenie.com/v2/alerts"
        api_key: "<your_api_key>"
        priority: "P2" # Default P3
        tags: # Default empty
        - production
        details: # Default empty
          environment: production
        responders: # Default empty
        - id: "4513b7ea-3b91-438f-b7e4-e3e54af9147c"
          type: "team"
    ```

    Change the `your_api_key` value to be the API Key you created from Opsgenie.

## Customize message templates
You can customize message templates in `notification_config`. Here is an example config:
```yaml
notification_config:
  alert_on:
    ...
  opsgenie_config:
    ...
  message_templates:
    failure:
      details: >
        Failed to execute pipeline {pipeline_run_url}.
        Pipeline uuid: {pipeline_uuid}. Trigger name: {pipeline_schedule_name}.
        Test custom message.
    success:
      details: ...
    passed_sla:
      details: ...
```
You can customize the message template for `success`, `failure`, `passed_sla` scenarios. For each message template,
you can specify either `summary` or `details`.
* If you specify the `summary`, the slack message will be your `summary` + the url of the pipeline run page
* If you specify the `details`, the `details` will be used as your slack message directly

To interpolate variables in the message template, you can use `{variable_name}` syntax.
Here are the supported variables:
1. `execution_time`
1. `pipeline_run_url`
1. `pipeline_schedule_id`
1. `pipeline_schedule_name`
1. `pipeline_schedule_description`
1. `pipeline_uuid`
1. `error`
    * available only for the `failure` message template
1. `stacktrace`
    * available only for the `failure` message template

> **Note**: For `pipeline_run_url`, the default host is `http://localhost:6789`. You can specify `MAGE_PUBLIC_HOST` to be
the host url you want to use in the notification messages.

### ðŸš€ Pro Only: Interpolate Mage Variables in Message Templates

If you're using **Mage Pro**, you can interpolate environment variables and other [Mage variables](/development/variables/referencing-variables#accessing-variables-in-mage) directly in your Slack message templates using the familiar Jinja-like syntax:

```yaml
notification_config:
  message_templates:
    failure:
      details: >
        Failed at {{ env_var('ENVIRONMENT') }} environment.
        Pipeline run: {pipeline_run_url}.
```

This makes your Opsgenie notifications more dynamic and context-aware â€” ideal for multi-environment deployments and advanced workflows.

---

## What next?

Whenever a pipeline run is successfully completed or fails, an Opsgenie alert be
created.

Here is an example of what the alert could look like:

|                                                                                                        |
|--------------------------------------------------------------------------------------------------------|
| ![Opsgenie](https://mage-ai.github.io/assets/opsgenie-alert-example.jpeg)                                                        |
