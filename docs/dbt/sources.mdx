---
title: "dbt sources and upstream dependencies"
sidebarTitle: "Get data from blocks"
---

dbt model blocks can depend on other dbt models and other blocks:
[sensors](/guides/sensors), Python,
[SQL](/guides/sql-blocks),
[R](/guides/r-blocks).

---

## dbt models depending on other dbt models

When you add a dbt model block to your pipeline, if it contains any `ref`s,
those dbt models will be added to the current pipeline as upstream dependencies
to the dbt model you initially added.

![](https://github.com/mage-ai/assets/blob/main/dbt-model-refs.gif?raw=true)

---

## dbt models depending on other blocks

When a dbt model depends on a block that isn’t another dbt model, a YAML file is
created named `mage_sources.yml`. This file is automatically generated and
updated whenever a new non-dbt model block is an upstream dependency of a dbt
model block.

If you have a Mage project named `demo_project` with a dbt project named `demo`,
here is an example of where the `mage_sources.yml` file could be located:

```
demo_project/
|   dbt/
|   |   demo/
|   |   |   models/
|   |   |   |   example/
|   |   |   |   |   mage_sources.yml
|   |   |   |   |   my_first_dbt_model.sql
|   |   |   |   |   my_second_dbt_model.sql
```

### Sources

The contents of the `mage_sources.yml` could look like this:

```yaml
sources:
  - name: mage_demo_project
    tables:
      - name: demo_pipeline_load_data
version: 2
```

The source name follows this convention: `mage_[Mage_project_name]`.

The table names under the source follow this convention:
`[pipeline_uuid]_[block_uuid]`.

For more information on sources, read
[dbt’s documentation](https://docs.getdbt.com/docs/build/sources).
