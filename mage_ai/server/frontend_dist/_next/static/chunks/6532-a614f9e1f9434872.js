"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6532],{86532:function(n,e,t){t.d(e,{Z:function(){return J}});var o,i=t(21831),r=t(82394),u=t(75582),c=t(77837),l=t(38860),d=t.n(l),a=t(51774),s=t.n(a),v=t(9518),f=t(4804),p=t(82684),h=t(83455),m=t(86422),b=t(67971),k=t(16634),g=t(86673),y=t(54283),x=t(19711),C=t(23831),E=t(10503),j=t(49125),O=(j.iI,{height:10,width:10}),w=[m.tf.DATA_EXPORTER,m.tf.SENSOR],P=[m.Lq.GREY,m.Lq.PINK,m.Lq.TEAL,m.Lq.YELLOW];!function(n){n.NORTH="NORTH",n.SOUTH="SOUTH"}(o||(o={}));var A=t(73942),D=t(37391),I=v.default.div.withConfig({displayName:"indexstyle__GraphContainerStyle",componentId:"sc-bc2ei5-0"})(["div:only-child{","}",""],D.w5,(function(n){return n.height&&"\n    height: ".concat(n.height,"px;\n  ")})),T=v.default.div.withConfig({displayName:"indexstyle__NodeStyle",componentId:"sc-bc2ei5-1"})(["border-radius:","px;border:1px solid transparent;min-width:fit-content;"," "," "," ",""],A.BG,(function(n){return n.selected&&"\n    border-color: ".concat((n.theme.content||C.Z.content).active,";\n  ")}),(function(n){return n.backgroundColor&&"\n    background-color: ".concat(n.backgroundColor,";\n  ")}),(function(n){return(n.isCancelled||n.disabled)&&"\n    // opacity doesn\u2019t work on Safari\n    border-color: ".concat((n.theme.content||C.Z.content).active,";\n    border-style: dashed;\n    cursor: not-allowed;\n  ")}),(function(n){return n.disabled&&"\n    &:hover {\n      cursor: not-allowed;\n    }\n  "})),Z=v.default.div.withConfig({displayName:"indexstyle__RuntimeStyle",componentId:"sc-bc2ei5-2"})(["margin-right:","px;padding:12px 4px;height:100%;width:50px;background:rgba(0,0,0,0.2);background-blend-mode:soft-light;"],2*j.iI),N=t(44162),S=t(90211),_=function(n){var e=n/1e3,t=4-Math.floor(e).toString().length,o=(0,S.QV)(e,t>=0?t:0),i="s";return o>1e3&&(o=(0,S.QV)(o/60,0),i="m"),"".concat(o).concat(i)},R=function(n,e){var t=n||{},i=t.id,r=t.side,u=null===e||void 0===e?void 0:e.id;return r===o.NORTH?null===i||void 0===i?void 0:i.endsWith("".concat(u,"-to")):r===o.SOUTH&&(null===i||void 0===i?void 0:i.startsWith(u))},B=t(28598);var L=function(n){var e=n.block,t=n.children,o=n.disabled,i=n.hasFailed,r=n.hideStatus,u=n.isCancelled,c=n.isInProgress,l=n.isQueued,d=n.isSuccessful,a=(n.onClick,n.runtime),s=n.selected,f=(0,p.useContext)(v.ThemeContext),h=e.color,m=e.type,O=e.uuid,A=!(c||l||i||d||u),D=d&&!(c||l),I=i&&!(c||l),S="";return A?S="No status":D?S="Successful execution":I?S="Failed execution":c?S="Currently executiing":u&&(S="Cancelled execution"),(0,B.jsx)(T,{backgroundColor:(0,N.qn)(m,{blockColor:h,theme:f}).accent,disabled:o,isCancelled:u,selected:s,children:(0,B.jsxs)(b.Z,{alignItems:"center",children:[a&&(0,B.jsx)(Z,{backgroundColor:(0,N.qn)(m,{blockColor:h,theme:f}).accent,children:(0,B.jsx)(b.Z,{justifyContent:"center",children:(0,B.jsx)(x.ZP,{inverted:w.includes(m)||P.includes(h),xsmall:!0,children:_(a)})})}),!a&&(0,B.jsx)(g.Z,{ml:2}),!r&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(b.Z,{alignItems:"center",justifyContent:"center",style:{height:2*j.iI,width:2*j.iI},title:S,children:[c&&(0,B.jsx)(y.Z,{color:(f||C.Z).content.active,small:!0}),D&&(0,B.jsx)(E.Jr,{size:2*j.iI,success:!0}),I&&(0,B.jsx)(E.x8,{danger:!0,size:1.5*j.iI}),A&&(0,B.jsx)(k.Z,{borderSize:1,size:1*j.iI})]}),(0,B.jsx)(g.Z,{ml:1})]}),(0,B.jsx)(b.Z,{alignItems:"center",justifyContent:"center",style:{padding:"8px 0",height:"100%"},children:(0,B.jsx)(x.ZP,{inverted:w.includes(m)||P.includes(h),monospace:!0,small:!0,children:t})})]})},O)},U=t(11135),H=t(98781),M=t(82531),G=t(66050),q=t(24224),F=t(25958),V=t(96510),K=t(87323);function Q(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}function z(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(t),!0).forEach((function(e){(0,r.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Q(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var X=s()((0,c.Z)(d().mark((function n(){var e;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.e(4434),t.e(5987),t.e(3873)]).then(t.t.bind(t,74529,23));case 2:return e=n.sent,n.abrupt("return",e.Canvas);case 4:case"end":return n.stop()}}),n)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[74529]}}}),W=s()((0,c.Z)(d().mark((function n(){var e;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.e(4434),t.e(5987),t.e(3873)]).then(t.t.bind(t,74529,23));case 2:return e=n.sent,n.abrupt("return",e.Node);case 4:case"end":return n.stop()}}),n)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[74529]}}}),Y=s()((0,c.Z)(d().mark((function n(){var e;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.e(4434),t.e(5987),t.e(3873)]).then(t.t.bind(t,74529,23));case 2:return e=n.sent,n.abrupt("return",e.Edge);case 4:case"end":return n.stop()}}),n)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[74529]}}}),$=(s()((0,c.Z)(d().mark((function n(){var e;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.e(4434),t.e(5987),t.e(3873)]).then(t.t.bind(t,74529,23));case 2:return e=n.sent,n.abrupt("return",e.MarkerArrow);case 4:case"end":return n.stop()}}),n)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[74529]}}}),s()((0,c.Z)(d().mark((function n(){var e;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.e(4434),t.e(5987),t.e(3873)]).then(t.t.bind(t,74529,23));case 2:return e=n.sent,n.abrupt("return",e.Port);case 4:case"end":return n.stop()}}),n)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[74529]}}}));var J=function(n){var e=n.blockRefs,t=n.blockStatus,r=n.disabled,c=n.editingBlock,l=n.enablePorts,d=void 0!==l&&l,a=n.fetchPipeline,s=n.height,k=n.heightOffset,y=void 0===k?10*j.iI:k,C=n.noStatus,E=n.pannable,w=void 0===E||E,P=n.pipeline,A=n.runningBlocks,D=void 0===A?[]:A,T=n.selectedBlock,Z=n.setEditingBlock,S=n.setErrors,_=n.setSelectedBlock,Q=n.showDynamicBlocks,J=void 0!==Q&&Q,nn=n.zoomable,en=void 0===nn||nn,tn=(0,p.useContext)(v.ThemeContext),on=(0,p.useState)([]),rn=on[0],un=on[1],cn=(0,p.useState)(!1),ln=cn[0],dn=cn[1],an=(0,p.useState)(null),sn=an[0],vn=an[1],fn=d&&ln,pn=(null===c||void 0===c?void 0:c.upstreamBlocks)||{},hn=pn.block,mn=pn.values,bn=void 0===mn?[]:mn,kn=(0,p.useMemo)((function(){return bn.length}),[bn]),gn=(0,p.useMemo)((function(){var n;return(null===P||void 0===P||null===(n=P.blocks)||void 0===n?void 0:n.filter((function(n){var e=n.type;return m.tf.SCRATCHPAD!==e})))||[]}),[null===P||void 0===P?void 0:P.blocks]),yn=(0,q.HK)((0,K.cU)(gn,gn),(function(n){return n.block.uuid})),xn=(0,p.useMemo)((function(){return gn}),[gn,J]),Cn=(0,p.useMemo)((function(){return(0,q.HK)(xn,(function(n){return n.uuid}))}),[xn]),En=(0,p.useMemo)((function(){return(0,q.HK)(D,(function(n){return n.uuid}))}),[D]),jn=(0,h.Db)(M.ZP.blocks.pipelines.useUpdate(null===P||void 0===P?void 0:P.uuid,encodeURIComponent(null===hn||void 0===hn?void 0:hn.uuid)),{onSuccess:function(n){return(0,V.wD)(n,{callback:function(){Z({upstreamBlocks:null}),null===a||void 0===a||a()},onErrorCallback:function(n,e){return null===S||void 0===S?void 0:S({errors:e,response:n})}})}}),On=(0,u.Z)(jn,2),wn=On[0],Pn=On[1].isLoading,An=(0,h.Db)((function(n){var e=n.fromBlock,t=n.toBlock,o=n.removeDependency;return M.ZP.blocks.pipelines.useUpdate(null===P||void 0===P?void 0:P.uuid,encodeURIComponent(t.uuid))({block:z(z({},t),{},{upstream_blocks:o?t.upstream_blocks.filter((function(n){return n!==e.uuid})):t.upstream_blocks.concat(e.uuid)})})}),{onSuccess:function(n){return(0,V.wD)(n,{callback:function(){null===a||void 0===a||a()},onErrorCallback:function(n,e){return null===S||void 0===S?void 0:S({errors:e,response:n})}})}}),Dn=(0,u.Z)(An,1)[0],In=(0,p.useCallback)((function(n){var t=n.type,o=n.uuid;if(null===_||void 0===_||_(n),un([]),null!==e&&void 0!==e&&e.current){var i,r=e.current["".concat(t,"s/").concat(o,".py")];null===r||void 0===r||null===(i=r.current)||void 0===i||i.scrollIntoView()}}),[e,_]),Tn=(0,p.useCallback)((function(n){un([]),Z((function(e){var t=e.upstreamBlocks.values||[],o=t.findIndex((function(e){var t=e.uuid;return n.uuid===t}));return z(z({},e),{},{upstreamBlocks:z(z({},e.upstreamBlocks),{},{values:o>=0?(0,q.oM)(t,o):t.concat(n)})})}))}),[Z]),Zn=(0,p.useMemo)((function(){var n={};return xn.forEach((function(e){e.upstream_blocks.forEach((function(t){n[t]||(n[t]=[]),n[t].push(e)}))})),n}),[xn]),Nn=(0,p.useCallback)((function(n){var e;if(H.q.INTEGRATION===(null===P||void 0===P?void 0:P.type)&&m.tf.TRANSFORMER!==n.type){var t,o={};if(m.t6.YAML===n.language&&(o=(0,f.Qc)(n.content)),m.tf.DATA_LOADER===n.type)e="".concat(n.uuid,": ").concat(null===(t=o)||void 0===t?void 0:t.source);else if(m.tf.DATA_EXPORTER===n.type){var i;e="".concat(n.uuid,": ").concat(null===(i=o)||void 0===i?void 0:i.destination)}}else m.tf.DBT===n.type&&m.t6.SQL===n.language&&(e=(0,F.$)(n,{fullPath:!0}));var r=(null===yn||void 0===yn?void 0:yn[n.uuid])||{},u=r.dynamic,c=r.dynamicUpstreamBlock,l=(r.reduceOutput,r.reduceOutputUpstreamBlock);return e||(e=n.uuid,u?e="[dynamic] ".concat(e):c&&!l&&(e="[dynamic child] ".concat(e))),e}),[yn,P]),Sn=(0,p.useMemo)((function(){var n=[],e=[];return xn.forEach((function(u){var c,l=Nn(u),d=u.type,a=u.upstream_blocks,s=void 0===a?[]:a,v=u.uuid,f=Zn[v],p=[];f?p.push.apply(p,(0,i.Z)(f.map((function(n){return z(z({},O),{},{id:"".concat(v,"-").concat(n.uuid,"-from"),side:o.SOUTH})})))):d!==m.tf.DATA_EXPORTER&&p.push(z(z({},O),{},{id:"".concat(v,"-from"),side:o.SOUTH})),0===s.length&&d!==m.tf.DATA_LOADER&&p.push(z(z({},O),{},{id:"".concat(v,"-to"),side:o.NORTH})),null===s||void 0===s||s.forEach((function(n){p.push(z(z({},O),{},{id:"".concat(n,"-").concat(v,"-to"),side:o.NORTH})),e.push({from:n,fromPort:"".concat(n,"-").concat(v,"-from"),id:"".concat(n,"-").concat(v),to:v,toPort:"".concat(n,"-").concat(v,"-to")})})),n.push({data:{block:u},height:37,id:v,ports:p,width:l.length*j.KF+(r?0:5*j.iI)+((null===hn||void 0===hn?void 0:hn.uuid)===u.uuid?19*j.KF:0)+(null!==t&&void 0!==t&&null!==(c=t[u.uuid])&&void 0!==c&&c.runtime?50:0)})})),{edges:e,nodes:n}}),[null===hn||void 0===hn?void 0:hn.uuid,t,xn,r,Nn,Zn]),_n=Sn.edges,Rn=Sn.nodes,Bn=(0,p.useCallback)((function(n){if(C)return{};if(t){var e=t[n.uuid]||{},o=e.status,i=e.runtime;return{hasFailed:G.V.FAILED===o,isCancelled:G.V.CANCELLED===o,isInProgress:G.V.RUNNING===o,isQueued:G.V.INITIAL===o,isSuccessful:G.V.COMPLETED===o,runtime:i}}var r;return{hasFailed:m.DA.FAILED===n.status,isInProgress:En[n.uuid],isQueued:En[n.uuid]&&(null===(r=D[0])||void 0===r?void 0:r.uuid)!==n.uuid,isSuccessful:m.DA.EXECUTED===n.status}}),[t,C,D,En]);return(0,B.jsxs)(B.Fragment,{children:[hn&&(0,B.jsxs)(g.Z,{my:3,px:j.cd,children:[(0,B.jsxs)(g.Z,{mb:j.cd,children:[(0,B.jsxs)(x.ZP,{children:["Select parent block(s) for ",(0,B.jsx)(x.ZP,{color:(0,N.qn)(hn.type,{blockColor:hn.color,theme:tn}).accent,inline:!0,monospace:!0,children:hn.uuid}),":"]}),(0,B.jsx)(g.Z,{mt:1,children:bn.map((function(n,e){var t,o,i=n.uuid;return(0,B.jsxs)(x.ZP,{color:(0,N.qn)(null===(t=Cn[i])||void 0===t?void 0:t.type,{blockColor:null===(o=Cn[i])||void 0===o?void 0:o.type,theme:tn}).accent,inline:!0,monospace:!0,children:[i,kn>=2&&e<=kn-2?(0,B.jsx)(x.ZP,{inline:!0,children:",\xa0"}):null]},i)}))})]}),(0,B.jsxs)(b.Z,{alignItems:"center",children:[(0,B.jsx)(U.ZP,{compact:!0,inline:!0,loading:Pn,onClick:function(){return wn({block:z(z({},hn),{},{upstream_blocks:bn.map((function(n){return n.uuid}))})})},uuid:"DependencyGraph/save_parents",children:"Save dependencies"}),(0,B.jsx)(g.Z,{ml:1}),(0,B.jsx)(U.ZP,{compact:!0,inline:!0,noBackground:!0,onClick:function(){un([]),Z({upstreamBlocks:null})},uuid:"DependencyGraph/cancel_save_parents",children:"Cancel"})]})]}),(0,B.jsx)(I,{height:s-y,children:(0,B.jsx)(X,{arrow:null,disabled:r,edge:function(n){var e,t=Cn[n.source];return(0,B.jsx)(Y,z(z({},n),{},{onClick:function(n,e){vn(null),un([e.id])},onRemove:function(n,e){var t=Cn[e.from],o=Cn[e.to];Dn({fromBlock:t,removeDependency:!0,toBlock:o}),un([])},removable:d&&!(null!==c&&void 0!==c&&c.upstreamBlocks),style:{stroke:null===(e=(0,N.qn)(null===t||void 0===t?void 0:t.type,{blockColor:null===t||void 0===t?void 0:t.color,theme:tn}))||void 0===e?void 0:e.accent}}))},edges:_n,fit:!0,node:function(n){var e,t,o,i,u,l;return(0,B.jsx)(W,z(z({},n),{},{dragType:"port",linkable:!0,onClick:function(n,e){var t=e.data.block;vn(null),(null===hn||void 0===hn?void 0:hn.uuid)===t.uuid||(hn?Tn(t):In(t))},onEnter:function(){null!==c&&void 0!==c&&c.upstreamBlocks||dn(!0)},onLeave:function(){return dn(!1)},port:fn&&(null===sn||R(sn,n))?(0,B.jsx)($,{onDrag:function(){return dn(!0)},onDragEnd:function(){dn(!1),vn(null)},onDragStart:function(n,e,t){vn({id:null===t||void 0===t?void 0:t.id,side:null===t||void 0===t?void 0:t.side})},onEnter:function(){return dn(!0)},rx:10,ry:10,style:{fill:(0,N.qn)(null===n||void 0===n||null===(e=n.properties)||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.block)||void 0===o?void 0:o.type,{blockColor:null===n||void 0===n||null===(i=n.properties)||void 0===i||null===(u=i.data)||void 0===u||null===(l=u.block)||void 0===l?void 0:l.color,theme:tn}).accent,stroke:"white",strokeWidth:"1px"}}):null,style:{fill:"transparent",stroke:"transparent",strokeWidth:0},children:function(n){var e=n.node.data.block,t=Bn(e);return(0,B.jsx)("foreignObject",{height:n.height,style:{pointerEvents:"none"},width:n.width,x:0,y:0,children:(0,B.jsxs)(L,z(z({block:e,disabled:(null===hn||void 0===hn?void 0:hn.uuid)===e.uuid,hideStatus:r,selected:hn?!!(0,q.sE)(bn,(function(n){return n.uuid===e.uuid})):(null===T||void 0===T?void 0:T.uuid)===e.uuid},t),{},{children:[Nn(e),(null===hn||void 0===hn?void 0:hn.uuid)===e.uuid&&" (editing)"]}),e.uuid)})}}))},nodes:Rn,onNodeLink:function(n,e,t,o){var i,r=Cn[e.id],u=Cn[t.id],c=(null===P||void 0===P?void 0:P.type)===H.q.INTEGRATION&&((null===r||void 0===r?void 0:r.type)===m.tf.DATA_EXPORTER||(null===r||void 0===r?void 0:r.type)===m.tf.DATA_LOADER&&(null===u||void 0===u?void 0:u.type)===m.tf.DATA_EXPORTER);null!==r&&void 0!==r&&null!==(i=r.upstream_blocks)&&void 0!==i&&i.includes(u.uuid)||e.id===t.id||c||Dn({fromBlock:r,toBlock:u})},onNodeLinkCheck:function(n,e,t){return!_n.some((function(n){return n.from===e.id&&n.to===t.id}))},pannable:w,selections:rn,zoomable:en})})]})}},66050:function(n,e,t){var o;t.d(e,{V:function(){return o}}),function(n){n.CANCELLED="cancelled",n.COMPLETED="completed",n.FAILED="failed",n.INITIAL="initial",n.RUNNING="running"}(o||(o={}))},87323:function(n,e,t){t.d(e,{cU:function(){return u}});var o=t(82684),i=t(24224);function r(n,e){return function(n,e,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{includeAllNodes:!1},r=(0,i.HK)(t,(function(n){return n.uuid})),u=(o||{}).includeAllNodes,c=[];function l(t){if(t){var o=(t[e]||[]).reduce((function(e,t){return n.uuid===t?e:e.concat(r[t])}),[]);(0===o.length||u&&n.uuid!==t.uuid)&&c.push(t),o.forEach((function(n){l(n)}))}}return l(n),c}(n,"upstream_blocks",e,{includeAllNodes:!0})}function u(n,e){return(0,o.useMemo)((function(){return n.map((function(n){var t=function(n,e){var t=r(n,e);return{dynamicUpstreamBlock:t.find((function(e){var t=e.configuration,o=e.uuid;return(null===t||void 0===t?void 0:t.dynamic)&&o!==(null===n||void 0===n?void 0:n.uuid)})),reduceOutputUpstreamBlock:t.find((function(e){var t=e.configuration,o=e.uuid;return(null===t||void 0===t?void 0:t.reduce_output)&&o!==(null===n||void 0===n?void 0:n.uuid)}))}}(n,e),o=t.dynamicUpstreamBlock,i=t.reduceOutputUpstreamBlock,u=(n||{}).configuration||{};return{block:n,dynamic:!!u.dynamic,dynamicUpstreamBlock:o,reduceOutput:!!u.reduce_output,reduceOutputUpstreamBlock:i}}))}),[e,null===e||void 0===e?void 0:e.map((function(n){var e=n.configuration;return null===e||void 0===e?void 0:e.dynamic})),null===e||void 0===e?void 0:e.map((function(n){var e=n.configuration;return null===e||void 0===e?void 0:e.reduce_output})),null===e||void 0===e?void 0:e.map((function(n){return n.upstream_blocks}))])}},25958:function(n,e,t){function o(n,e){var t,o=null===e||void 0===e?void 0:e.fullPath,i=null===n||void 0===n||null===(t=n.configuration)||void 0===t?void 0:t.file_path;if(o)return null===n||void 0===n?void 0:n.uuid;if(i){var r=i.split("/"),u=r[r.length-1].split(".");return u.pop(),u.join(".")}}t.d(e,{$:function(){return o}})}}]);