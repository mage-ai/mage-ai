"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9624],{29624:function(e,n,t){t.d(n,{Z:function(){return Q}});var i=t(82394),l=t(75582),r=t(12691),u=t.n(r),o=t(82684),c=t(69864),s=t(34376),p=t(71180),d=t(50724),a=t(30160),f=t(44897),h=t(42631),g=t(70515),v=t(38626),_=v.default.div.withConfig({displayName:"indexstyle__ModalStyle",componentId:"sc-qldrgc-0"})(["position:absolute;"," "," display:flex;flex-direction:column;width:","px;overflow:hidden;background-color:",";border:1px solid ",";border-radius:","px;box-shadow:",";"],(function(e){return e.top&&"\n    top: ".concat(e.top,"px;\n  ")}),(function(e){return e.left&&"\n    left: ".concat(e.left,"px;\n  ")}),39*g.iI,(function(e){return(e.theme||f.Z).background.dashboard}),(function(e){return(e.theme||f.Z).borders.darkLight}),h.n_,(function(e){return(e.theme||f.Z).shadow.popup})),x=v.default.div.withConfig({displayName:"indexstyle__ContentStyle",componentId:"sc-qldrgc-1"})(["display:flex;flex-direction:column;gap:","px;padding:","px ","px;"],2*g.iI,2.5*g.iI,2*g.iI),j=v.default.div.withConfig({displayName:"indexstyle__ActionsStyle",componentId:"sc-qldrgc-2"})(["display:flex;gap:","px;padding:","px;background-color:",";border-top:1px solid ",";& > *{flex:1;}"],g.iI,2*g.iI,(function(e){return(e.theme||f.Z).background.panel}),(function(e){return(e.theme||f.Z).borders.darkLight})),y=t(72473),b=t(72191),Z=t(79633),m=t(81728),C=t(28598);var P=function(e){var n=e.inProgressRunsCount,t=e.left,i=void 0===t?0:t,l=e.onAllow,r=e.onStop,u=e.pipelineScheduleId,c=e.pipelineUuid,s=e.top,d=void 0===s?0:s,f=e.topOffset,h=void 0===f?0:f,v=(0,o.useRef)(null),P=(0,o.useState)(d+h),k=P[0],w=P[1];return(0,o.useEffect)((function(){var e=null!==v&&void 0!==v&&v.current?v.current.getBoundingClientRect().height:32*g.iI,n=d+h+e>window.innerHeight;w(n?d-e:d+h)}),[i,d,h]),(0,C.jsxs)(_,{left:i,ref:v,top:k,children:[(0,C.jsxs)(x,{children:[(0,C.jsx)(y.uy,{fill:Z.$R,size:b.nz}),(0,C.jsx)(a.ZP,{bold:!0,large:!0,warning:!0,children:"There ".concat(1===n?"is":"are"," currently ").concat((0,m._6)("run",n,!0)," in progress.")}),(0,C.jsx)(a.ZP,{large:!0,children:"Do you want to stop or allow the ".concat((0,m._6)("run",n,!0,!0)," to complete?")})]}),(0,C.jsxs)(j,{children:[(0,C.jsx)(p.ZP,{large:!0,onClick:function(){return r(u,c)},children:"Stop"}),(0,C.jsx)(p.ZP,{large:!0,onClick:function(){return l(u)},children:"Allow"})]})]})},k=t(55485),w=t(48670),I=t(30229),O=t(89515),S=t(38276),R=t(75499),E=t(48381),A=t(69650),D=t(12468),N=t(35686),T=t(77417),q=t(19698),L=t(81655),U=t(41143),z=t(31608),B=t(16488),F=t(3917),V=t(50178),H=t(72619),X=t(3314),$=t(70320),G=t(89538);function K(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function M(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?K(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var J=1.5*g.iI;var Q=function(e){var n=e.disableActions,t=e.fetchPipelineSchedules,i=e.highlightRowOnHover,r=e.includeCreatedAtColumn,f=e.includePipelineColumn,h=e.pipeline,g=e.pipelineSchedules,v=e.pipelineTriggersByName,_=e.selectedSchedule,x=e.setErrors,j=e.setSelectedSchedule,Z=e.stickyHeader,m=null===h||void 0===h?void 0:h.uuid,K=(0,s.useRouter)(),Q=(0,T.Z)().projectPlatformActivated,W=(0,q.Z)().status,Y=(0,o.useRef)({}),ee=(0,o.useRef)({}),ne=(0,o.useState)(null),te=ne[0],ie=ne[1],le=(0,o.useState)(0),re=le[0],ue=le[1],oe=(0,o.useState)(0),ce=oe[0],se=oe[1],pe=(0,$.qB)(),de=pe?L.O$:{},ae=(0,c.Db)((function(e){return N.ZP.pipelines.useUpdate(e.uuid)({pipeline:e})}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null===t||void 0===t||t()},onErrorCallback:function(e,n){return null===x||void 0===x?void 0:x({errors:n,response:e})}})}}),fe=(0,l.Z)(ae,1)[0],he=(0,c.Db)((function(e){return N.ZP.pipeline_schedules.useUpdate(e.id)({pipeline_schedule:e})}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null===t||void 0===t||t()},onErrorCallback:function(e,n){return null===x||void 0===x?void 0:x({errors:n,response:e})}})}}),ge=(0,l.Z)(he,1)[0],ve=(0,c.Db)((function(e){return N.ZP.pipeline_schedules.useDelete(e)()}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null===t||void 0===t||t(),m?K.push("/pipelines/[pipeline]/triggers","/pipelines/".concat(m,"/triggers")):null===t||void 0===t||t()},onErrorCallback:function(e,n){return x({errors:n,response:e})}})}}),_e=(0,l.Z)(ve,1)[0],xe=[],je=[];n||(xe.push.apply(xe,[null,null]),je.push.apply(je,[{uuid:"Active"},{uuid:"Type"}])),Q&&(xe.push.apply(xe,[null]),je.push.apply(je,[{uuid:"Project"}])),xe.push.apply(xe,[1,2]),je.push.apply(je,[{uuid:"Name"},{uuid:"Description"}]),n||(xe.push.apply(xe,[null]),je.push({uuid:"Frequency"})),xe.push.apply(xe,[1,1,null]),je.push.apply(je,[M(M({},de),{},{uuid:"Next run date"}),{uuid:"Latest status"},{uuid:"Runs"}]),n||(xe.push.apply(xe,[1]),je.push({uuid:"Tags"})),xe.push.apply(xe,[null]),je.push({uuid:"Logs"}),n||(0,V.Ct)()||(xe.push.apply(xe,[null]),je.push({label:function(){return""},uuid:"edit/delete"})),!n&&f&&(je.splice(2,0,{uuid:"Pipeline"}),xe.splice(2,0,1)),!n&&r&&(je.splice(5,0,M(M({},de),{},{uuid:"Created at"})),xe.splice(5,0,null));var ye=(0,G.dd)((function(e){var n=e.inProgressRunsCount,t=e.left,i=e.pipelineScheduleId,l=e.pipelineUuid,r=e.top,u=e.topOffset;return(0,C.jsx)(P,{inProgressRunsCount:n,left:t,onAllow:function(e){me(),ge({id:e,status:I.fq.INACTIVE})},onStop:function(e,n){me(),fe({pipeline_schedule_id:e,status:U.V.CANCELLED,uuid:n}),ge({id:e,status:I.fq.INACTIVE})},pipelineScheduleId:i,pipelineUuid:l,top:r,topOffset:u})}),{},[],{background:!0,uuid:"disable_trigger"}),be=(0,l.Z)(ye,2),Ze=be[0],me=be[1];return(0,C.jsx)(z.cl,{overflowVisible:!0,children:0===g.length?(0,C.jsx)(S.Z,{px:3,py:1,children:(0,C.jsx)(a.ZP,{bold:!0,default:!0,monospace:!0,muted:!0,children:"No triggers available"})}):(0,C.jsx)(R.Z,{columnFlex:xe,columns:je,highlightRowOnHover:i,isSelectedRow:function(e){return g[e].id===(null===_||void 0===_?void 0:_.id)},onClickRow:j?function(e){return null===j||void 0===j?void 0:j(g[e])}:null,rowVerticalPadding:6,rows:g.map((function(e,t){var i=e.id,l=e.created_at,c=e.description,s=e.next_pipeline_run_date,h=e.pipeline_in_progress_runs_count,g=e.pipeline_runs_count,_=e.pipeline_uuid,x=e.last_pipeline_run_status,j=e.name,Z=e.repo_path,P=e.schedule_interval,R=e.status,N=e.tags,T=I.fq.ACTIVE===R,q=(0,B._U)(P),U=m||_;Y.current[i]=(0,o.createRef)(),ee.current[i]=(0,o.createRef)();var z=null!==v&&void 0!==v&&v[j]?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(S.Z,{mr:1}),(0,C.jsx)(D.Z,{block:!0,label:"This trigger is saved in code.",size:J,widthFitContent:!0,children:(0,C.jsx)(y.EK,{default:!0,size:J})})]}):null,H=[];if(n)H.push.apply(H,[(0,C.jsxs)(k.ZP,{alignItems:"center",children:[(0,C.jsx)(a.ZP,{bold:!0,children:j}),z]},"trigger_name_".concat(t))]);else{var $,G;if(H.push.apply(H,[(0,C.jsx)(D.Z,{block:!0,label:R,size:20,widthFitContent:!0,children:(0,C.jsx)("div",{ref:Y.current[i],style:{position:"relative"},children:(0,C.jsx)(A.Z,{checked:T,compact:!0,onCheck:function(e){return function(e){var n=e.event,t=e.inProgressRunsCount,i=e.pipelineIsActive,l=e.pipelineScheduleId,r=e.pipelineUuid;if((0,X.j)(n),i&&t>0){var u,o=null===(u=Y.current[l])||void 0===u?void 0:u.current,c=null===o||void 0===o?void 0:o.getBoundingClientRect(),s=c.height,p=c.left,d=c.top;Ze({inProgressRunsCount:t,left:p,pipelineScheduleId:l,pipelineUuid:r,top:d,topOffset:s})}else ge({id:l,status:i?I.fq.INACTIVE:I.fq.ACTIVE})}({event:e,inProgressRunsCount:h,pipelineIsActive:T,pipelineScheduleId:i,pipelineUuid:_})},purpleBackground:!0})})},"trigger_enabled_".concat(t)),(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:null===($=I.Z4[e.schedule_type])||void 0===$?void 0:$.call(I.Z4)},"trigger_type_".concat(t))]),Q)H.push.apply(H,[(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:null===Z||void 0===Z||null===(G=Z.replace((null===W||void 0===W?void 0:W.repo_path_root)||"",""))||void 0===G?void 0:G.slice(1)},"project_".concat(t))]);H.push.apply(H,[(0,C.jsxs)(k.ZP,{alignItems:"center",children:[(0,C.jsx)(u(),{as:"/pipelines/".concat(U,"/triggers/").concat(i),href:"/pipelines/[pipeline]/triggers/[...slug]",passHref:!0,children:(0,C.jsx)(w.Z,{bold:!0,onClick:function(e){(0,X.j)(e),K.push("/pipelines/[pipeline]/triggers/[...slug]","/pipelines/".concat(U,"/triggers/").concat(i))},sky:!0,children:j})}),z]},"trigger_name_".concat(t))])}return H.push.apply(H,[(0,C.jsx)(a.ZP,{default:!0,children:c},"trigger_description_".concat(t))]),n||H.push((0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:pe&&q?(0,B.lO)(P):P},"trigger_frequency_".concat(t))),H.push.apply(H,[(0,C.jsx)(a.ZP,{monospace:!0,small:!0,title:s?"UTC: ".concat(s.slice(0,19)):null,children:s?pe?(0,F.XG)(s,pe):(0,F.d$)(s,{includeSeconds:!0,utcFormat:!0}):(0,C.jsx)(C.Fragment,{children:"\u2014"})},"trigger_next_run_date_".concat(t)),(0,o.createElement)(a.ZP,M(M({},(0,L.NC)(x)),{},{key:"latest_run_status_".concat(t)}),x||"N/A"),(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:g||"0"},"trigger_run_count_".concat(t))]),n||H.push((0,C.jsx)("div",{children:(0,C.jsx)(E.Z,{tags:null===N||void 0===N?void 0:N.map((function(e){return{uuid:e}}))})},"pipeline_tags_".concat(t))),H.push((0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return K.push("/pipelines/".concat(U,"/logs?pipeline_schedule_id[]=").concat(i))},children:(0,C.jsx)(y.UL,{default:!0,size:b.bL})},"logs_button_".concat(t))),n||(0,V.Ct)()||H.push((0,C.jsxs)(k.ZP,{children:[(0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return K.push("/pipelines/".concat(U,"/triggers/").concat(i,"/edit"))},title:"Edit",children:(0,C.jsx)(y.I8,{default:!0,size:b.bL})}),(0,C.jsx)(S.Z,{mr:1}),(0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){var e,n,t,l;ie(i),ue((null===(e=ee.current[i])||void 0===e||null===(n=e.current)||void 0===n?void 0:n.offsetTop)||0),se((null===(t=ee.current[i])||void 0===t||null===(l=t.current)||void 0===l?void 0:l.offsetLeft)||0)},ref:ee.current[i],title:"Delete",children:(0,C.jsx)(y.rF,{default:!0,size:b.bL})}),(0,C.jsx)(d.Z,{onClickOutside:function(){return ie(null)},open:te===i,children:(0,C.jsx)(O.Z,{danger:!0,left:(ce||0)-L.nH,onCancel:function(){return ie(null)},onClick:function(){ie(null),_e(i)},title:"Are you sure you want to delete the trigger ".concat(j,"?"),top:(re||0)-(t<=1?L.oz:L.OK),width:L.Xx})})]},"edit_delete_buttons_".concat(t))),!n&&f&&H.splice(2,0,(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:U},"pipeline_name_".concat(t))),!n&&r&&H.splice(5,0,(0,C.jsx)(a.ZP,{default:!0,monospace:!0,small:!0,title:l?(0,F._6)(l):null,children:(0,F.XG)(null===l||void 0===l?void 0:l.slice(0,19),pe)},"created_at_".concat(t))),H})),stickyHeader:Z,uuid:"pipeline-triggers"})})}},19698:function(e,n,t){var i=t(82684),l=t(35686);n.Z=function(){var e=l.ZP.statuses.list().data;return{status:(0,i.useMemo)((function(){var n;return null===e||void 0===e||null===(n=e.statuses)||void 0===n?void 0:n[0]}),[e])}}}}]);