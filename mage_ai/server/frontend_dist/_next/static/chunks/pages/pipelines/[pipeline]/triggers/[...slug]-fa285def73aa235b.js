(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[643],{92709:function(e,n,t){"use strict";t.d(n,{IY:function(){return s},Jf:function(){return l},LR:function(){return r},NR:function(){return o},b7:function(){return i}});var i="edit",r="[ERR_BLOCK_EXISTS]",l={uuid:"All files"},s={uuid:"Files in pipeline"},o=[l,s]},39457:function(e,n,t){"use strict";var i,r=t(82394),l=(t(82684),t(64866)),s=t(21764),o=t(55485),c=t(48670),u=t(38276),a=t(30160),d=t(12468),p=t(72473),h=t(70515),m=t(28598);function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}!function(e){e.LEFT="left",e.RIGHT="right"}(i||(i={})),n.Z=function(e){var n,t=e.children,r=e.copiedText,f=e.iconPosition,v=void 0===f?i.LEFT:f,x=e.inverted,j=e.linkProps,Z=e.linkText,b=e.monospace,_=e.muted,P=e.small,y=e.toastMessage,O=e.withCopyIcon;return t?n=(0,m.jsx)("span",{children:t}):O&&(n=(0,m.jsx)(c.Z,g(g({href:"#",inline:!0,muted:_,preventDefault:!0,sameColorAsText:!0,small:P},j),{},{children:(0,m.jsxs)(o.ZP,{alignItems:"center",children:[v===i.LEFT&&(0,m.jsx)(u.Z,{mr:Z?1:0,children:(0,m.jsx)(o.ZP,{alignItems:"center",children:(0,m.jsx)(p.CK,{inverted:x,muted:_,size:2*h.iI})})}),Z&&(0,m.jsx)(a.ZP,{inverted:x,monospace:b,muted:_,small:P,children:Z}),v===i.RIGHT&&(0,m.jsx)(u.Z,{ml:Z?1:0,children:(0,m.jsx)(o.ZP,{alignItems:"center",children:(0,m.jsx)(p.CK,{inverted:x,muted:_})})})]})}))),(0,m.jsx)(d.Z,{block:!0,label:"Copy",size:null,widthFitContent:!0,children:(0,m.jsx)(l.CopyToClipboard,{onCopy:function(){return s.Am.success(y||"Successfully copied to clipboard.",{position:s.Am.POSITION.BOTTOM_RIGHT,toastId:r})},text:r,children:n})})}},666:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Ye}});var i,r=t(75582),l=t(77837),s=t(82394),o=t(38860),c=t.n(o),u=t(82684),a=t(69864),d=t(34376),p=t(71180),h=t(39457),m=t(15338),f=t(55485),g=t(85854),v=t(48670),x=t(55072),j=t(75457),Z=t(53943),b=t(44265),_=t(30229),P=t(83784),y=t(44085),O=t(38276),w=t(4190),I=t(75499),S=t(48381),k=t(30160),E=t(12468),C=t(35686),T=t(8955),M=t(74395),D=t(44425),N=t(72473),A=t(70515),U=t(28795),H=t(86735);!function(e){e.AWS="aws_event"}(i||(i={}));var F=[{label:function(){return"AWS"},uuid:i.AWS}],L=(0,H.HK)(F,(function(e){return e.uuid})),q=t(8916),R=t(16488),W=t(3917),z=t(44375),X=t(15610),Y=t(42122),K=t(50178),V=t(72619),G=t(3314),J=t(69419),B=t(70320),Q=t(28598);function $(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function ee(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?$(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ne=function(e){var n=e.errors,t=e.fetchPipelineSchedule,i=e.pipeline,l=e.pipelineSchedule,s=e.setErrors,o=e.variables,c=(0,d.useRouter)(),F=(0,K.Ct)(),$=(0,B.q)(),ne=(i||{}).uuid,te=l||{},ie=te.description,re=te.id,le=te.event_matchers,se=te.name,oe=te.next_pipeline_run_date,ce=te.schedule_interval,ue=te.schedule_type,ae=te.settings,de=te.sla,pe=te.start_time,he=te.status,me=te.tags,fe=te.variables,ge=void 0===fe?{}:fe,ve=(0,u.useMemo)((function(){return(0,R._U)(ce)}),[ce]),xe=(0,J.iV)(),je={_limit:30,_offset:30*(null!==xe&&void 0!==xe&&xe.page?xe.page:0)};null!==xe&&void 0!==xe&&xe.status&&(je.status=xe.status),null!==l&&void 0!==l&&l.global_data_product_uuid&&(je.global_data_product_uuid=null===l||void 0===l?void 0:l.global_data_product_uuid);var Ze=C.ZP.pipeline_runs.pipeline_schedules.list(re,je,{refreshInterval:3e3,revalidateOnFocus:!0}),be=Ze.data,_e=Ze.mutate,Pe=(0,u.useMemo)((function(){return(null===be||void 0===be?void 0:be.pipeline_runs)||[]}),[be]),ye=(0,u.useMemo)((function(){var e;return(null===be||void 0===be||null===(e=be.metadata)||void 0===e?void 0:e.count)||[]}),[be]),Oe=(0,u.useState)(null),we=Oe[0],Ie=Oe[1],Se=(0,u.useMemo)((function(){var e=null!==xe&&void 0!==xe&&xe.page?xe.page:0;return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(Z.Z,{fetchPipelineRuns:_e,onClickRow:function(e){return Ie((function(n){var t=Pe[e];return(null===n||void 0===n?void 0:n.id)!==t.id?t:null}))},pipelineRuns:Pe,selectedRun:we,setErrors:s}),(0,Q.jsx)(O.Z,{p:2,children:(0,Q.jsx)(x.ZP,{maxPages:9,onUpdate:function(e){var n=Number(e),t=ee(ee({},xe),{},{page:n>=0?n:0});c.push("/pipelines/[pipeline]/triggers/[...slug]","/pipelines/".concat(ne,"/triggers/").concat(re,"?").concat((0,J.uM)(t)))},page:Number(e),totalPages:Math.ceil(ye/30)})})]})}),[_e,Pe,re,ne,xe,c,we,s,ye]),ke=(0,u.useState)(T.G7[0]),Ee=ke[0],Ce=ke[1],Te=(0,a.Db)((function(e){return C.ZP.pipeline_schedules.useUpdate(e.id)({pipeline_schedule:(0,Y.gR)(e,["id"])})}),{onSuccess:function(e){return(0,V.wD)(e,{callback:function(){t()},onErrorCallback:function(e,n){return s({errors:n,response:e})}})}}),Me=(0,r.Z)(Te,2),De=Me[0],Ne=Me[1].isLoading,Ae=C.ZP.pipeline_triggers.pipelines.list(ne),Ue=Ae.data,He=Ae.mutate,Fe=(0,u.useMemo)((function(){return(0,H.HK)((null===Ue||void 0===Ue?void 0:Ue.pipeline_triggers)||[],(function(e){return e.name}))}),[Ue]),Le=(0,u.useMemo)((function(){return!(null===Fe||void 0===Fe||!Fe[null===l||void 0===l?void 0:l.name])}),[l,Fe]),qe=(0,a.Db)(C.ZP.pipeline_triggers.pipelines.useCreate(ne),{onSuccess:function(e){return(0,V.wD)(e,{callback:function(){He()},onErrorCallback:function(e,n){return s({errors:n,response:e})}})}}),Re=(0,r.Z)(qe,2),We=Re[0],ze=Re[1].isLoading,Xe=(0,u.useMemo)((function(){return _.fq.ACTIVE===he}),[he]),Ye=(0,u.useMemo)((function(){var e,n,t={default:!0,size:1.5*A.iI},i=[[(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.VW,ee({},t)),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Trigger type"})]},"trigger_type_label"),(0,Q.jsx)(k.ZP,{monospace:!0,children:null===(e=_.Z4[ue])||void 0===e?void 0:e.call(_.Z4)},"trigger_type")],[(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.rs,ee({},t)),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Status"})]},"trigger_status_label"),(0,Q.jsx)(k.ZP,{danger:!Xe,monospace:!0,success:Xe,children:he},"trigger_status")]];if(ie&&i.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.KJ,ee({},t)),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Description"})]},"trigger_description_label"),(0,Q.jsx)(k.ZP,{children:ie},"trigger_description")]),de){var r=(0,R.gU)(de),s=r.time,o=r.unit,c=1===s?o:"".concat(o,"s");i.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.kI,ee({},t)),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"SLA"})]},"trigger_sla_label"),(0,Q.jsx)(k.ZP,{monospace:!0,children:"".concat(s," ").concat(c)},"trigger_sla")])}if(ce&&i.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.Pf,ee({},t)),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Frequency"})]},"trigger_frequency_label"),(0,Q.jsx)(k.ZP,{monospace:!0,children:$&&ve?(0,R.lO)(ce):ce.replace("@","")},"trigger_frequency")],[(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.aw,ee({},t)),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Next run date"})]},"trigger_next_run_date_label"),(0,Q.jsx)(k.ZP,{monospace:!0,children:oe?$?(0,W.XG)(oe,$):(0,W.d$)(oe,{includeSeconds:!0,utcFormat:!0}):"N/A"},"trigger_next_run_date")]),pe&&i.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.aw,ee({},t)),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Start date"})]},"trigger_start_date_label"),(0,Q.jsx)(k.ZP,{monospace:!0,children:$?(0,W.XG)(pe,$):pe},"trigger_start_date")]),_.Xm.API===ue){var u=(0,R.M8)(l);i.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.Ae,ee({},t)),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"API endpoint"})]},"trigger_api_endpoint_label"),(0,Q.jsx)(h.Z,{copiedText:u,children:(0,Q.jsx)(k.ZP,{monospace:!0,small:!0,children:u})},"trigger_api_endpoint")])}if(null!==ae&&void 0!==ae&&ae.timeout){var a=(0,R.gU)(null===ae||void 0===ae?void 0:ae.timeout),d=a.time,p=a.unit,m=1===d?p:"".concat(p,"s");i.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(E.Z,{default:!0,label:"Timeout set for runs of this trigger",size:1.5*A.iI,widthFitContent:!0}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Timeout"})]},"trigger_timeout"),(0,Q.jsx)(k.ZP,{monospace:!0,children:"".concat(d," ").concat(m)},"trigger_timeout_label")])}null!==ae&&void 0!==ae&&ae.skip_if_previous_running&&i.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(E.Z,{default:!0,label:"Skip current run if any previous runs are still in progress",size:1.5*A.iI,widthFitContent:!0}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Skip if running"})]},"trigger_skip_if_running"),(0,Q.jsx)(k.ZP,{monospace:!0,children:null===(n=ae.skip_if_previous_running)||void 0===n?void 0:n.toString()},"trigger_skip_if_running_label")]);return null!==ae&&void 0!==ae&&ae.allow_blocks_to_fail&&i.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(E.Z,{default:!0,label:"Trigger runs will continue running blocks if other unrelated blocks fail",size:1.5*A.iI,widthFitContent:!0}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Allow blocks to fail"})]},"trigger_allow_blocks_to_fail"),(0,Q.jsx)(k.ZP,{monospace:!0,children:ae.allow_blocks_to_fail.toString()},"trigger_allow_blocks_to_fail_label")]),(0,Q.jsx)(I.Z,{columnFlex:[null,1],rows:i})}),[ie,$,Xe,ve,oe,l,ce,ue,ae,de,pe,he]),Ke=(0,u.useMemo)((function(){return ge||{}}),[ge]),Ve=(0,u.useMemo)((function(){var e,n=[];return(0,Y.Qr)(Ke)?n=(0,q.wx)(o,(function(e){return e.uuid===P.C})):Object.entries(Ke).forEach((function(e){var t=(0,r.Z)(e,2),i=t[0],l=t[1];b.sZ!==i&&n.push({uuid:i,value:(0,q.FS)(l)})})),"undefined"!==typeof(n=(0,q.JZ)(n||[],ue))&&null!==(e=n)&&void 0!==e&&e.length?(0,Q.jsx)(I.Z,{columnFlex:[null,1],rows:n.map((function(e){var n=e.uuid,t=e.value;return[(0,Q.jsx)(k.ZP,{default:!0,monospace:!0,children:n},"settings_variable_label_".concat(n)),(0,Q.jsx)(k.ZP,{monospace:!0,children:t},"settings_variable_".concat(n))]}))}):null}),[ue,Ke,o]),Ge=(0,u.useMemo)((function(){var e,n,t=[],r=null===Ke||void 0===Ke||null===(e=Ke[b.sZ])||void 0===e?void 0:e.blocks;return null===i||void 0===i||null===(n=i.blocks)||void 0===n||n.forEach((function(e){var n=e.type,i=e.uuid;if(D.tf.DBT===n){var l,s=(null===r||void 0===r||null===(l=r[i])||void 0===l?void 0:l.configuration)||{},o=s.flags,c=s.prefix,u=s.suffix,a=(0,z.IU)(e).name;(o||c||u)&&t.push({flags:o,prefix:c,suffix:u,uuid:a})}})),"undefined"!==typeof t&&null!==t&&void 0!==t&&t.length?(0,Q.jsx)(I.Z,{columnFlex:[1,null],rows:t.map((function(e){var n=e.flags,t=e.prefix,i=e.suffix,r=e.uuid;return[(0,Q.jsxs)(k.ZP,{monospace:!0,small:!0,children:[t&&(0,Q.jsx)(k.ZP,{inline:!0,monospace:!0,muted:!0,small:!0,children:t}),r,i&&(0,Q.jsx)(k.ZP,{inline:!0,monospace:!0,muted:!0,small:!0,children:i})]},"settings_variable_label_".concat(r)),(0,Q.jsx)(k.ZP,{monospace:!0,muted:!0,small:!0,children:n&&n.join(", ")},"settings_variable_".concat(r))]}))}):null}),[i,Ke]),Je=(0,u.useMemo)((function(){return(0,Q.jsx)(I.Z,{columnFlex:[null,1],columns:[{uuid:"Provider"},{uuid:"Event"}],rows:null===le||void 0===le?void 0:le.map((function(e,n){var t=e.event_type,i=e.name;return[(0,Q.jsx)(k.ZP,{default:!0,monospace:!0,children:L[t].label()},"".concat(t,"_").concat(n,"_label")),(0,Q.jsx)(k.ZP,{monospace:!0,children:i},"".concat(t,"_").concat(n,"_name"))]}))})}),[le]);return(0,Q.jsxs)(j.Z,{afterHidden:!we,before:(0,Q.jsxs)(M.M,{children:[(0,Q.jsxs)(O.Z,{mb:A.HN,pt:A.cd,px:A.cd,children:[(0,Q.jsxs)(O.Z,{mb:A.cd,children:[_.Xm.TIME===ue&&(0,Q.jsx)(N.kO,{size:5*A.iI}),_.Xm.EVENT===ue&&(0,Q.jsx)(N.Jp,{size:5*A.iI}),_.Xm.API===ue&&(0,Q.jsx)(N.Bf,{size:5*A.iI}),!ue&&(0,Q.jsx)(N.VW,{size:5*A.iI})]}),(0,Q.jsx)(g.Z,{children:se})]}),(0,Q.jsx)(O.Z,{px:A.cd,children:(0,Q.jsx)(g.Z,{level:5,children:"Settings"})}),(0,Q.jsx)(m.Z,{light:!0,mt:1,short:!0}),Ye,(null===le||void 0===le?void 0:le.length)>=1&&(0,Q.jsxs)(O.Z,{my:A.HN,children:[(0,Q.jsx)(O.Z,{px:A.cd,children:(0,Q.jsx)(g.Z,{level:5,children:"Events"})}),(0,Q.jsx)(m.Z,{light:!0,mt:1,short:!0}),Je]}),Ve&&(0,Q.jsxs)(O.Z,{my:A.HN,children:[(0,Q.jsx)(O.Z,{px:A.cd,children:(0,Q.jsx)(g.Z,{level:5,children:"Runtime variables"})}),(0,Q.jsx)(m.Z,{light:!0,mt:1,short:!0}),Ve]}),Ge&&(0,Q.jsxs)(O.Z,{my:A.HN,children:[(0,Q.jsx)(O.Z,{px:A.cd,children:(0,Q.jsx)(g.Z,{level:5,children:"dbt runtime settings"})}),(0,Q.jsx)(m.Z,{light:!0,mt:1,short:!0}),Ge]}),(null===me||void 0===me?void 0:me.length)>=1&&(0,Q.jsxs)(O.Z,{my:A.HN,children:[(0,Q.jsx)(O.Z,{px:A.cd,children:(0,Q.jsx)(g.Z,{level:5,children:"Tags"})}),(0,Q.jsx)(m.Z,{light:!0,mt:1,short:!0}),(0,Q.jsx)(O.Z,{mt:A.cd,px:A.cd,children:(0,Q.jsx)(S.Z,{tags:null===me||void 0===me?void 0:me.map((function(e){return{uuid:e}}))})})]}),(0,Q.jsx)(O.Z,{my:A.HN,children:(0,Q.jsxs)(O.Z,{px:A.cd,children:[(0,Q.jsxs)(g.Z,{level:5,children:[Le&&"Trigger exists in code",!Le&&"Store trigger in code"]}),(0,Q.jsx)(O.Z,{mt:1,children:(0,Q.jsxs)(k.ZP,{default:!0,children:["Save or update the trigger and its settings in the pipeline\u2019s metadata and version control the trigger using Git. For more information, please read the ",(0,Q.jsx)(v.Z,{href:"https://docs.mage.ai/guides/triggers/configure-triggers-in-code",openNewWindow:!0,children:"documentation"}),"."]})}),(0,Q.jsxs)(O.Z,{mt:A.cd,children:[!Ue&&(0,Q.jsx)(w.Z,{inverted:!0}),Ue&&(0,Q.jsxs)(p.Z,{disabled:!(null!==l&&void 0!==l&&l.id),loading:ze,onClick:function(){We({pipeline_trigger:{pipeline_schedule_id:null===l||void 0===l?void 0:l.id}})},secondary:!0,children:[Le&&"Update trigger in code",!Le&&"Save trigger in code"]})]})]})})]}),beforeWidth:M.W,breadcrumbs:[{label:function(){return"Triggers"},linkProps:{as:"/pipelines/".concat(ne,"/triggers"),href:"/pipelines/[pipeline]/triggers"}},{label:function(){return se},linkProps:{as:"/pipelines/".concat(ne,"/triggers/").concat(re),href:"/pipelines/[pipeline]/triggers/[...slug]"}}],buildSidekick:function(e){return(0,T.ZP)(ee(ee({},e),{},{selectedRun:we,selectedTab:Ee,setSelectedTab:Ce}))},errors:n,pageName:U.M.TRIGGERS,pipeline:i,setErrors:s,subheader:(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(p.Z,{beforeIcon:Xe?(0,Q.jsx)(N.dz,{size:2*A.iI}):(0,Q.jsx)(N.Py,{inverted:!F,size:2*A.iI}),danger:Xe&&!F,loading:Ne,onClick:function(e){(0,G.j)(e),De({id:re,status:Xe?_.fq.INACTIVE:_.fq.ACTIVE})},outline:!0,success:!Xe&&!F,children:Xe?"Pause trigger":"Start trigger"}),(0,Q.jsx)(O.Z,{mr:A.cd}),!F&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(p.Z,{linkProps:{as:"/pipelines/".concat(ne,"/triggers/").concat(re,"/edit"),href:"/pipelines/[pipeline]/triggers/[...slug]"},noHoverUnderline:!0,outline:!0,sameColorAsText:!0,children:"Edit trigger"}),(0,Q.jsx)(O.Z,{mr:A.cd})]}),(0,Q.jsxs)(y.Z,{compact:!0,defaultColor:!0,onChange:function(e){e.preventDefault(),"all"===e.target.value?c.push("/pipelines/[pipeline]/triggers/[...slug]","/pipelines/".concat(ne,"/triggers/").concat(re)):(0,X.u7)({page:0,status:e.target.value})},paddingRight:4*A.iI,placeholder:"Select run status",value:(null===xe||void 0===xe?void 0:xe.status)||"all",children:[(0,Q.jsx)("option",{value:"all",children:"All statuses"},"all_statuses"),b.IK.map((function(e){return(0,Q.jsx)("option",{value:e,children:b.Do[e]},e)}))]})]}),title:function(){return se},uuid:"triggers/detail",children:[(0,Q.jsx)(O.Z,{mt:A.cd,px:A.cd,children:(0,Q.jsx)(g.Z,{level:5,children:"Runs for this trigger"})}),(0,Q.jsx)(m.Z,{light:!0,mt:A.cd,short:!0}),Se]})},te=t(21831),ie=t(20026),re=t.n(ie),le=t(92083),se=t.n(le),oe=t(21764),ce=t(14805),ue=t(70652),ae=t(50724),de=t(9134),pe=t(38626),he=t(39867),me=t(17488),fe=t(55283);function ge(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function ve(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ge(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ge(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var xe=function(e){var n=e.blocks,t=e.updateVariables,i=e.variables,r=(0,u.useContext)(pe.ThemeContext),l=(0,u.useCallback)((function(e,n){return t((function(){var t=(null===i||void 0===i?void 0:i.__mage_variables)||{},r=(null===t||void 0===t?void 0:t.blocks)||{},l=r[e]||{},o=(null===l||void 0===l?void 0:l.configuration)||{};return ve(ve({},i),{},{__mage_variables:ve(ve({},t),{},{blocks:ve(ve({},r),{},(0,s.Z)({},e,ve(ve({},l),{},{configuration:ve(ve({},o),n)})))})})}))}),[t,i]);return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(g.Z,{children:"dbt runtime settings"}),(0,Q.jsx)(O.Z,{mt:A.Mq,children:(0,Q.jsx)(I.Z,{columnFlex:[1,null,null,null],columns:[{uuid:"Block"},{uuid:"Flags"},{uuid:"Prefix"},{uuid:"Suffix"}],compact:!0,rows:null===n||void 0===n?void 0:n.map((function(e){var n,t,s,o=e.type,c=e.uuid,u=(0,z.IU)(e).name,a=(0,fe.qn)(o,{blockColor:e.color,theme:r}).accent,d=null===i||void 0===i||null===(n=i.__mage_variables)||void 0===n||null===(t=n.blocks)||void 0===t||null===(s=t[c])||void 0===s?void 0:s.configuration,p=d||{},h=p.prefix,m=p.suffix,g=(null===d||void 0===d?void 0:d.flags)||[],v=!(null===g||void 0===g||!g.includes(z.Dy));return[(0,Q.jsx)(E.Z,{block:!0,label:(0,Q.jsx)(k.ZP,{monospace:!0,small:!0,children:c}),size:null,widthFitContent:!0,children:(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(he.Z,{color:a,size:1.5*A.iI,square:!0}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsxs)(k.ZP,{monospace:!0,small:!0,children:[h&&(0,Q.jsx)(k.ZP,{default:!0,inline:!0,monospace:!0,small:!0,children:h}),u,m&&(0,Q.jsx)(k.ZP,{default:!0,inline:!0,monospace:!0,small:!0,children:m})]})]})},"uuid-".concat(c)),(0,Q.jsx)(f.ZP,{alignItems:"center",children:(0,Q.jsx)(ue.Z,{checked:v,label:z.Dy,monospace:!0,onClick:function(){return l(c,{flags:v?(0,H.Od)(g,(function(e){return z.Dy===e})):g.concat(z.Dy)})},small:!0})},"flags-".concat(c)),(0,Q.jsx)(me.Z,{compact:!0,monospace:!0,onChange:function(e){return l(c,{prefix:e.target.value})},placeholder:"N+, +",small:!0,value:h,width:10*A.iI},"prefix-".concat(c)),(0,Q.jsx)(me.Z,{compact:!0,monospace:!0,onChange:function(e){return l(c,{suffix:e.target.value})},placeholder:"+, +N",small:!0,value:m,width:10*A.iI},"suffix-".concat(c))]}))})})]})},je=t(97618),Ze=t(26304),be=t(44897),_e=t(95363),Pe=t(61896),ye=["children","large","lineHeight","ordered"];function Oe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function we(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Oe(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Oe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Ie=(0,pe.css)([""," "," "," "," "," "," "," "," "," ",""],(function(e){return!e.muted&&"\n    color: ".concat((e.theme.content||be.Z.content).default,";\n  ")}),(function(e){return e.muted&&"\n    color: ".concat((e.theme.content||be.Z.content).muted,";\n  ")}),(function(e){return e.inverted&&"\n    color: ".concat((e.theme.content||be.Z.content).inverted,";\n  ")}),(function(e){return e.color&&"\n    color: ".concat(e.color,";\n  ")}),(function(e){return!e.monospace&&"\n    font-family: ".concat(_e.ry,";\n  ")}),(function(e){return e.monospace&&"\n    font-family: ".concat(_e.Vp,";\n  ")}),(function(e){return e.large&&"\n    ".concat(Pe.x_,"\n  ")}),(function(e){return!e.large&&!e.small&&"\n    ".concat(Pe.i3,"\n  ")}),(function(e){return e.small&&"\n    ".concat(Pe.J5,"\n  ")}),(function(e){return e.lineHeight&&"\n    line-height: ".concat(e.lineHeight,"px !important;\n  ")})),Se=pe.default.ul.withConfig({displayName:"List__UnorderedListStyle",componentId:"sc-1f6yhbi-0"})(["",""],Ie),ke=pe.default.ol.withConfig({displayName:"List__OrderedListStyle",componentId:"sc-1f6yhbi-1"})(["",""],Ie),Ee=pe.default.li.withConfig({displayName:"List__ListItemStyle",componentId:"sc-1f6yhbi-2"})(["",""],(function(e){return e.large&&e.marginTop&&"\n    margin-top: ".concat(1*A.iI,"px;\n  ")}));var Ce=function(e){var n=e.children,t=e.large,i=e.lineHeight,r=e.ordered,l=(0,Ze.Z)(e,ye),s=r?ke:Se;return(0,Q.jsx)(s,we(we({large:t,lineHeight:i},l),{},{children:u.Children.map(n,(function(e,n){var i;return(0,Q.jsx)(Ee,we(we({large:t,marginTop:n>=1},l),{},{children:u.cloneElement(e)}),(null===(i=e.props)||void 0===i?void 0:i.key)||n)}))}))},Te=t(57653),Me=t(81334),De=t(69650),Ne=t(88785),Ae=t(79500),Ue=t(81728);function He(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function Fe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?He(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):He(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Le=function(e){var n=e.errors,t=e.fetchPipelineSchedule,i=e.pipeline,l=e.pipelineSchedule,o=e.setErrors,c=e.variables,x=(0,d.useRouter)(),Z=(0,B.q)(),w=null===i||void 0===i?void 0:i.uuid,S=null===l||void 0===l?void 0:l.id,E=(null===i||void 0===i?void 0:i.type)===Te.qL.STREAMING,T=(0,u.useState)([]),M=T[0],L=T[1],z=(0,u.useState)(!1),X=z[0],K=z[1],G=(0,u.useState)(!1),J=G[0],$=G[1],ee=(0,u.useState)(),ne=ee[0],ie=ee[1],le=(0,u.useState)({}),pe=le[0],he=le[1],fe=(0,u.useState)(null),ge=fe[0],ve=fe[1],Ze=(0,u.useState)(!1),be=Ze[0],_e=Ze[1],Pe=(0,u.useState)(null),ye=Pe[0],Oe=Pe[1],we=(0,u.useMemo)((function(){return(0,q.wx)(c,(function(e){return e.uuid===P.C}))}),[c]),Ie=ge||{},Se=Ie.description,ke=Ie.name,Ee=Ie.schedule_interval,He=Ie.schedule_type,Le=Ie.settings,qe=void 0===Le?{}:Le,Re=(Ie.sla,Ie.start_time),We=Ie.tags,ze=Ie.variables,Xe=void 0===ze?{}:ze;(0,u.useEffect)((function(){qe&&ie(qe)}),[qe]);var Ye=(0,u.useState)(null),Ke=Ye[0],Ve=Ye[1],Ge=(0,u.useState)({hour:"00",minute:"00"}),Je=Ge[0],Be=Ge[1],Qe=(0,u.useState)({dayOfMonth:null,dayOfWeek:null,hour:null,minute:null,second:null}),$e=Qe[0],en=Qe[1],nn=C.ZP.event_rules.detail(_.Xm.EVENT===He?"aws":null).data,tn=(0,u.useMemo)((function(){var e;return(null===nn||void 0===nn||null===(e=nn.event_rule)||void 0===e?void 0:e.rules)||[]}),[nn]),rn=(0,u.useMemo)((function(){return(0,H.HK)(tn,(function(e){return e.name}))}),[tn]),ln=(0,a.Db)(C.ZP.pipeline_schedules.useUpdate(S),{onSuccess:function(e){return(0,V.wD)(e,{callback:function(){t(),x.push("/pipelines/[pipeline]/triggers/[...slug]","/pipelines/".concat(w,"/triggers/").concat(S))},onErrorCallback:function(e,n){return o({errors:n,response:e})}})}}),sn=(0,r.Z)(ln,2),on=sn[0],cn=sn[1].isLoading,un=(0,u.useMemo)((function(){return Xe||{}}),[Xe]);(0,u.useEffect)((function(){if(Re){var e=(0,Ae.a)(Re,{localTimezone:Z});Ve(null===e||void 0===e?void 0:e.date),Be(null===e||void 0===e?void 0:e.time);var n=se()(Re).utc();en({dayOfMonth:n.date(),dayOfWeek:n.day(),hour:n.hours(),minute:n.minutes(),second:n.seconds()})}else{var t=new Date;Ve(t),Be(Z?{hour:(0,W.lJ)(String(t.getHours())),minute:(0,W.lJ)(String(t.getMinutes()))}:{hour:(0,W.lJ)(String(t.getUTCHours())),minute:(0,W.lJ)(String(t.getUTCMinutes()))})}}),[Z,Re]),(0,u.useEffect)((function(){un&&Object.keys(un).length>0&&K(!0)}),[un]),(0,u.useEffect)((function(){he(X?null===we||void 0===we?void 0:we.reduce((function(e,n){var t=n.uuid,i=n.value;return Fe(Fe({},e),{},(0,s.Z)({},t,un[t]||i))}),{}):null)}),[we,X,un]);var an=(0,u.useMemo)((function(){return(0,R._U)(Ee)}),[Ee]),dn=(0,u.useMemo)((function(){return an&&ye?re().toString(ye,{throwExceptionOnParseError:!1}):""}),[ye,an]),pn=(0,u.useMemo)((function(){return null===dn||void 0===dn?void 0:dn.toLowerCase().includes("error")}),[dn]);(0,u.useEffect)((function(){if(l&&!ge){if(L(l.event_matchers),(0,R._U)(null===l||void 0===l?void 0:l.schedule_interval)){var e=Z?(0,R.lO)(null===l||void 0===l?void 0:l.schedule_interval):null===l||void 0===l?void 0:l.schedule_interval;Oe(e),ve(Fe(Fe({},l),{},{schedule_interval:"custom"}))}else ve(E?Fe(Fe({},l),{},{schedule_interval:_.U5.ONCE}):l);var n=l.sla;if(n){$(!0);var t=(0,R.gU)(n),i=t.time,r=t.unit;ve((function(e){return Fe(Fe({},e),{},{slaAmount:i,slaUnit:r})}))}}}),[Z,E,l,ge,Ee]);var hn=(0,u.useMemo)((function(){return!(null===ne||void 0===ne||!ne.landing_time_enabled)}),[ne]),mn=(0,u.useMemo)((function(){return _.Xm.TIME!==He||![_.U5.DAILY,_.U5.HOURLY,_.U5.MONTHLY,_.U5.WEEKLY].includes(Ee)}),[Ee,He]),fn=(0,u.useMemo)((function(){return hn&&!mn}),[mn,hn]),gn=(0,u.useCallback)((function(){var e=Fe(Fe({},(0,Y.GL)(ge,["name","description","schedule_type","tags"])),{},{event_matchers:[],schedule_interval:null,start_time:null,variables:(0,q.e7)(pe)});if(fn){var n=$e.dayOfMonth,t=$e.dayOfWeek,i=$e.hour,r=$e.minute,s=$e.second,o=se()("2023-07-01").utc();(0,Ue.HW)(n)&&(o=o.date(n)),(0,Ue.HW)(t)&&(o=o.day(t)),(0,Ue.HW)(i)&&(o=o.hours(i)),(0,Ue.HW)(r)&&(o=o.minutes(r)),(0,Ue.HW)(s)&&(o=o.seconds(s)),e.schedule_interval=an?ye:ge.schedule_interval,e.start_time=o.toISOString()}else _.Xm.EVENT===ge.schedule_type?e.event_matchers=M:(e.schedule_interval=an?Z&&!pn&&ye?(0,R.lO)(ye,!0):ye:ge.schedule_interval,e.start_time=Ke&&null!==Je&&void 0!==Je&&Je.hour&&null!==Je&&void 0!==Je&&Je.minute?(0,R.XM)(Ke,Je,{convertToUtc:Z,includeSeconds:!0,localTimezone:Z}):null);if(J){var c=null===ge||void 0===ge?void 0:ge.slaAmount,u=null===ge||void 0===ge?void 0:ge.slaUnit;if(!c||isNaN(c)||!u)return void oe.Am.error("Please enter a valid SLA",{position:oe.Am.POSITION.BOTTOM_RIGHT,toastId:"sla_error"});e.sla=(0,R.vJ)(c,u)}else null!==l&&void 0!==l&&l.sla&&(e.sla=0);e.settings=ne,on({pipeline_schedule:e})}),[pn,ye,Ke,Z,J,M,an,$e,l,pe,ge,ne,fn,Je,on]),vn=(0,u.useMemo)((function(){if(null===l||void 0===l||!l.runtime_average)return"Trigger doesn\u2019t have enough history to estimate runtime.";var e=Number(null===l||void 0===l?void 0:l.runtime_average),n=Math.max(Math.floor(e/3600),0),t=Math.max(Math.floor((e-60*n*60)/60),0),i=Math.max(Math.floor(e-(60*n*60+60*t)),0),r=[];return n>=1&&r.push((0,Ue._6)("hour",n,!0)),t>=1&&r.push((0,Ue._6)("minute",t,!0)),i>=1&&r.push((0,Ue._6)("second",i,!0)),r.join(" ")}),[l]),xn=(0,u.useMemo)((function(){if(!fn)return null;var e=[(0,Q.jsxs)(O.Z,{mr:1,children:[(0,Q.jsx)(O.Z,{mb:1,children:(0,Q.jsx)(k.ZP,{bold:!0,default:!0,small:!0,children:"Minute"})}),(0,Q.jsxs)(y.Z,{compact:!0,monospace:!0,onChange:function(e){en((function(n){return Fe(Fe({},n),{},{minute:e.target.value})}))},value:(null===$e||void 0===$e?void 0:$e.minute)||"",children:[(0,Q.jsx)("option",{value:""}),(0,H.w6)(60).map((function(e,n){return(0,Q.jsx)("option",{value:n,children:n>=10?String(n):"0".concat(n)},n)}))]})]},"Minute"),(0,Q.jsxs)(O.Z,{mr:1,children:[(0,Q.jsx)(O.Z,{mb:1,children:(0,Q.jsx)(k.ZP,{bold:!0,default:!0,small:!0,children:"Second"})}),(0,Q.jsxs)(y.Z,{compact:!0,monospace:!0,onChange:function(e){en((function(n){return Fe(Fe({},n),{},{second:e.target.value})}))},value:(null===$e||void 0===$e?void 0:$e.second)||"",children:[(0,Q.jsx)("option",{value:""}),(0,H.w6)(60).map((function(e,n){return(0,Q.jsx)("option",{value:n,children:n>=10?String(n):"0".concat(n)},n)}))]})]},"Second")];return[_.U5.DAILY,_.U5.MONTHLY,_.U5.WEEKLY].includes(Ee)&&e.unshift((0,Q.jsxs)(O.Z,{mr:1,children:[(0,Q.jsx)(O.Z,{mb:1,children:(0,Q.jsx)(k.ZP,{bold:!0,default:!0,small:!0,children:"Hour"})}),(0,Q.jsxs)(y.Z,{compact:!0,monospace:!0,onChange:function(e){en((function(n){return Fe(Fe({},n),{},{hour:e.target.value})}))},value:(null===$e||void 0===$e?void 0:$e.hour)||"",children:[(0,Q.jsx)("option",{value:""}),(0,H.w6)(24).map((function(e,n){return(0,Q.jsx)("option",{value:n,children:n>=10?String(n):"0".concat(n)},n)}))]})]},"Hour")),_.U5.WEEKLY===Ee?e.unshift((0,Q.jsxs)(O.Z,{mr:1,children:[(0,Q.jsx)(O.Z,{mb:1,children:(0,Q.jsx)(k.ZP,{bold:!0,default:!0,small:!0,children:"Day of the week"})}),(0,Q.jsxs)(y.Z,{compact:!0,monospace:!0,onChange:function(e){en((function(n){return Fe(Fe({},n),{},{dayOfWeek:e.target.value})}))},value:(null===$e||void 0===$e?void 0:$e.dayOfWeek)||"",children:[(0,Q.jsx)("option",{value:""}),(0,Q.jsx)("option",{value:6,children:"Sunday"}),(0,Q.jsx)("option",{value:0,children:"Monday"}),(0,Q.jsx)("option",{value:1,children:"Tuesday"}),(0,Q.jsx)("option",{value:2,children:"Wednesday"}),(0,Q.jsx)("option",{value:3,children:"Thursday"}),(0,Q.jsx)("option",{value:4,children:"Friday"}),(0,Q.jsx)("option",{value:5,children:"Saturday"})]})]},"Day of the week")):_.U5.MONTHLY===Ee&&e.unshift((0,Q.jsxs)(O.Z,{mr:1,children:[(0,Q.jsx)(O.Z,{mb:1,children:(0,Q.jsx)(k.ZP,{bold:!0,default:!0,small:!0,children:"Day of the month"})}),(0,Q.jsxs)(y.Z,{compact:!0,monospace:!0,onChange:function(e){en((function(n){return Fe(Fe({},n),{},{dayOfMonth:e.target.value})}))},value:(null===$e||void 0===$e?void 0:$e.dayOfMonth)||"",children:[(0,Q.jsx)("option",{value:""}),(0,H.w6)(31).map((function(e,n){return(0,Q.jsx)("option",{value:n+1,children:n+1>=10?String(n+1):"0".concat(n+1)},n+1)}))]})]},"Day of the month")),(0,Q.jsx)(f.ZP,{children:e})}),[$e,Ee,fn]),jn=(0,u.useMemo)((function(){return[(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.KJ,{default:!0}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Trigger name"})]},"trigger_name"),(0,Q.jsx)(me.Z,{monospace:!0,onChange:function(e){e.preventDefault(),ve((function(n){return Fe(Fe({},n),{},{name:e.target.value})}))},placeholder:"Name this trigger",value:ke},"trigger_name_input")]}),[ke]),Zn=(0,u.useMemo)((function(){return[(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.KJ,{default:!0}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Trigger description"})]},"trigger_description"),(0,Q.jsx)(me.Z,{monospace:!0,onChange:function(e){e.preventDefault(),ve((function(n){return Fe(Fe({},n),{},{description:e.target.value})}))},placeholder:"Description",value:Se},"trigger_description_input")]}),[Se]),bn=(0,u.useMemo)((function(){var e=[jn,Zn,[(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.Pf,{default:!0,size:1.5*A.iI}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Frequency"})]},"frequency"),(0,Q.jsxs)("div",{children:[(0,Q.jsxs)(y.Z,{monospace:!0,onChange:function(e){e.preventDefault();var n=e.target.value;ve((function(e){return Fe(Fe({},e),{},{schedule_interval:n})}))},placeholder:"Choose the frequency to run",value:Ee,children:[Object.values(_.U5).map((function(e){return(0,Q.jsx)("option",{value:e,children:e.substring(1)},e)})),(0,Q.jsx)("option",{value:"custom",children:"custom"},"custom")]}),(0,Q.jsx)(O.Z,{mt:1,p:1,children:(0,Q.jsxs)(k.ZP,{muted:!0,small:!0,children:["If you don\u2019t see the frequency option you need, select ",(0,Q.jsx)(k.ZP,{inline:!0,monospace:!0,small:!0,children:"custom"})," and enter CRON syntax."]})})]},"frequency_input")]];return e.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.rs,{default:!0,size:1.5*A.iI}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Enable landing time"})]},"frequency"),(0,Q.jsxs)("div",{children:[(0,Q.jsx)(De.Z,{checked:hn,disabled:mn,onCheck:function(){ie((function(e){return Fe(Fe({},e),{},{landing_time_enabled:!hn})}))}}),(0,Q.jsxs)(O.Z,{mt:1,p:1,children:[mn&&(0,Q.jsxs)(k.ZP,{muted:!0,small:!0,children:["In order to enable landing time, the trigger\u2019s frequency must be ",(0,Q.jsx)(k.ZP,{inline:!0,monospace:!0,small:!0,children:_.U5.HOURLY}),", ",(0,Q.jsx)(k.ZP,{inline:!0,monospace:!0,small:!0,children:_.U5.DAILY}),", ",(0,Q.jsx)(k.ZP,{inline:!0,monospace:!0,small:!0,children:_.U5.WEEKLY}),", or ",(0,Q.jsx)(k.ZP,{inline:!0,monospace:!0,small:!0,children:_.U5.MONTHLY}),"."]}),!mn&&(0,Q.jsx)(k.ZP,{muted:!0,small:!0,children:"Instead of starting at a specific time, this trigger will schedule pipeline runs at a time where it will finish by the specified time below."})]})]},"frequency_input")]),fn&&e.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.Pf,{default:!0,size:1.5*A.iI}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Average runtime"})]},"runtime_average"),(0,Q.jsx)(f.ZP,{alignItems:"center",style:{minHeight:"".concat(5.75*A.iI,"px")},children:(0,Q.jsx)(k.ZP,{monospace:!0,children:vn})},"runtime_average_value")]),e.push([(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.aw,{default:!0,size:1.5*A.iI}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsxs)(k.ZP,{default:!0,children:[fn&&"Pipeline complete by",!fn&&"Start date and time"]})]},"start_time"),fn?xn:(0,Q.jsxs)("div",{style:{minHeight:"".concat(5.75*A.iI,"px")},children:[!be&&(0,Q.jsx)(me.Z,{monospace:!0,onClick:function(){return _e((function(e){return!e}))},placeholder:"YYYY-MM-DD HH:MM",value:Ke?(0,R.XM)(Ke,Je,{localTimezone:Z}):""}),(0,Q.jsx)("div",{style:{width:"400px"},children:(0,Q.jsx)(ae.Z,{disableEscape:!0,onClickOutside:function(){return _e(!1)},open:be,style:{position:"relative"},children:(0,Q.jsx)(ce.Z,{localTime:Z,selectedDate:Ke,selectedTime:Je,setSelectedDate:Ve,setSelectedTime:Be,topPosition:!0})})})]},"start_time_input")]),E&&e.splice(2,2),an&&e.splice(2,0,[(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.EK,{default:!0,size:1.5*A.iI}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"Cron expression"})]},"cron_expression"),(0,Q.jsxs)("div",{children:[(0,Q.jsx)(me.Z,{monospace:!0,onChange:function(e){e.preventDefault(),Oe(e.target.value)},placeholder:"* * * * *",value:ye}),(0,Q.jsxs)(O.Z,{mt:1,p:1,children:[(0,Q.jsx)(k.ZP,{monospace:!0,xsmall:!0,children:"[minute] [hour] [day(month)] [month] [day(week)]"}),ye?(0,Q.jsx)(k.ZP,{danger:pn,muted:!0,small:!0,children:pn?"Invalid cron expression. Please check the cron syntax.":(0,Q.jsxs)(Q.Fragment,{children:['"',dn,'"']})}):null,Z&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(k.ZP,{bold:!0,inline:!0,small:!0,warning:!0,children:"Note:\xa0"}),(0,Q.jsxs)(k.ZP,{inline:!0,small:!0,children:["If you have the display_local_timezone setting enabled, the local cron expression above will match your local timezone only",(0,Q.jsx)("br",{}),"if the minute and hour values are single values without any special characters, such as the comma, hyphen, or slash.",(0,Q.jsx)("br",{}),"You can still use cron expressions with special characters for the minute/hour values, but it will be based in UTC time."]})]})]})]},"cron_expression_input")]),(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(O.Z,{mb:2,px:A.cd,children:(0,Q.jsx)(g.Z,{children:"Settings"})}),(0,Q.jsx)(m.Z,{light:!0,short:!0}),(0,Q.jsx)(I.Z,{columnFlex:[null,1],rows:e})]})}),[pn,ye,Ke,Z,an,E,mn,hn,xn,dn,vn,Ee,be,fn,Je,jn,Zn]),_n=(0,u.useCallback)((function(e,n){L((function(t){return Object.entries(n).forEach((function(n){var i=(0,r.Z)(n,2),l=i[0],s=i[1];t[e][l]=s})),(0,te.Z)(t)}))}),[L]),Pn=(0,u.useMemo)((function(){return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(O.Z,{mb:A.cd,px:A.cd,children:(0,Q.jsx)(g.Z,{children:"Settings"})}),(0,Q.jsx)(m.Z,{light:!0,short:!0}),(0,Q.jsx)(I.Z,{columnFlex:[null,1],rows:[jn,Zn]}),(0,Q.jsxs)(O.Z,{mb:2,mt:5,px:A.cd,children:[(0,Q.jsx)(g.Z,{children:"Events"}),(0,Q.jsxs)(k.ZP,{muted:!0,children:["Add 1 or more event that will trigger this pipeline to run.",(0,Q.jsx)("br",{}),"If you add more than 1 event, this pipeline will trigger if any of the events are received."]}),(0,Q.jsxs)(O.Z,{mt:A.Mq,children:[(0,Q.jsx)(k.ZP,{bold:!0,large:!0,children:"AWS events"}),(0,Q.jsxs)(k.ZP,{muted:!0,children:["In order to retrieve all the possible AWS events you can trigger your pipeline from,",(0,Q.jsx)("br",{}),"you\u2019ll need to set 3 environment variables (",(0,Q.jsx)(v.Z,{href:"https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-envvars.html",openNewWindow:!0,underline:!0,children:"more info here"}),"):"]}),(0,Q.jsx)(O.Z,{mt:1,children:(0,Q.jsxs)(Ce,{monospace:!0,ordered:!0,children:[(0,Q.jsx)(k.ZP,{monospace:!0,children:"AWS_REGION_NAME"}),(0,Q.jsx)(k.ZP,{monospace:!0,children:"AWS_ACCESS_KEY_ID"}),(0,Q.jsx)(k.ZP,{monospace:!0,children:"AWS_SECRET_ACCESS_KEY"})]})})]})]}),(0,Q.jsx)(m.Z,{light:!0,short:!0}),(null===M||void 0===M?void 0:M.length)>=1&&(0,Q.jsx)(I.Z,{alignTop:!0,columnFlex:[1,1,2,null],columns:[{uuid:"Provider"},{uuid:"Event"},{uuid:"Pattern"},{label:function(){return""},uuid:"delete"}],rows:null===M||void 0===M?void 0:M.map((function(e,n){var t=e.event_type,i=e.name,r=e.pattern,l=e.id||"".concat(t,"-").concat(i,"-").concat(n,"-").concat(JSON.stringify(r)),s=[];return r&&JSON.stringify(r,null,2).split("\n").forEach((function(e){s.push("    ".concat(e))})),[(0,Q.jsx)(y.Z,{monospace:!0,onChange:function(e){return _n(n,{event_type:e.target.value})},placeholder:"Event provider",value:t||"",children:F.map((function(e){var n=e.label,t=e.uuid;return(0,Q.jsx)("option",{value:t,children:n()},t)}))},"event-provider-".concat(l)),(0,Q.jsx)(y.Z,{monospace:!0,onChange:function(e){var t,i=e.target.value,r=null===(t=rn[i])||void 0===t?void 0:t.event_pattern;_n(n,{name:i,pattern:r?JSON.parse(r):null})},placeholder:"Event name",value:i,children:tn.map((function(e){var n=e.name;return(0,Q.jsx)("option",{value:n,children:n},n)}))},"event-name-".concat(l)),r&&(0,Q.jsx)(de.Z,{language:"json",small:!0,source:s.join("\n")}),(0,Q.jsx)(p.Z,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return L((function(e){return(0,H.oM)(e,n)}))},children:(0,Q.jsx)(N.rF,{default:!0,size:2*A.iI})},"remove_event")]}))}),(0,Q.jsx)(O.Z,{p:A.cd,children:(0,Q.jsx)(p.Z,{beforeIcon:(0,Q.jsx)(N.mm,{size:2*A.iI}),onClick:function(){return L((function(e){return e.concat({})}))},outline:!0,children:"Add event matcher"})})]})}),[M,tn,rn,jn,Zn,_n]),yn=(0,u.useMemo)((function(){var e=(0,R.M8)(l);return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(O.Z,{mb:A.cd,px:A.cd,children:(0,Q.jsx)(g.Z,{children:"Settings"})}),(0,Q.jsx)(m.Z,{light:!0,short:!0}),(0,Q.jsx)(I.Z,{columnFlex:[null,1],rows:[jn,Zn]}),(0,Q.jsxs)(O.Z,{mb:2,mt:5,px:A.cd,children:[(0,Q.jsx)(g.Z,{children:"Endpoint"}),(0,Q.jsxs)(k.ZP,{muted:!0,children:["Make a ",(0,Q.jsx)(k.ZP,{bold:!0,inline:!0,monospace:!0,children:"POST"})," request to the following endpoint:"]}),(0,Q.jsx)(O.Z,{mt:A.Mq,children:(0,Q.jsx)(h.Z,{copiedText:e,linkText:e,monospace:!0,withCopyIcon:!0})})]}),(0,Q.jsxs)(O.Z,{mb:2,mt:5,px:A.cd,children:[(0,Q.jsx)(g.Z,{children:"Payload"}),(0,Q.jsx)(k.ZP,{muted:!0,children:"You can optionally include runtime variables in your request payload. These runtime variables are accessible from within each pipeline block."}),(0,Q.jsx)(O.Z,{mt:A.Mq,children:(0,Q.jsx)(h.Z,{copiedText:'{\n  "pipeline_run": {\n    "variables": {\n      "key1": "value1",\n      "key2": "value2"\n    }\n  }\n}\n',withCopyIcon:!0,children:(0,Q.jsx)(de.Z,{language:"json",small:!0,source:'\n    {\n      "pipeline_run": {\n        "variables": {\n          "key1": "value1",\n          "key2": "value2"\n        }\n      }\n    }\n'})})})]}),(0,Q.jsxs)(O.Z,{mb:2,mt:5,px:A.cd,children:[(0,Q.jsx)(g.Z,{children:"Sample cURL command"}),(0,Q.jsx)(O.Z,{mt:A.Mq,children:(0,Q.jsx)(de.Z,{language:"bash",small:!0,source:"\n    curl -X POST ".concat(e,' \\\n      --header \'Content-Type: application/json\' \\\n      --data \'\n    {\n      "pipeline_run": {\n        "variables": {\n          "key1": "value1",\n          "key2": "value2"\n        }\n      }\n    }\'\n')})})]})]})}),[l,Zn,jn]),On=!He||_.Xm.TIME===He&&!(E&&Ke||!E&&Ke&&Ee)||_.Xm.EVENT===He&&(!(null!==M&&void 0!==M&&M.length)||!M.every((function(e){var n=e.event_type,t=e.name;return n&&t}))),wn=(0,u.useMemo)((function(){var e;return(null===i||void 0===i||null===(e=i.blocks)||void 0===e?void 0:e.filter((function(e){var n=e.type;return D.tf.DBT===n})))||[]}),[i]),In=(0,u.useMemo)((function(){return(0,Q.jsxs)(O.Z,{p:A.cd,children:[(0,Q.jsxs)(O.Z,{mb:A.HN,children:[(0,Q.jsx)(g.Z,{children:"Run settings"}),(0,Q.jsxs)(O.Z,{mt:A.Mq,children:[!E&&(0,Q.jsxs)(O.Z,{mb:A.Mq,children:[(0,Q.jsx)(k.ZP,{children:"Set a timeout for each run of this trigger (optional)"}),(0,Q.jsx)(O.Z,{mb:1}),(0,Q.jsx)(me.Z,{label:"Timeout (in seconds)",onChange:function(e){return ie((function(n){return Fe(Fe({},n),{},{timeout:e.target.value})}))},primary:!0,setContentOnMount:!0,type:"number",value:null===ne||void 0===ne?void 0:ne.timeout})]}),(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(O.Z,{mr:2,children:(0,Q.jsx)(De.Z,{checked:J,onCheck:function(e){$(e),e||ve((function(e){return Fe(Fe({},e),{},{slaAmount:0})}))}})}),(0,Q.jsx)(k.ZP,{default:!0,monospace:!0,children:"Configure trigger SLA"})]}),J&&(0,Q.jsx)(I.Z,{columnFlex:[null,1],rows:[[(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(N.aw,{default:!0,size:1.5*A.iI}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(k.ZP,{default:!0,children:"SLA"})]},"sla_detail"),(0,Q.jsxs)(f.ZP,{children:[(0,Q.jsx)(je.Z,{flex:1,children:(0,Q.jsx)(me.Z,{fullWidth:!0,monospace:!0,noBorder:!0,onChange:function(e){e.preventDefault(),ve((function(n){return Fe(Fe({},n),{},{slaAmount:e.target.value})}))},placeholder:"Time",value:null===ge||void 0===ge?void 0:ge.slaAmount})}),(0,Q.jsx)(je.Z,{flex:1,children:(0,Q.jsx)(y.Z,{fullWidth:!0,monospace:!0,noBorder:!0,onChange:function(e){e.preventDefault(),ve((function(n){return Fe(Fe({},n),{},{slaUnit:e.target.value})}))},placeholder:"Select time unit",small:!0,value:null===ge||void 0===ge?void 0:ge.slaUnit,children:Object.keys(R.tL).map((function(e){return(0,Q.jsx)("option",{value:e,children:"".concat(e,"(s)")},e)}))})})]},"sla_input_detail")]]})]}),(0,Q.jsx)(O.Z,{mt:A.Mq,children:(0,Q.jsx)(f.ZP,{alignItems:"center",children:(0,Q.jsx)(ue.Z,{checked:null===ne||void 0===ne?void 0:ne.allow_blocks_to_fail,label:"Keep running pipeline even if blocks fail",onClick:function(){return ie((function(e){return Fe(Fe({},e),{},{allow_blocks_to_fail:!(null!==ne&&void 0!==ne&&ne.allow_blocks_to_fail)})}))}})})}),_.Xm.TIME===He&&(0,Q.jsx)(O.Z,{mt:A.Mq,children:(0,Q.jsx)(f.ZP,{alignItems:"center",children:(0,Q.jsx)(ue.Z,{checked:null===ne||void 0===ne?void 0:ne.skip_if_previous_running,label:"Skip run if previous run still in progress",onClick:function(){return ie((function(e){return Fe(Fe({},e),{},{skip_if_previous_running:!(null!==ne&&void 0!==ne&&ne.skip_if_previous_running)})}))}})})})]}),(0,Q.jsxs)(O.Z,{mb:A.HN,children:[(0,Q.jsx)(g.Z,{children:"Runtime variables"}),!(0,Y.Qr)(we)&&(0,Q.jsxs)(O.Z,{mt:A.Mq,children:[(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(O.Z,{mr:2,children:(0,Q.jsx)(De.Z,{checked:X,onCheck:K})}),(0,Q.jsx)(k.ZP,{monospace:!0,muted:!0,children:"Overwrite global variables"})]}),X&&pe&&Object.entries(pe).length>0&&(0,Q.jsx)(O.Z,{mt:1,children:(0,Q.jsx)(I.Z,{columnFlex:[null,1],columns:[{uuid:"Variable"},{uuid:"Value"}],rows:Object.entries(pe).reduce((function(e,n){var t=(0,r.Z)(n,2),i=t[0],l=t[1];return b.sZ===i?e:e.concat([[(0,Q.jsx)(k.ZP,{default:!0,monospace:!0,children:i},"variable_".concat(i)),(0,Q.jsx)(me.Z,{borderless:!0,monospace:!0,onChange:function(e){e.preventDefault(),he((function(n){return Fe(Fe({},n),{},(0,s.Z)({},i,e.target.value))}))},paddingHorizontal:0,placeholder:"Variable value",value:l},"variable_uuid_input_".concat(i))]])}),[])})})]})]}),(null===wn||void 0===wn?void 0:wn.length)>=1&&(0,Q.jsx)(O.Z,{mb:A.HN,children:(0,Q.jsx)(xe,{blocks:wn,updateVariables:he,variables:Fe(Fe({},un),pe)})})]})}),[wn,J,we,E,X,pe,ge,He,un,$,K,he,ne]),Sn=C.ZP.tags.list().data,kn=(0,u.useMemo)((function(){return((null===Sn||void 0===Sn?void 0:Sn.tags)||[]).filter((function(e){var n=e.uuid;return!(null!==We&&void 0!==We&&We.includes(n))}))}),[Sn,We]);return(0,Q.jsx)(Q.Fragment,{children:(0,Q.jsxs)(j.Z,{after:In,breadcrumbs:[{label:function(){return"Triggers"},linkProps:{as:"/pipelines/".concat(w,"/triggers"),href:"/pipelines/[pipeline]/triggers"}},{label:function(){return null===l||void 0===l?void 0:l.name},linkProps:{as:"/pipelines/".concat(w,"/triggers/").concat(S),href:"/pipelines/[pipeline]/triggers/[...slug]"}}],errors:n,pageName:U.M.TRIGGERS,pipeline:i,setErrors:o,subheader:(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(p.Z,{disabled:On,loading:cn,onClick:gn,outline:!0,primary:!0,children:"Save changes"}),(0,Q.jsx)(O.Z,{mr:1}),(0,Q.jsx)(p.Z,{linkProps:{as:"/pipelines/".concat(w,"/triggers/").concat(S),href:"/pipelines/[pipeline]/triggers/[...slug]"},noHoverUnderline:!0,outline:!0,sameColorAsText:!0,children:"Cancel"})]}),title:function(){return"Edit ".concat(null===l||void 0===l?void 0:l.name)},uuid:"triggers/edit",children:[(0,Q.jsxs)(O.Z,{p:A.cd,children:[(0,Q.jsxs)(O.Z,{mb:2,children:[(0,Q.jsx)(g.Z,{children:"Trigger type"}),(0,Q.jsx)(k.ZP,{muted:!0,children:"How would you like this pipeline to be triggered?"})]}),(0,Q.jsx)(f.ZP,{children:(0,R.ri)(E).map((function(e){var n=e.label,t=e.description,i=e.uuid,r=He===i,l=He&&!r;return(0,Q.jsx)(p.Z,{noBackground:!0,noBorder:!0,noPadding:!0,onClick:function(){_.Xm.EVENT!==i||null!==M&&void 0!==M&&M.length||L([{}]),ve((function(e){return Fe(Fe({},e),{},{schedule_type:i})}))},children:(0,Q.jsx)(Ne.U,{selected:r,children:(0,Q.jsxs)(f.ZP,{alignItems:"center",children:[(0,Q.jsx)(je.Z,{children:(0,Q.jsx)("input",{checked:r,type:"radio"})}),(0,Q.jsx)(O.Z,{mr:A.cd}),(0,Q.jsxs)(je.Z,{alignItems:"flex-start",flexDirection:"column",children:[(0,Q.jsx)(g.Z,{bold:!0,default:!r&&!l,level:5,muted:!r&&l,children:n()}),(0,Q.jsx)(k.ZP,{default:!r&&!l,leftAligned:!0,muted:l,children:t()})]})]})})},i)}))})]}),(0,Q.jsxs)(O.Z,{mt:A.HN,children:[_.Xm.TIME===He&&bn,_.Xm.EVENT===He&&Pn,_.Xm.API===He&&yn]}),(0,Q.jsxs)(O.Z,{mt:A.HN,px:A.cd,children:[(0,Q.jsxs)(O.Z,{mb:2,children:[(0,Q.jsx)(g.Z,{children:"Tags"}),(0,Q.jsx)(k.ZP,{muted:!0,children:"Add or remove tags from this trigger."})]}),(0,Q.jsx)(Me.Z,{removeTag:function(e){ve((function(n){return Fe(Fe({},n),{},{tags:null===We||void 0===We?void 0:We.filter((function(n){return n!==e.uuid}))})}))},selectTag:function(e){ve((function(n){return Fe(Fe({},n),{},{tags:(0,H.$C)(e.uuid,We,(function(n){return n===e.uuid}))})}))},selectedTags:null===We||void 0===We?void 0:We.map((function(e){return{uuid:e}})),tags:kn,uuid:"TagsAutocompleteInputField-trigger-".concat(S)})]})]})})},qe=t(93808),Re=t(92709);function We(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function ze(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?We(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):We(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Xe(e){var n=e.pipelineScheduleId,t=e.pipelineUUID,i=e.subpath,r=Re.b7===i,l=(0,u.useState)(null),s=l[0],o=l[1],c=C.ZP.variables.pipelines.list(t,{},{revalidateOnFocus:!1}).data,a=null===c||void 0===c?void 0:c.variables,d={};r&&(d._format="with_runtime_average");var p=C.ZP.pipeline_schedules.detail(n,d),h=p.data,m=p.mutate,f=null===h||void 0===h?void 0:h.pipeline_schedule,g=C.ZP.pipelines.detail(t,{includes_content:!1,includes_outputs:!1},{revalidateOnFocus:!1}).data,v=ze(ze({},null===g||void 0===g?void 0:g.pipeline),{},{uuid:t});return r?(0,Q.jsx)(Le,{errors:s,fetchPipelineSchedule:m,pipeline:v,pipelineSchedule:f,setErrors:o,variables:a}):(0,Q.jsx)(ne,{errors:s,fetchPipelineSchedule:m,pipeline:v,pipelineSchedule:f,setErrors:o,variables:a})}Xe.getInitialProps=function(){var e=(0,l.Z)(c().mark((function e(n){var t,i,l,s,o,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.query,i=t.pipeline,l=t.slug,!Array.isArray(l)){e.next=4;break}return s=(0,r.Z)(l,2),o=s[0],u=s[1],e.abrupt("return",{pipelineScheduleId:o,pipelineUUID:i,subpath:u});case 4:return e.abrupt("return",{pipelineUUID:i});case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var Ye=(0,qe.Z)(Xe)},95488:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pipelines/[pipeline]/triggers/[...slug]",function(){return t(666)}])}},function(e){e.O(0,[844,9902,426,2369,9161,4495,9302,6358,9696,8264,5499,1845,5457,7586,3943,5344,1334,9774,2888,179],(function(){return n=95488,e(e.s=n);var n}));var n=e.O();_N_E=n}]);