(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8170],{81334:function(e,n,t){"use strict";t.d(n,{Z:function(){return w}});var r=t(82394),i=t(82684),o=t(27277),u=t(31882),l=t(38276),c=t(48381),s=t(30160),a=t(17488),d=t(9518),p=t(44897),f=t(42631),g=t(47041),v=t(70515),h=d.default.div.withConfig({displayName:"indexstyle__DropdownStyle",componentId:"sc-suwkha-0"})([""," border-radius:","px;max-height:","px;overflow:auto;position:absolute;width:100%;z-index:1;"," ",""],g.w5,f.BG,40*v.iI,(function(e){return"\n    background-color: ".concat((e.theme.background||p.Z.background).popup,";\n    box-shadow: ").concat((e.theme.shadow||p.Z.shadow).popup,";\n  ")}),(function(e){return e.topOffset&&"\n    top: ".concat(e.topOffset-.5*v.iI,"px;\n  ")})),m=d.default.div.withConfig({displayName:"indexstyle__RowStyle",componentId:"sc-suwkha-1"})(["padding:","px;position:relative;z-index:2;&:hover{cursor:pointer;}",""],.5*v.iI,(function(e){return e.highlighted&&"\n    background-color: ".concat((e.theme.interactive||p.Z.interactive).hoverBackground,";\n  ")})),_=t(39643),y=t(95924),b=t(86735),j=t(44688),x=t(28598);function O(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?O(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var w=function(e){var n,t=e.removeTag,r=e.selectTag,d=e.selectedTags,p=void 0===d?[]:d,f=e.tags,g=void 0===f?[]:f,v=e.uuid,O=(0,i.useRef)(null),w=(0,i.useState)(!1),P=w[0],k=w[1],C=(0,i.useState)(null),S=C[0],E=C[1],N=(0,i.useMemo)((function(){return(0,b.YC)(g||[],"uuid")}),[g]),T=(0,i.useMemo)((function(){return null==N?void 0:N.map((function(e){return{itemObject:e,searchQueries:[e.uuid],value:e.uuid}}))}),[N]),D=(0,i.useMemo)((function(){return(null==S?void 0:S.length)>=1?T.concat({itemObject:{uuid:S},searchQueries:[S],value:"Add tag: ".concat(S)}):T}),[T,S]),I=(0,j.y)(),R=I.registerOnKeyDown,M=I.unregisterOnKeyDown;return(0,i.useEffect)((function(){return function(){return M(v)}}),[M,v]),null==R||R(v,(function(e,n){var t;P&&n[_.vP]&&(k(!1),null==O||null===(t=O.current)||void 0===t||t.blur())}),[P,O]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(c.Z,{onClickTag:t,tags:p}),(0,x.jsxs)(l.Z,{mt:1,style:{position:"relative"},children:[(0,x.jsx)(a.Z,{onBlur:function(){return setTimeout((function(){return k(!1)}),150)},onChange:function(e){return E(e.target.value)},onFocus:function(){return k(!0)},ref:O,value:S||""}),(0,x.jsx)(h,{topOffset:null==O||null===(n=O.current)||void 0===n?void 0:n.getBoundingClientRect().height,children:(0,x.jsx)(o.Z,{eventProperties:{eventParameters:{item_type:"tag"}},itemGroups:[{items:P?D:[],renderItem:function(e,n){var t=e.value;return(0,x.jsx)(m,Z(Z({},n),{},{onClick:function(e){var t;(0,y.j)(e),null==n||null===(t=n.onClick)||void 0===t||t.call(n,e)},children:(0,x.jsx)(u.Z,{small:!0,children:(0,x.jsx)(s.ZP,{children:t})})}))}}],onSelectItem:function(e){var n=e.itemObject;null==r||r(n),E(null)},searchQuery:S,uuid:v})})]})]})}},68781:function(e,n,t){"use strict";var r;t.d(n,{R:function(){return i}}),function(e){e.AZURE_CONTAINER_INSTANCE="azure_container_instance",e.ECS="ecs",e.GCP_CLOUD_RUN="gcp_cloud_run",e.K8S="k8s",e.LOCAL_PYTHON="local_python",e.PYSPARK="pyspark"}(r||(r={}));var i=[r.AZURE_CONTAINER_INSTANCE,r.ECS,r.GCP_CLOUD_RUN,r.K8S,r.LOCAL_PYTHON,r.PYSPARK]},37003:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return B}});var r=t(77837),i=t(75582),o=t(82394),u=t(38860),l=t.n(u),c=t(82684),s=t(34376),a=t(75457),d=t(93808),p=t(71180),f=t(70652),g=t(55485),v=t(85854),h=t(48670),m=t(57653),_=t(44085),y=t(88543),b=t(38276),j=t(81334),x=t(30160),O=t(17488),Z=t(35686),w=t(98464),P=t(77417),k=t(68781),C=t(78419),S=t(70515),E=t(53808),N=t(42122),T=t(81728),D=t(86735),I=t(28598);function R(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function M(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?R(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var A=function(e){var n,t,r,i,u,l,s,a,d,R,A,F,U=e.isPipelineUpdating,H=e.pipeline,L=e.updatePipeline,G=(0,P.Z)().project,K=(0,c.useRef)(null),B=(0,c.useRef)(null),Y=null==H?void 0:H.uuid,z=(0,c.useMemo)((function(){return(null==H?void 0:H.blocks)||[]}),[H]),W=(0,c.useState)(!1),Q=W[0],X=W[1],q=(0,c.useState)(!1),J=q[0],$=q[1],V=(0,c.useState)(null),ee=V[0],ne=V[1],te=(0,w.Z)(H);(0,c.useEffect)((function(){(0,N.Xy)(H,te)||ne(H)}),[H,te]);var re=(0,c.useCallback)((function(e){X(!0),ne(e)}),[]),ie="".concat(C.g6,"_").concat(Y),oe=(0,c.useState)({}),ue=oe[0],le=oe[1],ce="".concat(C.vF,"_").concat(Y),se=(0,c.useState)(!1),ae=se[0],de=se[1],pe=(0,c.useCallback)((function(e){le((function(n){var t=e(n);return(0,E.t8)(ie,JSON.stringify(t)),t}))}),[ie,le]),fe=(0,c.useCallback)((function(e){de((function(n){var t=e(n);return(0,E.t8)(ce,t),t}))}),[ce,de]);(0,c.useEffect)((function(){var e=(0,E.U2)(ie);e&&(0,T.Pb)(e)&&le(JSON.parse(e))}),[ie,le]),(0,c.useEffect)((function(){var e=(0,E.U2)(ce);e&&de(e)}),[ce,de]);var ge=(0,c.useMemo)((function(){return null==ee?void 0:ee.executor_type}),[ee]);(0,c.useEffect)((function(){J||!ge||k.R.find((function(e){return e===ge}))||$(!0)}),[J,ge]);var ve=(0,c.useMemo)((function(){return(null==z?void 0:z.filter((function(e){var n=e.uuid;return!(null==ue||!ue[n])}))).length===z.length}),[z,ue]),he=(0,c.useMemo)((function(){return!(null!=z&&z.length)}),[z]),me=(0,c.useMemo)((function(){return(null==ee?void 0:ee.tags)||[]}),[ee]),_e=Z.ZP.tags.list().data,ye=(0,c.useMemo)((function(){return((null==_e?void 0:_e.tags)||[]).filter((function(e){var n=e.uuid;return!me.includes(n)}))}),[_e,me]),be=(0,c.useMemo)((function(){var e;return null==G||null===(e=G.pipelines)||void 0===e?void 0:e.settings}),[G]),je=(0,c.useMemo)((function(){var e,n,t;return(null==be||null===(e=be.triggers)||void 0===e?void 0:e.save_in_code_automatically)&&void 0===(null==ee||null===(n=ee.settings)||void 0===n||null===(t=n.triggers)||void 0===t?void 0:t.save_in_code_automatically)}),[ee,be]);return(0,I.jsxs)(b.Z,{p:S.cd,children:[(0,I.jsxs)(y.Z,{title:"Details",children:[(0,I.jsx)(y.S,{invalid:Q&&!(null!=ee&&ee.name),textInput:{onChange:function(e){return re((function(n){return M(M({},n),{},{name:e.target.value})}))},value:null==ee?void 0:ee.name},title:"Pipeline name"}),(0,I.jsx)(y.S,{textInput:{onChange:function(e){return re((function(n){return M(M({},n),{},{description:e.target.value})}))},placeholder:"Enter description...",value:(null==ee?void 0:ee.description)||""},title:"Pipeline description"}),(0,I.jsx)(y.S,{description:"When enabled, this setting allows sharing of objects and memory space across blocks within a single pipeline.",title:"Run pipeline in a single process",toggleSwitch:{checked:!(null==ee||!ee.run_pipeline_in_one_process),onCheck:function(e){return re((function(n){return M(M({},n),{},{run_pipeline_in_one_process:e(null==n?void 0:n.run_pipeline_in_one_process)})}))}}}),(0,I.jsx)(y.S,{description:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(x.ZP,{muted:!0,small:!0,children:"Every time a trigger is created or updated in this pipeline, itâ€™ll be automatically be persisted it in code."}),(null==be||null===(n=be.triggers)||void 0===n?void 0:n.save_in_code_automatically)&&(0,I.jsx)(x.ZP,{small:!0,warning:!0,children:"This settings is enabled at the project level. Changing the value here will only affect this pipeline."})]}),title:"Save triggers in code automatically",toggleSwitch:{checked:je||!(null==ee||null===(t=ee.settings)||void 0===t||null===(r=t.triggers)||void 0===r||!r.save_in_code_automatically),onCheck:function(e){return re((function(n){var t,r,i;return M(M({},n),{},{settings:M(M({},null==n?void 0:n.settings),{},{triggers:M(M({},null==n||null===(t=n.settings)||void 0===t?void 0:t.triggers),{},{save_in_code_automatically:e(je||(null==n||null===(r=n.settings)||void 0===r||null===(i=r.triggers)||void 0===i?void 0:i.save_in_code_automatically))})})})}))}}})]}),(0,I.jsx)(b.Z,{mt:S.HN,children:(0,I.jsxs)(y.Z,{title:"Pipeline level concurrency",children:[(0,I.jsx)(y.S,{description:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(x.ZP,{muted:!0,small:!0,children:"Limit the concurrent pipeline runs across all trigers in this pipeline."})}),textInput:{monospace:!0,onChange:function(e){return re((function(n){return M(M({},n),{},{concurrency_config:M(M({},null==n?void 0:n.concurrency_config),{},{pipeline_run_limit_all_triggers:Number(e.target.value)})})}))},placeholder:"e.g. 40",type:"number",value:String((null==ee||null===(i=ee.concurrency_config)||void 0===i?void 0:i.pipeline_run_limit_all_triggers)||"")},title:"Pipeline run limit across all triggers"}),(0,I.jsx)(y.S,{description:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(x.ZP,{muted:!0,small:!0,children:"Limit the concurrent pipeline runs in a single trigger for this pipeline."})}),textInput:{monospace:!0,onChange:function(e){return re((function(n){return M(M({},n),{},{concurrency_config:M(M({},null==n?void 0:n.concurrency_config),{},{pipeline_run_limit:Number(e.target.value)})})}))},placeholder:"e.g. 10",type:"number",value:String((null==ee||null===(u=ee.concurrency_config)||void 0===u?void 0:u.pipeline_run_limit)||"")},title:"Pipeline run limit in 1 trigger"}),(0,I.jsx)(y.S,{description:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(x.ZP,{muted:!0,small:!0,children:"Limit the concurrent blocks runs in one pipeline run."})}),textInput:{monospace:!0,onChange:function(e){return re((function(n){return M(M({},n),{},{concurrency_config:M(M({},null==n?void 0:n.concurrency_config),{},{block_run_limit:Number(e.target.value)})})}))},placeholder:"e.g. 20",type:"number",value:String((null==ee||null===(l=ee.concurrency_config)||void 0===l?void 0:l.block_run_limit)||"")},title:"Block run limit"}),(0,I.jsx)(y.S,{description:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(x.ZP,{muted:!0,small:!0,children:"Choose whether to wait or skip when the pipeline run limit is reached."})}),selectInput:{onChange:function(e){return re((function(n){return M(M({},n),{},{concurrency_config:M(M({},null==n?void 0:n.concurrency_config),{},{on_pipeline_run_limit_reached:e.target.value})})}))},options:null===(s=Object.values(m.pF))||void 0===s?void 0:s.map((function(e){return{label:(0,T.kC)(e),value:e}})),placeholder:"Select an option",value:(null==ee||null===(a=ee.concurrency_config)||void 0===a?void 0:a.on_pipeline_run_limit_reached)||""},title:"How to handle new pipeline runs when limit reached"})]})}),(0,I.jsxs)(b.Z,{mt:S.HN,children:[(0,I.jsx)(v.Z,{children:"Executor type"}),(0,I.jsxs)(x.ZP,{muted:!0,children:["For more information on this setting, please read the ",(0,I.jsx)(h.Z,{href:"https://docs.mage.ai/production/configuring-production-settings/compute-resource#2-set-executor-type-and-customize-the-compute-resource-of-the-mage-executor",openNewWindow:!0,children:"documentation"}),"."]}),(0,I.jsxs)(b.Z,{mt:1,children:[!J&&(0,I.jsx)(_.Z,{label:"Executor type",onChange:function(e){return re((function(n){return M(M({},n),{},{executor_type:e.target.value})}))},primary:!0,ref:K,value:(null==ee?void 0:ee.executor_type)||"",children:k.R.map((function(e){return(0,I.jsx)("option",{value:e,children:e},e)}))}),J&&(0,I.jsx)(O.Z,{label:"Executor type",monospace:!0,onChange:function(e){return re((function(n){return M(M({},n),{},{executor_type:e.target.value})}))},ref:B,setContentOnMount:!0,value:(null==ee?void 0:ee.executor_type)||""}),(0,I.jsx)(b.Z,{mt:1,children:(0,I.jsx)(h.Z,{muted:!0,onClick:function(){J?(re((function(e){return M(M({},e),{},{executor_type:null==H?void 0:H.executor_type})})),setTimeout((function(){var e;return null==K||null===(e=K.current)||void 0===e?void 0:e.focus()}),1)):setTimeout((function(){var e;return null==B||null===(e=B.current)||void 0===e?void 0:e.focus()}),1),$(!J)},preventDefault:!0,small:!0,children:J?"Select a preset executor type":"Enter a custom executor type"})})]})]}),(0,I.jsxs)(b.Z,{mt:S.HN,children:[(0,I.jsx)(v.Z,{children:"Retry configuration"}),(0,I.jsxs)(x.ZP,{muted:!0,children:["For more information on this setting, please read the ",(0,I.jsx)(h.Z,{href:"https://docs.mage.ai/orchestration/pipeline-runs/retrying-block-runs",openNewWindow:!0,children:"documentation"}),"."]}),(0,I.jsx)(b.Z,{mt:1,children:(0,I.jsxs)(g.ZP,{children:[(0,I.jsx)(O.Z,{label:"Retries",monospace:!0,onChange:function(e){return re((function(n){return M(M({},n),{},{retry_config:M(M({},null==n?void 0:n.retry_config),{},{retries:void 0!==e.target.value&&null!==e.target.value?Number(e.target.value):e.target.value})})}))},setContentOnMount:!0,type:"number",value:(null==ee||null===(d=ee.retry_config)||void 0===d?void 0:d.retries)||""}),(0,I.jsx)(b.Z,{mr:1}),(0,I.jsx)(O.Z,{label:"Delay",monospace:!0,onChange:function(e){return re((function(n){return M(M({},n),{},{retry_config:M(M({},null==n?void 0:n.retry_config),{},{delay:void 0!==e.target.value&&null!==e.target.value?Number(e.target.value):e.target.value})})}))},setContentOnMount:!0,type:"number",value:(null==ee||null===(R=ee.retry_config)||void 0===R?void 0:R.delay)||""}),(0,I.jsx)(b.Z,{mr:1}),(0,I.jsx)(O.Z,{label:"Max delay",monospace:!0,onChange:function(e){return re((function(n){return M(M({},n),{},{retry_config:M(M({},null==n?void 0:n.retry_config),{},{max_delay:void 0!==e.target.value&&null!==e.target.value?Number(e.target.value):e.target.value})})}))},setContentOnMount:!0,type:"number",value:(null==ee||null===(A=ee.retry_config)||void 0===A?void 0:A.max_delay)||""}),(0,I.jsx)(b.Z,{mr:1}),(0,I.jsx)(f.Z,{checked:!(null==ee||null===(F=ee.retry_config)||void 0===F||!F.exponential_backoff),label:"Exponential backoff",onClick:function(){return re((function(e){var n;return M(M({},e),{},{retry_config:M(M({},null==e?void 0:e.retry_config),{},{exponential_backoff:!(null!=e&&null!==(n=e.retry_config)&&void 0!==n&&n.exponential_backoff)})})}))}})]})})]}),(0,I.jsxs)(b.Z,{mt:S.HN,children:[(0,I.jsx)(v.Z,{children:"Tags"}),(0,I.jsx)(b.Z,{mt:1,children:(0,I.jsx)(j.Z,{removeTag:function(e){re((function(n){return M(M({},n),{},{tags:me.filter((function(n){return n!==e.uuid}))})}))},selectTag:function(e){re((function(n){return M(M({},n),{},{tags:(0,D.$C)(e.uuid,me,(function(n){return n===e.uuid}))})}))},selectedTags:null==me?void 0:me.map((function(e){return{uuid:e}})),tags:ye,uuid:"TagsAutocompleteInputField-".concat(null==H?void 0:H.uuid)})})]}),(0,I.jsx)(b.Z,{mt:S.HN,children:(0,I.jsx)(g.ZP,{children:(0,I.jsx)(p.ZP,{disabled:!Q,loading:U,onClick:function(){return L({concurrency_config:null==ee?void 0:ee.concurrency_config,description:null==ee?void 0:ee.description,executor_type:null==ee?void 0:ee.executor_type,name:null==ee?void 0:ee.name,retry_config:null==ee?void 0:ee.retry_config,run_pipeline_in_one_process:null==ee?void 0:ee.run_pipeline_in_one_process,settings:null==ee?void 0:ee.settings,tags:null==ee?void 0:ee.tags}).then((function(){return X(!1)}))},primary:!0,children:"Save pipeline settings"})})}),(0,I.jsx)(b.Z,{mt:S.HN,children:(0,I.jsx)(f.Z,{checked:ve&&!he,disabled:he,label:"Hide all blocks in notebook",onClick:function(){return pe((function(){return ve?{}:null==z?void 0:z.reduce((function(e,n){var t=n.uuid;return M(M({},e),{},(0,o.Z)({},t,!0))}),{})}))}})}),(0,I.jsx)(b.Z,{mt:S.Mq,children:(0,I.jsx)(f.Z,{checked:ae,label:"When running a block while editing a pipeline, output the block messages to the logs",onClick:function(){return fe((function(e){return!e}))}})})]})},F=t(28795),U=t(83455),H=t(72619);function L(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function G(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?L(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function K(e){var n=e.pipeline,t=(0,s.useRouter)(),r=(0,c.useState)(null),o=r[0],u=r[1],l=null==n?void 0:n.uuid,d=Z.ZP.pipelines.detail(l).data,p=G(G({},null==d?void 0:d.pipeline),n),f=(0,U.Db)(Z.ZP.pipelines.useUpdate(l,{update_content:!0}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(e){if(null!=e&&e.pipeline){var n=e.pipeline.uuid;l!==n&&(window.location.href="".concat(null==t?void 0:t.basePath,"/pipelines/").concat(n,"/settings"))}},onErrorCallback:function(e,n){return u({errors:n,response:e})}})}}),g=(0,i.Z)(f,2),v=g[0],h=g[1].isLoading;return(0,I.jsx)(a.Z,{breadcrumbs:[{label:function(){return"Settings"}}],errors:o,pageName:F.M.SETTINGS,pipeline:p,setErrors:u,title:function(e){var n=e.name;return"".concat(n," settings")},uuid:"".concat(F.M.SETTINGS,"_").concat(l),children:p&&(0,I.jsx)(A,{isPipelineUpdating:h,pipeline:p,updatePipeline:function(e){return v({pipeline:e})}})})}K.getInitialProps=function(){var e=(0,r.Z)(l().mark((function e(n){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.query.pipeline,e.abrupt("return",{pipeline:{uuid:t}});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var B=(0,d.Z)(K)},59606:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pipelines/[pipeline]/settings",function(){return t(37003)}])},80022:function(e,n,t){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}t.d(n,{Z:function(){return r}})},15544:function(e,n,t){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}t.d(n,{Z:function(){return r}})},13692:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(61049);function i(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&(0,r.Z)(e,n)}},93189:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(12539),i=t(80022);function o(e,n){if(n&&("object"===r(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}}},function(e){e.O(0,[1557,3782,9774,2888,179],(function(){return n=59606,e(e.s=n);var n}));var n=e.O();_N_E=n}]);