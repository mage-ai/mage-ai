(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7803],{16488:function(n,e,t){"use strict";t.d(e,{IJ:function(){return p},M8:function(){return E},Uc:function(){return Z},XM:function(){return O},_U:function(){return m},eI:function(){return x},gU:function(){return _},lO:function(){return w},ri:function(){return b},tL:function(){return g},vJ:function(){return I},xH:function(){return j}});var r,o=t(82394),i=t(92083),u=t.n(i),c=t(3917),l=t(4383),s=t(30229),a=t(42122),d=t(86735);function f(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function v(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?f(Object(t),!0).forEach((function(e){(0,o.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var m=function(n){return!!n&&!Object.values(s.U5).includes(n)};function p(n){return null===n||void 0===n?void 0:n.reduce((function(n,e){var t=e.block_uuid,r=e.completed_at,i=e.started_at,c=e.status,l=null;i&&r&&(l=u()(r).valueOf()-u()(i).valueOf());return v(v({},n),{},(0,o.Z)({},t,{runtime:l,status:c}))}),{})}var h,b=function(n){var e=[{description:function(){return"This pipeline will run continuously on an interval or just once."},label:function(){return"Schedule"},uuid:s.Xm.TIME},{description:function(){return"This pipeline will run when a specific event occurs."},label:function(){return"Event"},uuid:s.Xm.EVENT},{description:function(){return"Run this pipeline when you make an API call."},label:function(){return"API"},uuid:s.Xm.API}];return n?e.slice(0,1):e};function j(n){var e=(0,a.gR)(n,[s.gm.INTERVAL,s.gm.TYPE]),t=n[s.gm.INTERVAL];t&&(e["schedule_interval[]"]=encodeURIComponent(t));var r=n[s.gm.TYPE];return r&&(e["schedule_type[]"]=r),e}function x(n){return n?new Date(u()(n).valueOf()):null}function Z(n,e){return e?(0,c.XG)(n,e):function(n){if("string"!==typeof n)return n;var e=n.split("+")[0];return u()(x(e)).format(c.Nx)}(n)}!function(n){n.DAY="day",n.HOUR="hour",n.MINUTE="minute",n.SECOND="second"}(h||(h={}));var g=(r={},(0,o.Z)(r,h.DAY,86400),(0,o.Z)(r,h.HOUR,3600),(0,o.Z)(r,h.MINUTE,60),(0,o.Z)(r,h.SECOND,1),r);function _(n){var e=h.SECOND,t=n;return n%86400===0?(t/=86400,e=h.DAY):n%3600===0?(t/=3600,e=h.HOUR):n%60===0&&(t/=60,e=h.MINUTE),{time:t,unit:e}}function I(n,e){return n*g[e]}function O(n,e,t){var r,o=u()(n);return o.set("hour",+(null===e||void 0===e?void 0:e.hour)||0),o.set("minute",+(null===e||void 0===e?void 0:e.minute)||0),o.set("second",0),r=o.format(c.TD),null!==t&&void 0!==t&&t.includeSeconds&&(r=r.concat(":00")),null!==t&&void 0!==t&&t.localTimezone&&(r=o.format(c.lE),null!==t&&void 0!==t&&t.convertToUtc&&(r=(0,c.d$)(r,{includeSeconds:null===t||void 0===t?void 0:t.includeSeconds,utcFormat:!0}))),r}function E(n){var e,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="",o=!0;return o&&(t?r="".concat(window.origin,"/api/pipeline_schedules/").concat(null===n||void 0===n?void 0:n.id,"/api_trigger"):(r="".concat(window.origin,"/api/pipeline_schedules/").concat(null===n||void 0===n?void 0:n.id,"/pipeline_runs"),null!==n&&void 0!==n&&n.token&&(r="".concat(r,"/").concat(n.token)))),o&&(e=window.location.port)&&(r=r.replace(e,l.QT)),r}function y(n,e,t){return n.match(/[*,-/]/)?{additionalOffset:0,cronValue:n}:function(n,e,t){var r=t.indexOf(n),o=0;if(e<0)for(var i=0;i>e;i--)0===r?(r=t.length-1,o-=1):r-=1;else if(e>0)for(var u=0;u<e;u++)r===t.length-1?(r=0,o+=1):r+=1;return{additionalOffset:o,cronValue:String(t[r]||n)}}(+n,e,t)}var N=(0,d.m5)(60),P=(0,d.m5)(24),k=(0,c.Cs)();function w(n,e){if(!n)return n;var t=u()().local().format("Z"),r=t.split(":"),o="-"===t[0],i=3===r[0].length?Number(r[0].slice(1)):Number(r[0]),c=Number(r[1]);(o&&!e||!o&&e)&&(i=-i,c=-c);var l=n.split(" "),s=l[0],a=l[1],d=l[2],f=y(s,c,N),v=y(a,i+f.additionalOffset,P);if(l[0]=f.cronValue,l[1]=v.cronValue,0!==(null===v||void 0===v?void 0:v.additionalOffset)){var m=y(d,v.additionalOffset,k);l[2]=m.cronValue}return l.join(" ")}},44265:function(n,e,t){"use strict";t.d(e,{Az:function(){return s},BF:function(){return l},Do:function(){return d},IK:function(){return c},P0:function(){return o},VO:function(){return u},sZ:function(){return a}});var r,o,i=t(82394),u=t(41143).V,c=[u.FAILED,u.COMPLETED,u.RUNNING,u.CANCELLED,u.INITIAL],l=[u.INITIAL,u.RUNNING],s=[u.CANCELLED,u.COMPLETED,u.FAILED],a="__mage_variables",d=(r={},(0,i.Z)(r,u.CANCELLED,"Cancelled"),(0,i.Z)(r,u.COMPLETED,"Done"),(0,i.Z)(r,u.FAILED,"Failed"),(0,i.Z)(r,u.INITIAL,"Ready"),(0,i.Z)(r,u.RUNNING,"Running"),r);!function(n){n.PIPELINE_UUID="pipeline_uuid[]",n.STATUS="status[]",n.TAG="pipeline_tag[]"}(o||(o={}))},30229:function(n,e,t){"use strict";t.d(e,{PN:function(){return c},TR:function(){return m},U5:function(){return s},Wb:function(){return v},Xm:function(){return i},Z4:function(){return a},fq:function(){return l},gm:function(){return d},kJ:function(){return f}});var r,o,i,u=t(82394),c="__bookmark_values__";!function(n){n.API="api",n.EVENT="event",n.TIME="time"}(i||(i={}));var l,s,a=(r={},(0,u.Z)(r,i.API,(function(){return"API"})),(0,u.Z)(r,i.EVENT,(function(){return"event"})),(0,u.Z)(r,i.TIME,(function(){return"schedule"})),r);!function(n){n.ACTIVE="active",n.INACTIVE="inactive"}(l||(l={})),function(n){n.ONCE="@once",n.HOURLY="@hourly",n.DAILY="@daily",n.WEEKLY="@weekly",n.MONTHLY="@monthly",n.ALWAYS_ON="@always_on"}(s||(s={}));var d,f,v=[s.ONCE,s.HOURLY,s.DAILY,s.WEEKLY,s.MONTHLY];!function(n){n.INTERVAL="frequency[]",n.STATUS="status[]",n.TAG="tag[]",n.TYPE="type[]"}(d||(d={})),function(n){n.CREATED_AT="created_at",n.NAME="name",n.PIPELINE="pipeline_uuid",n.STATUS="status",n.TYPE="schedule_type"}(f||(f={}));var m=(o={},(0,u.Z)(o,f.CREATED_AT,"Created at"),(0,u.Z)(o,f.NAME,"Name"),(0,u.Z)(o,f.PIPELINE,"Pipeline"),(0,u.Z)(o,f.STATUS,"Active"),(0,u.Z)(o,f.TYPE,"Type"),o)},25050:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return sn}});var r=t(77837),o=t(38860),i=t.n(o),u=t(82684),c=t(75457),l=t(93808),s=t(75582),a=t(82394),d=t(97618),f=t(55485),v=t(85854),m=t(44265),p=t(38276),h=t(4190),b=t(30160),j=t(44897),x=t(38626),Z=t(42631),g=t(95363),_=t(70515),I=t(61896),O=x.default.div.withConfig({displayName:"indexstyle__RowStyle",componentId:"sc-15svh8z-0"})(["border-radius:","px;margin:","px;overflow:hidden;"," "," "," "," "," "," &:hover{"," "," "," "," ","}"],Z.n_,_.cd*_.iI,(function(n){return"\n    background-color: ".concat((n.theme.background||j.Z.background).panel,";\n    border: 1px solid ").concat((n.theme.borders||j.Z.borders).dark,";\n\n    &:hover {\n      cursor: pointer;\n    }\n  ")}),(function(n){return n.selected&&n.danger&&"\n    border-color: ".concat((n.theme.accent||j.Z.accent).negative,";\n  ")}),(function(n){return n.selected&&n.primary&&"\n    border-color: ".concat((n.theme.interactive||j.Z.interactive).linkPrimary,";\n  ")}),(function(n){return n.selected&&n.default&&"\n    border-color: ".concat((n.theme.interactive||j.Z.interactive).focusBackground,";\n  ")}),(function(n){return n.selected&&n.success&&"\n    border-color: ".concat((n.theme.background||j.Z.background).success,";\n  ")}),(function(n){return n.selected&&n.warning&&"\n    border-color: ".concat((n.theme.accent||j.Z.accent).warning,";\n  ")}),(function(n){return n.danger&&"\n      border-color: ".concat((n.theme.accent||j.Z.accent).negative,";\n    ")}),(function(n){return n.primary&&"\n      border-color: ".concat((n.theme.interactive||j.Z.interactive).linkPrimary,";\n    ")}),(function(n){return n.default&&"\n      border-color: ".concat((n.theme.interactive||j.Z.interactive).focusBackground,";\n    ")}),(function(n){return n.success&&"\n      border-color: ".concat((n.theme.background||j.Z.background).success,";\n    ")}),(function(n){return n.warning&&"\n      border-color: ".concat((n.theme.accent||j.Z.accent).warning,";\n    ")})),E=(0,x.css)([""," "," "," "," ",""],(function(n){return n.danger&&"\n    background-color: ".concat((n.theme.accent||j.Z.accent).negative,";\n  ")}),(function(n){return n.primary&&"\n    background-color: ".concat((n.theme.interactive||j.Z.interactive).linkPrimary,";\n  ")}),(function(n){return n.default&&"\n    background-color: ".concat((n.theme.interactive||j.Z.interactive).defaultBackground,";\n  ")}),(function(n){return n.success&&"\n    background-color: ".concat((n.theme.background||j.Z.background).success,";\n  ")}),(function(n){return n.warning&&"\n    background-color: ".concat((n.theme.accent||j.Z.accent).warning,";\n  ")})),y=x.default.div.withConfig({displayName:"indexstyle__StatusStyle",componentId:"sc-15svh8z-1"})([""," ",";border-radius:","px;display:inline-block;font-family:",";padding:6px;"," "," "," "," "," ",""],E,I.iD,Z.D7,g.ry,(function(n){return n.danger&&"\n    color: ".concat((n.theme.content||j.Z.content).active,";\n  ")}),(function(n){return n.primary&&"\n    color: ".concat((n.theme.content||j.Z.content).active,";\n  ")}),(function(n){return(n.default||n.success)&&"\n  "}),(function(n){return n.default&&"\n    color: ".concat((n.theme.content||j.Z.content).default,";\n  ")}),(function(n){return n.success&&"\n    color: ".concat((n.theme.content||j.Z.content).inverted,";\n  ")}),(function(n){return n.warning&&"\n    color: ".concat((n.theme.content||j.Z.content).inverted,";\n  ")})),N=x.default.div.withConfig({displayName:"indexstyle__BarStyle",componentId:"sc-15svh8z-2"})([""," display:flex;height:auto;width:3px;",""],E,(function(n){return n.default&&"\n    background-color: ".concat((n.theme.interactive||j.Z.interactive).focusBackground,";\n  ")})),P=t(72473),k=t(16488),w=t(92083),T=t.n(w),A=t(41143),L=t(81728),S=t(86735);function M(n){var e;return Object.keys((null===n||void 0===n||null===(e=n.metrics)||void 0===e?void 0:e.blocks)||{}).sort()}function C(n){var e,t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=null,i=null,u=null,c=null,l={},a=(null===n||void 0===n?void 0:n.block_runs)||[],d=(null===n||void 0===n||null===(e=n.metrics)||void 0===e?void 0:e.blocks)||{},f=(null===n||void 0===n||null===(t=n.metrics)||void 0===t?void 0:t.pipeline)||{},v=D(n);return Object.entries(d).forEach((function(n){var e,t=(0,s.Z)(n,2),a=t[0],d=t[1];if(!r||r===a){var m,p=d||{},h=p.destinations,b=void 0===h?{records_affected:null,records_inserted:null,records_updated:null}:h,j=p.sources,x=void 0===j?{records:null}:j,Z=v[a]||[];if(r&&r===a&&Z.every((function(n){var e=n.status;return A.V.COMPLETED===e}))&&null===o&&(o=0),null!==f&&void 0!==f&&null!==(e=f[a])&&void 0!==e&&e.record_counts)null===o&&(o=0),o+=Number(null===f||void 0===f||null===(m=f[a])||void 0===m?void 0:m.record_counts);else null!==x&&void 0!==x&&x.records&&(null===o&&(o=0),o+=Number(x.records));null!==b&&void 0!==b&&b.records_updated?(null===u&&(u=0),u+=Number(b.records_updated),null===c&&(c=0),c+=Number(b.records_updated)):null!==b&&void 0!==b&&b.records_inserted?(null===u&&(u=0),u+=Number(b.records_inserted),null===i&&(i=0),i+=Number(b.records_inserted)):null!==b&&void 0!==b&&b.records_affected&&(null===u&&(u=0),u+=Number(b.records_affected)),["destinations","sources"].forEach((function(n){var e=d[n]||{};null!==e&&void 0!==e&&e.error&&(l[a]||(l[a]={}),l[a][n]={error:null===e||void 0===e?void 0:e.error,errors:null===e||void 0===e?void 0:e.errors,message:null===e||void 0===e?void 0:e.message})}))}})),null===a||void 0===a||a.forEach((function(n){var e=n.block_uuid,t=n.metrics,r=n.status;if(A.V.FAILED===r&&null!==t&&void 0!==t&&t.error&&e){var o=e.split(":"),i=(0,s.Z)(o,3),u=(i[0],i[1]);i[2];l[u]||(l[u]={}),l[u][""]=t.error}})),{errors:l,records:o,recordsInserted:i,recordsProcessed:u,recordsUpdated:c}}function D(n){var e=n.block_runs,t={};return null===e||void 0===e||e.forEach((function(n){var e=n.block_uuid.split(":"),r=(0,s.Z)(e,3),o=(r[0],r[1]);r[2];t[o]||(t[o]=[]),t[o].push(n)})),t}function V(n){var e=D(n),t={};return Object.entries(e).forEach((function(n){var e=(0,s.Z)(n,2),r=e[0],o=e[1],i=o.filter((function(n){var e=n.status;return A.V.COMPLETED===e})),u=i.map((function(n){var e=n.completed_at,t=n.started_at,r=T().utc(e),o=T().utc(t);return r.diff(o,"second")})),c=i.length,l=o.length;t[r]={completed:c,runtime:u.length>=1?(0,S.Sm)(u)/u.length:null,total:l}})),t}function R(n){var e=n.block_runs,t=(null===e||void 0===e?void 0:e.length)||1,r=function(n){var e=(null===n||void 0===n?void 0:n.block_runs)||[];return null===e||void 0===e?void 0:e.filter((function(n){var e=n.status;return A.V.COMPLETED===e}))}(n).length||0;return r/t}function U(n){var e=n.completed_at,t=n.block_runs,r=void 0===t?[]:t,o=n.status;if(null===r||void 0===r||!r.length)return 0;var i=T().utc();if(e)i=T().utc(e);else if([m.VO.CANCELLED,m.VO.FAILED].includes(o)){var u=(0,S.YC)(r,(function(n){return n.started_at}),{ascending:!1})[0];i=T().utc(u.updated_at)}var c=T().utc(n.created_at);return i.diff(c,"second")}function Y(n,e){var t,r,o,i,u,c=D(n),l=V(n),s=(null===n||void 0===n?void 0:n.metrics)||{blocks:null,pipeline:null},a=s.blocks||{},d=s.pipeline||{},f=(a[e],d[e],l[e]||{completed:null,total:null}),v=f.completed,m=f.total,p=v&&m?v/m:0,h=c[e]||[],b=h.every((function(n){var e=n.status;return A.V.COMPLETED===e})),j=(0,S.YC)(h,(function(n){return n.updated_at}),{ascending:!1})[0],x=null===(t=(0,S.YC)(h,(function(n){return n.started_at}),{ascending:!0})[0])||void 0===t?void 0:t.started_at;b?r=null===(u=(0,S.YC)(h,(function(n){return n.completed_at}),{ascending:!1})[0])||void 0===u?void 0:u.completed_at:j&&(i=null===j||void 0===j?void 0:j.updated_at);var Z=b?T().utc(r||i):T().utc(),g=T().utc(x);return{completed:v,completedAt:r,done:b,progress:p,runtime:o=Z.diff(g,"second"),startedAt:x,status:null===j||void 0===j?void 0:j.status,timeText:(0,L.zf)(o),total:m,updatedAt:i}}var F=t(70320),G=t(28598);function z(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function B(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?z(Object(t),!0).forEach((function(e){(0,a.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):z(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var H=function(n){var e=n.onSelect,t=n.pipelineRun,r=n.selected,o=t.created_at,i=t.status,c=(0,u.useMemo)((function(){return(null===t||void 0===t?void 0:t.metrics)||{blocks:{},destination:null,pipeline:{},source:null}}),[t]),l=(0,u.useMemo)((function(){return c.pipeline||{}}),[c]),a=(0,F.qB)(),x=c.destination,Z=c.source,g=(0,u.useMemo)((function(){return Object.keys(l).length}),[l]),I=(0,u.useMemo)((function(){return C(t)}),[t]),E=I.errors,w=I.records,T=I.recordsProcessed,A=(0,u.useMemo)((function(){return R(t)}),[t]),S=(0,u.useMemo)((function(){return[m.VO.COMPLETED].includes(i)}),[i]),M=(0,u.useMemo)((function(){return{danger:m.VO.FAILED===i,default:m.VO.INITIAL===i,primary:m.VO.RUNNING===i,success:S,warning:m.VO.CANCELLED===i}}),[S,i]),D=(0,u.useMemo)((function(){if(t){var n=U(t);return(0,L.zf)(n)}}),[t]);return(0,G.jsx)(O,B(B({},M),{},{onClick:function(){return e(r?null:t.id)},selected:r,children:(0,G.jsxs)(f.ZP,{fullHeight:!0,justifyContent:"space-between",children:[(0,G.jsx)(N,B({},M)),(0,G.jsx)(d.Z,{flex:1,flexDirection:"column",children:(0,G.jsxs)(p.Z,{ml:3,py:3,children:[(0,G.jsx)(v.Z,{bold:!0,level:5,monospace:!0,children:(0,k.Uc)(o,a)}),(0,G.jsx)(p.Z,{fullWidth:!1,mt:2,children:(0,G.jsx)(y,B(B({},M),{},{children:(0,G.jsxs)(f.ZP,{alignItems:"center",children:[S&&(0,G.jsx)(P.Jr,{inverted:!0,size:2*_.iI}),[m.VO.INITIAL,m.VO.RUNNING].includes(i)&&(0,G.jsx)(h.Z,{color:m.VO.INITIAL!==i?j.Z.monotone.white:null,inverted:m.VO.INITIAL===i,small:!0}),"\xa0",m.VO.RUNNING===i&&(0,G.jsxs)(G.Fragment,{children:["\xa0",Math.round(100*A),"%"]}),![m.VO.INITIAL,m.VO.RUNNING].includes(i)&&m.Do[i],m.VO.INITIAL===i&&"Starting"]})}))}),Object.values(E).length>=1&&(0,G.jsx)(p.Z,{mt:1,children:Object.entries(E).map((function(n){var e=(0,s.Z)(n,2),t=e[0];e[1];return(0,G.jsxs)(b.ZP,{monospace:!0,muted:!0,small:!0,children:[t," stream failed"]},t)}))})]})}),(0,G.jsxs)(d.Z,{flex:1,children:[(0,G.jsx)(d.Z,{flex:1,flexDirection:"column",children:(0,G.jsxs)(p.Z,{ml:3,py:3,children:[(0,G.jsxs)(p.Z,{mb:1,children:[(0,G.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Rows processed"}),(0,G.jsx)(b.ZP,{monospace:!0,children:T>=1?(0,L.x6)(T):"-"})]}),(0,G.jsxs)(p.Z,{mb:1,children:[(0,G.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Rows remaining"}),(0,G.jsx)(b.ZP,{monospace:!0,children:w>=1&&w>=T?(0,L.x6)(w-T):"-"})]}),m.VO.RUNNING!==i&&(0,G.jsxs)(p.Z,{mb:1,children:[(0,G.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Runtime"}),(0,G.jsx)(b.ZP,{monospace:!0,children:D})]})]})}),(0,G.jsx)(d.Z,{flex:1,flexDirection:"column",children:(0,G.jsxs)(p.Z,{ml:3,py:3,children:[(0,G.jsxs)(p.Z,{mb:1,children:[(0,G.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Source"}),(0,G.jsx)(b.ZP,{monospace:!0,children:Z||"-"})]}),(0,G.jsxs)(p.Z,{mb:1,children:[(0,G.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Destination"}),(0,G.jsx)(b.ZP,{monospace:!0,children:x||"-"})]}),(0,G.jsxs)(p.Z,{mb:1,children:[(0,G.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Streams"}),(0,G.jsx)(b.ZP,{monospace:!0,children:g>=1?(0,L.x6)(g):"-"})]})]})})]})]})}))},X=t(89565),W=t.n(X),J=t(34376),q=t(71180),K=t(48670),Q=t(75499),$=x.default.div.withConfig({displayName:"indexstyle__BarStyle",componentId:"sc-1thr560-0"})(["display:flex;flex:1;"," "," ",""],(function(n){return n.even&&n.fill&&"\n    background-color: ".concat((n.theme.accent||j.Z.accent).cyan,";\n  ")}),(function(n){return n.even&&!n.fill&&"\n    background-color: ".concat((n.theme.accent||j.Z.accent).cyanTransparent,";\n  ")}),(function(n){return"\n    height: ".concat((n.small?1:2)*_.iI,"px;\n  ")})),nn=t(3314),en=t(3917);var tn=function(n){var e=n.onClickRow,t=n.pipelineRun,r=n.selectedStream,o=(0,J.useRouter)(),i=(0,F.qB)(),c=(0,u.useState)(null),l=c[0],a=c[1],d=(0,u.useState)(null),h=d[0],j=d[1],x=(0,u.useMemo)((function(){return t?D(t):{}}),[t]),Z=(0,u.useMemo)((function(){return t?V(t):{}}),[t]),g=(0,u.useMemo)((function(){var n=0,e=[],t=[];if(Object.entries(Z).forEach((function(r){var o=(0,s.Z)(r,2),i=(o[0],o[1]),u=i.completed,c=i.runtime,l=i.total;null===c?t.push(i):(e.push(c),n+=c*(l-u))})),0===e.length)return null;var r=(0,S.Sm)(e)/e.length;return t.forEach((function(e){var t=e.completed,o=e.total;n+=r*(o-t)})),n}),[Z]),I=(0,u.useMemo)((function(){return r?Z[r]:null}),[Z,r]),O=(0,u.useMemo)((function(){if(r&&Z){var n=Z[r]||{},e=n.completed,o=n.total;if(o>=1)return e/o}else if(t)return R(t);return 0}),[Z,t,r]),E=(0,u.useMemo)((function(){return(0,G.jsx)(f.ZP,{children:(0,S.w6)(101).map((function(n,e){return(0,G.jsx)($,{even:e%2===0,fill:O>0&&Math.round(100*O)>=e},e)}))})}),[O]),y=(0,u.useMemo)((function(){if(r){var n=x[r]||[],e=n.every((function(n){var e=n.status;return A.V.COMPLETED===e})),o=(0,S.YC)(n,(function(n){return n.updated_at}),{ascending:!1})[0],i=null===o||void 0===o?void 0:o.status,u=I||{},c=u.completed,l=u.runtime,s=u.total;if(e)return"Sync complete for ".concat(r);if([A.V.CANCELLED,A.V.FAILED].includes(i))return m.Do[i];if(l&&s>=1){var a=Math.ceil(l*(s-c)/60);return"".concat((0,L._6)("minute",a,!0)," to completion")}return"Estimating time remaining for stream..."}if(m.VO.COMPLETED===(null===t||void 0===t?void 0:t.status))return"Sync complete";if(t){if([m.VO.CANCELLED,m.VO.FAILED].includes(null===t||void 0===t?void 0:t.status))return m.Do[null===t||void 0===t?void 0:t.status];if(m.VO.INITIAL===(null===t||void 0===t?void 0:t.status))return"Initializing sync (this can take several minutes)";if(null===g)return"Estimating time remaining...";var d=Math.ceil(g/60);return"".concat((0,L._6)("minute",d,!0)," to completion")}return"Select a sync"}),[x,g,I,t,r]),N=(0,u.useMemo)((function(){return t&&r?Y(t,r):{completed:null,completedAt:null,done:null,progress:null,runtime:null,startedAt:null,status:null,timeText:null,total:null,updatedAt:null}}),[t,r]);(0,u.useEffect)((function(){var n;if(t){var e=U(t);a(e),n=setInterval((function(){return a((function(n){return n+1}))}),1e3)}return function(){return clearInterval(n)}}),[t]),(0,u.useEffect)((function(){var n;if(t&&r&&N){var e=(null===N||void 0===N?void 0:N.runtime)||0;j(e),n=setInterval((function(){return j((function(n){return n+1}))}),1e3)}return function(){return clearInterval(n)}}),[t,r,N]);var w=(0,u.useMemo)((function(){if(t){if(r)return null===N||void 0===N?void 0:N.timeText;var n=U(t);return(0,L.zf)(n)}}),[t,r,N]),T=(0,u.useMemo)((function(){var n=Math.floor(l%86400/3600),e=Math.floor(l%3600/60),t=Math.floor(l%60/1);return[n>=10?String(n):"0".concat(n),e>=10?String(e):"0".concat(e),t>=10?String(t):"0".concat(t)].join(":")}),[l]),z=(0,u.useMemo)((function(){var n=Math.floor(h%86400/3600),e=Math.floor(h%3600/60),t=Math.floor(h%60/1);return[n>=10?String(n):"0".concat(n),e>=10?String(e):"0".concat(e),t>=10?String(t):"0".concat(t)].join(":")}),[h]),B=(0,u.useMemo)((function(){return t?C(t):{errors:null,records:null,recordsInserted:null,recordsProcessed:null,recordsUpdated:null}}),[t]),H=B.errors,X=B.records,tn=B.recordsInserted,rn=B.recordsProcessed,on=B.recordsUpdated,un=(0,u.useMemo)((function(){return t&&r?C(t,r):{errors:null,records:null,recordsInserted:null,recordsProcessed:null,recordsUpdated:null}}),[t,r]),cn=(0,u.useMemo)((function(){var n=r?null===un||void 0===un?void 0:un.records:X,e=r?null===un||void 0===un?void 0:un.recordsInserted:tn,t=r?null===un||void 0===un?void 0:un.recordsProcessed:rn,o=r?null===un||void 0===un?void 0:un.recordsUpdated:on,i=[{label:"Rows fetched",value:null===n?"-":(0,L.x6)(n)}];return null===e&&null===o?i.push({label:"Rows processed",value:null===t?"-":(0,L.x6)(t)}):null!==e?i.push({label:"Rows inserted",value:(0,L.x6)(e)}):null!==o&&i.push({label:"Rows updated",value:(0,L.x6)(o)}),i.map((function(n){var e=n.label,t=n.value;return(0,G.jsxs)("div",{children:[(0,G.jsx)(b.ZP,{bold:!0,large:!0,muted:!0,children:e}),(0,G.jsx)(b.ZP,{headline:!0,children:t})]},e)}))}),[X,un,tn,rn,on,r]),ln=(0,u.useMemo)((function(){if(!t)return(0,G.jsx)("div",{});var n=M(t);return(0,G.jsx)(Q.Z,{columnFlex:[null,null,null,null,null,null],columns:[{uuid:"Stream"},{uuid:"Start"},{uuid:"End"},{uuid:"Time"},{uuid:"Progress"},{uuid:"Logs"}],isSelectedRow:function(e){return r&&r===n[e]},onClickRow:e,rows:n.map((function(n){var e=Y(t,n),r=(e.completed,e.completedAt),u=e.done,c=e.progress,l=e.startedAt,s=e.status,a=e.timeText,d=(e.total,!!H[n]);return[(0,G.jsx)(b.ZP,{danger:d,default:!d,monospace:!0,children:n},"stream"),(0,G.jsx)(b.ZP,{default:!0,monospace:!0,title:l?(0,en._6)(l):null,children:l?(0,k.Uc)(l,i):(0,G.jsx)(G.Fragment,{children:"\u2014"})},"started_at"),(0,G.jsx)(b.ZP,{default:!0,monospace:!0,title:r?(0,en._6)(r):null,children:r?(0,k.Uc)(r,i):(0,G.jsx)(G.Fragment,{children:"\u2014"})},"completed_at"),(0,G.jsx)(b.ZP,{default:!0,children:[A.V.INITIAL,A.V.RUNNING].includes(s)?"-":a},"runtime"),(0,G.jsxs)("div",{children:[u&&(0,G.jsx)(P.Jr,{default:!0,size:2*_.iI}),!u&&(0,G.jsx)(f.ZP,{children:(0,S.w6)(51).map((function(n,e){return(0,G.jsx)($,{even:e%2===0,fill:c>0&&Math.round(50*c)>=e,small:!0},e)}))})]},"progress"),(0,G.jsx)(q.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(n){o.push("/pipelines/".concat(t.pipeline_uuid,"/logs?pipeline_run_id[]=").concat(t.id)),(0,nn.j)(n)},children:(0,G.jsx)(P.UL,{default:!0,size:2*_.iI})},"logs")]})),uuid:"".concat(null===t||void 0===t?void 0:t.id,"-streams-table")})}),[i,H,e,t,o,r]),sn=(0,u.useMemo)((function(){var n,e,o,i,u,c,l,a;if(t&&r){var d=(null===t||void 0===t?void 0:t.metrics)||{blocks:null,destination:null,pipeline:null,source:null},f=null===d||void 0===d||null===(n=d.pipeline)||void 0===n||null===(e=n[r])||void 0===e||null===(o=e.bookmarks)||void 0===o?void 0:o[r],v=null===d||void 0===d||null===(i=d.blocks)||void 0===i||null===(u=i[r])||void 0===u||null===(c=u.destinations)||void 0===c||null===(l=c.state)||void 0===l||null===(a=l.bookmarks)||void 0===a?void 0:a[r];if(f||v){var m=Array.from(new Set(Object.keys(f||{}).concat(Object.keys(v||{})))).sort(),p=[];m.forEach((function(n){var e=[(0,G.jsx)(b.ZP,{bold:!0,monospace:!0,muted:!0,small:!0,children:n},n)];[f,v].forEach((function(t,r){t&&e.push((0,G.jsx)(b.ZP,{monospace:!0,small:!0,children:t[n]},"".concat(n,"-").concat(r)))})),p.push(e)}));var h=[{label:function(){return""},uuid:"column"}];return[[null===d||void 0===d?void 0:d.source,"source",f],[null===d||void 0===d?void 0:d.destination,"destination",v]].forEach((function(n){var e=(0,s.Z)(n,3),t=e[0],r=e[1];e[2]&&h.push({uuid:"".concat(t," (").concat(r,")")})})),(0,G.jsx)(Q.Z,{columnFlex:[null,1,1],columns:h,rows:p,uuid:"".concat(r,"-bookmark-table")})}}}),[t,r]),an=(0,u.useMemo)((function(){var n,e,o,i,u,c;if(t&&r){var l=(null===t||void 0===t?void 0:t.metrics)||{blocks:null,destination:null,pipeline:null,source:null},a=null===l||void 0===l||null===(n=l.blocks)||void 0===n||null===(e=n[r])||void 0===e||null===(o=e.sources)||void 0===o?void 0:o.record,d=null===l||void 0===l||null===(i=l.blocks)||void 0===i||null===(u=i[r])||void 0===u||null===(c=u.destinations)||void 0===c?void 0:c.record;if(a||d){var f=Object.keys(d||a||{}).sort(),v=[];f.forEach((function(n){var e=[(0,G.jsx)(b.ZP,{bold:!0,monospace:!0,muted:!0,small:!0,children:n},n)];[a,d].forEach((function(t,r){if(t){var o=t[n],i="object"===typeof o;e.push((0,G.jsxs)(b.ZP,{monospace:!0,small:!0,textOverflow:!0,whiteSpaceNormal:!0,wordBreak:!0,children:[i&&(0,G.jsx)("pre",{children:JSON.stringify(o,null,2)}),!i&&o]},"".concat(n,"-").concat(r)))}})),v.push(e)}));var m=[{label:function(){return""},uuid:"column"}];return[[null===l||void 0===l?void 0:l.source,"source",a],[null===l||void 0===l?void 0:l.destination,"destination",d]].forEach((function(n){var e=(0,s.Z)(n,3),t=e[0],r=e[1];e[2]&&m.push({uuid:"".concat(t," (").concat(r,")")})})),(0,G.jsx)(Q.Z,{columnFlex:[null,1,1],columns:m,rows:v.map((function(n){return n.map((function(n){return(0,G.jsx)(b.ZP,{default:!0,monospace:!0,children:n},n)}))})),uuid:"".concat(r,"-bookmark-table")})}}}),[t,r]),dn=(0,u.useMemo)((function(){var n,e,o,i,u,c,l=null===t||void 0===t||null===(n=t.metrics)||void 0===n||null===(e=n.blocks)||void 0===e?void 0:e[r];return(null===l||void 0===l||null===(o=l.sources)||void 0===o||null===(i=o.block_tags)||void 0===i?void 0:i.destination_table)||(null===l||void 0===l||null===(u=l.destinations)||void 0===u||null===(c=u.block_tags)||void 0===c?void 0:c.destination_table)}),[t,r]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(p.Z,{p:3,children:[r&&(0,G.jsx)(p.Z,{mb:3,children:(0,G.jsxs)(f.ZP,{alignItems:"center",children:[(0,G.jsx)(K.Z,{block:!0,onClick:function(){return o.push("/pipelines/".concat(t.pipeline_uuid,"/syncs?pipeline_run_id=").concat(t.id))},preventDefault:!0,children:(0,G.jsxs)(f.ZP,{alignItems:"center",children:[(0,G.jsx)(P.Xd,{default:!0,size:1.5*_.iI}),(0,G.jsx)(p.Z,{mr:1}),(0,G.jsx)(b.ZP,{default:!0,children:"Syncs"})]})}),(0,G.jsx)(p.Z,{mx:1,children:(0,G.jsx)(b.ZP,{default:!0,monospace:!0,children:"/"})}),(0,G.jsx)(b.ZP,{bold:!0,monospace:!0,children:r})]})}),(0,G.jsxs)(f.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,G.jsx)(p.Z,{mr:2,my:1,children:(0,G.jsx)(v.Z,{level:5,muted:!t,children:y})}),t&&(0,G.jsx)(q.ZP,{onClick:function(){return o.push("/pipelines/".concat(t.pipeline_uuid,"/logs?pipeline_run_id[]=").concat(t.id))},small:!0,children:"Logs"})]}),(0,G.jsx)(p.Z,{mt:2,children:E}),t&&(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(p.Z,{mt:3,children:(0,G.jsxs)(f.ZP,{justifyContent:"space-between",children:[(0,G.jsxs)("div",{children:[(0,G.jsx)(b.ZP,{bold:!0,large:!0,muted:!0,children:"Runtime"}),(0,G.jsxs)(b.ZP,{headline:!0,children:[r&&[A.V.INITIAL,A.V.RUNNING].includes(null===N||void 0===N?void 0:N.status)&&z,r&&![A.V.INITIAL,A.V.RUNNING].includes(null===N||void 0===N?void 0:N.status)&&(null===N||void 0===N?void 0:N.timeText),!r&&[m.VO.INITIAL,m.VO.RUNNING].includes(null===t||void 0===t?void 0:t.status)&&T,!r&&![m.VO.INITIAL,m.VO.RUNNING].includes(null===t||void 0===t?void 0:t.status)&&w]})]}),cn]})}),Object.values(H).length>=1&&(0,G.jsxs)(p.Z,{mt:3,children:[(0,G.jsx)(v.Z,{level:5,muted:!0,children:"Errors"}),Object.entries(H).map((function(n,e){var t=(0,s.Z)(n,2),o=t[0],i=t[1];return(!r||r===o)&&(0,G.jsx)(p.Z,{mt:e>=1?1:0,children:Object.entries(i).map((function(n){var e=(0,s.Z)(n,2),t=e[0],r=e[1],i=r.error,u=r.errors,c=r.message,l=Array.isArray(i)?i.join(" "):i;return(0,G.jsxs)("div",{children:[(0,G.jsx)(p.Z,{mb:c||(null===u||void 0===u?void 0:u.length)>=1?2:0,children:(0,G.jsxs)(b.ZP,{monospace:!0,preWrap:!0,textOverflow:!0,children:[o,!!t&&(0,G.jsxs)(b.ZP,{inline:!0,monospace:!0,muted:!0,children:["\xa0(",t,")"]}),": ",(0,G.jsx)(b.ZP,{default:!0,inline:!0,monospace:!0,children:l&&(0,G.jsx)(W(),{children:l})})]})}),(0,G.jsx)(b.ZP,{default:!0,monospace:!0,preWrap:!0,small:!0,children:c}),u.map((function(n){return(0,G.jsx)(b.ZP,{default:!0,monospace:!0,preWrap:!0,small:!0,children:n},n)}))]},"".concat(o,"-").concat(t))}))},o)}))]})]})]}),t&&!r&&(0,G.jsx)(p.Z,{my:3,children:ln}),t&&r&&(0,G.jsxs)(G.Fragment,{children:[dn&&(0,G.jsx)(p.Z,{my:3,children:(0,G.jsxs)(p.Z,{px:3,children:[(0,G.jsx)(v.Z,{level:5,children:"Table name"}),(0,G.jsx)(p.Z,{mt:1,children:(0,G.jsx)(b.ZP,{default:!0,monospace:!0,children:dn})})]})}),sn&&(0,G.jsxs)(p.Z,{my:3,children:[(0,G.jsx)(p.Z,{px:3,children:(0,G.jsx)(v.Z,{level:5,children:"Bookmarks"})}),(0,G.jsx)(p.Z,{px:1,children:sn})]}),an&&(0,G.jsxs)(p.Z,{my:3,children:[(0,G.jsx)(p.Z,{px:3,children:(0,G.jsx)(v.Z,{level:5,children:"Sample row"})}),(0,G.jsx)(p.Z,{px:1,children:an})]})]})]})},rn=t(35686),on=t(28795),un=t(15610),cn=t(69419);function ln(n){var e=n.pipeline,t=e.uuid,r=rn.ZP.pipeline_runs.list({_limit:20,_offset:0,pipeline_uuid:t},{refreshInterval:5e3}).data,o=(0,u.useMemo)((function(){return(null===r||void 0===r?void 0:r.pipeline_runs)||[]}),[r]),i=(0,cn.iV)(),l=(0,u.useState)(null),s=l[0],a=l[1],d=(0,u.useState)(null),f=d[0],v=d[1],m=(0,u.useState)(null),p=m[0],h=m[1];(0,u.useEffect)((function(){null!==i&&void 0!==i&&i.pipeline_run_id?h(null===o||void 0===o?void 0:o.find((function(n){return n.id===Number(i.pipeline_run_id)}))):p&&h(null),null!==i&&void 0!==i&&i.stream?v(i.stream):f&&v(null)}),[o,i,p,f]);var b=(0,u.useCallback)((function(){var n=p?M(p):[];return(0,G.jsx)(tn,{onClickRow:function(e){var t=n[e];(0,un.u7)({stream:f===t?null:t})},pipelineRun:p,selectedStream:f})}),[p,f]),j=(0,u.useMemo)((function(){var n="/pipelines/".concat(t,"/syncs");p&&(n="".concat(n,"?pipeline_run_id=").concat(p.id));var e=[{label:function(){return"Syncs"},linkProps:f?{as:n,href:"/pipelines/[pipeline]/syncs"}:null}];return f&&e.push({label:function(){return f}}),e}),[t,p,f]);return(0,G.jsx)(c.Z,{breadcrumbs:j,buildSidekick:b,errors:s,pageName:on.M.SYNCS,pipeline:e,setErrors:a,title:function(n){var e=n.name;return"".concat(e," syncs")},uuid:"".concat(on.M.SYNCS,"_").concat(t),children:o.map((function(n){var e=(null===p||void 0===p?void 0:p.id)===n.id;return(0,G.jsx)(H,{onSelect:function(n){return(0,un.u7)({pipeline_run_id:n,stream:null})},pipelineRun:n,selected:e},n.id)}))})}ln.getInitialProps=function(){var n=(0,r.Z)(i().mark((function n(e){var t;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.query.pipeline,n.abrupt("return",{pipeline:{uuid:t}});case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();var sn=(0,l.Z)(ln)},59416:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pipelines/[pipeline]/syncs",function(){return t(25050)}])},80022:function(n,e,t){"use strict";function r(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}t.d(e,{Z:function(){return r}})},15544:function(n,e,t){"use strict";function r(n){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},r(n)}t.d(e,{Z:function(){return r}})},13692:function(n,e,t){"use strict";t.d(e,{Z:function(){return o}});var r=t(61049);function o(n,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&(0,r.Z)(n,e)}},93189:function(n,e,t){"use strict";t.d(e,{Z:function(){return i}});var r=t(12539),o=t(80022);function i(n,e){if(e&&("object"===r(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return(0,o.Z)(n)}},61049:function(n,e,t){"use strict";function r(n,e){return r=Object.setPrototypeOf||function(n,e){return n.__proto__=e,n},r(n,e)}t.d(e,{Z:function(){return r}})}},function(n){n.O(0,[2678,1154,844,4267,9266,8487,8264,7858,5499,5457,9774,2888,179],(function(){return e=59416,n(n.s=e);var e}));var e=n.O();_N_E=e}]);