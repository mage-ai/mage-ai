(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8662],{16488:function(e,n,t){"use strict";t.d(n,{IJ:function(){return d},M8:function(){return h},Vx:function(){return f},eI:function(){return p},gU:function(){return b},tL:function(){return v},vJ:function(){return O}});var r,i,u=t(82394),o=t(92083),l=t.n(o),c=t(4383);function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){(0,u.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function d(e){return null===e||void 0===e?void 0:e.reduce((function(e,n){var t=n.block_uuid,r=n.completed_at,i=n.started_at,o=n.status,c=null;i&&r&&(c=l()(r).valueOf()-l()(i).valueOf());return a(a({},e),{},(0,u.Z)({},t,{runtime:c,status:o}))}),{})}function p(e){if(!e)return null;var n=new Date(l()(e).valueOf()),t=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds());return new Date(t)}function f(e){return"string"!==typeof e?e:p(e.split("+")[0]).toISOString().split(".")[0]}!function(e){e.DAY="day",e.HOUR="hour",e.MINUTE="minute",e.SECOND="second"}(i||(i={}));var v=(r={},(0,u.Z)(r,i.DAY,86400),(0,u.Z)(r,i.HOUR,3600),(0,u.Z)(r,i.MINUTE,60),(0,u.Z)(r,i.SECOND,1),r);function b(e){var n=i.SECOND,t=e;return e%86400===0?(t/=86400,n=i.DAY):e%3600===0?(t/=3600,n=i.HOUR):e%60===0&&(t/=60,n=i.MINUTE),{time:t,unit:n}}function O(e,n){return e*v[n]}function h(e){var n,t="";return t="".concat(window.origin,"/api/pipeline_schedules/").concat(null===e||void 0===e?void 0:e.id,"/pipeline_runs"),null!==e&&void 0!==e&&e.token&&(t="".concat(t,"/").concat(e.token)),(n=window.location.port)&&(t=t.replace(n,c.QT)),t}},44265:function(e,n,t){"use strict";t.d(n,{Az:function(){return c},BF:function(){return l},Do:function(){return a},IK:function(){return o},VO:function(){return u},sZ:function(){return s}});var r,i=t(82394),u=t(41143).V,o=[u.FAILED,u.COMPLETED,u.RUNNING,u.CANCELLED,u.INITIAL],l=[u.INITIAL,u.RUNNING],c=[u.CANCELLED,u.COMPLETED,u.FAILED],s="__mage_variables",a=(r={},(0,i.Z)(r,u.CANCELLED,"Cancelled"),(0,i.Z)(r,u.COMPLETED,"Done"),(0,i.Z)(r,u.FAILED,"Failed"),(0,i.Z)(r,u.INITIAL,"Ready"),(0,i.Z)(r,u.RUNNING,"Running"),r)},14532:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return K}});var r=t(77837),i=t(75582),u=t(82394),o=t(38860),l=t.n(o),c=t(82684),s=t(83455),a=t(34376),d=t(23192),p=t(71180),f=t(15338),v=t(97618),b=t(55485),O=t(85854),h=t(55072),g=t(75457),j=t(44265),m=t(57653),y=t(93808),_=t(38276),Z=t(4190),P=t(30160),D=t(35686),x=t(26304),E=t(90299),w=t(93859),k=t(17586),N=t(48339),I=t(70515),T=t(66909),R=t(8955),C=t(16488),S=t(31098),L=t(28598),M=["blockRuns","columns","dataType","height","heightOffset","loadingData","pipeline","renderColumnHeader","rows","selectedRun","selectedTab","setSelectedTab","textData"];function A(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function U(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?A(Object(t),!0).forEach((function(n){(0,u.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var F={uuid:"Dependency tree"},B={uuid:"Block output"},G=[B,F];var H=t(28795),J=t(81655),V=t(72619),Y=t(3314),q=t(69419);function Q(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function X(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Q(Object(t),!0).forEach((function(n){(0,u.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Q(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function z(e){var n,t=e.pipeline,r=e.pipelineRun,u=(0,a.useRouter)(),o=(0,q.iV)(),l=null!==o&&void 0!==o&&o.page?o.page:0,y=(0,c.useState)(null),A=y[0],Q=y[1],z=(0,c.useState)(G[0]),K=z[0],W=z[1],$=(0,c.useState)(null),ee=$[0],ne=$[1],te=t.uuid,re=D.ZP.pipelines.detail(te,{includes_content:!1,includes_outputs:!1},{revalidateOnFocus:!1}).data,ie=(0,c.useMemo)((function(){return X(X({},null===re||void 0===re?void 0:re.pipeline),{},{uuid:te})}),[re,te]),ue=D.ZP.pipeline_runs.detail(r.id,{_format:"with_basic_details"},{refreshInterval:3e3,revalidateOnFocus:!0}).data,oe=(0,c.useMemo)((function(){return(null===ue||void 0===ue?void 0:ue.pipeline_run)||{}}),[ue]),le=oe.execution_date,ce=oe.id,se=oe.status,ae={_limit:h.Q,_offset:l*h.Q,pipeline_run_id:ce},de=null===o||void 0===o?void 0:o[J.lG.SORT_COL_IDX],pe=null===o||void 0===o?void 0:o[J.lG.SORT_DIRECTION];if(de){var fe=d.fi[de],ve=pe||J.sh.ASC;ae.order_by="".concat(fe,"%20").concat(ve)}var be=D.ZP.block_runs.list(ae,{refreshInterval:5e3}),Oe=be.data,he=be.mutate,ge=(0,c.useMemo)((function(){return(null===Oe||void 0===Oe?void 0:Oe.block_runs)||[]}),[Oe]),je=(0,s.Db)(D.ZP.pipeline_runs.useUpdate(ce),{onSuccess:function(e){return(0,V.wD)(e,{callback:function(){Q(null),null===he||void 0===he||he()},onErrorCallback:function(e,n){return ne({errors:n,response:e})}})}}),me=(0,i.Z)(je,2),ye=me[0],_e=me[1].isLoading,Ze=D.ZP.outputs.block_runs.list(null===A||void 0===A?void 0:A.id),Pe=Ze.data,De=Ze.loading,xe=(null===Pe||void 0===Pe||null===(n=Pe.outputs)||void 0===n?void 0:n[0])||{},Ee=xe.sample_data,we=xe.text_data,ke=xe.type;(0,c.useEffect)((function(){A||(null===K||void 0===K?void 0:K.uuid)!==B.uuid||W(F)}),[A,null===K||void 0===K?void 0:K.uuid]);var Ne=((null===Ee||void 0===Ee?void 0:Ee.columns)||[]).slice(0,40),Ie=(null===Ee||void 0===Ee?void 0:Ee.rows)||[],Te=(0,c.useMemo)((function(){return(0,L.jsx)(d.ZP,{blockRuns:ge,onClickRow:function(e){Q((function(n){var t=ge[e],r=(null===n||void 0===n?void 0:n.id)!==t.id?t:null;return r&&W((function(e){return e!==B?B:e})),r}))},pipeline:ie,selectedRun:A,setErrors:ne,sortableColumnIndexes:d.lG})}),[ge,ie,A]),Re=(null===ie||void 0===ie?void 0:ie.type)!==m.qL.STREAMING&&se&&se!==j.VO.COMPLETED,Ce=((null===ie||void 0===ie?void 0:ie.type)===m.qL.PYTHON||(null===ie||void 0===ie?void 0:ie.type)===m.qL.INTEGRATION)&&A&&j.Az.includes(se),Se=(0,c.useMemo)((function(){var e;return(null===Oe||void 0===Oe||null===(e=Oe.metadata)||void 0===e?void 0:e.count)||[]}),[Oe]),Le=(0,c.useMemo)((function(){return(0,L.jsx)(_.Z,{p:2,children:(0,L.jsx)(h.ZP,{maxPages:h.Et,onUpdate:function(e){var n=Number(e),t=X(X({},o),{},{page:n>=0?n:0});Q(null),u.push("/pipelines/[pipeline]/runs/[run]","/pipelines/".concat(te,"/runs/").concat(ce,"?").concat((0,q.uM)(t)))},page:Number(l),totalPages:Math.ceil(Se/h.Q)})})}),[l,ce,te,o,u,Se]);return(0,L.jsxs)(g.Z,{breadcrumbs:[{label:function(){return"Runs"},linkProps:{as:"/pipelines/".concat(te,"/runs"),href:"/pipelines/[pipeline]/runs"}},{label:function(){return le}}],buildSidekick:function(e){return function(e){var n=e.blockRuns,t=e.columns,r=e.dataType,i=e.height,u=e.heightOffset,o=e.loadingData,l=e.pipeline,c=e.renderColumnHeader,s=e.rows,a=e.selectedRun,d=e.selectedTab,p=e.setSelectedTab,f=e.textData,v=U({},(0,x.Z)(e,M));v.blockStatus=(0,C.IJ)(n);var O=(0,L.jsx)(_.Z,{ml:2,children:(0,L.jsx)(P.ZP,{children:"This block run has no output."})}),h=s&&s.length>0?(0,L.jsx)(w.Z,{columnHeaderHeight:c?T.Eh:0,columns:t,height:i-u-90,noBorderBottom:!0,noBorderLeft:!0,noBorderRight:!0,renderColumnHeader:c,rows:s}):O,g=(0,S.Pb)(f)?JSON.stringify(JSON.parse(f),null,2):f,j=f?(0,L.jsx)(_.Z,{ml:2,children:(0,L.jsx)(P.ZP,{monospace:!0,children:(0,L.jsx)("pre",{children:g})})}):O,m=d&&p;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{style:{position:"fixed",top:"50px"},children:m&&(0,L.jsx)(_.Z,{py:I.cd,children:(0,L.jsx)(E.Z,{onClickTab:p,selectedTabUUID:null===d||void 0===d?void 0:d.uuid,tabs:a?G:[F]})})}),(0,L.jsxs)("div",{style:{position:"relative",top:"75px"},children:[(!a||F.uuid===(null===d||void 0===d?void 0:d.uuid))&&(0,L.jsx)(k.Z,U(U({},v),{},{height:i,heightOffset:(u||0)+(m?R.u$:0),pipeline:l})),a&&B.uuid===(null===d||void 0===d?void 0:d.uuid)&&(0,L.jsxs)(L.Fragment,{children:[o&&(0,L.jsx)(_.Z,{mt:2,children:(0,L.jsx)(b.ZP,{alignItems:"center",fullWidth:!0,justifyContent:"center",children:(0,L.jsx)(Z.Z,{color:"white",large:!0})})}),!o&&r===N.Gi.TABLE&&h,!o&&r!==N.Gi.TABLE&&j]})]})]})}(X(X({},e),{},{blockRuns:ge,columns:Ne,dataType:ke,loadingData:De,rows:Ie,selectedRun:A,selectedTab:K,setSelectedTab:W,showDynamicBlocks:!0,textData:we}))},errors:ee,pageName:H.M.RUNS,pipeline:ie,setErrors:ne,subheader:(Re||Ce)&&(0,L.jsxs)(b.ZP,{alignItems:"center",children:[j.BF.includes(se)&&(0,L.jsxs)(v.Z,{children:[(0,L.jsx)(P.ZP,{bold:!0,default:!0,large:!0,children:"Pipeline is running"}),(0,L.jsx)(_.Z,{mr:1}),(0,L.jsx)(Z.Z,{inverted:!0}),(0,L.jsx)(_.Z,{mr:2})]}),Re&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(p.Z,{danger:!0,loading:_e,onClick:function(e){(0,Y.j)(e),ye({pipeline_run:{pipeline_run_action:"retry_blocks"}})},outline:!0,children:"Retry incomplete blocks"}),(0,L.jsx)(_.Z,{mr:2})]}),Ce&&(0,L.jsxs)(p.Z,{loading:_e,onClick:function(e){(0,Y.j)(e),ye({pipeline_run:{from_block_uuid:A.block_uuid,pipeline_run_action:"retry_blocks"}})},outline:!0,primary:!0,children:["Retry from selected block (",A.block_uuid,")"]})]}),title:function(e){var n=e.name;return"".concat(n," runs")},uuid:"".concat(H.M.RUNS,"_").concat(te,"_").concat(ce),children:[(0,L.jsx)(_.Z,{mt:I.cd,px:I.cd,children:(0,L.jsx)(O.Z,{level:5,children:"Block runs"})}),(0,L.jsx)(f.Z,{light:!0,mt:I.cd,short:!0}),Te,Le]})}z.getInitialProps=function(){var e=(0,r.Z)(l().mark((function e(n){var t,r,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.query,r=t.pipeline,i=t.run,e.abrupt("return",{pipeline:{uuid:r},pipelineRun:{id:i}});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var K=(0,y.Z)(z)},39525:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pipelines/[pipeline]/runs/[run]",function(){return t(14532)}])}},function(e){e.O(0,[844,9902,426,5264,4259,5896,7849,5872,9696,8264,5499,5347,5457,7586,1543,9265,3419,9774,2888,179],(function(){return n=39525,e(e.s=n);var n}));var n=e.O();_N_E=n}]);