(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8867],{53779:function(e,n,t){"use strict";t.d(n,{C:function(){return h},X$:function(){return f},eD:function(){return d}});var r=t(25976),i=t(44897),o=t(42631),c=t(70515),s=t(47041),l=t(91437),a=6.25*c.iI,u=(c.iI,100*c.iI),d=r.default.div.withConfig({displayName:"indexstyle__WindowContainerStyle",componentId:"sc-g0cszf-0"})(["border-radius:","px;width:100%;max-width:","px;z-index:101;position:absolute;overflow:hidden;top:50%;left:50%;transform:translate(-50%,-50%);",""],o.n_,u,(function(e){return"\n    box-shadow: ".concat((e.theme||i.Z).shadow.window,";\n    background-color: ").concat((e.theme||i.Z).background.panel,";\n  ")})),p=(0,r.css)(["display:flex;align-items:center;justify-content:space-between;height:","px;padding:","px ","px;",""],a,c.iI,c.cd*c.iI,(function(e){return"\n    background-color: ".concat((e.theme||i.Z).background.output,";\n  ")})),f=r.default.div.withConfig({displayName:"indexstyle__WindowHeaderStyle",componentId:"sc-g0cszf-1"})([""," border-top-left-radius:","px;border-top-right-radius:","px;",""],p,o.n_,o.n_,(function(e){return"\n    border-bottom: ".concat(o.YF,"px ").concat(o.M8," ").concat((e.theme||i.Z).borders.medium,";\n  ")})),h=r.default.div.withConfig({displayName:"indexstyle__WindowContentStyle",componentId:"sc-g0cszf-2"})(["overflow:auto;padding:","px 0;"," "," "," ",""],c.iI,s.w5,(0,l.eR)(),(function(e){return e.minMaxHeight&&"\n    max-height: ".concat(7*c.iI,"px;\n  ")}),(function(e){return!e.minMaxHeight&&"\n    max-height: calc(100vh - ".concat(6.5*a,"px);\n  ")}));r.default.div.withConfig({displayName:"indexstyle__WindowFooterStyle",componentId:"sc-g0cszf-3"})([""," justify-content:flex-end;border-bottom-left-radius:","px;border-bottom-right-radius:","px;",""],p,o.n_,o.n_,(function(e){return"\n    border-top: ".concat(o.YF,"px ").concat(o.M8," ").concat((e.theme||i.Z).borders.medium,";\n  ")})),r.default.div.withConfig({displayName:"indexstyle__InputRowStyle",componentId:"sc-g0cszf-4"})(["padding:","px ","px;",""],.75*c.iI,2*c.iI,(function(e){return"\n    border-bottom: ".concat(o.YF,"px ").concat(o.M8," ").concat((e.theme||i.Z).borders.medium,";\n  ")}))},29480:function(e,n,t){"use strict";t.d(n,{$W:function(){return u},cl:function(){return d},cv:function(){return p},dE:function(){return l},zG:function(){return a}});var r=t(25976),i=t(44897),o=t(42631),c=t(70515),s=t(47041),l=r.default.div.withConfig({displayName:"indexstyle__SectionStyle",componentId:"sc-7a1uhf-0"})(["border-radius:","px;padding:","px;",""],o.n_,c.cd*c.iI,(function(e){return"\n    background-color: ".concat((e.theme.background||i.Z.background).popup,";\n  ")})),a=r.default.div.withConfig({displayName:"indexstyle__DocsStyle",componentId:"sc-7a1uhf-1"})(["> div{overflow:initial;}> div img{max-width:80%;background:white;padding:1rem;max-height:20vh;}"]),u=r.default.div.withConfig({displayName:"indexstyle__CodeEditorStyle",componentId:"sc-7a1uhf-2"})(["padding-top:","px;",""],c.cd*c.iI,(function(e){return"\n    background-color: ".concat((e.theme.background||i.Z.background).codeTextarea,";\n  ")})),d=r.default.div.withConfig({displayName:"indexstyle__TableContainerStyle",componentId:"sc-7a1uhf-3"})(["overflow:auto;max-height:90vh;width:100%;"," "," "," "," ",""],s.w5,(function(e){return e.hideHorizontalScrollbar&&"\n    overflow-x: hidden;\n  "}),(function(e){return e.width&&"\n    width: ".concat(e.width,";\n  ")}),(function(e){return e.height&&"\n    height: ".concat(e.height,";\n  ")}),(function(e){return e.maxHeight&&"\n    max-height: ".concat(e.maxHeight,";\n  ")})),p=r.default.div.withConfig({displayName:"indexstyle__HeaderRowStyle",componentId:"sc-7a1uhf-4"})(["padding:","px;"," "," ",""],2*c.iI,(function(e){return"\n    background-color: ".concat((e.theme||i.Z).interactive.defaultBackground,";\n    border-bottom: ").concat(o.YF,"px ").concat(o.M8," ").concat((e.theme||i.Z).borders.medium,";\n  ")}),(function(e){return e.padding&&"\n    padding: ".concat(e.padding,"px;\n  ")}),(function(e){return e.rounded&&"\n    border-top-left-radius: ".concat(o.n_,"px;\n    border-top-right-radius: ").concat(o.n_,"px;\n  ")}))},11074:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(25976),i=t(44897),o=t(42631),c=r.default.div.withConfig({displayName:"indexstyle__PanelStyle",componentId:"sc-1rfr5wd-0"})(["border-radius:","px;"," ",""],o.n_,(function(e){return"\n    background-color: ".concat((e.theme.background||i.Z.background).panel,";\n  ")}),(function(e){return e.fullWidth&&"\n    width: 100%;\n  "})),s=t(28598);var l=function(e){var n=e.children,t=e.fullWidth,r=void 0===t||t;return(0,s.jsx)(c,{fullWidth:r,children:n})}},42765:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Ze}});var r,i=t(77837),o=t(75582),c=t(82394),s=t(38860),l=t.n(s),a=t(82684),u=t(34376),d=t(71180),p=t(69864),f=t(32013),h=t(98777),m=t(89083),x=t(15338),j=t(78650),v=t(97618),g=t(55485),b=t(85854),Z=t(68562),y=t(11074),_=t(44085),w=t(38276),P=t(30160),k=t(17488),C=t(69650),O=t(12468),S=t(35686),I=["ReadWriteOnce","ReadWriteMany","ReadOnlyMany"],D=["Retain","Delete"],N=[{label:"Workspace name",required:!0,uuid:"name"}],E=[{label:"Namespace",labelDescription:"The namespace where the workspace resources will be deployed. Defaults to the value of the KUBE_NAMESPACE environment variable.",uuid:"namespace"},{label:"Service account name",placeholder:"default",uuid:"service_account_name"},{label:"Ingress name",labelDescription:"If you want to add the workspace to an existing ingress, enter the name of the ingress here. Otherwise, the workspace can be accessed through the service.",placeholder:"my-ingress",uuid:"ingress_name"}],M=[{label:"Storage class name",placeholder:"default",uuid:"storage_class_name"},{label:"Storage request size (in GB)",type:"number",uuid:"storage_request_size"}],F=t(44425),R=t(72473);!function(e){e.K8S="k8s",e.ECS="ecs",e.CLOUD_RUN="cloud_run",e.EMR="emr"}(r||(r={}));var A={ingress_name:"Ingress",namespace:"Namespace",pvc_retention_policy:"PVC retention policy",service_account_name:"Service account name",storage_access_mode:"Storage access mode",storage_class_name:"Storage class name",storage_request_size:"Storage request size (in GB)",url:"Access URL"},W={"termination_policy.enable_auto_termination":"Termination policy: auto-terminate","termination_policy.max_idle_seconds":"Termination policy: max idle seconds",pre_start_script_path:"Pre start: script path","post_start.command":"Post start: command","post_start.hook_path":"Post start: path to hook"},T=t(29480),z=t(79633),L=t(53779),B=t(72619),G=t(81728),U=t(89538),q=t(28598);function H(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function V(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?H(Object(t),!0).forEach((function(n){(0,c.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):H(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var K=function(e){var n=e.clusterType,t=e.onCancel,i=e.onCreate,s=e.project,l=(0,a.useState)(),u=l[0],A=l[1],W=(0,a.useState)(),H=W[0],K=W[1],Y=(0,a.useState)(null),$=Y[0],Q=Y[1],X=(0,a.useState)(null),J=X[0],ee=X[1],ne=(0,a.useMemo)((function(){return null===s||void 0===s?void 0:s.workspace_config_defaults}),[s]);(0,a.useEffect)((function(){if(ne&&(J||ee(null===ne||void 0===ne?void 0:ne.lifecycle_config),!$)){var e=V(V({},null===ne||void 0===ne?void 0:ne.k8s),{},{name:null===ne||void 0===ne?void 0:ne.name});Q(e)}}),[ne,J,$]);var te=(0,p.Db)(S.ZP.workspaces.useCreate(),{onSuccess:function(e){return(0,B.wD)(e,{callback:function(e){e.error_message?A(e.error_message):i()},onErrorCallback:function(e){var n=e.error,t=n.errors,r=n.message;A(r),console.log(t,r)}})}}),re=(0,o.Z)(te,2),ie=re[0],oe=re[1].isLoading,ce=S.ZP.files.list(),se=ce.data,le=ce.mutate,ae=(0,a.useMemo)((function(){return(null===se||void 0===se?void 0:se.files)||[]}),[se]),ue=(0,U.dd)((function(e){return(0,q.jsxs)(L.eD,{children:[(0,q.jsxs)(L.X$,{children:[(0,q.jsx)(v.Z,{alignItems:"center",children:(0,q.jsx)(P.ZP,{disableWordBreak:!0,monospace:!0,children:"Select file"})}),(0,q.jsx)(d.ZP,{iconOnly:!0,onClick:fe,children:(0,q.jsx)(R.Close,{muted:!0})})]}),(0,q.jsx)(L.C,{children:(0,q.jsx)(j.Z,{disableContextMenu:!0,fetchFiles:le,files:ae,isFileDisabled:null===e||void 0===e?void 0:e.isFileDisabled,openFile:e.onFileOpen,uuid:"ConfigureWorkspace/FileBrowser"})})]})}),{},[ae,le],{background:!0,uuid:"file_selector"}),de=(0,o.Z)(ue,2),pe=de[0],fe=de[1],he=(0,a.useCallback)((function(e){var n=e.autoComplete,t=e.disabled,r=e.label,i=e.labelDescription,o=e.placeholder,s=e.required,l=e.type,a=e.uuid;return(0,q.jsxs)("div",{children:[(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(w.Z,{ml:3,mr:2,my:1,children:(0,q.jsxs)(g.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,q.jsxs)(v.Z,{flex:2,flexDirection:"column",children:[(0,q.jsx)(P.ZP,{children:r}),i&&(0,q.jsx)(P.ZP,{muted:!0,children:i})]}),(0,q.jsx)(v.Z,{flex:1}),(0,q.jsx)(v.Z,{flex:1,children:(0,q.jsx)(k.Z,{autoComplete:n,disabled:t,onChange:function(e){Q((function(n){return V(V({},n),{},(0,c.Z)({},a,e.target.value))}))},placeholder:o,required:s,setContentOnMount:!0,type:l,value:(null===$||void 0===$?void 0:$[a])||""})})]})})]},a)}),[$,Q]),me=(0,a.useMemo)((function(){return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(g.ZP,{children:(0,q.jsx)(w.Z,{ml:2,my:2,children:(0,q.jsx)(P.ZP,{bold:!0,sky:!0,children:"General"})})}),E.map((function(e){return he(e)})),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(g.ZP,{children:(0,q.jsx)(w.Z,{ml:2,my:2,children:(0,q.jsx)(P.ZP,{bold:!0,sky:!0,children:"Volume claim params"})})}),M.map((function(e){return he(e)})),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(w.Z,{ml:3,mr:2,my:1,children:(0,q.jsxs)(g.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,q.jsx)(v.Z,{flex:3,children:(0,q.jsx)(P.ZP,{children:"Access mode"})}),(0,q.jsx)(v.Z,{flex:1,children:(0,q.jsx)(_.Z,{fullWidth:!0,label:"Access mode",onChange:function(e){e.preventDefault(),Q((function(n){return V(V({},n),{},{storage_access_mode:e.target.value})}))},placeholder:"Access mode",value:null===$||void 0===$?void 0:$.storage_access_mode,children:I.map((function(e){return(0,q.jsx)("option",{value:e,children:e},e)}))})})]})}),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(w.Z,{ml:3,mr:2,my:1,children:(0,q.jsxs)(g.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,q.jsx)(v.Z,{flex:3,children:(0,q.jsx)(O.Z,{block:!0,description:(0,q.jsxs)(P.ZP,{default:!0,inline:!0,children:["Configure the retention policy for the stateful set PVC.",(0,q.jsx)("br",{}),"Retain will keep the PVC after the workspace is deleted.",(0,q.jsx)("br",{}),"Delete will delete the PVC when the workspace is deleted."]}),size:null,widthFitContent:!0,children:(0,q.jsx)(P.ZP,{children:"Retention policy (default: Retain)"})})}),(0,q.jsx)(v.Z,{flex:1,children:(0,q.jsx)(_.Z,{fullWidth:!0,label:"Retention policy",onChange:function(e){e.preventDefault(),Q((function(n){return V(V({},n),{},{pvc_retention_policy:e.target.value})}))},placeholder:"Retention policy",value:null===$||void 0===$?void 0:$.pvc_retention_policy,children:D.map((function(e){return(0,q.jsx)("option",{value:e,children:e},e)}))})})]})}),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(w.Z,{ml:2,my:2,children:(0,q.jsxs)(g.ZP,{alignItems:"center",children:[(0,q.jsx)(C.Z,{checked:H,compact:!0,onCheck:function(){return K((function(e){return!e}))}}),(0,q.jsx)(w.Z,{ml:1,children:(0,q.jsx)(P.ZP,{bold:!0,sky:!0,children:"Configure container"})})]})}),(0,q.jsx)(x.Z,{muted:!0}),H&&(0,q.jsx)(w.Z,{ml:3,mr:2,my:1,children:(0,q.jsx)(T.$W,{children:(0,q.jsx)(m.Z,{autoHeight:!0,fontSize:12,language:F.t6.YAML,onChange:function(e){Q((function(n){return V(V({},n),{},{container_config:e})}))},tabSize:2,value:null===$||void 0===$?void 0:$.container_config,width:"100%"})})})]})}),[he,H,$]),xe=(0,a.useMemo)((function(){var e,n,t,r;return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(g.ZP,{children:(0,q.jsx)(w.Z,{ml:2,my:2,children:(0,q.jsx)(P.ZP,{bold:!0,sky:!0,children:"Termination policy"})})}),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(w.Z,{ml:3,mr:2,my:1,children:(0,q.jsxs)(g.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,q.jsx)(v.Z,{flex:3,children:(0,q.jsx)(P.ZP,{children:"Enable auto termination"})}),(0,q.jsx)(v.Z,{flex:1,children:(0,q.jsxs)(_.Z,{fullWidth:!0,onChange:function(e){e.preventDefault(),ee((function(n){return V(V({},n),{},{termination_policy:V(V({},null===n||void 0===n?void 0:n.termination_policy),{},{enable_auto_termination:"true"===e.target.value})})}))},value:(null===J||void 0===J||null===(e=J.termination_policy)||void 0===e?void 0:e.enable_auto_termination)||"false",children:[(0,q.jsx)("option",{value:"true",children:"True"},"true"),(0,q.jsx)("option",{value:"false",children:"False"},"false")]})})]})}),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(w.Z,{ml:3,mr:2,my:1,children:(0,q.jsxs)(g.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,q.jsx)(v.Z,{flex:3,children:(0,q.jsx)(P.ZP,{children:"Max idle time (in seconds)"})}),(0,q.jsx)(v.Z,{flex:1,children:(0,q.jsx)(k.Z,{onChange:function(e){ee((function(n){return V(V({},n),{},{termination_policy:V(V({},null===n||void 0===n?void 0:n.termination_policy),{},{max_idle_seconds:e.target.value})})}))},setContentOnMount:!0,type:"number",value:(null===J||void 0===J||null===(n=J.termination_policy)||void 0===n?void 0:n.max_idle_seconds)||""})})]})}),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(g.ZP,{children:(0,q.jsx)(w.Z,{ml:2,my:2,children:(0,q.jsx)(P.ZP,{bold:!0,sky:!0,children:"Pre start"})})}),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(w.Z,{ml:3,mr:2,my:1,children:(0,q.jsxs)(g.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,q.jsxs)(v.Z,{flex:3,justifyContent:"space-between",children:[(0,q.jsx)(P.ZP,{children:"Path to pre start script"}),(0,q.jsx)(w.Z,{mr:1,children:(0,q.jsx)(d.ZP,{iconOnly:!0,noBackground:!0,noBorder:!0,onClick:function(){return pe({isFileDisabled:function(e,n){return!n&&!e.endsWith(".py")},onFileOpen:function(e,n){ee((function(n){return V(V({},n),{},{pre_start_script_path:e})})),fe()}})},children:(0,q.jsx)(R.Folder,{})})})]}),(0,q.jsx)(v.Z,{flex:1,children:(0,q.jsx)(k.Z,{onChange:function(e){ee((function(n){return V(V({},n),{},{pre_start_script_path:e.target.value})}))},placeholder:"/",setContentOnMount:!0,value:(null===J||void 0===J?void 0:J.pre_start_script_path)||""})})]})}),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(g.ZP,{children:(0,q.jsx)(w.Z,{ml:2,my:2,children:(0,q.jsx)(P.ZP,{bold:!0,sky:!0,children:"Post start"})})}),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(w.Z,{ml:3,mr:2,my:1,children:(0,q.jsxs)(g.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,q.jsx)(v.Z,{flex:3,children:(0,q.jsx)(P.ZP,{children:"Command"})}),(0,q.jsx)(v.Z,{flex:1,children:(0,q.jsx)(k.Z,{monospace:!0,onChange:function(e){ee((function(n){return V(V({},n),{},{post_start:V(V({},null===n||void 0===n?void 0:n.post_start),{},{command:e.target.value})})}))},setContentOnMount:!0,value:(null===J||void 0===J||null===(t=J.post_start)||void 0===t?void 0:t.command)||""})})]})}),(0,q.jsx)(x.Z,{muted:!0}),(0,q.jsx)(w.Z,{ml:3,mr:2,my:1,children:(0,q.jsxs)(g.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,q.jsxs)(v.Z,{flex:3,justifyContent:"space-between",children:[(0,q.jsx)(P.ZP,{children:"Path to hook (optional)"}),(0,q.jsx)(w.Z,{mr:1,children:(0,q.jsx)(d.ZP,{iconOnly:!0,noBackground:!0,noBorder:!0,onClick:function(){return pe({onFileOpen:function(e,n){ee((function(n){return V(V({},n),{},{post_start:V(V({},null===n||void 0===n?void 0:n.post_start),{},{hook_path:e})})})),fe()}})},children:(0,q.jsx)(R.Folder,{})})})]}),(0,q.jsx)(v.Z,{flex:1,children:(0,q.jsx)(k.Z,{onChange:function(e){ee((function(n){return V(V({},n),{},{post_start:V(V({},null===n||void 0===n?void 0:n.post_start),{},{hook_path:e.target.value})})}))},placeholder:"/",setContentOnMount:!0,value:(null===J||void 0===J||null===(r=J.post_start)||void 0===r?void 0:r.hook_path)||""})})]})}),(0,q.jsx)(x.Z,{muted:!0})]})}),[fe,J,ee,pe]);return(0,q.jsx)(y.Z,{children:(0,q.jsx)("div",{style:{width:"750px"},children:(0,q.jsxs)(w.Z,{p:2,children:[(0,q.jsx)(b.Z,{level:4,children:"Create workspace"}),(0,q.jsxs)("form",{children:[N.map((function(e){var n=e.autoComplete,t=e.disabled,r=e.label,i=e.required,o=e.type,s=e.uuid;return(0,q.jsx)(w.Z,{mt:2,children:(0,q.jsx)(k.Z,{autoComplete:n,disabled:t,label:r,onChange:function(e){Q((function(n){return V(V({},n),{},(0,c.Z)({},s,e.target.value))}))},required:i,setContentOnMount:!0,type:o,value:(null===$||void 0===$?void 0:$[s])||""})},s)})),(0,q.jsx)(w.Z,{mt:2,children:(0,q.jsxs)(f.Z,{noPaddingContent:!0,children:[n===r.K8S&&(0,q.jsx)(h.Z,{title:"Kubernetes",children:me}),(0,q.jsx)(h.Z,{title:"Lifecycle (optional)",children:xe})]})})]}),oe&&(0,q.jsx)(w.Z,{mt:1,children:(0,q.jsx)(P.ZP,{small:!0,warning:!0,children:"This may take up to a few minutes... Once the service is created, it may take another 5-10 minutes for the service to be accessible."})}),!oe&&u&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(w.Z,{mt:1,children:(0,q.jsx)(P.ZP,{danger:!0,small:!0,children:"Failed to create instance, see error below."})}),(0,q.jsx)(w.Z,{mt:1,children:(0,q.jsx)(P.ZP,{danger:!0,small:!0,children:u})})]}),(0,q.jsx)(w.Z,{my:2,children:(0,q.jsxs)(g.ZP,{flexDirection:"row-reverse",children:[(0,q.jsx)(Z.ZP,{background:z.a$,bold:!0,inline:!0,loading:oe,onClick:function(){var e=$||{},t=e.name,r=e.container_config;if(t){var i=V({},$);i.name=function(e){return"ecs"===n?(0,G.We)(e,"_"):(0,G.We)(e,"-")}(t),i.container_config=H&&r,ie({workspace:V(V({},i),{},{cluster_type:n,lifecycle_config:J})})}else A("Please enter a valid name!")},uuid:"workspaces/create",children:"Create"}),(0,q.jsx)(w.Z,{ml:1}),(0,q.jsx)(Z.ZP,{bold:!0,inline:!0,onClick:t,uuid:"workspaces/cancel",children:"Cancel"})]})})]})})})},Y=t(65956),$=t(93808),Q=t(75499),X=t(85544),J=t(59533),ee=t(25976),ne=t(44897),te=ee.default.div.withConfig({displayName:"indexstyle__ContainerStyle",componentId:"sc-19701zd-0"})(["border:1px solid;border-radius:8px;",""],(function(e){return"\n    border-color: ".concat((e.theme.monotone||ne.Z.monotone).grey500,";\n  ")})),re=t(70515);function ie(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function oe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ie(Object(t),!0).forEach((function(n){(0,c.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ie(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ce,se=function(e){var n=e.clusterType,t=e.fetchWorkspaces,i=e.onSuccess,c=e.setErrors,s=e.workspace,l=s.instance,u=s.lifecycle_config,f=(l.ip,l.name),h=l.status,m=(l.type,{cluster_type:n}),j=(0,p.Db)(S.ZP.workspaces.useUpdate(f,m),{onSuccess:function(e){return(0,B.wD)(e,{callback:function(){t(),i()},onErrorCallback:function(e,n){return c({errors:n,response:e})}})}}),Z=(0,o.Z)(j,2),y=Z[0],_=Z[1].isLoading,k=(0,p.Db)(S.ZP.workspaces.useDelete(f,m),{onSuccess:function(e){return(0,B.wD)(e,{callback:function(){t(),i()},onErrorCallback:function(e,n){return c({errors:n,response:e})}})}}),C=(0,o.Z)(k,2),O=C[0],I=C[1].isLoading,D=(0,a.useMemo)((function(){if(u){var e={};return Object.entries(u).map((function(n){var t=(0,o.Z)(n,2),r=t[0],i=t[1];i&&"object"===typeof i?Object.entries(i).map((function(n){var t=(0,o.Z)(n,2),i=t[0],c=t[1];e["".concat(r,".").concat(i)]=c})):e[r]=i})),e}}),[u]),N=(0,a.useMemo)((function(){var e=l.status,t=[];return"ecs"===n&&("STOPPED"===e?t.unshift({label:"Resume instance",onClick:function(){return y({workspace:{action:"resume",cluster_type:n,name:l.name,task_arn:l.task_arn}})},props:{loading:_,primary:!0},uuid:"resume_instance"}):"RUNNING"===e&&t.unshift({label:"Stop instance",onClick:function(){return y({workspace:{action:"stop",cluster_type:n,name:l.name,task_arn:l.task_arn}})},props:{loading:_,warning:!0},uuid:"stop_instance"})),"k8s"===n&&("STOPPED"===e?t.unshift({label:"Resume instance",onClick:function(){return y({workspace:{action:"resume",cluster_type:n,name:l.name}})},props:{loading:_,primary:!0},uuid:"resume_instance"}):"RUNNING"===e&&t.unshift({label:"Stop instance",onClick:function(){return y({workspace:{action:"stop",cluster_type:n,name:l.name}})},props:{loading:_,warning:!0},uuid:"stop_instance"})),null===s||void 0===s||!s.ingress_name||null!==s&&void 0!==s&&s.url||t.push({label:"Add to ingress",onClick:function(){return y({workspace:{action:"add_to_ingress",cluster_type:n,name:l.name}})},props:{default:!0,loading:_},uuid:"re_add_to_ingress"}),t}),[n,l,y,s,_]),E=(0,a.useMemo)((function(){return(0,q.jsx)(d.ZP,{danger:!0,loading:I,onClick:function(){window.confirm("Are you sure you want to delete workspace ".concat(f,"?"))&&O()},children:"Delete workspace"})}),[O,I,f]);return(0,q.jsx)(q.Fragment,{children:(0,q.jsxs)(w.Z,{p:2,children:[(0,q.jsx)(w.Z,{mb:2,children:(0,q.jsxs)(g.ZP,{alignItems:"center",children:[(0,q.jsx)(R.Folder,{size:2*re.iI}),(0,q.jsx)(w.Z,{mr:1}),(0,q.jsx)(b.Z,{level:3,children:null===s||void 0===s?void 0:s.name})]})}),(0,q.jsx)(w.Z,{mb:2,children:(0,q.jsxs)(P.ZP,{children:["Status: ",(0,q.jsx)(P.ZP,{bold:!0,danger:"STOPPED"===h,default:"PROVISIONING"===h,inline:!0,success:"RUNNING"===h,warning:"PENDING"===h,children:h})]})}),!N||0==N.length&&(0,q.jsx)(w.Z,{mb:2,children:E}),N&&N.length>0&&(0,q.jsx)(w.Z,{mb:2,children:(0,q.jsxs)(g.ZP,{justifyContent:"space-between",children:[(0,q.jsx)(v.Z,{children:N.map((function(e){var n=e.label,t=e.onClick,r=e.uuid,i=e.props;return(0,q.jsx)(w.Z,{mr:1,children:(0,q.jsx)(d.ZP,oe(oe({},i),{},{onClick:t,children:n}))},r)}))}),E]})}),n===r.K8S&&(0,q.jsx)(te,{children:Object.entries(A).map((function(e,n){var t=(0,o.Z)(e,2),r=t[0],i=t[1];return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(w.Z,{mx:2,my:2,children:(0,q.jsxs)(g.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,q.jsx)(v.Z,{flex:4,children:(0,q.jsx)(P.ZP,{muted:!0,children:i})}),(0,q.jsx)(v.Z,{flex:2,flexDirection:"row-reverse",children:(0,q.jsx)(P.ZP,{bold:!0,children:(null===s||void 0===s?void 0:s[r])||"N/A"})})]})},r),n!==Object.entries(A).length-1&&(0,q.jsx)(x.Z,{muted:!0})]})}))}),D&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(w.Z,{my:2,children:(0,q.jsx)(b.Z,{default:!0,level:5,children:"Lifecycle Properties"})}),(0,q.jsx)(te,{children:Object.entries(W).map((function(e,n){var t,r=(0,o.Z)(e,2),i=r[0],c=r[1];return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(w.Z,{mx:2,my:2,children:(0,q.jsxs)(g.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,q.jsx)(v.Z,{flex:3,children:(0,q.jsx)(P.ZP,{muted:!0,children:c})}),(0,q.jsx)(v.Z,{flex:1,flexDirection:"row-reverse",children:(0,q.jsx)(P.ZP,{bold:!0,children:null===(t=D[i])||void 0===t?void 0:t.toString()})})]})},i),n!==Object.entries(W).length-1&&(0,q.jsx)(x.Z,{muted:!0})]})}))})]})]})})};!function(e){e.ALL="__all__",e.NAMESPACE="namespace[]"}(ce||(ce={}));var le=t(42631),ae=t(11498),ue=t(75083),de=t(69419),pe=t(53808),fe="workspace_list_filters";function he(e){return(0,pe.t8)(fe,e),e}var me=t(15610),xe=t(42122),je=t(98464);function ve(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ge(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ve(Object(t),!0).forEach((function(n){(0,c.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ve(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function be(){var e=(0,u.useRouter)(),n=S.ZP.statuses.list().data,t=(0,a.useState)(null),i=t[0],s=t[1],l=(0,de.iV)(),p=(0,a.useMemo)((function(){return ge({},(0,de.DQ)(l,[ce.NAMESPACE]))}),[l]),f=(0,a.useMemo)((function(){var e,t;return(null===n||void 0===n||null===(e=n.statuses)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.instance_type)||"ecs"}),[n]),h=S.ZP.projects.list({},{revalidateOnFocus:!1}).data,m=(0,a.useMemo)((function(){var e;return null===h||void 0===h||null===(e=h.projects)||void 0===e?void 0:e[0]}),[h]),x=(0,a.useState)(!1),j=x[0],v=x[1],g=S.ZP.workspaces.list(ge(ge({},p),{},{cluster_type:f}),{revalidateOnFocus:!1}),b=g.data,Z=g.mutate,y=(0,je.Z)(b);(0,a.useEffect)((function(){null==b?v(!0):null==y&&v(!1)}),[b,y]);var _=(0,a.useMemo)((function(){var e;return null===b||void 0===b||null===(e=b.workspaces)||void 0===e?void 0:e.filter((function(e){return e.name}))}),[b]),w=(0,U.dd)((function(){return(0,q.jsx)(K,{clusterType:f,onCancel:O,onCreate:function(){Z(),O()},project:m})}),{},[f,Z,m],{background:!0,disableClickOutside:!0,disableEscape:!0,uuid:"configure_workspace"}),k=(0,o.Z)(w,2),C=k[0],O=k[1],I=(0,U.dd)((function(e){var n=e.workspace;return(0,q.jsx)(Y.Z,{children:(0,q.jsx)("div",{style:{width:"750px"},children:(0,q.jsx)(se,{clusterType:f,fetchWorkspaces:Z,onSuccess:E,setErrors:s,workspace:n})})})}),{},[f,Z,s,_],{background:!0,uuid:"workspace_detail"}),D=(0,o.Z)(I,2),N=D[0],E=D[1],M=(0,a.useCallback)((function(e){var n=null===_||void 0===_?void 0:_[e];N({workspace:n})}),[N,_]);(0,a.useEffect)((function(){var e={};if((0,xe.Qr)(p)){var n={},t=(0,pe.U2)(fe,{});t&&Object.entries(t).forEach((function(e){var t=(0,o.Z)(e,2),r=t[0],i=t[1];"undefined"!==typeof i&&null!==i&&(ae.RG.includes(r)?n[r]=i:(n[r]=[],Object.entries(i).forEach((function(e){var t=(0,o.Z)(e,2),i=t[0];t[1]&&n[r].push(i)}))))})),(0,xe.Qr)(n)||(e={},Object.entries(ge(ge({},e),n)||{}).forEach((function(n){var t=(0,o.Z)(n,2),r=t[0],i=t[1];"undefined"!==typeof i&&null!==i&&(e[r]=i)})))}else{var r={};Object.entries(p).forEach((function(e){var n=(0,o.Z)(e,2),t=n[0],i=n[1];r[t]={};var c,s=i;"undefined"!==typeof i&&null!==i&&(ae.RG.includes(t)?r[t]=s:(Array.isArray(s)||(s=[s]),s&&Array.isArray(s)&&(null===(c=s)||void 0===c||c.forEach((function(e){r[t][e]=!0})))))})),he((0,xe.hB)(r))}(0,xe.Qr)(e)||(0,me.u)((0,xe.hB)(e),{pushHistory:!1})}),[p]);var F=(0,a.useMemo)((function(){var n={},t={};return f===r.K8S&&(n={namespace:[ce.ALL]},t={namespace:(0,c.Z)({},ce.ALL,"All namespaces")}),(0,q.jsx)(X.Z,{addButtonProps:{label:"Create new workspace",onClick:C},extraActionButtonProps:{Icon:R.Refresh,disabled:!1,isLoading:j,onClick:function(){v(!0),Z().then((function(){return v(!1)}))},tooltip:"Refresh workspaces"},filterOptions:n,filterValueLabelMapping:t,onClickFilterDefaults:function(){he({}),e.push("/manage")},onFilterApply:function(e,n){Object.values(n).every((function(e){return!(null!==e&&void 0!==e&&e.length)}))&&he({})},query:p})}),[f,Z,j,p,e,C]);return(0,q.jsx)(J.Z,{breadcrumbs:[{bold:!0,label:function(){return"Workspaces"}}],errors:i,pageName:ue.L6.WORKSPACES,setErrors:s,subheaderChildren:F,children:(0,q.jsx)(Q.Z,{columnFlex:[2,4,2,3,1,null],columns:[{uuid:"Status"},{uuid:"Instance Name"},{uuid:"Type"},{uuid:"URL/IP"},{uuid:"Open"}],onClickRow:["ecs","k8s"].includes(f)&&M,rows:null===_||void 0===_?void 0:_.map((function(e){var n=e.instance,t=e.url,r=n.ip,i=n.name,o=n.status,c=n.type,s=t||r,l=s;return s&&!s.includes("http")&&(l="http://".concat(s),"ecs"===f&&(l="http://".concat(s,":6789"))),[(0,q.jsx)(d.ZP,{borderRadius:"".concat(le.D7,"px"),danger:"STOPPED"===o,default:"PROVISIONING"===o,notClickable:!0,padding:"6px",success:"RUNNING"===o,warning:"PENDING"===o,children:(0,G.vg)(o)},"status"),(0,q.jsx)(P.ZP,{children:i},"name"),(0,q.jsx)(P.ZP,{children:(0,G.vg)(c)},"type"),(0,q.jsx)(P.ZP,{children:s||"N/A"},"ip"),(0,q.jsx)(d.ZP,{disabled:!s,iconOnly:!0,onClick:function(){return window.open(l)},children:(0,q.jsx)(R.Expand,{size:2*re.iI})},"open_button")]}))})})}be.getInitialProps=(0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})));var Ze=(0,$.Z)(be)},13157:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage",function(){return t(42765)}])}},function(e){e.O(0,[1557,1598,5544,9774,2888,179],(function(){return n=13157,e(e.s=n);var n}));var n=e.O();_N_E=n}]);