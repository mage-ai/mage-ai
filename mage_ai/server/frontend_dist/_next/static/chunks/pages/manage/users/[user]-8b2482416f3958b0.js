(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4496],{1210:function(e,n,r){"use strict";r.d(n,{Z:function(){return S}});var t=r(82394),i=r(21831),o=r(82684),u=r(47999),l=r(49894),s=r(93461),a=r(57384),c=r(41424),d=r(72454),f=r(28598);function p(e,n){var r=e.children;return(0,f.jsx)(d.HS,{ref:n,children:r})}var m=o.forwardRef(p),v=r(32063),h=r(85019),b=r(82531),w=r(66166),g=r(3055),y=r(49125),j=r(91427),O=r(24141);function x(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function Z(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?x(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var S=function(e){var n,r=e.after,t=e.afterHidden,p=e.afterWidth,x=e.afterWidthOverride,S=e.before,_=e.beforeWidth,I=e.breadcrumbs,P=e.children,C=e.errors,k=e.headerMenuItems,N=e.headerOffset,E=e.mainContainerHeader,D=e.navigationItems,H=e.setErrors,M=e.subheaderChildren,T=e.title,A=e.uuid,z=(0,O.i)().width,R="dashboard_after_width_".concat(A),U="dashboard_before_width_".concat(A),F=(0,o.useRef)(null),W=(0,o.useState)(x?p:(0,j.U2)(R,p)),B=W[0],L=W[1],q=(0,o.useState)(!1),G=q[0],Q=q[1],X=(0,o.useState)(S?Math.max((0,j.U2)(U,_),13*y.iI):null),K=X[0],J=X[1],Y=(0,o.useState)(!1),V=Y[0],$=Y[1],ee=(0,o.useState)(null)[1],ne=b.ZP.projects.list({},{revalidateOnFocus:!1}).data,re=null===ne||void 0===ne?void 0:ne.projects,te=[];I?te.push.apply(te,(0,i.Z)(I)):(null===re||void 0===re?void 0:re.length)>=1&&te.push.apply(te,[{label:function(){var e;return null===(e=re[0])||void 0===e?void 0:e.name},linkProps:{href:"/"}},{bold:!0,label:function(){return T}}]),(0,o.useEffect)((function(){null===F||void 0===F||!F.current||G||V||null===ee||void 0===ee||ee(F.current.getBoundingClientRect().width)}),[G,B,V,K,F,ee,z]),(0,o.useEffect)((function(){G||(0,j.t8)(R,B)}),[t,G,B,R]),(0,o.useEffect)((function(){V||(0,j.t8)(U,K)}),[V,K,U]);var ie=(0,w.Z)(p);return(0,o.useEffect)((function(){x&&ie!==p&&L(p)}),[x,p,ie]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(a.Z,{title:T}),(0,f.jsx)(c.Z,{breadcrumbs:te,menuItems:k,project:null===re||void 0===re?void 0:re[0],version:null===re||void 0===re||null===(n=re[0])||void 0===n?void 0:n.version}),(0,f.jsxs)(d.Nk,{children:[0!==(null===D||void 0===D?void 0:D.length)&&(0,f.jsx)(d.lm,{showMore:!0,children:(0,f.jsx)(h.Z,{navigationItems:D,showMore:!0})}),(0,f.jsx)(s.Z,{flex:1,flexDirection:"column",children:(0,f.jsxs)(v.Z,{after:r,afterHeightOffset:g.Mz,afterHidden:t,afterMousedownActive:G,afterWidth:B,before:S,beforeHeightOffset:g.Mz,beforeMousedownActive:V,beforeWidth:d.k1+(S?K:0),headerOffset:N,hideAfterCompletely:!0,leftOffset:S?d.k1:null,mainContainerHeader:E,mainContainerRef:F,setAfterMousedownActive:Q,setAfterWidth:L,setBeforeMousedownActive:$,setBeforeWidth:J,children:[M&&(0,f.jsx)(m,{children:M}),P]})})]}),C&&(0,f.jsx)(u.Z,{disableClickOutside:!0,isOpen:!0,onClickOutside:function(){return null===H||void 0===H?void 0:H(null)},children:(0,f.jsx)(l.Z,Z(Z({},C),{},{onClose:function(){return null===H||void 0===H?void 0:H(null)}}))})]})}},63153:function(e,n,r){"use strict";r.d(n,{Z3:function(){return t},ms:function(){return o},s7:function(){return i}});var t=[{autoComplete:"username",label:"Username",required:!0,uuid:"username"},{autoComplete:"email",disabled:!1,label:"Email",required:!0,type:"email",uuid:"email"}],i="password_current",o=[{autoComplete:"current-password",label:"Current password",type:"password",uuid:i},{autoComplete:"new-password",label:"New password",type:"password",uuid:"password"},{autoComplete:"new-password",label:"Confirm new password",type:"password",uuid:"password_confirmation"}]},20582:function(e,n,r){"use strict";var t=r(82394),i=r(21831),o=r(75582),u=r(21764),l=r(82684),s=r(83455),a=r(60328),c=r(79891),d=r(67971),f=r(87372),p=r(55378),m=r(86673),v=r(82944),h=r(82531),b=r(66166),w=r(63153),g=r(24224),y=r(9736),j=r(7715),O=r(96510),x=r(28598);function Z(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function S(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}n.Z=function(e){var n=e.disabledFields,r=e.entity,Z=void 0===r?"global":r,_=e.entityID,I=e.hideFields,P=e.newUser,C=e.onDeleteSuccess,k=e.onSaveSuccess,N=e.showDelete,E=e.title,D=e.user,H=(0,l.useState)(!0),M=H[0],T=H[1],A=(0,l.useState)({}),z=A[0],R=A[1],U=(0,l.useState)(null),F=U[0],W=U[1],B=((0,y.PR)()||{}).owner,L=h.ZP.roles.list({entity:Z,entity_ids:_?[_]:[],limit_roles:!!P},{revalidateOnFocus:!1}),q=L.data,G=(L.mutate,(0,l.useMemo)((function(){return(null===q||void 0===q?void 0:q.roles)||[]}),[null===q||void 0===q?void 0:q.roles])),Q=(0,s.Db)(P?h.ZP.users.useCreate():h.ZP.users.useUpdate(null===D||void 0===D?void 0:D.id),{onSuccess:function(e){return(0,O.wD)(e,{callback:function(e){var n=e.user,r=w.Z3.concat(w.ms).map((function(e){return e.uuid})),t=(0,j.GL)(n,r);W(t),u.Am.success(P?"New user created successfully.":"User profile successfully updated.",{position:u.Am.POSITION.BOTTOM_RIGHT,toastId:"user-update-success-".concat(n.id)}),null===k||void 0===k||k(t)},onErrorCallback:function(e){var n=e.error,r=n.errors,t=n.exception,i=n.message,o=n.type;u.Am.error((null===r||void 0===r?void 0:r.error)||t||i,{position:u.Am.POSITION.BOTTOM_RIGHT,toastId:o})}})}}),X=(0,o.Z)(Q,2),K=X[0],J=X[1].isLoading,Y=(0,s.Db)(h.ZP.users.useDelete(null===D||void 0===D?void 0:D.id),{onSuccess:function(e){return(0,O.wD)(e,{callback:function(){null===C||void 0===C||C()},onErrorCallback:function(e){var n=e.error,r=n.errors,t=n.message;alert(t),console.log(r)}})}}),V=(0,o.Z)(Y,2),$=V[0],ee=V[1].isLoading,ne=I?(0,i.Z)(I):[];P&&ne.push(w.s7);var re=!ne||!ne.includes(w.s7),te=(0,b.Z)(D);(0,l.useEffect)((function(){if(D&&(!F||(null===te||void 0===te?void 0:te.id)!==(null===D||void 0===D?void 0:D.id))){var e=w.Z3.concat(w.ms).map((function(e){return e.uuid}));W((0,j.GL)(D,e))}null!==F&&void 0!==F&&F.password||null!==F&&void 0!==F&&F.password_confirmation?(null===F||void 0===F?void 0:F.password)!==(null===F||void 0===F?void 0:F.password_confirmation)?R({password_confirmation:"Password confirmation does not match."}):!re||null!==F&&void 0!==F&&F.password_current?R(null):R({password_current:"This field is required."}):null!==F&&void 0!==F&&F.password_current&&re?null!==F&&void 0!==F&&F.password&&null!==F&&void 0!==F&&F.password_confirmation?R(null):R({password:"This field is required.",password_confirmation:"This field is required."}):null!==F&&void 0!==F&&F.password_current||null!==F&&void 0!==F&&F.password||null!==F&&void 0!==F&&F.password_confirmation||R(null)}),[F,re,D,te]);var ie=(0,l.useState)(!1),oe=ie[0],ue=ie[1],le=(0,l.useMemo)((function(){return(oe?null===F||void 0===F?void 0:F.roles_new:null===D||void 0===D?void 0:D.roles_new)||[]}),[F,oe,D]),se=(0,l.useMemo)((function(){var e=(null===G||void 0===G?void 0:G.map((function(e){return e.id})))||[];return null===le||void 0===le?void 0:le.filter((function(n){var r=n.id;return e.includes(r)}))}),[le,G]);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(f.Z,{children:E||"Edit profile"}),(0,x.jsxs)("form",{children:[w.Z3.filter((function(e){var n=e.uuid;return!ne||!ne.includes(n)})).map((function(e){var n=e.autoComplete,r=e.disabled,i=e.label,o=e.required,u=e.type,l=e.uuid;return(0,x.jsx)(m.Z,{mt:2,children:(0,x.jsx)(v.Z,{autoComplete:n,disabled:r&&!P,label:i,onChange:function(e){T(!1),W((function(n){return S(S({},n),{},(0,t.Z)({},l,e.target.value))}))},primary:!0,required:o,setContentOnMount:!0,type:u,value:(null===F||void 0===F?void 0:F[l])||""})},l)})),!(null!==D&&void 0!==D&&D.owner)&&(0,x.jsxs)(m.Z,{mt:2,children:[(0,x.jsx)(p.Z,{disabled:null===n||void 0===n?void 0:n.includes("roles"),label:"Roles",onChange:function(e){var n=(0,g.sE)(G,(function(n){return n.id==e.target.value}));n&&(T(!1),ue(!0),W((function(e){var r={};return(0,g.sE)(le,(function(e){return e.id==(null===n||void 0===n?void 0:n.id)}))||(r={roles_new:[].concat((0,i.Z)(le),[n])}),S(S({},e),r)})))},primary:!0,setContentOnMount:!0,children:G.map((function(e){var n=e.id,r=e.name;return(0,x.jsx)("option",{value:n,children:r},r)}))}),(0,x.jsx)(m.Z,{mb:1}),(0,x.jsx)(d.Z,{alignItems:"center",flexWrap:"wrap",children:null===se||void 0===se?void 0:se.map((function(e){var r=e.id,t=e.name;return(0,x.jsx)(m.Z,{mb:1,mr:1,children:(0,x.jsx)(c.Z,{disabled:null===n||void 0===n?void 0:n.includes("roles"),label:t,onClick:function(){T(!1),ue(!0),W((function(e){return S(S({},e),{},{roles_new:(0,g.Od)(le,(function(e){return e.id===r}))})}))},primary:!0})},"user_roles/".concat(t))}))})]}),(0,x.jsxs)(m.Z,{mt:5,children:[(0,x.jsx)(f.Z,{children:P?"Password":"Change password"}),w.ms.filter((function(e){var n=e.uuid;return!ne||!ne.includes(n)})).map((function(e){var n=e.autoComplete,r=e.disabled,i=e.label,o=e.required,u=e.type,l=e.uuid;return(0,x.jsx)(m.Z,{mt:2,children:(0,x.jsx)(v.Z,{autoComplete:n,disabled:r,label:i,meta:{error:null===z||void 0===z?void 0:z[l],touched:!(null===z||void 0===z||!z[l])},onChange:function(e){T(!1),W((function(n){return S(S({},n),{},(0,t.Z)({},l,e.target.value))}))},primary:!0,required:o,setContentOnMount:!0,type:u,value:(null===F||void 0===F?void 0:F[l])||""})},l)}))]}),(0,x.jsx)(m.Z,{mt:5,children:(0,x.jsxs)(d.Z,{children:[(0,x.jsx)(a.Z,{disabled:M||z&&!(0,j.Qr)(z),loading:J,onClick:function(){var e,n=S({},F);"roles_new"in n&&(n.roles_new=null===(e=F.roles_new)||void 0===e?void 0:e.map((function(e){return e.id})));K({user:n})},primary:!0,children:P?"Create new user":"Update user profile"}),N&&B&&(0,x.jsx)(m.Z,{ml:1,children:(0,x.jsx)(a.Z,{danger:!0,loading:ee,onClick:function(){window.confirm("Are you sure you want to delete ".concat(F.username||F.email,"?"))&&$()},children:"Delete user"})})]})})]})]})}},84392:function(e,n,r){"use strict";r.d(n,{HF:function(){return l},L6:function(){return t}});var t,i=r(81132),o=r(10503),u=r(9736);function l(e,n){var r=e.owner,l=e.roles,s=[{Icon:o.Vz,id:t.WORKSPACES,isSelected:function(){return t.WORKSPACES===n},label:function(){return"Workspaces"},linkProps:{href:"/manage"}}];return(r||l===i.No.ADMIN)&&s.push({Icon:o.NO,id:t.USERS,isSelected:function(){return t.USERS===n},label:function(){return"Users"},linkProps:{href:"/manage/users"}}),(!(0,u.YB)()||l<=i.No.EDITOR)&&s.push({Icon:o.Zr,id:t.SETTINGS,isSelected:function(){return t.SETTINGS===n},label:function(){return"Settings"},linkProps:{href:"/manage/settings"}}),s}!function(e){e.WORKSPACES="workspaces",e.USERS="users",e.SETTINGS="settings"}(t||(t={}))},3849:function(e,n,r){"use strict";r(82684);var t=r(1210),i=r(49125),o=r(84392),u=r(9736),l=r(28598);n.Z=function(e){var n=e.before,r=e.breadcrumbs,s=void 0===r?[]:r,a=e.children,c=e.pageName,d=e.subheaderChildren,f=(0,u.PR)()||{};return(0,l.jsx)(t.Z,{before:n,beforeWidth:n?50*i.iI:0,breadcrumbs:s,navigationItems:(0,o.HF)(f,c),subheaderChildren:d,title:"Workspaces",uuid:"workspaces/index",children:a})}},79891:function(e,n,r){"use strict";var t=r(9518),i=r(60328),o=r(67971),u=r(86673),l=r(19711),s=r(23831),a=r(10503),c=r(49125),d=r(31012),f=r(28598),p=t.default.div.withConfig({displayName:"Chip__ChipStyle",componentId:"sc-1ok73g-0"})(["display:inline-block;"," "," "," "," ",""],(function(e){return!e.primary&&"\n    background-color: ".concat((e.theme.background||s.Z.background).popup,";\n  ")}),(function(e){return e.primary&&"\n    background-color: ".concat((e.theme.chart||s.Z.chart).primary,";\n  ")}),(function(e){return!e.small&&"\n    border-radius: ".concat((c.iI+d.Al)/2,"px;\n    height: ").concat(1.5*c.iI+d.Al,"px;\n    padding: ").concat(c.iI/1.5,"px ").concat(1.25*c.iI,"px;\n  ")}),(function(e){return e.small&&"\n    border-radius: ".concat((c.iI/2+d.Al)/2,"px;\n    height: ").concat(d.Al+c.iI/2+2,"px;\n    padding: ").concat(c.iI/4,"px ").concat(c.iI,"px;\n  ")}),(function(e){return e.border&&"\n    border: 1px solid ".concat((e.theme.content||s.Z.content).muted,";\n  ")}));n.Z=function(e){var n=e.border,r=e.children,t=e.disabled,s=e.label,d=e.onClick,m=e.primary,v=e.small;return(0,f.jsx)(p,{border:n,primary:m,small:v,children:(0,f.jsx)(i.Z,{basic:!0,disabled:t,noBackground:!0,noPadding:!0,onClick:d,transparent:!0,children:(0,f.jsxs)(o.Z,{alignItems:"center",children:[r,s&&(0,f.jsx)(l.ZP,{small:v,children:s}),!t&&(0,f.jsx)(u.Z,{ml:1,children:(0,f.jsx)(a.x8,{default:m,muted:!m,size:v?c.iI:1.25*c.iI})})]})})})}},87372:function(e,n,r){"use strict";var t,i,o,u,l,s,a,c,d=r(82394),f=r(26304),p=r(26653),m=r(9518),v=r(33591),h=r(23831),b=r(2005),w=r(31012),g=r(19711),y=r(49125),j=r(86673),O=r(28598),x=["children","condensed","inline","level","marketing","spacingBelow"];function Z(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function S(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(r),!0).forEach((function(n){(0,d.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var _=(0,m.css)([""," margin:0;"," "," "," "," "," "," "," "," "," "," "," "," ",""],g.IH,(function(e){return e.color&&"\n    color: ".concat(e.color,"\n  ")}),(function(e){return e.yellow&&"\n    color: ".concat((e.theme.accent||h.Z.accent).yellow,";\n  ")}),(function(e){return e.center&&"\n    text-align: center;\n  "}),(function(e){return!e.monospace&&0===Number(e.weightStyle)&&"\n    font-family: ".concat(b.iI,";\n  ")}),(function(e){return!e.monospace&&1===Number(e.weightStyle)&&"\n    font-family: ".concat(b.LX,";\n  ")}),(function(e){return!e.monospace&&2===Number(e.weightStyle)&&"\n    font-family: ".concat(b.LX,";\n  ")}),(function(e){return!e.monospace&&3===Number(e.weightStyle)&&"\n    font-family: ".concat(b.ry,";\n  ")}),(function(e){return!e.monospace&&4===Number(e.weightStyle)&&"\n    font-family: ".concat(b.YC,";\n  ")}),(function(e){return!e.monospace&&5===Number(e.weightStyle)&&"\n    font-family: ".concat(b.nF,";\n  ")}),(function(e){return!e.monospace&&(6===Number(e.weightStyle)||e.bold)&&"\n    font-family: ".concat(b.nF,";\n  ")}),(function(e){return!e.monospace&&7===Number(e.weightStyle)&&"\n    font-family: ".concat(b.nF,";\n  ")}),(function(e){return!e.monospace&&8===Number(e.weightStyle)&&"\n    font-family: ".concat(b.nF,";\n  ")}),(function(e){return e.lineHeightAuto&&"\n    line-height: normal !important;\n  "})),I=m.default.div.withConfig({displayName:"Headline__HeadlineContainerStyle",componentId:"sc-12jzt2e-0"})(["",""],(function(e){return"\n    color: ".concat((e.theme.content||h.Z.content).active,";\n  ")})),P=m.default.h1.withConfig({displayName:"Headline__H1HeroStyle",componentId:"sc-12jzt2e-1"})([""," font-size:42px;line-height:56px;"," "," ",""],_,v.media.md(t||(t=(0,p.Z)(["\n    ","\n  "])),w.aQ),v.media.lg(i||(i=(0,p.Z)(["\n    ","\n  "])),w.aQ),v.media.xl(o||(o=(0,p.Z)(["\n    ","\n  "])),w.aQ)),C=m.default.h1.withConfig({displayName:"Headline__H1Style",componentId:"sc-12jzt2e-2"})([""," ",""],_,w.MJ),k=m.default.h1.withConfig({displayName:"Headline__H1MarketingStyle",componentId:"sc-12jzt2e-3"})([""," "," "," "," "," ",""],_,v.media.xs(u||(u=(0,p.Z)(["\n    font-size: ","px;\n    line-height: ","px;\n  "])),6*y.iI,7*y.iI),v.media.sm(l||(l=(0,p.Z)(["\n    font-size: ","px;\n    line-height: ","px;\n  "])),6*y.iI,7*y.iI),v.media.md(s||(s=(0,p.Z)(["\n    font-size: ","px;\n    line-height: ","px;\n  "])),6*y.iI,7*y.iI),v.media.lg(a||(a=(0,p.Z)(["\n    font-size: ","px;\n    line-height: ","px;\n  "])),6*y.iI,7*y.iI),v.media.xl(c||(c=(0,p.Z)(["\n    font-size: ","px;\n    line-height: ","px;\n  "])),6*y.iI,7*y.iI)),N=m.default.h2.withConfig({displayName:"Headline__H2Style",componentId:"sc-12jzt2e-4"})([""," ",""],_,w.BL),E=m.default.h3.withConfig({displayName:"Headline__H3Style",componentId:"sc-12jzt2e-5"})([""," font-size:24px;line-height:32px;"],_),D=m.default.h4.withConfig({displayName:"Headline__H4Style",componentId:"sc-12jzt2e-6"})([""," font-size:20px;line-height:28px;"],_),H=m.default.h5.withConfig({displayName:"Headline__H5Style",componentId:"sc-12jzt2e-7"})([""," font-size:18px;line-height:26px;"],_),M=m.default.span.withConfig({displayName:"Headline__SpanStyle",componentId:"sc-12jzt2e-8"})([""," "," "," "," ",""],_,(function(e){return 1===e.level&&"\n    ".concat(w.MJ,"\n  ")}),(function(e){return 2===e.level&&"\n    ".concat(w.BL,"\n  ")}),(function(e){return 3===e.level&&"\n    font-size: 24px;\n    line-height: 32px;\n  "}),(function(e){return 4===e.level&&"\n    font-size: 20px;\n    line-height: 28px;\n  "})),T=function(e){var n,r=e.children,t=e.condensed,i=e.inline,o=e.level,u=e.marketing,l=e.spacingBelow,s=(0,f.Z)(e,x);i?n=M:0===Number(o)?n=P:1===Number(o)?n=u?k:C:2===Number(o)?n=N:3===Number(o)?n=E:4===Number(o)?n=D:5===Number(o)&&(n=H);var a=(0,O.jsxs)(n,S(S({},s),{},{level:o,children:[l&&(0,O.jsx)(j.Z,{mb:t?2:3,children:r}),!l&&r]}));return i?a:(0,O.jsx)(I,{children:a})};T.defaultProps={level:3,weightStyle:6},n.Z=T},82702:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return E}});var t=r(77837),i=r(38860),o=r.n(i),u=r(82684),l=r(34376),s=r(41788),a=r(86673),c=r(20582),d=r(75582),f=r(21831),p=r(82394),m=r(21764),v=r(83455),h=r(60328),b=r(55378),w=r(58180),g=r(19711),y=r(82531),j=r(24224),O=r(96510),x=r(28598);function Z(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function S(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(r),!0).forEach((function(n){(0,p.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var _=function(e){var n=e.fetchUser,r=e.user,t=e.workspaces,i=(0,u.useState)(),o=i[0],l=i[1];(0,u.useEffect)((function(){r&&l(r)}),[r]);var s=null===t||void 0===t?void 0:t.map((function(e){return e.repo_path})),c=y.ZP.roles.list({entity:"project",entity_ids:s},{},{}),Z=c.data,_=(c.mutate,(0,u.useMemo)((function(){var e=(null===Z||void 0===Z?void 0:Z.roles)||[];return null===e||void 0===e?void 0:e.reduce((function(e,n){var r=n.permissions[0].entity_id,t=e[r]||[];return S(S({},e),{},(0,p.Z)({},r,[].concat((0,f.Z)(t),[n])))}),{})}),[Z])),I=(0,u.useMemo)((function(){var e=o||r,n=null===e||void 0===e?void 0:e.roles_new;return null===n||void 0===n?void 0:n.reduce((function(e,n){var r,t,i=null===n||void 0===n||null===(r=n.permissions)||void 0===r||null===(t=r[0])||void 0===t?void 0:t.entity_id;return S(S({},e),{},(0,p.Z)({},i,n))}),{})}),[o,r]),P=(0,v.Db)(y.ZP.users.useUpdate(null===r||void 0===r?void 0:r.id),{onSuccess:function(e){return(0,O.wD)(e,{callback:function(e){var r=e.user;m.Am.success("User roles successfully updated.",{position:m.Am.POSITION.BOTTOM_RIGHT,toastId:"user-update-success-".concat(r.id)}),n()},onErrorCallback:function(e){var n=e.error,r=n.errors,t=n.exception,i=n.message,o=n.type;m.Am.error((null===r||void 0===r?void 0:r.error)||t||i,{position:m.Am.POSITION.BOTTOM_RIGHT,toastId:o})}})}}),C=(0,d.Z)(P,2),k=C[0],N=C[1].isLoading;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(w.Z,{columnFlex:[1,1],columns:[{uuid:"Workspace"},{uuid:"Role"}],rows:null===t||void 0===t?void 0:t.map((function(e){var n=e.name,r=e.repo_path,t=(null===_||void 0===_?void 0:_[r])||[],i=null===I||void 0===I?void 0:I[r];return[(0,x.jsx)(g.ZP,{bold:!0,children:n},"name"),(0,x.jsx)(b.Z,{onChange:function(e){var n=(0,j.sE)(t,(function(n){return n.id==e.target.value}));n&&l((function(e){var r,t=(null===e||void 0===e||null===(r=e.roles_new)||void 0===r?void 0:r.filter((function(e){return e.id!=(null===n||void 0===n?void 0:n.id)})))||[];console.log("prev roles:",t);var i={roles_new:[].concat((0,f.Z)(t),[n])};return S(S({},e),i)}))},placeholder:"No access",primary:!0,setContentOnMount:!0,value:null===i||void 0===i?void 0:i.id,children:t.map((function(e){var n=e.id,r=e.name;return(0,x.jsx)("option",{value:n,children:r},r)}))},"project_role")]}))}),(0,x.jsx)(a.Z,{p:2,children:(0,x.jsx)(h.Z,{loading:N,onClick:function(){var e,n=S(S({},o),{},{roles_new:null===o||void 0===o||null===(e=o.roles_new)||void 0===e?void 0:e.map((function(e){return e.id}))});k({user:n})},primary:!0,children:"Update roles"})})]})},I=r(3849),P=r(49125),C=r(63153),k=r(84392);function N(e){var n=e.user,r=(0,l.useRouter)(),t=null===n||void 0===n?void 0:n.id,i=y.ZP.users.detail(t),o=i.data,s=i.mutate,d=(0,u.useMemo)((function(){return null===o||void 0===o?void 0:o.user}),[o]),f=y.ZP.workspaces.list({user_id:t},{refreshInterval:5e3,revalidateOnFocus:!0}),p=f.data,m=(f.mutate,(0,u.useMemo)((function(){return null===p||void 0===p?void 0:p.workspaces}),[p]));return(0,x.jsx)(I.Z,{before:(0,x.jsx)(a.Z,{p:P.cd,children:(0,x.jsx)(c.Z,{entity:"global",entityID:null,hideFields:[C.s7],onDeleteSuccess:function(){return r.push("/manage/users")},onSaveSuccess:s,showDelete:!0,title:"Edit user",user:d})}),breadcrumbs:[{label:function(){return"Workspaces"},linkProps:{as:"/manage",href:"/manage"}},{label:function(){return"Users"},linkProps:{as:"/manage/users",href:"/manage/users"}},{bold:!0,label:function(){return(null===d||void 0===d?void 0:d.username)||"User"}}],pageName:k.L6.USERS,children:(0,x.jsx)(_,{fetchUser:s,user:d,workspaces:m})})}N.getInitialProps=function(){var e=(0,t.Z)(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.query.user,e.abrupt("return",{user:{id:r}});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var E=(0,s.Z)(N)},11976:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage/users/[user]",function(){return r(82702)}])}},function(e){e.O(0,[844,7607,1424,1005,8180,9774,2888,179],(function(){return n=11976,e(e.s=n);var n}));var n=e.O();_N_E=n}]);