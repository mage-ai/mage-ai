"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[52],{17463:function(e,t,i){i.d(t,{p:function(){return r}});var r={exports:{}}},45493:function(e,t,i){function r(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o}function n(e,t){return function(i,r){t(i,r,e)}}i.d(t,{f:function(){return n},g:function(){return r}})},51254:function(e,t,i){i.d(t,{Z:function(){return pe}});var r={exports:{}};function n(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}r.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:n,changeDefaults:function(e){r.exports.defaults=e}};const s=/[&<>"']/,o=/[&<>"']/g,a=/[<>"']|&(?!#?\w+;)/,c=/[<>"']|&(?!#?\w+;)/g,l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=e=>l[e];const u=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function h(e){return e.replace(u,((e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const p=/(^|[^\[])\^/g;const m=/[^\w:]/g,f=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;const g={},v=/^[^:]+:\/*[^/]*$/,_=/^([^:]+:)[\s\S]*$/,b=/^([^:]+:\/*[^/]*)[\s\S]*$/;function w(e,t){g[" "+e]||(v.test(e)?g[" "+e]=e+"/":g[" "+e]=y(e,"/",!0));const i=-1===(e=g[" "+e]).indexOf(":");return"//"===t.substring(0,2)?i?t:e.replace(_,"$1")+t:"/"===t.charAt(0)?i?t:e.replace(b,"$1")+t:e+t}function y(e,t,i){const r=e.length;if(0===r)return"";let n=0;for(;n<r;){const s=e.charAt(r-n-1);if(s!==t||i){if(s===t||!i)break;n++}else n++}return e.substr(0,r-n)}var x={escape:function(e,t){if(t){if(s.test(e))return e.replace(o,d)}else if(a.test(e))return e.replace(c,d);return e},unescape:h,edit:function(e,t){e=e.source||e,t=t||"";const i={replace:(t,r)=>(r=(r=r.source||r).replace(p,"$1"),e=e.replace(t,r),i),getRegex:()=>new RegExp(e,t)};return i},cleanUrl:function(e,t,i){if(e){let e;try{e=decodeURIComponent(h(i)).replace(m,"").toLowerCase()}catch(e){return null}if(0===e.indexOf("javascript:")||0===e.indexOf("vbscript:")||0===e.indexOf("data:"))return null}t&&!f.test(i)&&(i=w(t,i));try{i=encodeURI(i).replace(/%25/g,"%")}catch(e){return null}return i},resolveUrl:w,noopTest:{exec:function(){}},merge:function(e){let t,i,r=1;for(;r<arguments.length;r++)for(i in t=arguments[r],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},splitCells:function(e,t){const i=e.replace(/\|/g,((e,t,i)=>{let r=!1,n=t;for(;--n>=0&&"\\"===i[n];)r=!r;return r?"|":" |"})).split(/ \|/);let r=0;if(i[0].trim()||i.shift(),i[i.length-1].trim()||i.pop(),i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(/\\\|/g,"|");return i},rtrim:y,findClosingBracket:function(e,t){if(-1===e.indexOf(t[1]))return-1;const i=e.length;let r=0,n=0;for(;n<i;n++)if("\\"===e[n])n++;else if(e[n]===t[0])r++;else if(e[n]===t[1]&&(r--,r<0))return n;return-1},checkSanitizeDeprecation:function(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},repeatString:function(e,t){if(t<1)return"";let i="";for(;t>1;)1&t&&(i+=e),t>>=1,e+=e;return i+e}};const{defaults:C}=r.exports,{rtrim:S,splitCells:E,escape:D,findClosingBracket:k}=x;function I(e,t,i,r){const n=t.href,s=t.title?D(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){r.state.inLink=!0;const e={type:"link",raw:i,href:n,title:s,text:o,tokens:r.inlineTokens(o,[])};return r.state.inLink=!1,e}return{type:"image",raw:i,href:n,title:s,text:D(o)}}var P=class{constructor(e){this.options=e||C}space(e){const t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:"\n"}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:S(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],i=function(e,t){const i=e.match(/^(\s+)(?:```)/);if(null===i)return t;const r=i[1];return t.split("\n").map((e=>{const t=e.match(/^\s+/);if(null===t)return e;const[i]=t;return i.length>=r.length?e.slice(r.length):e})).join("\n")}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim():t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){const t=S(e,"#");this.options.pedantic?e=t.trim():t&&!/ $/.test(t)||(e=t.trim())}const i={type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const e=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(e,[]),text:e}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i,r,n,s,o,a,c,l,d,u,h=t[1].trim();const p=h.length>1,m={type:"list",raw:"",ordered:p,start:p?+h.slice(0,-1):"",loose:!1,items:[]};h=p?`\\d{1,9}\\${h.slice(-1)}`:`\\${h}`,this.options.pedantic&&(h=p?h:"[*+-]");const f=new RegExp(`^( {0,3}${h})((?: [^\\n]*| *)(?:\\n[^\\n]*)*(?:\\n|$))`);for(;e&&!this.rules.block.hr.test(e)&&(t=f.exec(e));){d=t[2].split("\n"),this.options.pedantic?(s=2,u=d[0].trimLeft()):(s=t[2].search(/[^ ]/),s=t[1].length+(s>4?1:s),u=d[0].slice(s-t[1].length)),a=!1,i=t[0],!d[0]&&/^ *$/.test(d[1])&&(i=t[1]+d.slice(0,2).join("\n")+"\n",m.loose=!0,d=[]);const h=new RegExp(`^ {0,${Math.min(3,s-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(o=1;o<d.length;o++){if(l=d[o],this.options.pedantic&&(l=l.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),h.test(l)){i=t[1]+d.slice(0,o).join("\n")+"\n";break}if(a){if(!(l.search(/[^ ]/)>=s)&&l.trim()){i=t[1]+d.slice(0,o).join("\n")+"\n";break}u+="\n"+l.slice(s)}else l.trim()||(a=!0),l.search(/[^ ]/)>=s?u+="\n"+l.slice(s):u+="\n"+l}m.loose||(c?m.loose=!0:/\n *\n *$/.test(i)&&(c=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(u),r&&(n="[ ] "!==r[0],u=u.replace(/^\[[ xX]\] +/,""))),m.items.push({type:"list_item",raw:i,task:!!r,checked:n,loose:!1,text:u}),m.raw+=i,e=e.slice(i.length)}m.items[m.items.length-1].raw=i.trimRight(),m.items[m.items.length-1].text=u.trimRight(),m.raw=m.raw.trimRight();const g=m.items.length;for(o=0;o<g;o++)this.lexer.state.top=!1,m.items[o].tokens=this.lexer.blockTokens(m.items[o].text,[]),m.items[o].tokens.some((e=>"space"===e.type))&&(m.loose=!0,m.items[o].loose=!0);return m}}html(e){const t=this.rules.block.html.exec(e);if(t){const e={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};return this.options.sanitize&&(e.type="paragraph",e.text=this.options.sanitizer?this.options.sanitizer(t[0]):D(t[0]),e.tokens=[],this.lexer.inline(e.text,e.tokens)),e}}def(e){const t=this.rules.block.def.exec(e);if(t){t[3]&&(t[3]=t[3].substring(1,t[3].length-1));return{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}}table(e){const t=this.rules.block.table.exec(e);if(t){const e={type:"table",header:E(t[1]).map((e=>({text:e}))),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]?t[3].replace(/\n$/,"").split("\n"):[]};if(e.header.length===e.align.length){e.raw=t[0];let i,r,n,s,o=e.align.length;for(i=0;i<o;i++)/^ *-+: *$/.test(e.align[i])?e.align[i]="right":/^ *:-+: *$/.test(e.align[i])?e.align[i]="center":/^ *:-+ *$/.test(e.align[i])?e.align[i]="left":e.align[i]=null;for(o=e.rows.length,i=0;i<o;i++)e.rows[i]=E(e.rows[i],e.header.length).map((e=>({text:e})));for(o=e.header.length,r=0;r<o;r++)e.header[r].tokens=[],this.lexer.inlineTokens(e.header[r].text,e.header[r].tokens);for(o=e.rows.length,r=0;r<o;r++)for(s=e.rows[r],n=0;n<s.length;n++)s[n].tokens=[],this.lexer.inlineTokens(s[n].text,s[n].tokens);return e}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const e={type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e={type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}text(e){const t=this.rules.block.text.exec(e);if(t){const e={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:D(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):D(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;const t=S(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=k(t[2],"()");if(e>-1){const i=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let i=t[2],r="";if(this.options.pedantic){const e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);e&&(i=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(i=this.options.pedantic&&!/>$/.test(e)?i.slice(1):i.slice(1,-1)),I(t,{href:i?i.replace(this.rules.inline._escapes,"$1"):i,title:r?r.replace(this.rules.inline._escapes,"$1"):r},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let e=(i[2]||i[1]).replace(/\s+/g," ");if(e=t[e.toLowerCase()],!e||!e.href){const e=i[0].charAt(0);return{type:"text",raw:e,text:e}}return I(i,e,i[0],this.lexer)}}emStrong(e,t,i=""){let r=this.rules.inline.emStrong.lDelim.exec(e);if(!r)return;if(r[3]&&i.match(/[\p{L}\p{N}]/u))return;const n=r[1]||r[2]||"";if(!n||n&&(""===i||this.rules.inline.punctuation.exec(i))){const i=r[0].length-1;let n,s,o=i,a=0;const c="*"===r[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+i);null!=(r=c.exec(t));){if(n=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!n)continue;if(s=n.length,r[3]||r[4]){o+=s;continue}if((r[5]||r[6])&&i%3&&!((i+s)%3)){a+=s;continue}if(o-=s,o>0)continue;if(s=Math.min(s,s+o+a),Math.min(i,s)%2){const t=e.slice(1,i+r.index+s);return{type:"em",raw:e.slice(0,i+r.index+s+1),text:t,tokens:this.lexer.inlineTokens(t,[])}}const t=e.slice(2,i+r.index+s-1);return{type:"strong",raw:e.slice(0,i+r.index+s+1),text:t,tokens:this.lexer.inlineTokens(t,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," ");const i=/[^ ]/.test(e),r=/^ /.test(e)&&/ $/.test(e);return i&&r&&(e=e.substring(1,e.length-1)),e=D(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const i=this.rules.inline.autolink.exec(e);if(i){let e,r;return"@"===i[2]?(e=D(this.options.mangle?t(i[1]):i[1]),r="mailto:"+e):(e=D(i[1]),r=e),{type:"link",raw:i[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}url(e,t){let i;if(i=this.rules.inline.url.exec(e)){let e,r;if("@"===i[2])e=D(this.options.mangle?t(i[0]):i[0]),r="mailto:"+e;else{let t;do{t=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0]}while(t!==i[0]);e=D(i[0]),r="www."===i[1]?"http://"+e:e}return{type:"link",raw:i[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e,t){const i=this.rules.inline.text.exec(e);if(i){let e;return e=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):D(i[0]):i[0]:D(this.options.smartypants?t(i[0]):i[0]),{type:"text",raw:i[0],text:e}}}};const{noopTest:T,edit:A,merge:R}=x,$={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:T,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};$.def=A($.def).replace("label",$._label).replace("title",$._title).getRegex(),$.bullet=/(?:[*+-]|\d{1,9}[.)])/,$.listItemStart=A(/^( *)(bull) */).replace("bull",$.bullet).getRegex(),$.list=A($.list).replace(/bull/g,$.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+$.def.source+")").getRegex(),$._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",$._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,$.html=A($.html,"i").replace("comment",$._comment).replace("tag",$._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),$.paragraph=A($._paragraph).replace("hr",$.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",$._tag).getRegex(),$.blockquote=A($.blockquote).replace("paragraph",$.paragraph).getRegex(),$.normal=R({},$),$.gfm=R({},$.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)\\|?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),$.gfm.table=A($.gfm.table).replace("hr",$.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",$._tag).getRegex(),$.pedantic=R({},$.normal,{html:A("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",$._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:T,paragraph:A($.normal._paragraph).replace("hr",$.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",$.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const L={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:T,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:T,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};L.punctuation=A(L.punctuation).replace(/punctuation/g,L._punctuation).getRegex(),L.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,L.escapedEmSt=/\\\*|\\_/g,L._comment=A($._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),L.emStrong.lDelim=A(L.emStrong.lDelim).replace(/punct/g,L._punctuation).getRegex(),L.emStrong.rDelimAst=A(L.emStrong.rDelimAst,"g").replace(/punct/g,L._punctuation).getRegex(),L.emStrong.rDelimUnd=A(L.emStrong.rDelimUnd,"g").replace(/punct/g,L._punctuation).getRegex(),L._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,L._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,L._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,L.autolink=A(L.autolink).replace("scheme",L._scheme).replace("email",L._email).getRegex(),L._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,L.tag=A(L.tag).replace("comment",L._comment).replace("attribute",L._attribute).getRegex(),L._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,L._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,L._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,L.link=A(L.link).replace("label",L._label).replace("href",L._href).replace("title",L._title).getRegex(),L.reflink=A(L.reflink).replace("label",L._label).getRegex(),L.reflinkSearch=A(L.reflinkSearch,"g").replace("reflink",L.reflink).replace("nolink",L.nolink).getRegex(),L.normal=R({},L),L.pedantic=R({},L.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:A(/^!?\[(label)\]\((.*?)\)/).replace("label",L._label).getRegex(),reflink:A(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",L._label).getRegex()}),L.gfm=R({},L.normal,{escape:A(L.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),L.gfm.url=A(L.gfm.url,"i").replace("email",L.gfm._extended_email).getRegex(),L.breaks=R({},L.gfm,{br:A(L.br).replace("{2,}","*").getRegex(),text:A(L.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var N={block:$,inline:L};const z=P,{defaults:F}=r.exports,{block:M,inline:O}=N,{repeatString:H}=x;function U(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function B(e){let t,i,r="";const n=e.length;for(t=0;t<n;t++)i=e.charCodeAt(t),Math.random()>.5&&(i="x"+i.toString(16)),r+="&#"+i+";";return r}const{defaults:W}=r.exports,{cleanUrl:V,escape:q}=x;var j=class{constructor(e){this.options=e||W}code(e,t,i){const r=(t||"").match(/\S*/)[0];if(this.options.highlight){const t=this.options.highlight(e,r);null!=t&&t!==e&&(i=!0,e=t)}return e=e.replace(/\n$/,"")+"\n",r?'<pre><code class="'+this.options.langPrefix+q(r,!0)+'">'+(i?e:q(e,!0))+"</code></pre>\n":"<pre><code>"+(i?e:q(e,!0))+"</code></pre>\n"}blockquote(e){return"<blockquote>\n"+e+"</blockquote>\n"}html(e){return e}heading(e,t,i,r){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+r.slug(i)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t,i){const r=t?"ol":"ul";return"<"+r+(t&&1!==i?' start="'+i+'"':"")+">\n"+e+"</"+r+">\n"}listitem(e){return"<li>"+e+"</li>\n"}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+"</p>\n"}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return"<tr>\n"+e+"</tr>\n"}tablecell(e,t){const i=t.header?"th":"td";return(t.align?"<"+i+' align="'+t.align+'">':"<"+i+">")+e+"</"+i+">\n"}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,i){if(null===(e=V(this.options.sanitize,this.options.baseUrl,e)))return i;let r='<a href="'+q(e)+'"';return t&&(r+=' title="'+t+'"'),r+=">"+i+"</a>",r}image(e,t,i){if(null===(e=V(this.options.sanitize,this.options.baseUrl,e)))return i;let r='<img src="'+e+'" alt="'+i+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">",r}text(e){return e}},K=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}},Q=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let i=e,r=0;if(this.seen.hasOwnProperty(i)){r=this.seen[e];do{r++,i=e+"-"+r}while(this.seen.hasOwnProperty(i))}return t||(this.seen[e]=r,this.seen[i]=0),i}slug(e,t={}){const i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun)}};const G=j,J=K,Y=Q,{defaults:X}=r.exports,{unescape:Z}=x;const ee=class e{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||F,this.options.tokenizer=this.options.tokenizer||new z,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:M.normal,inline:O.normal};this.options.pedantic?(t.block=M.pedantic,t.inline=O.pedantic):this.options.gfm&&(t.block=M.gfm,this.options.breaks?t.inline=O.breaks:t.inline=O.gfm),this.tokenizer.rules=t}static get rules(){return{block:M,inline:O}}static lex(t,i){return new e(i).lex(t)}static lexInline(t,i){return new e(i).inlineTokens(t)}lex(e){let t;for(e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){let i,r,n,s;for(this.options.pedantic&&(e=e.replace(/^ +$/gm,""));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((r=>!!(i=r.call({lexer:this},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)))))if(i=this.tokenizer.space(e))e=e.substring(i.raw.length),i.type&&t.push(i);else if(i=this.tokenizer.code(e))e=e.substring(i.raw.length),r=t[t.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?t.push(i):(r.raw+="\n"+i.raw,r.text+="\n"+i.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text);else if(i=this.tokenizer.fences(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.heading(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.hr(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.blockquote(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.list(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.html(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.def(e))e=e.substring(i.raw.length),r=t[t.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title}):(r.raw+="\n"+i.raw,r.text+="\n"+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text);else if(i=this.tokenizer.table(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.lheading(e))e=e.substring(i.raw.length),t.push(i);else{if(n=e,this.options.extensions&&this.options.extensions.startBlock){let t=1/0;const i=e.slice(1);let r;this.options.extensions.startBlock.forEach((function(e){r=e.call({lexer:this},i),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(n=e.substring(0,t+1))}if(this.state.top&&(i=this.tokenizer.paragraph(n)))r=t[t.length-1],s&&"paragraph"===r.type?(r.raw+="\n"+i.raw,r.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(i),s=n.length!==e.length,e=e.substring(i.raw.length);else if(i=this.tokenizer.text(e))e=e.substring(i.raw.length),r=t[t.length-1],r&&"text"===r.type?(r.raw+="\n"+i.raw,r.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(i);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t){this.inlineQueue.push({src:e,tokens:t})}inlineTokens(e,t=[]){let i,r,n,s,o,a,c=e;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(s=this.tokenizer.rules.inline.reflinkSearch.exec(c));)e.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,s.index)+"["+H("a",s[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(s=this.tokenizer.rules.inline.blockSkip.exec(c));)c=c.slice(0,s.index)+"["+H("a",s[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(s=this.tokenizer.rules.inline.escapedEmSt.exec(c));)c=c.slice(0,s.index)+"++"+c.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(o||(a=""),o=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((r=>!!(i=r.call({lexer:this},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)))))if(i=this.tokenizer.escape(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.tag(e))e=e.substring(i.raw.length),r=t[t.length-1],r&&"text"===i.type&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):t.push(i);else if(i=this.tokenizer.link(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(i.raw.length),r=t[t.length-1],r&&"text"===i.type&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):t.push(i);else if(i=this.tokenizer.emStrong(e,c,a))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.codespan(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.br(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.del(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.autolink(e,B))e=e.substring(i.raw.length),t.push(i);else if(this.state.inLink||!(i=this.tokenizer.url(e,B))){if(n=e,this.options.extensions&&this.options.extensions.startInline){let t=1/0;const i=e.slice(1);let r;this.options.extensions.startInline.forEach((function(e){r=e.call({lexer:this},i),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(n=e.substring(0,t+1))}if(i=this.tokenizer.inlineText(n,U))e=e.substring(i.raw.length),"_"!==i.raw.slice(-1)&&(a=i.raw.slice(-1)),o=!0,r=t[t.length-1],r&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):t.push(i);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}else e=e.substring(i.raw.length),t.push(i);return t}},te=class e{constructor(e){this.options=e||X,this.options.renderer=this.options.renderer||new G,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new J,this.slugger=new Y}static parse(t,i){return new e(i).parse(t)}static parseInline(t,i){return new e(i).parseInline(t)}parse(e,t=!0){let i,r,n,s,o,a,c,l,d,u,h,p,m,f,g,v,_,b,w,y="";const x=e.length;for(i=0;i<x;i++)if(u=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[u.type]&&(w=this.options.extensions.renderers[u.type].call({parser:this},u),!1!==w||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(u.type)))y+=w||"";else switch(u.type){case"space":continue;case"hr":y+=this.renderer.hr();continue;case"heading":y+=this.renderer.heading(this.parseInline(u.tokens),u.depth,Z(this.parseInline(u.tokens,this.textRenderer)),this.slugger);continue;case"code":y+=this.renderer.code(u.text,u.lang,u.escaped);continue;case"table":for(l="",c="",s=u.header.length,r=0;r<s;r++)c+=this.renderer.tablecell(this.parseInline(u.header[r].tokens),{header:!0,align:u.align[r]});for(l+=this.renderer.tablerow(c),d="",s=u.rows.length,r=0;r<s;r++){for(a=u.rows[r],c="",o=a.length,n=0;n<o;n++)c+=this.renderer.tablecell(this.parseInline(a[n].tokens),{header:!1,align:u.align[n]});d+=this.renderer.tablerow(c)}y+=this.renderer.table(l,d);continue;case"blockquote":d=this.parse(u.tokens),y+=this.renderer.blockquote(d);continue;case"list":for(h=u.ordered,p=u.start,m=u.loose,s=u.items.length,d="",r=0;r<s;r++)g=u.items[r],v=g.checked,_=g.task,f="",g.task&&(b=this.renderer.checkbox(v),m?g.tokens.length>0&&"paragraph"===g.tokens[0].type?(g.tokens[0].text=b+" "+g.tokens[0].text,g.tokens[0].tokens&&g.tokens[0].tokens.length>0&&"text"===g.tokens[0].tokens[0].type&&(g.tokens[0].tokens[0].text=b+" "+g.tokens[0].tokens[0].text)):g.tokens.unshift({type:"text",text:b}):f+=b),f+=this.parse(g.tokens,m),d+=this.renderer.listitem(f,_,v);y+=this.renderer.list(d,h,p);continue;case"html":y+=this.renderer.html(u.text);continue;case"paragraph":y+=this.renderer.paragraph(this.parseInline(u.tokens));continue;case"text":for(d=u.tokens?this.parseInline(u.tokens):u.text;i+1<x&&"text"===e[i+1].type;)u=e[++i],d+="\n"+(u.tokens?this.parseInline(u.tokens):u.text);y+=t?this.renderer.paragraph(d):d;continue;default:{const e='Token with "'+u.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return y}parseInline(e,t){t=t||this.renderer;let i,r,n,s="";const o=e.length;for(i=0;i<o;i++)if(r=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]&&(n=this.options.extensions.renderers[r.type].call({parser:this},r),!1!==n||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)))s+=n||"";else switch(r.type){case"escape":case"text":s+=t.text(r.text);break;case"html":s+=t.html(r.text);break;case"link":s+=t.link(r.href,r.title,this.parseInline(r.tokens,t));break;case"image":s+=t.image(r.href,r.title,r.text);break;case"strong":s+=t.strong(this.parseInline(r.tokens,t));break;case"em":s+=t.em(this.parseInline(r.tokens,t));break;case"codespan":s+=t.codespan(r.text);break;case"br":s+=t.br();break;case"del":s+=t.del(this.parseInline(r.tokens,t));break;default:{const e='Token with "'+r.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return s}},ie=P,re=j,ne=K,se=Q,{merge:oe,checkSanitizeDeprecation:ae,escape:ce}=x,{getDefaults:le,changeDefaults:de,defaults:ue}=r.exports;function he(e,t,i){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(i=t,t=null),t=oe({},he.defaults,t||{}),ae(t),i){const r=t.highlight;let n;try{n=ee.lex(e,t)}catch(e){return i(e)}const s=function(e){let s;if(!e)try{t.walkTokens&&he.walkTokens(n,t.walkTokens),s=te.parse(n,t)}catch(t){e=t}return t.highlight=r,e?i(e):i(null,s)};if(!r||r.length<3)return s();if(delete t.highlight,!n.length)return s();let o=0;return he.walkTokens(n,(function(e){"code"===e.type&&(o++,setTimeout((()=>{r(e.text,e.lang,(function(t,i){if(t)return s(t);null!=i&&i!==e.text&&(e.text=i,e.escaped=!0),o--,0===o&&s()}))}),0))})),void(0===o&&s())}try{const i=ee.lex(e,t);return t.walkTokens&&he.walkTokens(i,t.walkTokens),te.parse(i,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+ce(e.message+"",!0)+"</pre>";throw e}}he.options=he.setOptions=function(e){return oe(he.defaults,e),de(he.defaults),he},he.getDefaults=le,he.defaults=ue,he.use=function(...e){const t=oe({},...e),i=he.defaults.extensions||{renderers:{},childTokens:{}};let r;e.forEach((e=>{if(e.extensions&&(r=!0,e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if(e.renderer){const t=i.renderers?i.renderers[e.name]:null;i.renderers[e.name]=t?function(...i){let r=e.renderer.apply(this,i);return!1===r&&(r=t.apply(this,i)),r}:e.renderer}if(e.tokenizer){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");i[e.level]?i[e.level].unshift(e.tokenizer):i[e.level]=[e.tokenizer],e.start&&("block"===e.level?i.startBlock?i.startBlock.push(e.start):i.startBlock=[e.start]:"inline"===e.level&&(i.startInline?i.startInline.push(e.start):i.startInline=[e.start]))}e.childTokens&&(i.childTokens[e.name]=e.childTokens)}))),e.renderer){const i=he.defaults.renderer||new re;for(const t in e.renderer){const r=i[t];i[t]=(...n)=>{let s=e.renderer[t].apply(i,n);return!1===s&&(s=r.apply(i,n)),s}}t.renderer=i}if(e.tokenizer){const i=he.defaults.tokenizer||new ie;for(const t in e.tokenizer){const r=i[t];i[t]=(...n)=>{let s=e.tokenizer[t].apply(i,n);return!1===s&&(s=r.apply(i,n)),s}}t.tokenizer=i}if(e.walkTokens){const i=he.defaults.walkTokens;t.walkTokens=t=>{e.walkTokens.call(this,t),i&&i(t)}}r&&(t.extensions=i),he.setOptions(t)}))},he.walkTokens=function(e,t){for(const i of e)switch(t(i),i.type){case"table":for(const e of i.header)he.walkTokens(e.tokens,t);for(const e of i.rows)for(const i of e)he.walkTokens(i.tokens,t);break;case"list":he.walkTokens(i.items,t);break;default:he.defaults.extensions&&he.defaults.extensions.childTokens&&he.defaults.extensions.childTokens[i.type]?he.defaults.extensions.childTokens[i.type].forEach((function(e){he.walkTokens(i[e],t)})):i.tokens&&he.walkTokens(i.tokens,t)}},he.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");t=oe({},he.defaults,t||{}),ae(t);try{const i=ee.lexInline(e,t);return t.walkTokens&&he.walkTokens(i,t.walkTokens),te.parseInline(i,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+ce(e.message+"",!0)+"</pre>";throw e}},he.Parser=te,he.parser=te.parse,he.Renderer=re,he.TextRenderer=ne,he.Lexer=ee,he.lexer=ee.lex,he.Tokenizer=ie,he.Slugger=se,he.parse=he;var pe=he},5352:function(e,t,i){i.d(t,{T:function(){return n}});var r=i(59215);const n={add:(0,r.z)("add",6e4),plus:(0,r.z)("plus",6e4),gistNew:(0,r.z)("gist-new",6e4),repoCreate:(0,r.z)("repo-create",6e4),lightbulb:(0,r.z)("lightbulb",60001),lightBulb:(0,r.z)("light-bulb",60001),repo:(0,r.z)("repo",60002),repoDelete:(0,r.z)("repo-delete",60002),gistFork:(0,r.z)("gist-fork",60003),repoForked:(0,r.z)("repo-forked",60003),gitPullRequest:(0,r.z)("git-pull-request",60004),gitPullRequestAbandoned:(0,r.z)("git-pull-request-abandoned",60004),recordKeys:(0,r.z)("record-keys",60005),keyboard:(0,r.z)("keyboard",60005),tag:(0,r.z)("tag",60006),gitPullRequestLabel:(0,r.z)("git-pull-request-label",60006),tagAdd:(0,r.z)("tag-add",60006),tagRemove:(0,r.z)("tag-remove",60006),person:(0,r.z)("person",60007),personFollow:(0,r.z)("person-follow",60007),personOutline:(0,r.z)("person-outline",60007),personFilled:(0,r.z)("person-filled",60007),gitBranch:(0,r.z)("git-branch",60008),gitBranchCreate:(0,r.z)("git-branch-create",60008),gitBranchDelete:(0,r.z)("git-branch-delete",60008),sourceControl:(0,r.z)("source-control",60008),mirror:(0,r.z)("mirror",60009),mirrorPublic:(0,r.z)("mirror-public",60009),star:(0,r.z)("star",60010),starAdd:(0,r.z)("star-add",60010),starDelete:(0,r.z)("star-delete",60010),starEmpty:(0,r.z)("star-empty",60010),comment:(0,r.z)("comment",60011),commentAdd:(0,r.z)("comment-add",60011),alert:(0,r.z)("alert",60012),warning:(0,r.z)("warning",60012),search:(0,r.z)("search",60013),searchSave:(0,r.z)("search-save",60013),logOut:(0,r.z)("log-out",60014),signOut:(0,r.z)("sign-out",60014),logIn:(0,r.z)("log-in",60015),signIn:(0,r.z)("sign-in",60015),eye:(0,r.z)("eye",60016),eyeUnwatch:(0,r.z)("eye-unwatch",60016),eyeWatch:(0,r.z)("eye-watch",60016),circleFilled:(0,r.z)("circle-filled",60017),primitiveDot:(0,r.z)("primitive-dot",60017),closeDirty:(0,r.z)("close-dirty",60017),debugBreakpoint:(0,r.z)("debug-breakpoint",60017),debugBreakpointDisabled:(0,r.z)("debug-breakpoint-disabled",60017),debugHint:(0,r.z)("debug-hint",60017),terminalDecorationSuccess:(0,r.z)("terminal-decoration-success",60017),primitiveSquare:(0,r.z)("primitive-square",60018),edit:(0,r.z)("edit",60019),pencil:(0,r.z)("pencil",60019),info:(0,r.z)("info",60020),issueOpened:(0,r.z)("issue-opened",60020),gistPrivate:(0,r.z)("gist-private",60021),gitForkPrivate:(0,r.z)("git-fork-private",60021),lock:(0,r.z)("lock",60021),mirrorPrivate:(0,r.z)("mirror-private",60021),close:(0,r.z)("close",60022),removeClose:(0,r.z)("remove-close",60022),x:(0,r.z)("x",60022),repoSync:(0,r.z)("repo-sync",60023),sync:(0,r.z)("sync",60023),clone:(0,r.z)("clone",60024),desktopDownload:(0,r.z)("desktop-download",60024),beaker:(0,r.z)("beaker",60025),microscope:(0,r.z)("microscope",60025),vm:(0,r.z)("vm",60026),deviceDesktop:(0,r.z)("device-desktop",60026),file:(0,r.z)("file",60027),fileText:(0,r.z)("file-text",60027),more:(0,r.z)("more",60028),ellipsis:(0,r.z)("ellipsis",60028),kebabHorizontal:(0,r.z)("kebab-horizontal",60028),mailReply:(0,r.z)("mail-reply",60029),reply:(0,r.z)("reply",60029),organization:(0,r.z)("organization",60030),organizationFilled:(0,r.z)("organization-filled",60030),organizationOutline:(0,r.z)("organization-outline",60030),newFile:(0,r.z)("new-file",60031),fileAdd:(0,r.z)("file-add",60031),newFolder:(0,r.z)("new-folder",60032),fileDirectoryCreate:(0,r.z)("file-directory-create",60032),trash:(0,r.z)("trash",60033),trashcan:(0,r.z)("trashcan",60033),history:(0,r.z)("history",60034),clock:(0,r.z)("clock",60034),folder:(0,r.z)("folder",60035),fileDirectory:(0,r.z)("file-directory",60035),symbolFolder:(0,r.z)("symbol-folder",60035),logoGithub:(0,r.z)("logo-github",60036),markGithub:(0,r.z)("mark-github",60036),github:(0,r.z)("github",60036),terminal:(0,r.z)("terminal",60037),console:(0,r.z)("console",60037),repl:(0,r.z)("repl",60037),zap:(0,r.z)("zap",60038),symbolEvent:(0,r.z)("symbol-event",60038),error:(0,r.z)("error",60039),stop:(0,r.z)("stop",60039),variable:(0,r.z)("variable",60040),symbolVariable:(0,r.z)("symbol-variable",60040),array:(0,r.z)("array",60042),symbolArray:(0,r.z)("symbol-array",60042),symbolModule:(0,r.z)("symbol-module",60043),symbolPackage:(0,r.z)("symbol-package",60043),symbolNamespace:(0,r.z)("symbol-namespace",60043),symbolObject:(0,r.z)("symbol-object",60043),symbolMethod:(0,r.z)("symbol-method",60044),symbolFunction:(0,r.z)("symbol-function",60044),symbolConstructor:(0,r.z)("symbol-constructor",60044),symbolBoolean:(0,r.z)("symbol-boolean",60047),symbolNull:(0,r.z)("symbol-null",60047),symbolNumeric:(0,r.z)("symbol-numeric",60048),symbolNumber:(0,r.z)("symbol-number",60048),symbolStructure:(0,r.z)("symbol-structure",60049),symbolStruct:(0,r.z)("symbol-struct",60049),symbolParameter:(0,r.z)("symbol-parameter",60050),symbolTypeParameter:(0,r.z)("symbol-type-parameter",60050),symbolKey:(0,r.z)("symbol-key",60051),symbolText:(0,r.z)("symbol-text",60051),symbolReference:(0,r.z)("symbol-reference",60052),goToFile:(0,r.z)("go-to-file",60052),symbolEnum:(0,r.z)("symbol-enum",60053),symbolValue:(0,r.z)("symbol-value",60053),symbolRuler:(0,r.z)("symbol-ruler",60054),symbolUnit:(0,r.z)("symbol-unit",60054),activateBreakpoints:(0,r.z)("activate-breakpoints",60055),archive:(0,r.z)("archive",60056),arrowBoth:(0,r.z)("arrow-both",60057),arrowDown:(0,r.z)("arrow-down",60058),arrowLeft:(0,r.z)("arrow-left",60059),arrowRight:(0,r.z)("arrow-right",60060),arrowSmallDown:(0,r.z)("arrow-small-down",60061),arrowSmallLeft:(0,r.z)("arrow-small-left",60062),arrowSmallRight:(0,r.z)("arrow-small-right",60063),arrowSmallUp:(0,r.z)("arrow-small-up",60064),arrowUp:(0,r.z)("arrow-up",60065),bell:(0,r.z)("bell",60066),bold:(0,r.z)("bold",60067),book:(0,r.z)("book",60068),bookmark:(0,r.z)("bookmark",60069),debugBreakpointConditionalUnverified:(0,r.z)("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:(0,r.z)("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:(0,r.z)("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:(0,r.z)("debug-breakpoint-data-unverified",60072),debugBreakpointData:(0,r.z)("debug-breakpoint-data",60073),debugBreakpointDataDisabled:(0,r.z)("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:(0,r.z)("debug-breakpoint-log-unverified",60074),debugBreakpointLog:(0,r.z)("debug-breakpoint-log",60075),debugBreakpointLogDisabled:(0,r.z)("debug-breakpoint-log-disabled",60075),briefcase:(0,r.z)("briefcase",60076),broadcast:(0,r.z)("broadcast",60077),browser:(0,r.z)("browser",60078),bug:(0,r.z)("bug",60079),calendar:(0,r.z)("calendar",60080),caseSensitive:(0,r.z)("case-sensitive",60081),check:(0,r.z)("check",60082),checklist:(0,r.z)("checklist",60083),chevronDown:(0,r.z)("chevron-down",60084),chevronLeft:(0,r.z)("chevron-left",60085),chevronRight:(0,r.z)("chevron-right",60086),chevronUp:(0,r.z)("chevron-up",60087),chromeClose:(0,r.z)("chrome-close",60088),chromeMaximize:(0,r.z)("chrome-maximize",60089),chromeMinimize:(0,r.z)("chrome-minimize",60090),chromeRestore:(0,r.z)("chrome-restore",60091),circleOutline:(0,r.z)("circle-outline",60092),circle:(0,r.z)("circle",60092),debugBreakpointUnverified:(0,r.z)("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:(0,r.z)("terminal-decoration-incomplete",60092),circleSlash:(0,r.z)("circle-slash",60093),circuitBoard:(0,r.z)("circuit-board",60094),clearAll:(0,r.z)("clear-all",60095),clippy:(0,r.z)("clippy",60096),closeAll:(0,r.z)("close-all",60097),cloudDownload:(0,r.z)("cloud-download",60098),cloudUpload:(0,r.z)("cloud-upload",60099),code:(0,r.z)("code",60100),collapseAll:(0,r.z)("collapse-all",60101),colorMode:(0,r.z)("color-mode",60102),commentDiscussion:(0,r.z)("comment-discussion",60103),creditCard:(0,r.z)("credit-card",60105),dash:(0,r.z)("dash",60108),dashboard:(0,r.z)("dashboard",60109),database:(0,r.z)("database",60110),debugContinue:(0,r.z)("debug-continue",60111),debugDisconnect:(0,r.z)("debug-disconnect",60112),debugPause:(0,r.z)("debug-pause",60113),debugRestart:(0,r.z)("debug-restart",60114),debugStart:(0,r.z)("debug-start",60115),debugStepInto:(0,r.z)("debug-step-into",60116),debugStepOut:(0,r.z)("debug-step-out",60117),debugStepOver:(0,r.z)("debug-step-over",60118),debugStop:(0,r.z)("debug-stop",60119),debug:(0,r.z)("debug",60120),deviceCameraVideo:(0,r.z)("device-camera-video",60121),deviceCamera:(0,r.z)("device-camera",60122),deviceMobile:(0,r.z)("device-mobile",60123),diffAdded:(0,r.z)("diff-added",60124),diffIgnored:(0,r.z)("diff-ignored",60125),diffModified:(0,r.z)("diff-modified",60126),diffRemoved:(0,r.z)("diff-removed",60127),diffRenamed:(0,r.z)("diff-renamed",60128),diff:(0,r.z)("diff",60129),diffSidebyside:(0,r.z)("diff-sidebyside",60129),discard:(0,r.z)("discard",60130),editorLayout:(0,r.z)("editor-layout",60131),emptyWindow:(0,r.z)("empty-window",60132),exclude:(0,r.z)("exclude",60133),extensions:(0,r.z)("extensions",60134),eyeClosed:(0,r.z)("eye-closed",60135),fileBinary:(0,r.z)("file-binary",60136),fileCode:(0,r.z)("file-code",60137),fileMedia:(0,r.z)("file-media",60138),filePdf:(0,r.z)("file-pdf",60139),fileSubmodule:(0,r.z)("file-submodule",60140),fileSymlinkDirectory:(0,r.z)("file-symlink-directory",60141),fileSymlinkFile:(0,r.z)("file-symlink-file",60142),fileZip:(0,r.z)("file-zip",60143),files:(0,r.z)("files",60144),filter:(0,r.z)("filter",60145),flame:(0,r.z)("flame",60146),foldDown:(0,r.z)("fold-down",60147),foldUp:(0,r.z)("fold-up",60148),fold:(0,r.z)("fold",60149),folderActive:(0,r.z)("folder-active",60150),folderOpened:(0,r.z)("folder-opened",60151),gear:(0,r.z)("gear",60152),gift:(0,r.z)("gift",60153),gistSecret:(0,r.z)("gist-secret",60154),gist:(0,r.z)("gist",60155),gitCommit:(0,r.z)("git-commit",60156),gitCompare:(0,r.z)("git-compare",60157),compareChanges:(0,r.z)("compare-changes",60157),gitMerge:(0,r.z)("git-merge",60158),githubAction:(0,r.z)("github-action",60159),githubAlt:(0,r.z)("github-alt",60160),globe:(0,r.z)("globe",60161),grabber:(0,r.z)("grabber",60162),graph:(0,r.z)("graph",60163),gripper:(0,r.z)("gripper",60164),heart:(0,r.z)("heart",60165),home:(0,r.z)("home",60166),horizontalRule:(0,r.z)("horizontal-rule",60167),hubot:(0,r.z)("hubot",60168),inbox:(0,r.z)("inbox",60169),issueReopened:(0,r.z)("issue-reopened",60171),issues:(0,r.z)("issues",60172),italic:(0,r.z)("italic",60173),jersey:(0,r.z)("jersey",60174),json:(0,r.z)("json",60175),kebabVertical:(0,r.z)("kebab-vertical",60176),key:(0,r.z)("key",60177),law:(0,r.z)("law",60178),lightbulbAutofix:(0,r.z)("lightbulb-autofix",60179),linkExternal:(0,r.z)("link-external",60180),link:(0,r.z)("link",60181),listOrdered:(0,r.z)("list-ordered",60182),listUnordered:(0,r.z)("list-unordered",60183),liveShare:(0,r.z)("live-share",60184),loading:(0,r.z)("loading",60185),location:(0,r.z)("location",60186),mailRead:(0,r.z)("mail-read",60187),mail:(0,r.z)("mail",60188),markdown:(0,r.z)("markdown",60189),megaphone:(0,r.z)("megaphone",60190),mention:(0,r.z)("mention",60191),milestone:(0,r.z)("milestone",60192),gitPullRequestMilestone:(0,r.z)("git-pull-request-milestone",60192),mortarBoard:(0,r.z)("mortar-board",60193),move:(0,r.z)("move",60194),multipleWindows:(0,r.z)("multiple-windows",60195),mute:(0,r.z)("mute",60196),noNewline:(0,r.z)("no-newline",60197),note:(0,r.z)("note",60198),octoface:(0,r.z)("octoface",60199),openPreview:(0,r.z)("open-preview",60200),package:(0,r.z)("package",60201),paintcan:(0,r.z)("paintcan",60202),pin:(0,r.z)("pin",60203),play:(0,r.z)("play",60204),run:(0,r.z)("run",60204),plug:(0,r.z)("plug",60205),preserveCase:(0,r.z)("preserve-case",60206),preview:(0,r.z)("preview",60207),project:(0,r.z)("project",60208),pulse:(0,r.z)("pulse",60209),question:(0,r.z)("question",60210),quote:(0,r.z)("quote",60211),radioTower:(0,r.z)("radio-tower",60212),reactions:(0,r.z)("reactions",60213),references:(0,r.z)("references",60214),refresh:(0,r.z)("refresh",60215),regex:(0,r.z)("regex",60216),remoteExplorer:(0,r.z)("remote-explorer",60217),remote:(0,r.z)("remote",60218),remove:(0,r.z)("remove",60219),replaceAll:(0,r.z)("replace-all",60220),replace:(0,r.z)("replace",60221),repoClone:(0,r.z)("repo-clone",60222),repoForcePush:(0,r.z)("repo-force-push",60223),repoPull:(0,r.z)("repo-pull",60224),repoPush:(0,r.z)("repo-push",60225),report:(0,r.z)("report",60226),requestChanges:(0,r.z)("request-changes",60227),rocket:(0,r.z)("rocket",60228),rootFolderOpened:(0,r.z)("root-folder-opened",60229),rootFolder:(0,r.z)("root-folder",60230),rss:(0,r.z)("rss",60231),ruby:(0,r.z)("ruby",60232),saveAll:(0,r.z)("save-all",60233),saveAs:(0,r.z)("save-as",60234),save:(0,r.z)("save",60235),screenFull:(0,r.z)("screen-full",60236),screenNormal:(0,r.z)("screen-normal",60237),searchStop:(0,r.z)("search-stop",60238),server:(0,r.z)("server",60240),settingsGear:(0,r.z)("settings-gear",60241),settings:(0,r.z)("settings",60242),shield:(0,r.z)("shield",60243),smiley:(0,r.z)("smiley",60244),sortPrecedence:(0,r.z)("sort-precedence",60245),splitHorizontal:(0,r.z)("split-horizontal",60246),splitVertical:(0,r.z)("split-vertical",60247),squirrel:(0,r.z)("squirrel",60248),starFull:(0,r.z)("star-full",60249),starHalf:(0,r.z)("star-half",60250),symbolClass:(0,r.z)("symbol-class",60251),symbolColor:(0,r.z)("symbol-color",60252),symbolConstant:(0,r.z)("symbol-constant",60253),symbolEnumMember:(0,r.z)("symbol-enum-member",60254),symbolField:(0,r.z)("symbol-field",60255),symbolFile:(0,r.z)("symbol-file",60256),symbolInterface:(0,r.z)("symbol-interface",60257),symbolKeyword:(0,r.z)("symbol-keyword",60258),symbolMisc:(0,r.z)("symbol-misc",60259),symbolOperator:(0,r.z)("symbol-operator",60260),symbolProperty:(0,r.z)("symbol-property",60261),wrench:(0,r.z)("wrench",60261),wrenchSubaction:(0,r.z)("wrench-subaction",60261),symbolSnippet:(0,r.z)("symbol-snippet",60262),tasklist:(0,r.z)("tasklist",60263),telescope:(0,r.z)("telescope",60264),textSize:(0,r.z)("text-size",60265),threeBars:(0,r.z)("three-bars",60266),thumbsdown:(0,r.z)("thumbsdown",60267),thumbsup:(0,r.z)("thumbsup",60268),tools:(0,r.z)("tools",60269),triangleDown:(0,r.z)("triangle-down",60270),triangleLeft:(0,r.z)("triangle-left",60271),triangleRight:(0,r.z)("triangle-right",60272),triangleUp:(0,r.z)("triangle-up",60273),twitter:(0,r.z)("twitter",60274),unfold:(0,r.z)("unfold",60275),unlock:(0,r.z)("unlock",60276),unmute:(0,r.z)("unmute",60277),unverified:(0,r.z)("unverified",60278),verified:(0,r.z)("verified",60279),versions:(0,r.z)("versions",60280),vmActive:(0,r.z)("vm-active",60281),vmOutline:(0,r.z)("vm-outline",60282),vmRunning:(0,r.z)("vm-running",60283),watch:(0,r.z)("watch",60284),whitespace:(0,r.z)("whitespace",60285),wholeWord:(0,r.z)("whole-word",60286),window:(0,r.z)("window",60287),wordWrap:(0,r.z)("word-wrap",60288),zoomIn:(0,r.z)("zoom-in",60289),zoomOut:(0,r.z)("zoom-out",60290),listFilter:(0,r.z)("list-filter",60291),listFlat:(0,r.z)("list-flat",60292),listSelection:(0,r.z)("list-selection",60293),selection:(0,r.z)("selection",60293),listTree:(0,r.z)("list-tree",60294),debugBreakpointFunctionUnverified:(0,r.z)("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:(0,r.z)("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:(0,r.z)("debug-breakpoint-function-disabled",60296),debugStackframeActive:(0,r.z)("debug-stackframe-active",60297),circleSmallFilled:(0,r.z)("circle-small-filled",60298),debugStackframeDot:(0,r.z)("debug-stackframe-dot",60298),terminalDecorationMark:(0,r.z)("terminal-decoration-mark",60298),debugStackframe:(0,r.z)("debug-stackframe",60299),debugStackframeFocused:(0,r.z)("debug-stackframe-focused",60299),debugBreakpointUnsupported:(0,r.z)("debug-breakpoint-unsupported",60300),symbolString:(0,r.z)("symbol-string",60301),debugReverseContinue:(0,r.z)("debug-reverse-continue",60302),debugStepBack:(0,r.z)("debug-step-back",60303),debugRestartFrame:(0,r.z)("debug-restart-frame",60304),debugAlt:(0,r.z)("debug-alt",60305),callIncoming:(0,r.z)("call-incoming",60306),callOutgoing:(0,r.z)("call-outgoing",60307),menu:(0,r.z)("menu",60308),expandAll:(0,r.z)("expand-all",60309),feedback:(0,r.z)("feedback",60310),gitPullRequestReviewer:(0,r.z)("git-pull-request-reviewer",60310),groupByRefType:(0,r.z)("group-by-ref-type",60311),ungroupByRefType:(0,r.z)("ungroup-by-ref-type",60312),account:(0,r.z)("account",60313),gitPullRequestAssignee:(0,r.z)("git-pull-request-assignee",60313),bellDot:(0,r.z)("bell-dot",60314),debugConsole:(0,r.z)("debug-console",60315),library:(0,r.z)("library",60316),output:(0,r.z)("output",60317),runAll:(0,r.z)("run-all",60318),syncIgnored:(0,r.z)("sync-ignored",60319),pinned:(0,r.z)("pinned",60320),githubInverted:(0,r.z)("github-inverted",60321),serverProcess:(0,r.z)("server-process",60322),serverEnvironment:(0,r.z)("server-environment",60323),pass:(0,r.z)("pass",60324),issueClosed:(0,r.z)("issue-closed",60324),stopCircle:(0,r.z)("stop-circle",60325),playCircle:(0,r.z)("play-circle",60326),record:(0,r.z)("record",60327),debugAltSmall:(0,r.z)("debug-alt-small",60328),vmConnect:(0,r.z)("vm-connect",60329),cloud:(0,r.z)("cloud",60330),merge:(0,r.z)("merge",60331),export:(0,r.z)("export",60332),graphLeft:(0,r.z)("graph-left",60333),magnet:(0,r.z)("magnet",60334),notebook:(0,r.z)("notebook",60335),redo:(0,r.z)("redo",60336),checkAll:(0,r.z)("check-all",60337),pinnedDirty:(0,r.z)("pinned-dirty",60338),passFilled:(0,r.z)("pass-filled",60339),circleLargeFilled:(0,r.z)("circle-large-filled",60340),circleLarge:(0,r.z)("circle-large",60341),circleLargeOutline:(0,r.z)("circle-large-outline",60341),combine:(0,r.z)("combine",60342),gather:(0,r.z)("gather",60342),table:(0,r.z)("table",60343),variableGroup:(0,r.z)("variable-group",60344),typeHierarchy:(0,r.z)("type-hierarchy",60345),typeHierarchySub:(0,r.z)("type-hierarchy-sub",60346),typeHierarchySuper:(0,r.z)("type-hierarchy-super",60347),gitPullRequestCreate:(0,r.z)("git-pull-request-create",60348),runAbove:(0,r.z)("run-above",60349),runBelow:(0,r.z)("run-below",60350),notebookTemplate:(0,r.z)("notebook-template",60351),debugRerun:(0,r.z)("debug-rerun",60352),workspaceTrusted:(0,r.z)("workspace-trusted",60353),workspaceUntrusted:(0,r.z)("workspace-untrusted",60354),workspaceUnknown:(0,r.z)("workspace-unknown",60355),terminalCmd:(0,r.z)("terminal-cmd",60356),terminalDebian:(0,r.z)("terminal-debian",60357),terminalLinux:(0,r.z)("terminal-linux",60358),terminalPowershell:(0,r.z)("terminal-powershell",60359),terminalTmux:(0,r.z)("terminal-tmux",60360),terminalUbuntu:(0,r.z)("terminal-ubuntu",60361),terminalBash:(0,r.z)("terminal-bash",60362),arrowSwap:(0,r.z)("arrow-swap",60363),copy:(0,r.z)("copy",60364),personAdd:(0,r.z)("person-add",60365),filterFilled:(0,r.z)("filter-filled",60366),wand:(0,r.z)("wand",60367),debugLineByLine:(0,r.z)("debug-line-by-line",60368),inspect:(0,r.z)("inspect",60369),layers:(0,r.z)("layers",60370),layersDot:(0,r.z)("layers-dot",60371),layersActive:(0,r.z)("layers-active",60372),compass:(0,r.z)("compass",60373),compassDot:(0,r.z)("compass-dot",60374),compassActive:(0,r.z)("compass-active",60375),azure:(0,r.z)("azure",60376),issueDraft:(0,r.z)("issue-draft",60377),gitPullRequestClosed:(0,r.z)("git-pull-request-closed",60378),gitPullRequestDraft:(0,r.z)("git-pull-request-draft",60379),debugAll:(0,r.z)("debug-all",60380),debugCoverage:(0,r.z)("debug-coverage",60381),runErrors:(0,r.z)("run-errors",60382),folderLibrary:(0,r.z)("folder-library",60383),debugContinueSmall:(0,r.z)("debug-continue-small",60384),beakerStop:(0,r.z)("beaker-stop",60385),graphLine:(0,r.z)("graph-line",60386),graphScatter:(0,r.z)("graph-scatter",60387),pieChart:(0,r.z)("pie-chart",60388),bracket:(0,r.z)("bracket",60175),bracketDot:(0,r.z)("bracket-dot",60389),bracketError:(0,r.z)("bracket-error",60390),lockSmall:(0,r.z)("lock-small",60391),azureDevops:(0,r.z)("azure-devops",60392),verifiedFilled:(0,r.z)("verified-filled",60393),newline:(0,r.z)("newline",60394),layout:(0,r.z)("layout",60395),layoutActivitybarLeft:(0,r.z)("layout-activitybar-left",60396),layoutActivitybarRight:(0,r.z)("layout-activitybar-right",60397),layoutPanelLeft:(0,r.z)("layout-panel-left",60398),layoutPanelCenter:(0,r.z)("layout-panel-center",60399),layoutPanelJustify:(0,r.z)("layout-panel-justify",60400),layoutPanelRight:(0,r.z)("layout-panel-right",60401),layoutPanel:(0,r.z)("layout-panel",60402),layoutSidebarLeft:(0,r.z)("layout-sidebar-left",60403),layoutSidebarRight:(0,r.z)("layout-sidebar-right",60404),layoutStatusbar:(0,r.z)("layout-statusbar",60405),layoutMenubar:(0,r.z)("layout-menubar",60406),layoutCentered:(0,r.z)("layout-centered",60407),target:(0,r.z)("target",60408),indent:(0,r.z)("indent",60409),recordSmall:(0,r.z)("record-small",60410),errorSmall:(0,r.z)("error-small",60411),terminalDecorationError:(0,r.z)("terminal-decoration-error",60411),arrowCircleDown:(0,r.z)("arrow-circle-down",60412),arrowCircleLeft:(0,r.z)("arrow-circle-left",60413),arrowCircleRight:(0,r.z)("arrow-circle-right",60414),arrowCircleUp:(0,r.z)("arrow-circle-up",60415),layoutSidebarRightOff:(0,r.z)("layout-sidebar-right-off",60416),layoutPanelOff:(0,r.z)("layout-panel-off",60417),layoutSidebarLeftOff:(0,r.z)("layout-sidebar-left-off",60418),blank:(0,r.z)("blank",60419),heartFilled:(0,r.z)("heart-filled",60420),map:(0,r.z)("map",60421),mapHorizontal:(0,r.z)("map-horizontal",60421),foldHorizontal:(0,r.z)("fold-horizontal",60421),mapFilled:(0,r.z)("map-filled",60422),mapHorizontalFilled:(0,r.z)("map-horizontal-filled",60422),foldHorizontalFilled:(0,r.z)("fold-horizontal-filled",60422),circleSmall:(0,r.z)("circle-small",60423),bellSlash:(0,r.z)("bell-slash",60424),bellSlashDot:(0,r.z)("bell-slash-dot",60425),commentUnresolved:(0,r.z)("comment-unresolved",60426),gitPullRequestGoToChanges:(0,r.z)("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:(0,r.z)("git-pull-request-new-changes",60428),searchFuzzy:(0,r.z)("search-fuzzy",60429),commentDraft:(0,r.z)("comment-draft",60430),send:(0,r.z)("send",60431),sparkle:(0,r.z)("sparkle",60432),insert:(0,r.z)("insert",60433),mic:(0,r.z)("mic",60434),thumbsdownFilled:(0,r.z)("thumbsdown-filled",60435),thumbsupFilled:(0,r.z)("thumbsup-filled",60436),coffee:(0,r.z)("coffee",60437),snake:(0,r.z)("snake",60438),game:(0,r.z)("game",60439),vr:(0,r.z)("vr",60440),chip:(0,r.z)("chip",60441),piano:(0,r.z)("piano",60442),music:(0,r.z)("music",60443),micFilled:(0,r.z)("mic-filled",60444),repoFetch:(0,r.z)("repo-fetch",60445),copilot:(0,r.z)("copilot",60446),lightbulbSparkle:(0,r.z)("lightbulb-sparkle",60447),robot:(0,r.z)("robot",60448),sparkleFilled:(0,r.z)("sparkle-filled",60449),diffSingle:(0,r.z)("diff-single",60450),diffMultiple:(0,r.z)("diff-multiple",60451),surroundWith:(0,r.z)("surround-with",60452),share:(0,r.z)("share",60453),gitStash:(0,r.z)("git-stash",60454),gitStashApply:(0,r.z)("git-stash-apply",60455),gitStashPop:(0,r.z)("git-stash-pop",60456),vscode:(0,r.z)("vscode",60457),vscodeInsiders:(0,r.z)("vscode-insiders",60458),codeOss:(0,r.z)("code-oss",60459),runCoverage:(0,r.z)("run-coverage",60460),runAllCoverage:(0,r.z)("run-all-coverage",60461),coverage:(0,r.z)("coverage",60462),githubProject:(0,r.z)("github-project",60463),mapVertical:(0,r.z)("map-vertical",60464),foldVertical:(0,r.z)("fold-vertical",60464),mapVerticalFilled:(0,r.z)("map-vertical-filled",60465),foldVerticalFilled:(0,r.z)("fold-vertical-filled",60465),goToSearch:(0,r.z)("go-to-search",60466),percentage:(0,r.z)("percentage",60467),sortPercentage:(0,r.z)("sort-percentage",60467)}},59215:function(e,t,i){i.d(t,{u:function(){return o},z:function(){return s}});var r=i(47635);const n=Object.create(null);function s(e,t){if((0,r.HD)(t)){const i=n[t];if(void 0===i)throw new Error(`${e} references an unknown codicon: ${t}`);t=i}return n[e]=t,{id:e}}function o(){return n}},21033:function(e,t,i){function r(e,t){const i=this;let r,n=!1;return function(){if(n)return r;if(n=!0,t)try{r=e.apply(i,arguments)}finally{t()}else r=e.apply(i,arguments);return r}}i.d(t,{M:function(){return r}})},97698:function(e,t,i){var r;i.d(t,{$:function(){return r}}),function(e){function t(e){return e&&"object"==typeof e&&"function"==typeof e[Symbol.iterator]}e.is=t;const i=Object.freeze([]);function*r(e){yield e}e.empty=function(){return i},e.single=r,e.wrap=function(e){return t(e)?e:r(e)},e.from=function(e){return e||i},e.reverse=function*(e){for(let t=e.length-1;t>=0;t--)yield e[t]},e.isEmpty=function(e){return!e||!0===e[Symbol.iterator]().next().done},e.first=function(e){return e[Symbol.iterator]().next().value},e.some=function(e,t){for(const i of e)if(t(i))return!0;return!1},e.find=function(e,t){for(const i of e)if(t(i))return i},e.filter=function*(e,t){for(const i of e)t(i)&&(yield i)},e.map=function*(e,t){let i=0;for(const r of e)yield t(r,i++)},e.concat=function*(...e){for(const t of e)yield*t},e.reduce=function(e,t,i){let r=i;for(const i of e)r=t(r,i);return r},e.slice=function*(e,t,i=e.length){for(t<0&&(t+=e.length),i<0?i+=e.length:i>e.length&&(i=e.length);t<i;t++)yield e[t]},e.consume=function(t,i=Number.POSITIVE_INFINITY){const r=[];if(0===i)return[r,t];const n=t[Symbol.iterator]();for(let t=0;t<i;t++){const t=n.next();if(t.done)return[r,e.empty()];r.push(t.value)}return[r,{[Symbol.iterator](){return n}}]},e.asyncToArray=async function(e){const t=[];for await(const i of e)t.push(i);return Promise.resolve(t)}}(r||(r={}))},40048:function(e,t,i){i.d(t,{o:function(){return r}});class r{constructor(e){this.executor=e,this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}},95960:function(e,t,i){i.d(t,{PP:function(){return s},vW:function(){return r}});i(15229);const r=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});const n=/^(.+)\/(.+?)(;.+)?$/;function s(e,t){const i=n.exec(e);return i?`${i[1].toLowerCase()}/${i[2].toLowerCase()}${i[3]??""}`:t?void 0:e}},84018:function(e,t,i){i.d(t,{$P:function(){return c},IZ:function(){return r}});class r{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return function(e,t){const i=s.get(e);if(i)return i;const r=function(e,t){const i=s.get(e);if(i)return i;const r=t.owner?function(e){const t=a.get(e);if(t)return t;const i=function(e){const t=e.constructor;if(t)return t.name;return"Object"}(e);let r=o.get(i)??0;r++,o.set(i,r);const n=1===r?i:`${i}#${r}`;return a.set(e,n),n}(t.owner)+".":"";let n;const l=t.debugNameSource;if(void 0!==l){if("function"!=typeof l)return r+l;if(n=l(),void 0!==n)return r+n}const d=t.referenceFn;if(void 0!==d&&(n=c(d),void 0!==n))return r+n;if(void 0!==t.owner){const i=function(e,t){for(const i in e)if(e[i]===t)return i;return}(t.owner,e);if(void 0!==i)return r+i}return}(e,t);if(r){let t=n.get(r)??0;t++,n.set(r,t);const i=1===t?r:`${r}#${t}`;return s.set(e,i),i}return}(e,this)}}const n=new Map,s=new WeakMap;const o=new Map,a=new WeakMap;function c(e){const t=e.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(t),r=i?i[1]:void 0;return r?.trim()}},61826:function(e,t,i){i.d(t,{B:function(){return r},_:function(){return n}});const r=e=>{performance.mark(e)},n=()=>{let e=performance.timeOrigin;"number"!=typeof e&&(e=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);const t=[{name:"code/timeOrigin",startTime:Math.round(e)}];for(const i of performance.getEntriesByType("mark"))t.push({name:i.name,startTime:Math.round(e+i.startTime)});return t}},93293:function(e,t,i){i.d(t,{F:function(){return s}});var r=i(97698);const n=Symbol("unset");class s{constructor(){this.root=new a,this._size=0}get size(){return this._size}get nodes(){return this.root.children?.values()||r.$.empty()}insert(e,t,i){this.opNode(e,(e=>e._value=t),i)}mutate(e,t){this.opNode(e,(e=>e._value=t(e._value===n?void 0:e._value)))}delete(e){const t=this.getPathToKey(e);if(!t)return;let i=t.length-1;const r=t[i].node._value;if(r!==n){for(this._size--,t[i].node._value=n;i>0;i--){const{node:e,part:r}=t[i];if(e.children?.size||e._value!==n)break;t[i-1].node.children.delete(r)}return r}}*deleteRecursive(e){const t=this.getPathToKey(e);if(!t)return;const i=t[t.length-1].node;for(let e=t.length-1;e>0;e--){const i=t[e-1];if(i.node.children.delete(t[e].part),i.node.children.size>0||i.node._value!==n)break}for(const e of o(i))e._value!==n&&(this._size--,yield e._value)}find(e){let t=this.root;for(const i of e){const e=t.children?.get(i);if(!e)return;t=e}return t._value===n?void 0:t._value}hasKeyOrParent(e){let t=this.root;for(const i of e){const e=t.children?.get(i);if(!e)return!1;if(e._value!==n)return!0;t=e}return!1}hasKeyOrChildren(e){let t=this.root;for(const i of e){const e=t.children?.get(i);if(!e)return!1;t=e}return!0}hasKey(e){let t=this.root;for(const i of e){const e=t.children?.get(i);if(!e)return!1;t=e}return t._value!==n}getPathToKey(e){const t=[{part:"",node:this.root}];let i=0;for(const r of e){const e=t[i].node.children?.get(r);if(!e)return;t.push({part:r,node:e}),i++}return t}opNode(e,t,i){let r=this.root;for(const t of e){if(r.children)if(r.children.has(t))r=r.children.get(t);else{const e=new a;r.children.set(t,e),r=e}else{const e=new a;r.children=new Map([[t,e]]),r=e}i?.(r)}const s=r._value===n?0:1;t(r);const o=r._value===n?0:1;this._size+=o-s}*values(){for(const{_value:e}of o(this.root))e!==n&&(yield e)}}function*o(e){const t=[e];for(;t.length>0;){const e=t.pop();if(yield e,e.children)for(const i of e.children.values())t.push(i)}}class a{constructor(){this._value=n}get value(){return this._value===n?void 0:this._value}set value(e){this._value=void 0===e?n:e}}},74120:function(e,t,i){i.d(t,{Z:function(){return s}});var r,n=i(88023);!function(e){e[e.Ignore=0]="Ignore",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(r||(r={})),function(e){const t="error",i="warning",r="info";e.fromValue=function(s){return s?(0,n.qq)(t,s)?e.Error:(0,n.qq)(i,s)||(0,n.qq)("warn",s)?e.Warning:(0,n.qq)(r,s)?e.Info:e.Ignore:e.Ignore},e.toString=function(n){switch(n){case e.Error:return t;case e.Warning:return i;case e.Info:return r;default:return"ignore"}}}(r||(r={}));var s=r},43064:function(e,t,i){i.d(t,{G:function(){return n}});const r=globalThis.performance&&"function"==typeof globalThis.performance.now;class n{static create(e){return new n(e)}constructor(e){this._now=r&&!1===e?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return-1!==this._stopTime?this._stopTime-this._startTime:this._now()-this._startTime}}},43437:function(e,t,i){function r(e){return e<0?0:e>255?255:0|e}function n(e){return e<0?0:e>4294967295?4294967295:0|e}i.d(t,{A:function(){return n},K:function(){return r}})},42731:function(e,t,i){i.d(t,{_9:function(){return h},ov:function(){return u},qP:function(){return _}});var r=i(15229),n=i(11547);const s=/^\w[\w\d+.-]*$/,o=/^\//,a=/^\/\//;const c="",l="/",d=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class u{static isUri(e){return e instanceof u||!!e&&("string"==typeof e.authority&&"string"==typeof e.fragment&&"string"==typeof e.path&&"string"==typeof e.query&&"string"==typeof e.scheme&&"string"==typeof e.fsPath&&"function"==typeof e.with&&"function"==typeof e.toString)}constructor(e,t,i,r,n,d=!1){"object"==typeof e?(this.scheme=e.scheme||c,this.authority=e.authority||c,this.path=e.path||c,this.query=e.query||c,this.fragment=e.fragment||c):(this.scheme=function(e,t){return e||t?e:"file"}(e,d),this.authority=t||c,this.path=function(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==l&&(t=l+t):t=l}return t}(this.scheme,i||c),this.query=r||c,this.fragment=n||c,function(e,t){if(!e.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!s.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!o.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(a.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}(this,d))}get fsPath(){return _(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:r,query:n,fragment:s}=e;return void 0===t?t=this.scheme:null===t&&(t=c),void 0===i?i=this.authority:null===i&&(i=c),void 0===r?r=this.path:null===r&&(r=c),void 0===n?n=this.query:null===n&&(n=c),void 0===s?s=this.fragment:null===s&&(s=c),t===this.scheme&&i===this.authority&&r===this.path&&n===this.query&&s===this.fragment?this:new m(t,i,r,n,s)}static parse(e,t=!1){const i=d.exec(e);return i?new m(i[2]||c,x(i[4]||c),x(i[5]||c),x(i[7]||c),x(i[9]||c),t):new m(c,c,c,c,c)}static file(e){let t=c;if(n.ED&&(e=e.replace(/\\/g,l)),e[0]===l&&e[1]===l){const i=e.indexOf(l,2);-1===i?(t=e.substring(2),e=l):(t=e.substring(2,i),e=e.substring(i)||l)}return new m("file",t,e,c,c)}static from(e,t){return new m(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return i=n.ED&&"file"===e.scheme?u.file(r.Ku.join(_(e,!0),...t)).path:r.KR.join(e.path,...t),e.with({path:i})}toString(e=!1){return b(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof u)return e;{const t=new m(e);return t._formatted=e.external??null,t._fsPath=e._sep===p?e.fsPath??null:null,t}}return e}}function h(e){return!(!e||"object"!=typeof e)&&!("string"!=typeof e.scheme||"string"!=typeof e.authority&&void 0!==e.authority||"string"!=typeof e.path&&void 0!==e.path||"string"!=typeof e.query&&void 0!==e.query||"string"!=typeof e.fragment&&void 0!==e.fragment)}const p=n.ED?1:void 0;class m extends u{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=_(this,!1)),this._fsPath}toString(e=!1){return e?b(this,!0):(this._formatted||(this._formatted=b(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=p),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const f={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function g(e,t,i){let r,n=-1;for(let s=0;s<e.length;s++){const o=e.charCodeAt(s);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||45===o||46===o||95===o||126===o||t&&47===o||i&&91===o||i&&93===o||i&&58===o)-1!==n&&(r+=encodeURIComponent(e.substring(n,s)),n=-1),void 0!==r&&(r+=e.charAt(s));else{void 0===r&&(r=e.substr(0,s));const t=f[o];void 0!==t?(-1!==n&&(r+=encodeURIComponent(e.substring(n,s)),n=-1),r+=t):-1===n&&(n=s)}}return-1!==n&&(r+=encodeURIComponent(e.substring(n))),void 0!==r?r:e}function v(e){let t;for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);35===r||63===r?(void 0===t&&(t=e.substr(0,i)),t+=f[r]):void 0!==t&&(t+=e[i])}return void 0!==t?t:e}function _(e,t){let i;return i=e.authority&&e.path.length>1&&"file"===e.scheme?`//${e.authority}${e.path}`:47===e.path.charCodeAt(0)&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&58===e.path.charCodeAt(2)?t?e.path.substr(1):e.path[1].toLowerCase()+e.path.substr(2):e.path,n.ED&&(i=i.replace(/\//g,"\\")),i}function b(e,t){const i=t?v:g;let r="",{scheme:n,authority:s,path:o,query:a,fragment:c}=e;if(n&&(r+=n,r+=":"),(s||"file"===n)&&(r+=l,r+=l),s){let e=s.indexOf("@");if(-1!==e){const t=s.substr(0,e);s=s.substr(e+1),e=t.lastIndexOf(":"),-1===e?r+=i(t,!1,!1):(r+=i(t.substr(0,e),!1,!1),r+=":",r+=i(t.substr(e+1),!1,!0)),r+="@"}s=s.toLowerCase(),e=s.lastIndexOf(":"),-1===e?r+=i(s,!1,!0):(r+=i(s.substr(0,e),!1,!0),r+=s.substr(e))}if(o){if(o.length>=3&&47===o.charCodeAt(0)&&58===o.charCodeAt(2)){const e=o.charCodeAt(1);e>=65&&e<=90&&(o=`/${String.fromCharCode(e+32)}:${o.substr(3)}`)}else if(o.length>=2&&58===o.charCodeAt(1)){const e=o.charCodeAt(0);e>=65&&e<=90&&(o=`${String.fromCharCode(e+32)}:${o.substr(2)}`)}r+=i(o,!0,!1)}return a&&(r+="?",r+=i(a,!1,!1)),c&&(r+="#",r+=t?c:g(c,!1,!1)),r}function w(e){try{return decodeURIComponent(e)}catch{return e.length>3?e.substr(0,3)+w(e.substr(3)):e}}const y=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function x(e){return e.match(y)?e.replace(y,(e=>w(e))):e}},16184:function(e,t,i){function r(e){let t=0,i=0,r=0,n=0;for(let s=0,o=e.length;s<o;s++){const a=e.charCodeAt(s);13===a?(0===t&&(i=s),t++,s+1<o&&10===e.charCodeAt(s+1)?(n|=2,s++):n|=3,r=s+1):10===a&&(n|=1,0===t&&(i=s),t++,r=s+1)}return 0===t&&(i=e.length),[t,i,e.length-r,n]}i.d(t,{Q:function(){return r}})},20495:function(e,t,i){i.d(t,{L:function(){return r}});class r{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new r(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return r.equals(this,e)}static equals(e,t){return!e&&!t||!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return r.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber||!(t.lineNumber<e.lineNumber)&&e.column<t.column}isBeforeOrEqual(e){return r.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber||!(t.lineNumber<e.lineNumber)&&e.column<=t.column}static compare(e,t){const i=0|e.lineNumber,r=0|t.lineNumber;if(i===r){return(0|e.column)-(0|t.column)}return i-r}clone(){return new r(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new r(e.lineNumber,e.column)}static isIPosition(e){return e&&"number"==typeof e.lineNumber&&"number"==typeof e.column}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}}},3918:function(e,t,i){i.d(t,{e:function(){return n}});var r=i(20495);class n{constructor(e,t,i,r){e>i||e===i&&t>r?(this.startLineNumber=i,this.startColumn=r,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=r)}isEmpty(){return n.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return n.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber)&&(!(t.lineNumber===e.startLineNumber&&t.column<e.startColumn)&&!(t.lineNumber===e.endLineNumber&&t.column>e.endColumn))}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber)&&(!(t.lineNumber===e.startLineNumber&&t.column<=e.startColumn)&&!(t.lineNumber===e.endLineNumber&&t.column>=e.endColumn))}containsRange(e){return n.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber)&&(!(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber)&&(!(t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn)&&!(t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)))}strictContainsRange(e){return n.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber)&&(!(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber)&&(!(t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn)&&!(t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)))}plusRange(e){return n.plusRange(this,e)}static plusRange(e,t){let i,r,s,o;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,r=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,r=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,r=e.startColumn),t.endLineNumber>e.endLineNumber?(s=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(s=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(s=e.endLineNumber,o=e.endColumn),new n(i,r,s,o)}intersectRanges(e){return n.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,r=e.startColumn,s=e.endLineNumber,o=e.endColumn;const a=t.startLineNumber,c=t.startColumn,l=t.endLineNumber,d=t.endColumn;return i<a?(i=a,r=c):i===a&&(r=Math.max(r,c)),s>l?(s=l,o=d):s===l&&(o=Math.min(o,d)),i>s||i===s&&r>o?null:new n(i,r,s,o)}equalsRange(e){return n.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t||!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return n.getEndPosition(this)}static getEndPosition(e){return new r.L(e.endLineNumber,e.endColumn)}getStartPosition(){return n.getStartPosition(this)}static getStartPosition(e){return new r.L(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new n(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new n(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return n.collapseToStart(this)}static collapseToStart(e){return new n(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return n.collapseToEnd(this)}static collapseToEnd(e){return new n(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new n(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new n(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new n(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&"number"==typeof e.startLineNumber&&"number"==typeof e.startColumn&&"number"==typeof e.endLineNumber&&"number"==typeof e.endColumn}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn)&&!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn)&&!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const i=0|e.startLineNumber,r=0|t.startLineNumber;if(i===r){const i=0|e.startColumn,r=0|t.startColumn;if(i===r){const i=0|e.endLineNumber,r=0|t.endLineNumber;if(i===r){return(0|e.endColumn)-(0|t.endColumn)}return i-r}return i-r}return i-r}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}}},23775:function(e,t,i){i.d(t,{Y:function(){return s}});var r=i(20495),n=i(3918);class s extends n.e{constructor(e,t,i,r){super(e,t,i,r),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=r}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return s.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return 0===this.getDirection()?new s(this.startLineNumber,this.startColumn,e,t):new s(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new r.L(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new r.L(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return 0===this.getDirection()?new s(e,t,this.endLineNumber,this.endColumn):new s(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new s(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return 0===t?new s(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new s(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new s(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,r=e.length;i<r;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&"number"==typeof e.selectionStartLineNumber&&"number"==typeof e.selectionStartColumn&&"number"==typeof e.positionLineNumber&&"number"==typeof e.positionColumn}static createWithDirection(e,t,i,r,n){return 0===n?new s(e,t,i,r):new s(i,r,e,t)}}},22057:function(e,t,i){i.d(t,{D:function(){return r}});const r={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}}},71709:function(e,t,i){i.d(t,{G:function(){return s},J:function(){return o}});var r=i(22200),n=i(15229);function s(e,t,i,o,a,c){if(Array.isArray(e)){let r=0;for(const n of e){const e=s(n,t,i,o,a,c);if(10===e)return e;e>r&&(r=e)}return r}if("string"==typeof e)return o?"*"===e?5:e===i?10:0:0;if(e){const{language:s,pattern:l,scheme:d,hasAccessToAllModels:u,notebookType:h}=e;if(!o&&!u)return 0;h&&a&&(t=a);let p=0;if(d)if(d===t.scheme)p=10;else{if("*"!==d)return 0;p=5}if(s)if(s===i)p=10;else{if("*"!==s)return 0;p=Math.max(p,5)}if(h)if(h===c)p=10;else{if("*"!==h||void 0===c)return 0;p=Math.max(p,5)}if(l){let e;if(e="string"==typeof l?l:{...l,base:(0,n.Fv)(l.base)},e!==t.fsPath&&!(0,r.EQ)(e,t.fsPath))return 0;p=10}return p}return 0}function o(e){return"string"!=typeof e&&(Array.isArray(e)?e.some(o):!!e.notebookType)}},17263:function(e,t,i){i.d(t,{v:function(){return o}});var r=i(88023),n=i(20495),s=i(16210);class o{constructor(e,t,i,r){this._uri=e,this._lines=t,this._eol=i,this._versionId=r,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return null===this._cachedTextValue&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const e of t)this._acceptDeleteRange(e.range),this._acceptInsertText(new n.L(e.range.startLineNumber,e.range.startColumn),e.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let r=0;r<t;r++)i[r]=this._lines[r].length+e;this._lineStarts=new s.oQ(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber!==e.endLineNumber)this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber);else{if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1))}}_acceptInsertText(e,t){if(0===t.length)return;const i=(0,r.uq)(t);if(1===i.length)return void this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let t=1;t<i.length;t++)this._lines.splice(e.lineNumber+t-1,0,i[t]),n[t-1]=i[t].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}},51968:function(e,t,i){i.d(t,{Lv:function(){return m},Nr:function(){return h},Xp:function(){return u},nD:function(){return v}});var r=i(20495),n=i(3918),s=i(82416),o=i(79450),a=i(75396);const c=65535;function l(e){let t;return t=e[e.length-1]<65536?new Uint16Array(e.length):new Uint32Array(e.length),t.set(e,0),t}class d{constructor(e,t,i,r,n){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=r,this.isBasicASCII=n}}function u(e,t=!0){const i=[0];let r=1;for(let t=0,n=e.length;t<n;t++){const s=e.charCodeAt(t);13===s?t+1<n&&10===e.charCodeAt(t+1)?(i[r++]=t+2,t++):i[r++]=t+1:10===s&&(i[r++]=t+1)}return t?l(i):i}function h(e,t){e.length=0,e[0]=0;let i=1,r=0,n=0,s=0,o=!0;for(let a=0,c=t.length;a<c;a++){const l=t.charCodeAt(a);13===l?a+1<c&&10===t.charCodeAt(a+1)?(s++,e[i++]=a+2,a++):(r++,e[i++]=a+1):10===l?(n++,e[i++]=a+1):o&&9!==l&&(l<32||l>126)&&(o=!1)}const a=new d(l(e),r,n,s,o);return e.length=0,a}class p{constructor(e,t,i,r,n){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=r,this.length=n}}class m{constructor(e,t){this.buffer=e,this.lineStarts=t}}class f{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==o.Nc&&e.iterate(e.root,(e=>(e!==o.Nc&&this._pieces.push(e.piece),!0)))}read(){return 0===this._pieces.length?0===this._index?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:0===this._index?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class g{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let r=0;r<i.length;r++){const n=i[r];(null===n.node.parent||n.nodeStartOffset>=e)&&(i[r]=null,t=!0)}if(t){const e=[];for(const t of i)null!==t&&e.push(t);this._cache=e}}}class v{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new m("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=o.Nc,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let r=null;for(let t=0,i=e.length;t<i;t++)if(e[t].buffer.length>0){e[t].lineStarts||(e[t].lineStarts=u(e[t].buffer));const i=new p(t+1,{line:0,column:0},{line:e[t].lineStarts.length-1,column:e[t].buffer.length-e[t].lineStarts[e[t].lineStarts.length-1]},e[t].lineStarts.length-1,e[t].buffer.length);this._buffers.push(e[t]),r=this.rbInsertRight(r,i)}this._searchCache=new g(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=c,i=t-Math.floor(21845),r=2*i;let n="",s=0;const o=[];if(this.iterate(this.root,(t=>{const a=this.getNodeContent(t),c=a.length;if(s<=i||s+c<r)return n+=a,s+=c,!0;const l=n.replace(/\r\n|\r|\n/g,e);return o.push(new m(l,u(l))),n=a,s=c,!0})),s>0){const t=n.replace(/\r\n|\r|\n/g,e);o.push(new m(t,u(t)))}this.create(o,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new f(this,e)}equal(e){if(this.getLength()!==e.getLength())return!1;if(this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,(i=>{if(i===o.Nc)return!0;const r=this.getNodeContent(i),n=r.length,s=e.nodeAt(t),a=e.nodeAt(t+n),c=e.getValueInRange2(s,a);return t+=n,r===c}))}getOffsetAt(e,t){let i=0,r=this.root;for(;r!==o.Nc;)if(r.left!==o.Nc&&r.lf_left+1>=e)r=r.left;else{if(r.lf_left+r.piece.lineFeedCnt+1>=e){i+=r.size_left;return i+(this.getAccumulatedValue(r,e-r.lf_left-2)+t-1)}e-=r.lf_left+r.piece.lineFeedCnt,i+=r.size_left+r.piece.length,r=r.right}return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==o.Nc;)if(0!==t.size_left&&t.size_left>=e)t=t.left;else{if(t.size_left+t.piece.length>=e){const s=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+s.index,0===s.index){const e=n-this.getOffsetAt(i+1,1);return new r.L(i+1,e+1)}return new r.L(i+1,s.remainder+1)}if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===o.Nc){const t=n-e-this.getOffsetAt(i+1,1);return new r.L(i+1,t+1)}t=t.right}return new r.L(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),r=this.nodeAt2(e.endLineNumber,e.endColumn),n=this.getValueInRange2(i,r);return t?t===this._EOL&&this._EOLNormalized&&t===this.getEOL()&&this._EOLNormalized?n:n.replace(/\r\n|\r|\n/g,t):n}getValueInRange2(e,t){if(e.node===t.node){const i=e.node,r=this._buffers[i.piece.bufferIndex].buffer,n=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r.substring(n+e.remainder,n+t.remainder)}let i=e.node;const r=this._buffers[i.piece.bufferIndex].buffer,n=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let s=r.substring(n+e.remainder,n+i.piece.length);for(i=i.next();i!==o.Nc;){const e=this._buffers[i.piece.bufferIndex].buffer,r=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){s+=e.substring(r,r+t.remainder);break}s+=e.substr(r,i.piece.length),i=i.next()}return s}getLinesContent(){const e=[];let t=0,i="",r=!1;return this.iterate(this.root,(n=>{if(n===o.Nc)return!0;const s=n.piece;let a=s.length;if(0===a)return!0;const c=this._buffers[s.bufferIndex].buffer,l=this._buffers[s.bufferIndex].lineStarts,d=s.start.line,u=s.end.line;let h=l[d]+s.start.column;if(r&&(10===c.charCodeAt(h)&&(h++,a--),e[t++]=i,i="",r=!1,0===a))return!0;if(d===u)return this._EOLNormalized||13!==c.charCodeAt(h+a-1)?i+=c.substr(h,a):(r=!0,i+=c.substr(h,a-1)),!0;i+=this._EOLNormalized?c.substring(h,Math.max(h,l[d+1]-this._EOLLength)):c.substring(h,l[d+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let r=d+1;r<u;r++)i=this._EOLNormalized?c.substring(l[r],l[r+1]-this._EOLLength):c.substring(l[r],l[r+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return this._EOLNormalized||13!==c.charCodeAt(l[u]+s.end.column-1)?i=c.substr(l[u],s.end.column):(r=!0,0===s.end.column?t--:i=c.substr(l[u],s.end.column-1)),!0})),r&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e||(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,"")),this._lastVisitedLine.value}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],r=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(r)}{const t=this._buffers[e.node.piece.bufferIndex],i=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){const t=this.nodeAt(e);return this._getCharCode(t)}findMatchesInNode(e,t,i,r,s,o,c,l,d,u,h){const p=this._buffers[e.piece.bufferIndex],m=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),f=this.offsetInBuffer(e.piece.bufferIndex,s),g=this.offsetInBuffer(e.piece.bufferIndex,o);let v;const _={line:0,column:0};let b,w;t._wordSeparators?(b=p.buffer.substring(f,g),w=e=>e+f,t.reset(0)):(b=p.buffer,w=e=>e,t.reset(f));do{if(v=t.next(b),v){if(w(v.index)>=g)return u;this.positionInBuffer(e,w(v.index)-m,_);const t=this.getLineFeedCnt(e.piece.bufferIndex,s,_),o=_.line===s.line?_.column-s.column+r:_.column+1,c=o+v[0].length;if(h[u++]=(0,a.iE)(new n.e(i+t,o,i+t,c),v,l),w(v.index)+v[0].length>=g)return u;if(u>=d)return u}}while(v);return u}findMatchesLineByLine(e,t,i,r){const n=[];let s=0;const o=new a.sz(t.wordSeparators,t.regex);let c=this.nodeAt2(e.startLineNumber,e.startColumn);if(null===c)return[];const l=this.nodeAt2(e.endLineNumber,e.endColumn);if(null===l)return[];let d=this.positionInBuffer(c.node,c.remainder);const u=this.positionInBuffer(l.node,l.remainder);if(c.node===l.node)return this.findMatchesInNode(c.node,o,e.startLineNumber,e.startColumn,d,u,t,i,r,s,n),n;let h=e.startLineNumber,p=c.node;for(;p!==l.node;){const a=this.getLineFeedCnt(p.piece.bufferIndex,d,p.piece.end);if(a>=1){const c=this._buffers[p.piece.bufferIndex].lineStarts,l=this.offsetInBuffer(p.piece.bufferIndex,p.piece.start),u=c[d.line+a],m=h===e.startLineNumber?e.startColumn:1;if(s=this.findMatchesInNode(p,o,h,m,d,this.positionInBuffer(p,u-l),t,i,r,s,n),s>=r)return n;h+=a}const l=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){const a=this.getLineContent(h).substring(l,e.endColumn-1);return s=this._findMatchesInLine(t,o,a,e.endLineNumber,l,s,n,i,r),n}if(s=this._findMatchesInLine(t,o,this.getLineContent(h).substr(l),h,l,s,n,i,r),s>=r)return n;h++,c=this.nodeAt2(h,1),p=c.node,d=this.positionInBuffer(c.node,c.remainder)}if(h===e.endLineNumber){const a=h===e.startLineNumber?e.startColumn-1:0,c=this.getLineContent(h).substring(a,e.endColumn-1);return s=this._findMatchesInLine(t,o,c,e.endLineNumber,a,s,n,i,r),n}const m=h===e.startLineNumber?e.startColumn:1;return s=this.findMatchesInNode(l.node,o,h,m,d,u,t,i,r,s,n),n}_findMatchesInLine(e,t,i,r,o,c,l,d,u){const h=e.wordSeparators;if(!d&&e.simpleSearch){const t=e.simpleSearch,d=t.length,p=i.length;let m=-d;for(;-1!==(m=i.indexOf(t,m+d));)if((!h||(0,a.cM)(h,i,p,m,d))&&(l[c++]=new s.tk(new n.e(r,m+1+o,r,m+1+d+o),null),c>=u))return c;return c}let p;t.reset(0);do{if(p=t.next(i),p&&(l[c++]=(0,a.iE)(new n.e(r,p.index+1+o,r,p.index+1+p[0].length+o),p,d),c>=u))return c}while(p);return c}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==o.Nc){const{node:i,remainder:r,nodeStartOffset:n}=this.nodeAt(e),s=i.piece,o=s.bufferIndex,a=this.positionInBuffer(i,r);if(0===i.piece.bufferIndex&&s.end.line===this._lastChangeBufferPos.line&&s.end.column===this._lastChangeBufferPos.column&&n+s.length===e&&t.length<c)return this.appendToNode(i,t),void this.computeBufferMetadata();if(n===e)this.insertContentToNodeLeft(t,i),this._searchCache.validate(e);else if(n+i.piece.length>e){const e=[];let n=new p(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),this.offsetInBuffer(o,s.end)-this.offsetInBuffer(o,a));if(this.shouldCheckCRLF()&&this.endWithCR(t)){if(10===this.nodeCharCodeAt(i,r)){const e={line:n.start.line+1,column:0};n=new p(n.bufferIndex,e,n.end,this.getLineFeedCnt(n.bufferIndex,e,n.end),n.length-1),t+="\n"}}if(this.shouldCheckCRLF()&&this.startWithLF(t)){if(13===this.nodeCharCodeAt(i,r-1)){const n=this.positionInBuffer(i,r-1);this.deleteNodeTail(i,n),t="\r"+t,0===i.piece.length&&e.push(i)}else this.deleteNodeTail(i,a)}else this.deleteNodeTail(i,a);const c=this.createNewPieces(t);n.length>0&&this.rbInsertRight(i,n);let l=i;for(let e=0;e<c.length;e++)l=this.rbInsertRight(l,c[e]);this.deleteNodes(e)}else this.insertContentToNodeRight(t,i)}else{const e=this.createNewPieces(t);let i=this.rbInsertLeft(null,e[0]);for(let t=1;t<e.length;t++)i=this.rbInsertRight(i,e[t])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===o.Nc)return;const i=this.nodeAt(e),r=this.nodeAt(e+t),n=i.node,s=r.node;if(n===s){const s=this.positionInBuffer(n,i.remainder),a=this.positionInBuffer(n,r.remainder);if(i.nodeStartOffset===e){if(t===n.piece.length){const e=n.next();return(0,o.KI)(this,n),this.validateCRLFWithPrevNode(e),void this.computeBufferMetadata()}return this.deleteNodeHead(n,a),this._searchCache.validate(e),this.validateCRLFWithPrevNode(n),void this.computeBufferMetadata()}return i.nodeStartOffset+n.piece.length===e+t?(this.deleteNodeTail(n,s),this.validateCRLFWithNextNode(n),void this.computeBufferMetadata()):(this.shrinkNode(n,s,a),void this.computeBufferMetadata())}const a=[],c=this.positionInBuffer(n,i.remainder);this.deleteNodeTail(n,c),this._searchCache.validate(e),0===n.piece.length&&a.push(n);const l=this.positionInBuffer(s,r.remainder);this.deleteNodeHead(s,l),0===s.piece.length&&a.push(s);for(let e=n.next();e!==o.Nc&&e!==s;e=e.next())a.push(e);const d=0===n.piece.length?n.prev():n;this.deleteNodes(a),this.validateCRLFWithNextNode(d),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const r=t.piece,n={line:r.start.line+1,column:0},s=new p(r.bufferIndex,n,r.end,this.getLineFeedCnt(r.bufferIndex,n,r.end),r.length-1);t.piece=s,e+="\n",(0,o.Z2)(this,t,-1,-1),0===t.piece.length&&i.push(t)}const r=this.createNewPieces(e);let n=this.rbInsertLeft(t,r[r.length-1]);for(let e=r.length-2;e>=0;e--)n=this.rbInsertLeft(n,r[e]);this.validateCRLFWithPrevNode(n),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+="\n");const i=this.createNewPieces(e),r=this.rbInsertRight(t,i[0]);let n=r;for(let e=1;e<i.length;e++)n=this.rbInsertRight(n,i[e]);this.validateCRLFWithPrevNode(r)}positionInBuffer(e,t,i){const r=e.piece,n=e.piece.bufferIndex,s=this._buffers[n].lineStarts,o=s[r.start.line]+r.start.column+t;let a=r.start.line,c=r.end.line,l=0,d=0,u=0;for(;a<=c&&(l=a+(c-a)/2|0,u=s[l],l!==c);)if(d=s[l+1],o<u)c=l-1;else{if(!(o>=d))break;a=l+1}return i?(i.line=l,i.column=o-u,null):{line:l,column:o-u}}getLineFeedCnt(e,t,i){if(0===i.column)return i.line-t.line;const r=this._buffers[e].lineStarts;if(i.line===r.length-1)return i.line-t.line;const n=r[i.line+1],s=r[i.line]+i.column;if(n>s+1)return i.line-t.line;const o=s-1;return 13===this._buffers[e].buffer.charCodeAt(o)?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)(0,o.KI)(this,e[t])}createNewPieces(e){if(e.length>c){const t=[];for(;e.length>c;){const i=e.charCodeAt(65534);let r;13===i||i>=55296&&i<=56319?(r=e.substring(0,65534),e=e.substring(65534)):(r=e.substring(0,c),e=e.substring(c));const n=u(r);t.push(new p(this._buffers.length,{line:0,column:0},{line:n.length-1,column:r.length-n[n.length-1]},n.length-1,r.length)),this._buffers.push(new m(r,n))}const i=u(e);return t.push(new p(this._buffers.length,{line:0,column:0},{line:i.length-1,column:e.length-i[i.length-1]},i.length-1,e.length)),this._buffers.push(new m(e,i)),t}let t=this._buffers[0].buffer.length;const i=u(e,!1);let r=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&0!==t&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},r=this._lastChangeBufferPos;for(let e=0;e<i.length;e++)i[e]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(0!==t)for(let e=0;e<i.length;e++)i[e]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const n=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,o={line:s,column:n-this._buffers[0].lineStarts[s]},a=new p(0,r,o,this.getLineFeedCnt(0,r,o),n-t);return this._lastChangeBufferPos=o,[a]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let i=this.root,r="";const n=this._searchCache.get2(e);if(n){i=n.node;const s=this.getAccumulatedValue(i,e-n.nodeStartLineNumber-1),o=this._buffers[i.piece.bufferIndex].buffer,a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(n.nodeStartLineNumber+i.piece.lineFeedCnt!==e){const r=this.getAccumulatedValue(i,e-n.nodeStartLineNumber);return o.substring(a+s,a+r-t)}r=o.substring(a+s,a+i.piece.length)}else{let n=0;const s=e;for(;i!==o.Nc;)if(i.left!==o.Nc&&i.lf_left>=e-1)i=i.left;else{if(i.lf_left+i.piece.lineFeedCnt>e-1){const r=this.getAccumulatedValue(i,e-i.lf_left-2),o=this.getAccumulatedValue(i,e-i.lf_left-1),a=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:n,nodeStartLineNumber:s-(e-1-i.lf_left)}),a.substring(c+r,c+o-t)}if(i.lf_left+i.piece.lineFeedCnt===e-1){const t=this.getAccumulatedValue(i,e-i.lf_left-2),n=this._buffers[i.piece.bufferIndex].buffer,s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);r=n.substring(s+t,s+i.piece.length);break}e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right}}for(i=i.next();i!==o.Nc;){const e=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const n=this.getAccumulatedValue(i,0),s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r+=e.substring(s,s+n-t),r}{const t=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);r+=e.substr(t,i.piece.length)}i=i.next()}return r}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==o.Nc;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,r=this.positionInBuffer(e,t),n=r.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const t=this.getLineFeedCnt(e.piece.bufferIndex,i.start,r);if(t!==n)return{index:t,remainder:0}}return{index:n,remainder:r.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,r=this._buffers[i.bufferIndex].lineStarts,n=i.start.line+t+1;return n>i.end.line?r[i.end.line]+i.end.column-r[i.start.line]-i.start.column:r[n]-r[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,r=i.lineFeedCnt,n=this.offsetInBuffer(i.bufferIndex,i.end),s=t,a=this.offsetInBuffer(i.bufferIndex,s),c=this.getLineFeedCnt(i.bufferIndex,i.start,s),l=c-r,d=a-n,u=i.length+d;e.piece=new p(i.bufferIndex,i.start,s,c,u),(0,o.Z2)(this,e,d,l)}deleteNodeHead(e,t){const i=e.piece,r=i.lineFeedCnt,n=this.offsetInBuffer(i.bufferIndex,i.start),s=t,a=this.getLineFeedCnt(i.bufferIndex,s,i.end),c=a-r,l=n-this.offsetInBuffer(i.bufferIndex,s),d=i.length+l;e.piece=new p(i.bufferIndex,s,i.end,a,d),(0,o.Z2)(this,e,l,c)}shrinkNode(e,t,i){const r=e.piece,n=r.start,s=r.end,a=r.length,c=r.lineFeedCnt,l=t,d=this.getLineFeedCnt(r.bufferIndex,r.start,l),u=this.offsetInBuffer(r.bufferIndex,t)-this.offsetInBuffer(r.bufferIndex,n);e.piece=new p(r.bufferIndex,r.start,l,d,u),(0,o.Z2)(this,e,u-a,d-c);const h=new p(r.bufferIndex,i,s,this.getLineFeedCnt(r.bufferIndex,i,s),this.offsetInBuffer(r.bufferIndex,s)-this.offsetInBuffer(r.bufferIndex,i)),m=this.rbInsertRight(e,h);this.validateCRLFWithPrevNode(m)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+="\n");const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),r=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const n=u(t,!1);for(let e=0;e<n.length;e++)n[e]+=r;if(i){const e=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:r-e}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1));const s=this._buffers[0].lineStarts.length-1,a={line:s,column:this._buffers[0].buffer.length-this._buffers[0].lineStarts[s]},c=e.piece.length+t.length,l=e.piece.lineFeedCnt,d=this.getLineFeedCnt(0,e.piece.start,a),h=d-l;e.piece=new p(e.piece.bufferIndex,e.piece.start,a,d,c),this._lastChangeBufferPos=a,(0,o.Z2)(this,e,t.length,h)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let r=0;for(;t!==o.Nc;)if(t.size_left>e)t=t.left;else{if(t.size_left+t.piece.length>=e){r+=t.size_left;const i={node:t,remainder:e-t.size_left,nodeStartOffset:r};return this._searchCache.set(i),i}e-=t.size_left+t.piece.length,r+=t.size_left+t.piece.length,t=t.right}return null}nodeAt2(e,t){let i=this.root,r=0;for(;i!==o.Nc;)if(i.left!==o.Nc&&i.lf_left>=e-1)i=i.left;else{if(i.lf_left+i.piece.lineFeedCnt>e-1){const n=this.getAccumulatedValue(i,e-i.lf_left-2),s=this.getAccumulatedValue(i,e-i.lf_left-1);return r+=i.size_left,{node:i,remainder:Math.min(n+t-1,s),nodeStartOffset:r}}if(i.lf_left+i.piece.lineFeedCnt===e-1){const n=this.getAccumulatedValue(i,e-i.lf_left-2);if(n+t-1<=i.piece.length)return{node:i,remainder:n+t-1,nodeStartOffset:r};t-=i.piece.length-n;break}e-=i.lf_left+i.piece.lineFeedCnt,r+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==o.Nc;){if(i.piece.lineFeedCnt>0){const e=this.getAccumulatedValue(i,0),r=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,e),nodeStartOffset:r}}if(i.piece.length>=t-1){return{node:i,remainder:t-1,nodeStartOffset:this.offsetOfNode(i)}}t-=i.piece.length,i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],r=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(r)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&"\n"===this._EOL)}startWithLF(e){if("string"==typeof e)return 10===e.charCodeAt(0);if(e===o.Nc||0===e.piece.lineFeedCnt)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,r=t.start.line,n=i[r]+t.start.column;if(r===i.length-1)return!1;return!(i[r+1]>n+1)&&10===this._buffers[t.bufferIndex].buffer.charCodeAt(n)}endWithCR(e){return"string"==typeof e?13===e.charCodeAt(e.length-1):e!==o.Nc&&0!==e.piece.lineFeedCnt&&13===this.nodeCharCodeAt(e,e.piece.length-1)}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],r=this._buffers[e.piece.bufferIndex].lineStarts;let n;n=0===e.piece.end.column?{line:e.piece.end.line-1,column:r[e.piece.end.line]-r[e.piece.end.line-1]-1}:{line:e.piece.end.line,column:e.piece.end.column-1};const s=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new p(e.piece.bufferIndex,e.piece.start,n,a,s),(0,o.Z2)(this,e,-1,-1),0===e.piece.length&&i.push(e);const c={line:t.piece.start.line+1,column:0},l=t.piece.length-1,d=this.getLineFeedCnt(t.piece.bufferIndex,c,t.piece.end);t.piece=new p(t.piece.bufferIndex,c,t.piece.end,d,l),(0,o.Z2)(this,t,-1,-1),0===t.piece.length&&i.push(t);const u=this.createNewPieces("\r\n");this.rbInsertRight(e,u[0]);for(let e=0;e<i.length;e++)(0,o.KI)(this,i[e])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+="\n",1===i.piece.length)(0,o.KI)(this,i);else{const e=i.piece,t={line:e.start.line+1,column:0},r=e.length-1,n=this.getLineFeedCnt(e.bufferIndex,t,e.end);i.piece=new p(e.bufferIndex,t,e.end,n,r),(0,o.Z2)(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===o.Nc)return t(o.Nc);const i=this.iterate(e.left,t);return i?t(e)&&this.iterate(e.right,t):i}getNodeContent(e){if(e===o.Nc)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,r=this.offsetInBuffer(i.bufferIndex,i.start),n=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(r,n)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),r=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,r)}rbInsertRight(e,t){const i=new o.OF(t,1);i.left=o.Nc,i.right=o.Nc,i.parent=o.Nc,i.size_left=0,i.lf_left=0;if(this.root===o.Nc)this.root=i,i.color=0;else if(e.right===o.Nc)e.right=i,i.parent=e;else{const t=(0,o.xq)(e.right);t.left=i,i.parent=t}return(0,o.h4)(this,i),i}rbInsertLeft(e,t){const i=new o.OF(t,1);if(i.left=o.Nc,i.right=o.Nc,i.parent=o.Nc,i.size_left=0,i.lf_left=0,this.root===o.Nc)this.root=i,i.color=0;else if(e.left===o.Nc)e.left=i,i.parent=e;else{const t=(0,o.Q$)(e.left);t.right=i,i.parent=t}return(0,o.h4)(this,i),i}getContentOfSubTree(e){let t="";return this.iterate(e,(e=>(t+=this.getNodeContent(e),!0))),t}}},52623:function(e,t,i){i.d(t,{A:function(){return u}});var r=i(81557),n=i(88023),s=i(3918),o=i(82416),a=i(51968),c=i(16184),l=i(23949),d=i(7428);class u extends d.JT{constructor(e,t,i,n,s,o,c){super(),this._onDidChangeContent=this._register(new r.Q5),this.onDidChangeContent=this._onDidChangeContent.event,this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._pieceTree=new a.nD(e,i,c)}equals(e){return e instanceof u&&(this._BOM===e._BOM&&(this.getEOL()===e.getEOL()&&this._pieceTree.equal(e._pieceTree)))}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,r=this.getPositionAt(e),n=this.getPositionAt(i);return new s.e(r.lineNumber,r.column,n.lineNumber,n.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),r=this.getOffsetAt(e.endLineNumber,e.endColumn);let n=0;const s=this._getEndOfLine(t),o=this.getEOL();if(s.length!==o.length){n=(s.length-o.length)*(e.endLineNumber-e.startLineNumber)}return r-i+n}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const r=e.startLineNumber,s=e.endLineNumber;for(let t=r;t<=s;t++){const o=this.getLineContent(t),a=t===r?e.startColumn-1:0,c=t===s?e.endColumn-1:o.length;for(let e=a;e<c;e++)(0,n.ZG)(o.charCodeAt(e))?(i+=1,e+=1):i+=1}return i+=this._getEndOfLine(t).length*(s-r),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){const t=(0,n.LC)(this.getLineContent(e));return-1===t?0:t+1}getLineLastNonWhitespaceColumn(e){const t=(0,n.ow)(this.getLineContent(e));return-1===t?0:t+2}_getEndOfLine(e){switch(e){case 1:return"\n";case 2:return"\r\n";case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let r=this._mightContainRTL,s=this._mightContainUnusualLineTerminators,a=this._mightContainNonBasicASCII,d=!0,h=[];for(let t=0;t<e.length;t++){const i=e[t];d&&i._isTracked&&(d=!1);const o=i.range;if(i.text){let e=!0;a||(e=!(0,n.$i)(i.text),a=e),!r&&e&&(r=(0,n.Ut)(i.text)),!s&&e&&(s=(0,n.ab)(i.text))}let l="",u=0,p=0,m=0;if(i.text){let e;[u,p,m,e]=(0,c.Q)(i.text);const t=this.getEOL();l=0===e||e===("\r\n"===t?2:1)?i.text:i.text.replace(/\r\n|\r|\n/g,t)}h[t]={sortIndex:t,identifier:i.identifier||null,range:o,rangeOffset:this.getOffsetAt(o.startLineNumber,o.startColumn),rangeLength:this.getValueLengthInRange(o),text:l,eolCount:u,firstLineLength:p,lastLineLength:m,forceMoveMarkers:Boolean(i.forceMoveMarkers),isAutoWhitespaceEdit:i.isAutoWhitespaceEdit||!1}}h.sort(u._sortOpsAscending);let p=!1;for(let e=0,t=h.length-1;e<t;e++){const t=h[e].range.getEndPosition(),i=h[e+1].range.getStartPosition();if(i.isBeforeOrEqual(t)){if(i.isBefore(t))throw new Error("Overlapping ranges are not allowed!");p=!0}}d&&(h=this._reduceOperations(h));const m=i||t?u._getInverseEditRanges(h):[],f=[];if(t)for(let e=0;e<h.length;e++){const t=h[e],i=m[e];if(t.isAutoWhitespaceEdit&&t.range.isEmpty())for(let e=i.startLineNumber;e<=i.endLineNumber;e++){let r="";e===i.startLineNumber&&(r=this.getLineContent(t.range.startLineNumber),-1!==(0,n.LC)(r))||f.push({lineNumber:e,oldContent:r})}}let g=null;if(i){let e=0;g=[];for(let t=0;t<h.length;t++){const i=h[t],r=m[t],n=this.getValueInRange(i.range),s=i.rangeOffset+e;e+=i.text.length-n.length,g[t]={sortIndex:i.sortIndex,identifier:i.identifier,range:r,text:n,textChange:new l.q(i.rangeOffset,n,s,i.text)}}p||g.sort(((e,t)=>e.sortIndex-t.sortIndex))}this._mightContainRTL=r,this._mightContainUnusualLineTerminators=s,this._mightContainNonBasicASCII=a;const v=this._doApplyEdits(h);let _=null;if(t&&f.length>0){f.sort(((e,t)=>t.lineNumber-e.lineNumber)),_=[];for(let e=0,t=f.length;e<t;e++){const t=f[e].lineNumber;if(e>0&&f[e-1].lineNumber===t)continue;const i=f[e].oldContent,r=this.getLineContent(t);0!==r.length&&r!==i&&-1===(0,n.LC)(r)&&_.push(t)}}return this._onDidChangeContent.fire(),new o.je(g,v,_)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,r=e[e.length-1].range,n=new s.e(i.startLineNumber,i.startColumn,r.endLineNumber,r.endColumn);let o=i.startLineNumber,a=i.startColumn;const l=[];for(let i=0,r=e.length;i<r;i++){const r=e[i],n=r.range;t=t||r.forceMoveMarkers,l.push(this.getValueInRange(new s.e(o,a,n.startLineNumber,n.startColumn))),r.text.length>0&&l.push(r.text),o=n.endLineNumber,a=n.endColumn}const d=l.join(""),[u,h,p]=(0,c.Q)(d);return{sortIndex:0,identifier:e[0].identifier,range:n,rangeOffset:this.getOffsetAt(n.startLineNumber,n.startColumn),rangeLength:this.getValueLengthInRange(n,0),text:d,eolCount:u,firstLineLength:h,lastLineLength:p,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(u._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const r=e[i],n=r.range.startLineNumber,o=r.range.startColumn,a=r.range.endLineNumber,c=r.range.endColumn;if(n===a&&o===c&&0===r.text.length)continue;r.text?(this._pieceTree.delete(r.rangeOffset,r.rangeLength),this._pieceTree.insert(r.rangeOffset,r.text,!0)):this._pieceTree.delete(r.rangeOffset,r.rangeLength);const l=new s.e(n,o,a,c);t.push({range:l,rangeLength:r.rangeLength,text:r.text,rangeOffset:r.rangeOffset,forceMoveMarkers:r.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,r){return this._pieceTree.findMatchesLineByLine(e,t,i,r)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){const i=e.startLineNumber,r=e.startColumn,[n,o,a]=(0,c.Q)(t);let l;if(t.length>0){const e=n+1;l=1===e?new s.e(i,r,i,r+o):new s.e(i,r,i+e-1,a+1)}else l=new s.e(i,r,i,r);return l}static _getInverseEditRanges(e){const t=[];let i=0,r=0,n=null;for(let o=0,a=e.length;o<a;o++){const a=e[o];let c,l,d;if(n?n.range.endLineNumber===a.range.startLineNumber?(c=i,l=r+(a.range.startColumn-n.range.endColumn)):(c=i+(a.range.startLineNumber-n.range.endLineNumber),l=a.range.startColumn):(c=a.range.startLineNumber,l=a.range.startColumn),a.text.length>0){const e=a.eolCount+1;d=1===e?new s.e(c,l,c,l+a.firstLineLength):new s.e(c,l,c+e-1,a.lastLineLength+1)}else d=new s.e(c,l,c,l);i=d.endLineNumber,r=d.endColumn,t.push(d),n=a}return t}static _sortOpsAscending(e,t){const i=s.e.compareRangesUsingEnds(e.range,t.range);return 0===i?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=s.e.compareRangesUsingEnds(e.range,t.range);return 0===i?t.sortIndex-e.sortIndex:-i}}},894:function(e,t,i){i.d(t,{M:function(){return a}});var r=i(88023),n=i(51968),s=i(52623);class o{constructor(e,t,i,r,n,s,o,a,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=r,this._crlf=n,this._containsRTL=s,this._containsUnusualLineTerminators=o,this._isBasicASCII=a,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return 0===t?1===e?"\n":"\r\n":i>t/2?"\r\n":"\n"}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&("\r\n"===t&&(this._cr>0||this._lf>0)||"\n"===t&&(this._cr>0||this._crlf>0)))for(let e=0,r=i.length;e<r;e++){const r=i[e].buffer.replace(/\r\n|\r|\n/g,t),s=(0,n.Xp)(r);i[e]=new n.Lv(r,s)}const r=new s.A(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:r,disposable:r}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}}class a{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(0===e.length)return;0===this.chunks.length&&(0,r.uS)(e)&&(this.BOM=r.c1,e=e.substr(1));const t=e.charCodeAt(e.length-1);13===t||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){(t||0!==e.length)&&(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=(0,n.Nr)(this._tmpLineStarts,e);this.chunks.push(new n.Lv(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=(0,r.Ut)(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=(0,r.ab)(e)))}finish(e=!0){return this._finish(),new o(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(0===this.chunks.length&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=(0,n.Xp)(e.buffer);e.lineStarts=t,13===this._previousChar&&this.cr++}}}},9362:function(e,t,i){i.d(t,{C:function(){return o},O:function(){return a}});var r=i(53976),n=i(11547);function s(e){for(let t=0,i=e.length;t<i;t+=4){const i=e[t+0],r=e[t+1],n=e[t+2],s=e[t+3];e[t+0]=s,e[t+1]=n,e[t+2]=r,e[t+3]=i}}function o(e){const t=new Uint32Array(function(e){let t=0;if(t+=2,"full"===e.type)t+=1+e.data.length;else{t+=1,t+=3*e.deltas.length;for(const i of e.deltas)i.data&&(t+=i.data.length)}return t}(e));let i=0;if(t[i++]=e.id,"full"===e.type)t[i++]=1,t[i++]=e.data.length,t.set(e.data,i),i+=e.data.length;else{t[i++]=2,t[i++]=e.deltas.length;for(const r of e.deltas)t[i++]=r.start,t[i++]=r.deleteCount,r.data?(t[i++]=r.data.length,t.set(r.data,i),i+=r.data.length):t[i++]=0}return function(e){const t=new Uint8Array(e.buffer,e.byteOffset,4*e.length);return(0,n.r)()||s(t),r.KN.wrap(t)}(t)}function a(e){const t=function(e){const t=e.buffer;if((0,n.r)()||s(t),t.byteOffset%4==0)return new Uint32Array(t.buffer,t.byteOffset,t.length/4);{const e=new Uint8Array(t.byteLength);return e.set(t),new Uint32Array(e.buffer,e.byteOffset,e.length/4)}}(e);let i=0;const r=t[i++];if(1===t[i++]){const e=t[i++],n=t.subarray(i,i+e);return i+=e,{id:r,type:"full",data:n}}const o=t[i++],a=[];for(let e=0;e<o;e++){const r=t[i++],n=t[i++],s=t[i++];let o;s>0&&(o=t.subarray(i,i+s),i+=s),a[e]={start:r,deleteCount:n,data:o}}return{id:r,type:"delta",deltas:a}}},94783:function(e,t,i){i.d(t,{R:function(){return s}});var r=i(81557),n=i(7428);class s{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new r.Q5,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),(0,n.OF)((()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))}))}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();const i=new o(this,e,t);return this._factories.set(e,i),(0,n.OF)((()=>{const t=this._factories.get(e);t&&t===i&&(this._factories.delete(e),t.dispose())}))}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const t=this._factories.get(e);return!(t&&!t.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}}class o extends n.JT{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}},67525:function(e,t,i){i.d(t,{C$:function(){return c},OQ:function(){return l},aj:function(){return d}});let r="undefined"!=typeof document&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function n(e,t){let i;return i=0===t.length?e:e.replace(/\{(\d+)\}/g,((e,i)=>{const r=i[0],n=t[r];let s=e;return"string"==typeof n?s=n:"number"!=typeof n&&"boolean"!=typeof n&&null!=n||(s=String(n)),s})),r&&(i="［"+i.replace(/[aouei]/g,"$&$&")+"］"),i}let s,o=!1,a={};function c(e,t,i,...r){o=!0;const s="object"==typeof t?t.key:t;return n((a[e]??{})[s]??i,r)}function l(e,t,i,...r){o=!0;const s="object"==typeof t?t.key:t;return{value:n((a[e]??{})[s]??i,r),original:n(i,r)}}function d(e){return s}},1130:function(e,t,i){i.d(t,{Z:function(){return l}});var r=i(54316),n=i(67525);const s="vs/platform/contextkey/common/scanner";function o(...e){switch(e.length){case 1:return(0,n.C$)(s,0,"Did you mean {0}?",e[0]);case 2:return(0,n.C$)(s,1,"Did you mean {0} or {1}?",e[0],e[1]);case 3:return(0,n.C$)(s,2,"Did you mean {0}, {1} or {2}?",e[0],e[1],e[2]);default:return}}const a=(0,n.C$)(s,3,"Did you forget to open or close the quote?"),c=(0,n.C$)(s,4,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");class l{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:case 8:return">=";case 9:return"=~";case 10:case 17:case 18:case 19:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 20:return"EOF";default:throw(0,r.L6)(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static{this._regexFlags=new Set(["i","g","s","m","y","u"].map((e=>e.charCodeAt(0))))}static{this._keywords=new Map([["not",14],["in",13],["false",12],["true",11]])}get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();){this._start=this._current;switch(this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const e=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:e})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const e=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:e})}else this._match(126)?this._addToken(9):this._error(o("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(o("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(o("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return!this._isAtEnd()&&(this._input.charCodeAt(this._current)===e&&(this._current++,!0))}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),r={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(r)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=l._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;39!==this._peek()&&!this._isAtEnd();)this._advance();this._isAtEnd()?this._error(a):(this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1}))}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length)return this._current=e,void this._error(c);const r=this._input.charCodeAt(e);if(t)t=!1;else{if(47===r&&!i){e++;break}91===r?i=!0:92===r?t=!0:93===r&&(i=!1)}e++}for(;e<this._input.length&&l._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const r=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:r,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}}},29523:function(e,t,i){i.d(t,{S:function(){return s}});var r=i(54316),n=i(26258);const s=new class{constructor(){this._generators=new Map,this._cache=new WeakMap}register(e,t){this._generators.set(e,t)}readActivationEvents(e){return this._cache.has(e)||this._cache.set(e,this._readActivationEvents(e)),this._cache.get(e)}createActivationEventsMap(e){const t=Object.create(null);for(const i of e){const e=this.readActivationEvents(i);e.length>0&&(t[n.kP.toKey(i.identifier)]=e)}return t}_readActivationEvents(e){if(void 0===e.main&&void 0===e.browser)return[];const t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let i=0;i<t.length;i++)"onUri"===t[i]&&(t[i]=`onUri:${n.kP.toKey(e.identifier)}`);if(!e.contributes)return t;for(const i in e.contributes){const n=this._generators.get(i);if(!n)continue;const s=e.contributes[i],o=Array.isArray(s)?s:[s];try{n(o,t)}catch(e){(0,r.dL)(e)}}return t}}},80165:function(e,t,i){i.d(t,{M:function(){return r}});class r{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}},20658:function(e,t,i){i.d(t,{d:function(){return o},z:function(){return s}});var r=i(80165);const n=[];function s(e,t,i){t instanceof r.M||(t=new r.M(t,[],Boolean(i))),n.push([e,t])}function o(){return n}},99911:function(e,t,i){i.d(t,{F:function(){return p}});var r=i(35820),n=i(54316),s=i(7428),o=i(80165);class a{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}}class c{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())0===t.outgoing.size&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),r=this.lookupOrInsertNode(t);i.outgoing.set(r.key,r),r.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const e of this._nodes.values())e.outgoing.delete(t),e.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new a(t,e),this._nodes.set(t,i)),i}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return 0===this._nodes.size}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}\n\t(-> incoming)[${[...i.incoming.keys()].join(", ")}]\n\t(outgoing ->)[${[...i.outgoing.keys()].join(",")}]\n`);return e.join("\n")}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),r=this._findCycle(t,i);if(r)return r}}_findCycle(e,t){for(const[i,r]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const e=this._findCycle(r,t);if(e)return e;t.delete(i)}}}var l=i(28019),d=i(80195),u=i(65161);class h extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: \n${e.toString()}`}}class p{constructor(e=new d.y,t=!1,i,r=false){this._services=e,this._strict=t,this._parent=i,this._enableTracing=r,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(l.TG,this),this._globalGraph=r?i?._globalGraph??new c((e=>e)):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,(0,s.B9)(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)(0,s.Wf)(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e){this._throwIfDisposed();const t=new class extends p{dispose(){this._children.delete(t),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(t),t}invokeFunction(e,...t){this._throwIfDisposed();const i=m.traceInvocation(this._enableTracing,e);let r=!1;try{return e({get:e=>{if(r)throw(0,n.L6)("service accessor is only valid during the invocation of its target method");const t=this._getOrCreateServiceInstance(e,i);if(!t)throw new Error(`[invokeFunction] unknown service '${e}'`);return t}},...t)}finally{r=!0,i.stop()}}createInstance(e,...t){let i,r;return this._throwIfDisposed(),e instanceof o.M?(i=m.traceCreation(this._enableTracing,e.ctor),r=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=m.traceCreation(this._enableTracing,e),r=this._createInstance(e,t,i)),i.stop(),r}_createInstance(e,t=[],i){const r=l.I8.getServiceDependencies(e).sort(((e,t)=>e.index-t.index)),n=[];for(const t of r){const r=this._getOrCreateServiceInstance(t.id,i);r||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${t.id}.`,!1),n.push(r)}const s=r.length>0?r[0].index:t.length;if(t.length!==s){console.trace(`[createInstance] First service dependency of ${e.name} at position ${s+1} conflicts with ${t.length} static arguments`);const i=s-t.length;t=i>0?t.concat(new Array(i)):t.slice(0,s)}return Reflect.construct(e,t.concat(n))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof o.M)this._services.set(e,t);else{if(!this._parent)throw new Error("illegalState - setting UNKNOWN service instance");this._parent._setCreatedServiceInstance(e,t)}}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof o.M?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){const r=new c((e=>e.id.toString()));let n=0;const s=[{id:e,desc:t,_trace:i}];for(;s.length;){const t=s.pop();if(r.lookupOrInsertNode(t),n++>1e3)throw new h(r);for(const i of l.I8.getServiceDependencies(t.desc.ctor)){const n=this._getServiceInstanceOrDescriptor(i.id);if(n||this._throwIfStrict(`[createInstance] ${e} depends on ${i.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(t.id),String(i.id)),n instanceof o.M){const e={id:i.id,desc:n,_trace:t._trace.branch(i.id,!0)};r.lookup(e)||s.push(e),r.insertEdge(t,e)}}}for(;;){const e=r.roots();if(0===e.length){if(!r.isEmpty())throw new h(r);break}for(const{data:t}of e){if(this._getServiceInstanceOrDescriptor(t.id)instanceof o.M){const e=this._createServiceInstanceWithOwner(t.id,t.desc.ctor,t.desc.staticArguments,t.desc.supportsDelayedInstantiation,t._trace);this._setCreatedServiceInstance(t.id,e)}r.removeNode(t)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],r,n){if(this._services.get(e)instanceof o.M)return this._createServiceInstance(e,t,i,r,n,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,r,n);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],n,o,a){if(n){const n=new p(void 0,this._strict,this,this._enableTracing);n._globalGraphImplicitDependency=String(e);const c=new Map,l=new r.R5((()=>{const e=n._createInstance(t,i,o);for(const[t,i]of c){const r=e[t];if("function"==typeof r)for(const t of i)t.disposable=r.apply(e,t.listener)}return c.clear(),a.add(e),e}));return new Proxy(Object.create(null),{get(e,t){if(!l.isInitialized&&"string"==typeof t&&(t.startsWith("onDid")||t.startsWith("onWill"))){let e=c.get(t);e||(e=new u.S,c.set(t,e));return(i,r,n)=>{if(l.isInitialized)return l.value[t](i,r,n);{const t={listener:[i,r,n],disposable:void 0},o=e.push(t);return(0,s.OF)((()=>{o(),t.disposable?.dispose()}))}}}if(t in e)return e[t];const i=l.value;let r=i[t];return"function"!=typeof r||(r=r.bind(i),e[t]=r),r},set(e,t,i){return l.value[t]=i,!0},getPrototypeOf(e){return t.prototype}})}{const e=this._createInstance(t,i,o);return a.add(e),e}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}class m{static{this.all=new Set}static{this._None=new class extends m{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(e,t){return e?new m(2,t.name||(new Error).stack.split("\n").slice(3,4).join("\n")):m._None}static traceCreation(e,t){return e?new m(1,t.name):m._None}static{this._totals=0}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new m(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;m._totals+=e;let t=!1;const i=[`${1===this.type?"CREATE":"CALL"} ${this.name}`,`${function e(i,r){const n=[],s=new Array(i+1).join("\t");for(const[o,a,c]of r._dep)if(a&&c){t=!0,n.push(`${s}CREATES -> ${o}`);const r=e(i+1,c);r&&n.push(r)}else n.push(`${s}uses -> ${o}`);return n.join("\n")}(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${m._totals.toFixed(2)}ms)`];(e>2||t)&&m.all.add(i.join("\n"))}}},80195:function(e,t,i){i.d(t,{y:function(){return r}});class r{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}},8561:function(e,t,i){i.d(t,{I:function(){return s}});var r=i(81557),n=i(88001);const s={JSONContribution:"base.contributions.json"};const o=new class{constructor(){this._onDidChangeSchema=new r.Q5,this.onDidChangeSchema=this._onDidChangeSchema.event,this.schemasById={}}registerSchema(e,t){var i;this.schemasById[(i=e,i.length>0&&"#"===i.charAt(i.length-1)?i.substring(0,i.length-1):i)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}};n.B.add(s.JSONContribution,o)},26713:function(e,t,i){i.d(t,{V:function(){return n},y:function(){return s}});var r=i(28019);const n=(0,r.yh)("logService"),s=(0,r.yh)("loggerService")},80661:function(e,t,i){i.d(t,{$:function(){return s}});var r=i(7428),n=i(525);class s extends r.JT{constructor(e,t=[]){super(),this.logger=new n.qA([e,...t]),this._register(e.onDidChangeLogLevel((e=>this.setLevel(e))))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}flush(){this.logger.flush()}}},39989:function(e,t,i){i.d(t,{h:function(){return r}});const r="vscode://schemas/vscode-product"},25957:function(e,t,i){i.d(t,{U:function(){return r}});const r=(0,i(28019).yh)("requestService")},92206:function(e,t,i){i.d(t,{$:function(){return r}});class r{constructor(e){this._callback=e,this._terminalBufferMap=new Map}dispose(){for(const e of this._terminalBufferMap.values())e.dispose()}startBuffering(e,t,i=5){const r=t((t=>{const n="string"==typeof t?t:t.data;let s=this._terminalBufferMap.get(e);if(s)return void s.data.push(n);const o=setTimeout((()=>this.flushBuffer(e)),i);s={data:[n],timeoutId:o,dispose:()=>{clearTimeout(o),this.flushBuffer(e),r.dispose()}},this._terminalBufferMap.set(e,s)}));return r}stopBuffering(e){const t=this._terminalBufferMap.get(e);t?.dispose()}flushBuffer(e){const t=this._terminalBufferMap.get(e);t&&(this._terminalBufferMap.delete(e),this._callback(e,t.data.join("")))}}},14375:function(e,t,i){var r;i.d(t,{i:function(){return r}}),function(e){e[e.Complete=100]="Complete",e[e.Partial=50]="Partial",e[e.None=0]="None"}(r||(r={}))},76643:function(e,t,i){var r=i(20658),n=i(92231),s=i(89608),o=i(50365),a=i(63537),c=i(85315),l=i(1663),d=i(82209),u=i(87958),h=i(56687),p=i(28200),m=i(34142),f=i(80974),g=i(43878),v=i(72124),_=i(77600),b=i(52202),w=i(8685),y=i(3560),x=i(53917),C=i(71484),S=i(26713),E=i(98668),D=i(86540),k=i(6263),I=i(11301),P=i(76870),T=i(60192);(0,r.z)(D.O,D.I,1),(0,r.z)(S.y,C.m,1),(0,r.z)(g.J,g.H,1),(0,r.z)(c.f7,c.jK,0),(0,r.z)(I.E,I.j,0),(0,r.z)(P.X,P.Q,0),(0,r.z)(a.E1,a.T_,0),(0,r.z)(_.a,_.L,0),(0,r.z)(h.gM,h.uU,0),(0,r.z)(o.W,o.w,0),(0,r.z)(l.T,l.W,0),(0,r.z)(k.W,k.b,0),(0,r.z)(b.G,b.J,0),(0,r.z)(n.U,n.X,1),(0,r.z)(p.FR,p.dX,0),(0,r.z)(m.W,m.Y,0),(0,r.z)(u.h2,u.TE,0),(0,r.z)(d.$3,d.Ry,0),(0,r.z)(T.P,T.C,0),(0,r.z)(f.rd,f.Ce,0),(0,r.z)(v.V,v.x,0),(0,r.z)(s.w,s.M,0),(0,r.z)(w.Z,w.p,0),(0,r.z)(y.fv,y.wM,0),(0,r.z)(x.v,x.y,0),(0,r.z)(E.w,E.Y,0)},43878:function(e,t,i){i.d(t,{H:function(){return l},J:function(){return c}});var r=i(45493),n=i(28019),s=i(26713),o=i(78293),a=i(82722);const c=(0,n.yh)("IExtHostApiDeprecationService");let l=class{constructor(e,t){this._extHostLogService=t,this._reportedUsages=new Set,this._telemetryShape=e.getProxy(o.Tr.MainThreadTelemetry)}report(e,t,i){const r=this.getUsageKey(e,t);this._reportedUsages.has(r)||(this._reportedUsages.add(r),t.isUnderDevelopment&&this._extHostLogService.warn(`[Deprecation Warning] '${e}' is deprecated. ${i}`),this._telemetryShape.$publicLog2("extHostDeprecatedApiUsage",{extensionId:t.identifier.value,apiId:e}))}getUsageKey(e,t){return`${e}-${t.identifier.value}`}};l=(0,r.g)([(0,r.f)(0,a.O),(0,r.f)(1,s.V)],l)},11301:function(e,t,i){i.d(t,{E:function(){return u},j:function(){return h}});var r=i(45493),n=i(81557),s=i(78293),o=i(30874),a=i(26258),c=i(22837),l=i(28019),d=i(82722);const u=(0,l.yh)("IExtHostAuthentication");let h=class{constructor(e){this._authenticationProviders=new Map,this._onDidChangeSessions=new n.Q5,this.onDidChangeSessions=this._onDidChangeSessions.event,this._getSessionTaskSingler=new p,this._getSessionsTaskSingler=new p,this._proxy=e.getProxy(s.Tr.MainThreadAuthentication)}async getSession(e,t,i,r={}){const n=a.kP.toKey(e.identifier),s=[...i].sort().join(" ");return await this._getSessionTaskSingler.getOrCreate(`${n} ${t} ${s}`,(async()=>{await this._proxy.$ensureProvider(t);const s=e.displayName||e.name;return this._proxy.$getSession(t,i,n,s,r)}))}async getSessions(e,t,i){const r=a.kP.toKey(e.identifier),n=[...i].sort().join(" ");return await this._getSessionsTaskSingler.getOrCreate(`${r} ${n}`,(async()=>{await this._proxy.$ensureProvider(t);const n=e.displayName||e.name;return this._proxy.$getSessions(t,i,r,n)}))}async removeSession(e,t){const i=this._authenticationProviders.get(e);return i?i.provider.removeSession(t):this._proxy.$removeSession(e,t)}registerAuthenticationProvider(e,t,i,r){if(this._authenticationProviders.get(e))throw new Error(`An authentication provider with id '${e}' is already registered.`);this._authenticationProviders.set(e,{label:t,provider:i,options:r??{supportsMultipleAccounts:!1}});const n=i.onDidChangeSessions((t=>this._proxy.$sendDidChangeSessions(e,t)));return this._proxy.$registerAuthenticationProvider(e,t,r?.supportsMultipleAccounts??!1),new o.JTr((()=>{n.dispose(),this._authenticationProviders.delete(e),this._proxy.$unregisterAuthenticationProvider(e)}))}$createSession(e,t,i){const r=this._authenticationProviders.get(e);if(r)return Promise.resolve(r.provider.createSession(t,i));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$removeSession(e,t){const i=this._authenticationProviders.get(e);if(i)return Promise.resolve(i.provider.removeSession(t));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$getSessions(e,t){const i=this._authenticationProviders.get(e);if(i)return Promise.resolve(i.provider.getSessions(t));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$onDidChangeAuthenticationSessions(e,t){return e.startsWith(c.b)||this._onDidChangeSessions.fire({provider:{id:e,label:t}}),Promise.resolve()}};h=(0,r.g)([(0,r.f)(0,d.O)],h);class p{constructor(){this._inFlightPromises=new Map}getOrCreate(e,t){const i=this._inFlightPromises.get(e);if(i)return i;const r=t().finally((()=>this._inFlightPromises.delete(e)));return this._inFlightPromises.set(e,r),r}}},85315:function(e,t,i){i.d(t,{SF:function(){return P},_m:function(){return T},b9:function(){return A},f7:function(){return k},jK:function(){return D}});var r=i(45493),n=i(47635),s=i(30874),o=i(17430),a=i(82998),c=i(78293),l=i(78074),d=i(26713),u=i(59267),h=i(3918),p=i(20495),m=i(42731),f=i(7428),g=i(28019),v=i(82722),_=i(34472),b=i(53976),w=i(92962),y=i(36994),x=i(43064),C=i(73426),S=i(3560),E=i(92004);let D=class{#e;#t;#i;constructor(e,t,i){this._commands=new Map,this._apiCommands=new Map,this.#e=e.getProxy(c.Tr.MainThreadCommands),this._logService=t,this.#i=i,this.#t=e.getProxy(c.Tr.MainThreadTelemetry),this.converter=new I(this,(e=>{const t=this._apiCommands.get(e);return t?.result===T.Void?t:void 0}),t),this._argumentProcessors=[{processArgument(e){return(0,u.wL)(e)}},{processArgument(e){return(0,a.rs)(e,(function(e){return h.e.isIRange(e)?o.e6.to(e):p.L.isIPosition(e)?o.Ly.to(e):h.e.isIRange(e.range)&&m.ov.isUri(e.uri)?o.xh.to(e):e instanceof b.KN?e.buffer.buffer:Array.isArray(e)?void 0:e}))}}]}registerArgumentProcessor(e){this._argumentProcessors.push(e)}registerApiCommand(e){const t=this.registerCommand(!1,e.id,(async(...t)=>{const i=e.args.map(((i,r)=>{if(!i.validate(t[r]))throw new Error(`Invalid argument '${i.name}' when running '${e.id}', received: ${"object"==typeof t[r]?JSON.stringify(t[r],null,"\t"):t[r]} `);return i.convert(t[r])})),r=await this.executeCommand(e.internalId,...i);return e.result.convert(r,t,this.converter)}),void 0,{description:e.description,args:e.args,returns:e.result.description});return this._apiCommands.set(e.id,e),new s.JTr((()=>{t.dispose(),this._apiCommands.delete(e.id)}))}registerCommand(e,t,i,r,n,o){if(this._logService.trace("ExtHostCommands#registerCommand",t),!t.trim().length)throw new Error("invalid id");if(this._commands.has(t))throw new Error(`command '${t}' already exists`);return this._commands.set(t,{callback:i,thisArg:r,metadata:n,extension:o}),e&&this.#e.$registerCommand(t),new s.JTr((()=>{this._commands.delete(t)&&e&&this.#e.$unregisterCommand(t)}))}executeCommand(e,...t){return this._logService.trace("ExtHostCommands#executeCommand",e),this._doExecuteCommand(e,t,!0)}async _doExecuteCommand(e,t,i){if(this._commands.has(e))return this.#e.$fireCommandActivationEvent(e),this._executeContributedCommand(e,t,!1);{let r=!1;const n=(0,a.rs)(t,(function(e){return e instanceof s.Lyo?o.Ly.from(e):e instanceof s.e6w?o.e6.from(e):e instanceof s.YeX?o.xh.from(e):s.XsU.isNotebookRange(e)?o.Xs.from(e):e instanceof ArrayBuffer?(r=!0,b.KN.wrap(new Uint8Array(e))):e instanceof Uint8Array?(r=!0,b.KN.wrap(e)):e instanceof b.KN?(r=!0,e):Array.isArray(e)?void 0:e}));try{const t=await this.#e.$executeCommand(e,r?new w.ky(n):n,i);return(0,u.wL)(t)}catch(i){if(i instanceof Error&&"$executeCommand:retry"===i.message)return this._doExecuteCommand(e,t,!1);throw i}}}async _executeContributedCommand(e,t,i){const r=this._commands.get(e);if(!r)throw new Error("Unknown command");const{callback:s,thisArg:o,metadata:a}=r;if(a?.args)for(let i=0;i<a.args.length;i++)try{(0,n.Nf)(t[i],a.args[i].constraint)}catch(t){throw new Error(`Running the contributed command: '${e}' failed. Illegal argument '${a.args[i].name}' - ${a.args[i].description}`)}const c=x.G.create();try{return await s.apply(o,t)}catch(n){if(e===this.converter.delegatingCommandId){const i=this.converter.getActualCommand(...t);i&&(e=i.command)}if(this._logService.error(n,e,r.extension?.identifier),!i)throw n;if(r.extension?.identifier){const e=this.#i.onExtensionError(r.extension.identifier,n);this._logService.trace("forwarded error to extension?",e,r.extension?.identifier)}throw new class extends Error{constructor(){super((0,y.yJ)(n)),this.id=e,this.source=r.extension?.displayName??r.extension?.name}}}finally{this._reportTelemetry(r,e,c.elapsed())}}_reportTelemetry(e,t,i){e.extension&&this.#t.$publicLog2("Extension:ActionExecuted",{extensionId:e.extension.identifier.value,id:new C.NE(t),duration:i})}$executeContributedCommand(e,...t){this._logService.trace("ExtHostCommands#$executeContributedCommand",e);const i=this._commands.get(e);return i?(t=t.map((e=>this._argumentProcessors.reduce(((e,t)=>t.processArgument(e,i.extension?.identifier)),e))),this._executeContributedCommand(e,t,!0)):Promise.reject(new Error(`Contributed command '${e}' does not exist.`))}getCommands(e=!1){return this._logService.trace("ExtHostCommands#getCommands",e),this.#e.$getCommands().then((t=>(e&&(t=t.filter((e=>"_"!==e[0]))),t)))}$getContributedCommandMetadata(){const e=Object.create(null);for(const[t,i]of this._commands){const{metadata:r}=i;r&&(e[t]=r)}return Promise.resolve(e)}};D=(0,r.g)([(0,r.f)(0,v.O),(0,r.f)(1,d.V),(0,r.f)(2,S.fv)],D);const k=(0,g.yh)("IExtHostCommands");class I{constructor(e,t,i){this._commands=e,this._lookupApiCommand=t,this._logService=i,this.delegatingCommandId=`__vsc${(0,E.R)()}`,this._cache=new Map,this._cachIdPool=0,this._commands.registerCommand(!0,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,t){if(!e)return;const i={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return i;const r=this._lookupApiCommand(e.command);if(r)i.id=r.internalId,i.arguments=r.args.map(((t,i)=>t.convert(e.arguments&&e.arguments[i])));else if((0,l.Of)(e.arguments)){const r=`${e.command} /${++this._cachIdPool}`;this._cache.set(r,e),t.add((0,f.OF)((()=>{this._cache.delete(r),this._logService.trace("CommandsConverter#DISPOSE",r)}))),i.$ident=r,i.id=this.delegatingCommandId,i.arguments=[r],this._logService.trace("CommandsConverter#CREATE",e.command,r)}return i}fromInternal(e){return"string"==typeof e.$ident?this._cache.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){const t=this.getActualCommand(...e);return this._logService.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this._commands.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}}class P{static{this.Uri=new P("uri","Uri of a text document",(e=>m.ov.isUri(e)),(e=>e))}static{this.Position=new P("position","A position in a text document",(e=>s.Lyo.isPosition(e)),o.Ly.from)}static{this.Range=new P("range","A range in a text document",(e=>s.e6w.isRange(e)),o.e6.from)}static{this.Selection=new P("selection","A selection in a text document",(e=>s.Y19.isSelection(e)),o.Y1.from)}static{this.Number=new P("number","",(e=>"number"==typeof e),(e=>e))}static{this.String=new P("string","",(e=>"string"==typeof e),(e=>e))}static{this.StringArray=P.Arr(P.String)}static Arr(e){return new P(`${e.name}_array`,`Array of ${e.name}, ${e.description}`,(t=>Array.isArray(t)&&t.every((t=>e.validate(t)))),(t=>t.map((t=>e.convert(t)))))}static{this.CallHierarchyItem=new P("item","A call hierarchy item",(e=>e instanceof s.llk),o.ll.from)}static{this.TypeHierarchyItem=new P("item","A type hierarchy item",(e=>e instanceof s.fQK),o.fQ.from)}static{this.TestItem=new P("testItem","A VS Code TestItem",(e=>e instanceof _.SJ),o.UK.from)}constructor(e,t,i,r){this.name=e,this.description=t,this.validate=i,this.convert=r}optional(){return new P(this.name,`(optional) ${this.description}`,(e=>null==e||this.validate(e)),(e=>void 0===e?void 0:null===e?null:this.convert(e)))}with(e,t){return new P(e??this.name,t??this.description,this.validate,this.convert)}}class T{static{this.Void=new T("no result",(e=>e))}constructor(e,t){this.description=e,this.convert=t}}class A{constructor(e,t,i,r,n){this.id=e,this.internalId=t,this.description=i,this.args=r,this.result=n}}},63537:function(e,t,i){i.d(t,{E1:function(){return y},T_:function(){return b}});var r=i(45493),n=i(82998),s=i(81557),o=i(89608),a=i(78293),c=i(30874),l=i(2756),d=i(77264),u=i(47635),h=i(35820),p=i(28019),m=i(82722),f=i(26713),g=i(42731);function v(e,t){if(t){const i=t.split(".");let r=e;for(let e=0;r&&e<i.length;e++)r=r[i[e]];return r}}function _(e){return e instanceof g.ov?{resource:e}:function(e){return e&&e.uri instanceof g.ov&&e.languageId&&"string"==typeof e.languageId}(e)?{resource:e.uri,overrideIdentifier:e.languageId}:function(e){return e&&!e.uri&&e.languageId&&"string"==typeof e.languageId}(e)?{overrideIdentifier:e.languageId}:function(e){return e&&e.uri instanceof g.ov&&(!e.name||"string"==typeof e.name)&&(!e.index||"number"==typeof e.index)}(e)?{resource:e.uri}:null===e?{resource:null}:void 0}let b=class{constructor(e,t,i){this._proxy=e.getProxy(a.Tr.MainThreadConfiguration),this._extHostWorkspace=t,this._logService=i,this._barrier=new h.U8,this._actual=null}getConfigProvider(){return this._barrier.wait().then((e=>this._actual))}$initializeConfiguration(e){this._actual=new w(this._proxy,this._extHostWorkspace,e,this._logService),this._barrier.open()}$acceptConfigurationChanged(e,t){this.getConfigProvider().then((i=>i.$acceptConfigurationChanged(e,t)))}};b=(0,r.g)([(0,r.f)(0,m.O),(0,r.f)(1,o.w),(0,r.f)(2,f.V)],b);class w{constructor(e,t,i,r){this._onDidChangeConfiguration=new s.Q5,this._proxy=e,this._logService=r,this._extHostWorkspace=t,this._configuration=l.VK.parse(i,r),this._configurationScopes=this._toMap(i.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,t){const i={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=l.VK.parse(e,this._logService),this._configurationScopes=this._toMap(e.configurationScopes),this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(t,i))}getConfiguration(e,t,i){const r=_(t)||{},s=this._toReadonlyValue(e?v(this._configuration.getValue(void 0,r,this._extHostWorkspace.workspace),e):this._configuration.getValue(void 0,r,this._extHostWorkspace.workspace));e&&this._validateConfigurationAccess(e,r,i?.identifier);const o={has(e){return void 0!==v(s,e)},get:(t,o)=>{this._validateConfigurationAccess(e?`${e}.${t}`:t,r,i?.identifier);let a=v(s,t);if(void 0===a)a=o;else{let e;const i=(t,r)=>{if((0,u.Kn)(t)){let o;const a=()=>{e=e||(0,n.I8)(s),o=o||v(e,r)};return new Proxy(t,{get:(t,n)=>{if("string"==typeof n&&"tojson"===n.toLowerCase())return a(),()=>o;if(e)return o=o||v(e,r),o[n];const s=t[n];return"string"==typeof n?i(s,`${r}.${n}`):s},set:(e,t,i)=>(a(),o&&(o[t]=i),!0),deleteProperty:(e,t)=>(a(),o&&delete o[t],!0),defineProperty:(e,t,i)=>(a(),o&&Object.defineProperty(o,t,i),!0)})}return Array.isArray(t)?(0,n.I8)(t):t};a=i(a,t)}return a},update:(t,i,n,s)=>{t=e?`${e}.${t}`:t;const o=function(e){if(null==e)return null;if("boolean"==typeof e)return e?2:5;switch(e){case c.JDx.Global:return 2;case c.JDx.Workspace:return 5;case c.JDx.WorkspaceFolder:return 6}}(n);return void 0!==i?this._proxy.$updateConfigurationOption(o,t,i,r,s):this._proxy.$removeConfigurationOption(o,t,r,s)},inspect:t=>{t=e?`${e}.${t}`:t;const i=this._configuration.inspect(t,r,this._extHostWorkspace.workspace);if(i)return{key:t,defaultValue:(0,n.I8)(i.policy?.value??i.default?.value),globalValue:(0,n.I8)(i.user?.value??i.application?.value),workspaceValue:(0,n.I8)(i.workspace?.value),workspaceFolderValue:(0,n.I8)(i.workspaceFolder?.value),defaultLanguageValue:(0,n.I8)(i.default?.override),globalLanguageValue:(0,n.I8)(i.user?.override??i.application?.override),workspaceLanguageValue:(0,n.I8)(i.workspace?.override),workspaceFolderLanguageValue:(0,n.I8)(i.workspaceFolder?.override),languageIds:(0,n.I8)(i.overrideIdentifiers)}}};return"object"==typeof s&&(0,n.jB)(o,s,!1),Object.freeze(o)}_toReadonlyValue(e){const t=e=>(0,u.Kn)(e)?new Proxy(e,{get:(e,i)=>t(e[i]),set:(e,t,i)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(t)}' of object`)},deleteProperty:(e,t)=>{throw new Error(`TypeError: Cannot delete read only property '${String(t)}' of object`)},defineProperty:(e,t)=>{throw new Error(`TypeError: Cannot define property '${String(t)}' for a readonly object`)},setPrototypeOf:e=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):e;return t(e)}_validateConfigurationAccess(e,t,i){const r=d.eU.test(e)?4:this._configurationScopes.get(e),n=i?`[${i.value}] `:"";4!==r?3!==r||t?.resource&&this._logService.warn(`${n}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`):void 0===t?.resource&&this._logService.warn(`${n}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`)}_toConfigurationChangeEvent(e,t){const i=new l.YX(e,t,this._configuration,this._extHostWorkspace.workspace,this._logService);return Object.freeze({affectsConfiguration:(e,t)=>i.affectsConfiguration(e,_(t))})}_toMap(e){return e.reduce(((e,t)=>(e.set(t[0],t[1]),e)),new Map)}}const y=(0,p.yh)("IExtHostConfiguration")},56687:function(e,t,i){i.d(t,{gM:function(){return C},uU:function(){return P}});var r=i(45493),n=i(35820),s=i(81557),o=i(42731),a=i(26258),c=i(28019),l=i(78293),d=i(53917),u=i(26841),h=i(82722),p=i(30874),m=i(89608),f=i(47862),g=i(37358),v=i(63537),_=i(98668),b=i(7428),w=i(27528),y=i(85315),x=i(17430);const C=(0,c.yh)("IExtHostDebugService");let S=class{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){return this._activeDebugSession?.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(e,t,i,r,n,o,a){this._workspaceService=t,this._extensionService=i,this._configurationService=r,this._editorTabs=n,this._variableResolver=o,this._commands=a,this._debugSessions=new Map,this._debugVisualizationTreeItemIdsCounter=0,this._debugVisualizationProviders=new Map,this._debugVisualizationTrees=new Map,this._debugVisualizationTreeItemIds=new WeakMap,this._debugVisualizationElements=new Map,this._visualizers=new Map,this._visualizerIdCounter=0,this._configProviderHandleCounter=0,this._configProviders=[],this._adapterFactoryHandleCounter=0,this._adapterFactories=[],this._trackerFactoryHandleCounter=0,this._trackerFactories=[],this._debugAdapters=new Map,this._debugAdaptersTrackers=new Map,this._onDidStartDebugSession=new s.Q5,this._onDidTerminateDebugSession=new s.Q5,this._onDidChangeActiveDebugSession=new s.Q5,this._onDidReceiveDebugSessionCustomEvent=new s.Q5,this._debugServiceProxy=e.getProxy(l.Tr.MainThreadDebugService),this._onDidChangeBreakpoints=new s.Q5,this._onDidChangeActiveStackItem=new s.Q5,this._activeDebugConsole=new D(this._debugServiceProxy),this._breakpoints=new Map,this._extensionService.getExtensionRegistry().then((e=>{e.onDidChange((t=>{this.registerAllDebugTypes(e)})),this.registerAllDebugTypes(e)}))}async $getVisualizerTreeItem(e,t){const i=this.hydrateVisualizationContext(t);if(!i)return;const r=await(this._debugVisualizationTrees.get(e)?.getTreeItem?.(i));return r?this.convertVisualizerTreeItem(e,r):void 0}registerDebugVisualizationTree(e,t,i){const r=a.kP.toKey(e.identifier),n=this.extensionVisKey(r,t);if(this._debugVisualizationProviders.has(n))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationTrees.set(n,i),this._debugServiceProxy.$registerDebugVisualizerTree(n,!!i.editItem),(0,b.OF)((()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(n),this._debugVisualizationTrees.delete(t)}))}async $getVisualizerTreeItemChildren(e,t){const i=this._debugVisualizationElements.get(t)?.item;if(!i)return[];const r=await(this._debugVisualizationTrees.get(e)?.getChildren?.(i));return r?.map((t=>this.convertVisualizerTreeItem(e,t)))||[]}async $editVisualizerTreeItem(e,t){const i=this._debugVisualizationElements.get(e);if(!i)return;const r=await(this._debugVisualizationTrees.get(i.provider)?.editItem?.(i.item,t));return this.convertVisualizerTreeItem(i.provider,r||i.item)}$disposeVisualizedTree(e){const t=this._debugVisualizationElements.get(e);if(!t)return;const i=[t.children];for(const e of i)if(e)for(const t of e)i.push(this._debugVisualizationElements.get(t)?.children),this._debugVisualizationElements.delete(t)}convertVisualizerTreeItem(e,t){let i=this._debugVisualizationTreeItemIds.get(t);return i||(i=this._debugVisualizationTreeItemIdsCounter++,this._debugVisualizationTreeItemIds.set(t,i),this._debugVisualizationElements.set(i,{provider:e,item:t})),x.rT.from(t,i)}asDebugSourceUri(e,t){const i=e;if("number"==typeof i.sourceReference&&i.sourceReference>0){let e=`debug:${encodeURIComponent(i.path||"")}`,r="?";return t&&(e+=`${r}session=${encodeURIComponent(t.id)}`,r="&"),e+=`${r}ref=${i.sourceReference}`,o.ov.parse(e)}if(i.path)return o.ov.file(i.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}registerAllDebugTypes(e){const t=[];for(const i of e.getAllExtensionDescriptions())if(i.contributes){const e=i.contributes.debuggers;if(e&&e.length>0)for(const i of e)(0,g.b3)(i)&&t.push(i.type)}this._debugServiceProxy.$registerDebugTypes(t)}get activeStackItem(){return this._activeStackItem}get onDidChangeActiveStackItem(){return this._onDidChangeActiveStackItem.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){const e=[];return this._breakpoints.forEach((t=>e.push(t))),e}async $resolveDebugVisualizer(e,t){const i=this._visualizers.get(e);if(!i)throw new Error(`No debug visualizer found with id '${e}'`);let{v:r,provider:n,extensionId:s}=i;if(r.visualization||(r=await(n.resolveDebugVisualization?.(r,t))||r,i.v=r),!r.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${n}'`);return this.serializeVisualization(s,r.visualization)}async $executeDebugVisualizerCommand(e){const t=this._visualizers.get(e);if(!t)throw new Error(`No debug visualizer found with id '${e}'`);const i=t.v.visualization;i&&"command"in i&&this._commands.executeCommand(i.command,...i.arguments||[])}hydrateVisualizationContext(e){const t=this._debugSessions.get(e.sessionId);return t&&{session:t.api,variable:e.variable,containerId:e.containerId,frameId:e.frameId,threadId:e.threadId}}async $provideDebugVisualizers(e,t,i,r){const n=this.hydrateVisualizationContext(i),s=this.extensionVisKey(e,t),o=this._debugVisualizationProviders.get(s);if(!n||!o)return[];const a=await o.provideDebugVisualization(n,r);return a?a.map((t=>{const i=++this._visualizerIdCounter;this._visualizers.set(i,{v:t,provider:o,extensionId:e});const r=t.iconPath?this.getIconPathOrClass(t.iconPath):void 0;return{id:i,name:t.name,iconClass:r?.iconClass,iconPath:r?.iconPath,visualization:this.serializeVisualization(e,t.visualization)}})):[]}$disposeDebugVisualizers(e){for(const t of e)this._visualizers.delete(t)}registerDebugVisualizationProvider(e,t,i){if(!e.contributes?.debugVisualizers?.some((e=>e.id===t)))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${t})`);const r=a.kP.toKey(e.identifier),n=this.extensionVisKey(r,t);if(this._debugVisualizationProviders.has(n))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationProviders.set(n,i),this._debugServiceProxy.$registerDebugVisualizer(r,t),(0,b.OF)((()=>{this._debugServiceProxy.$unregisterDebugVisualizer(r,t),this._debugVisualizationProviders.delete(t)}))}addBreakpoints(e){const t=e.filter((e=>{const t=e.id;return!this._breakpoints.has(t)&&(this._breakpoints.set(t,e),!0)}));this.fireBreakpointChanges(t,[],[]);const i=[],r=new Map;for(const e of t)if(e instanceof p.TGJ){let t=r.get(e.location.uri.toString());t||(t={type:"sourceMulti",uri:e.location.uri,lines:[]},r.set(e.location.uri.toString(),t),i.push(t)),t.lines.push({id:e.id,enabled:e.enabled,condition:e.condition,hitCondition:e.hitCondition,logMessage:e.logMessage,line:e.location.range.start.line,character:e.location.range.start.character,mode:e.mode})}else e instanceof p.TpX&&i.push({type:"function",id:e.id,enabled:e.enabled,hitCondition:e.hitCondition,logMessage:e.logMessage,condition:e.condition,functionName:e.functionName,mode:e.mode});return this._debugServiceProxy.$registerBreakpoints(i)}removeBreakpoints(e){const t=e.filter((e=>this._breakpoints.delete(e.id)));this.fireBreakpointChanges([],t,[]);const i=t.filter((e=>e instanceof p.TGJ)).map((e=>e.id)),r=t.filter((e=>e instanceof p.TpX)).map((e=>e.id)),n=t.filter((e=>e instanceof p.K1l)).map((e=>e.id));return this._debugServiceProxy.$unregisterBreakpoints(i,r,n)}startDebugging(e,t,i){return this._debugServiceProxy.$startDebugging(e?e.uri:void 0,t,{parentSessionID:i.parentSession?i.parentSession.id:void 0,lifecycleManagedByParent:i.lifecycleManagedByParent,repl:i.consoleMode===p.lZM.MergeWithParent?"mergeWithParent":"separate",noDebug:i.noDebug,compact:i.compact,suppressSaveBeforeStart:i.suppressSaveBeforeStart,suppressDebugStatusbar:i.suppressDebugStatusbar??i.debugUI?.simple,suppressDebugToolbar:i.suppressDebugToolbar??i.debugUI?.simple,suppressDebugView:i.suppressDebugView??i.debugUI?.simple})}stopDebugging(e){return this._debugServiceProxy.$stopDebugging(e?e.id:void 0)}registerDebugConfigurationProvider(e,t,i){if(!t)return new p.JTr((()=>{}));const r=this._configProviderHandleCounter++;return this._configProviders.push({type:e,handle:r,provider:t}),this._debugServiceProxy.$registerDebugConfigurationProvider(e,i,!!t.provideDebugConfigurations,!!t.resolveDebugConfiguration,!!t.resolveDebugConfigurationWithSubstitutedVariables,r),new p.JTr((()=>{this._configProviders=this._configProviders.filter((e=>e.provider!==t)),this._debugServiceProxy.$unregisterDebugConfigurationProvider(r)}))}registerDebugAdapterDescriptorFactory(e,t,i){if(!i)return new p.JTr((()=>{}));if(!this.definesDebugType(e,t))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${t}' debugger.`);if(this.getAdapterDescriptorFactoryByType(t))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const r=this._adapterFactoryHandleCounter++;return this._adapterFactories.push({type:t,handle:r,factory:i}),this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(t,r),new p.JTr((()=>{this._adapterFactories=this._adapterFactories.filter((e=>e.factory!==i)),this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(r)}))}registerDebugAdapterTrackerFactory(e,t){if(!t)return new p.JTr((()=>{}));const i=this._trackerFactoryHandleCounter++;return this._trackerFactories.push({type:e,handle:i,factory:t}),new p.JTr((()=>{this._trackerFactories=this._trackerFactories.filter((e=>e.factory!==t))}))}async $runInTerminal(e,t){return Promise.resolve(void 0)}async $substituteVariables(e,t){let i;const r=await this.getFolder(e);r&&(i={uri:r.uri,name:r.name,index:r.index,toResource:()=>{throw new Error("Not implemented")}});return(await this._variableResolver.getResolver()).resolveAnyAsync(i,t)}createDebugAdapter(e,t){if("implementation"===e.type)return new I(e.implementation)}createSignService(){}async $startDASession(e,t){const i=this,r=await this.getSession(t);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(r.type),r).then((t=>{if(!t)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}' (extension might have failed to activate)`);const n=this.convertToDto(t),s=this.createDebugAdapter(n,r);if(!s)throw new Error(`Couldn't create a debug adapter for type '${r.type}'.`);const o=s;return this._debugAdapters.set(e,o),this.getDebugAdapterTrackers(r).then((t=>(t&&this._debugAdaptersTrackers.set(e,t),o.onMessage((async r=>{if("request"===r.type&&"handshake"===r.command){const e=r,t={type:"response",seq:0,command:e.command,request_seq:e.seq,success:!0};this._signService||(this._signService=this.createSignService());try{if(!this._signService)throw new Error("no signer");{const i=await this._signService.sign(e.arguments.value);t.body={signature:i},o.sendResponse(t)}}catch(e){t.success=!1,t.message=e.message,o.sendResponse(t)}}else t&&t.onDidSendMessage&&t.onDidSendMessage(r),r=(0,g.p0)(r,!0),i._debugServiceProxy.$acceptDAMessage(e,r)})),o.onError((i=>{t&&t.onError&&t.onError(i),this._debugServiceProxy.$acceptDAError(e,i.name,i.message,i.stack)})),o.onExit((i=>{t&&t.onExit&&t.onExit(i??void 0,void 0),this._debugServiceProxy.$acceptDAExit(e,i??void 0,void 0)})),t&&t.onWillStartSession&&t.onWillStartSession(),o.startSession())))}))}$sendDAMessage(e,t){t=(0,g.lv)(t,!1);const i=this._debugAdaptersTrackers.get(e);i&&i.onWillReceiveMessage&&i.onWillReceiveMessage(t);const r=this._debugAdapters.get(e);r?.sendMessage(t)}$stopDASession(e){const t=this._debugAdaptersTrackers.get(e);this._debugAdaptersTrackers.delete(e),t&&t.onWillStopSession&&t.onWillStopSession();const i=this._debugAdapters.get(e);return this._debugAdapters.delete(e),i?i.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(e){const t=[],i=[],r=[];if(e.added)for(const i of e.added){const e=i.id;if(e&&!this._breakpoints.has(e)){let r;if("function"===i.type)r=new p.TpX(i.functionName,i.enabled,i.condition,i.hitCondition,i.logMessage,i.mode);else if("data"===i.type)r=new p.K1l(i.label,i.dataId,i.canPersist,i.enabled,i.hitCondition,i.condition,i.logMessage,i.mode);else{const e=o.ov.revive(i.uri);r=new p.TGJ(new p.YeX(e,new p.Lyo(i.line,i.character)),i.enabled,i.condition,i.hitCondition,i.logMessage,i.mode)}(0,p.YL6)(r,e),this._breakpoints.set(e,r),t.push(r)}}if(e.removed)for(const t of e.removed){const e=this._breakpoints.get(t);e&&(this._breakpoints.delete(t),i.push(e))}if(e.changed)for(const t of e.changed)if(t.id){const e=this._breakpoints.get(t.id);if(e){if(e instanceof p.TpX&&"function"===t.type){const i=e;i.enabled=t.enabled,i.condition=t.condition,i.hitCondition=t.hitCondition,i.logMessage=t.logMessage,i.functionName=t.functionName}else if(e instanceof p.TGJ&&"source"===t.type){const i=e;i.enabled=t.enabled,i.condition=t.condition,i.hitCondition=t.hitCondition,i.logMessage=t.logMessage,i.location=new p.YeX(o.ov.revive(t.uri),new p.Lyo(t.line,t.character))}r.push(e)}}this.fireBreakpointChanges(t,i,r)}async $acceptStackFrameFocus(e){let t;if(e){const i=await this.getSession(e.sessionId);t="thread"===e.kind?new p.hNq(i.api,e.threadId):new p.U07(i.api,e.threadId,e.frameId)}this._activeStackItem=t,this._onDidChangeActiveStackItem.fire(this._activeStackItem)}$provideDebugConfigurations(e,t,i){return(0,n.OH)((async()=>{const r=this.getConfigProviderByHandle(e);if(!r)throw new Error("no DebugConfigurationProvider found");if(!r.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const n=await this.getFolder(t);return r.provideDebugConfigurations(n,i)})).then((e=>{if(!e)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return e}))}$resolveDebugConfiguration(e,t,i,r){return(0,n.OH)((async()=>{const n=this.getConfigProviderByHandle(e);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const s=await this.getFolder(t);return n.resolveDebugConfiguration(s,i,r)}))}$resolveDebugConfigurationWithSubstitutedVariables(e,t,i,r){return(0,n.OH)((async()=>{const n=this.getConfigProviderByHandle(e);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const s=await this.getFolder(t);return n.resolveDebugConfigurationWithSubstitutedVariables(s,i,r)}))}async $provideDebugAdapter(e,t){const i=this.getAdapterDescriptorFactoryByHandle(e);if(!i)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const r=await this.getSession(t);return this.getAdapterDescriptor(i,r).then((e=>{if(!e)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}'`);return this.convertToDto(e)}))}async $acceptDebugSessionStarted(e){const t=await this.getSession(e);this._onDidStartDebugSession.fire(t.api)}async $acceptDebugSessionTerminated(e){const t=await this.getSession(e);t&&(this._onDidTerminateDebugSession.fire(t.api),this._debugSessions.delete(t.id))}async $acceptDebugSessionActiveChanged(e){this._activeDebugSession=e?await this.getSession(e):void 0,this._onDidChangeActiveDebugSession.fire(this._activeDebugSession?.api)}async $acceptDebugSessionNameChanged(e,t){const i=await this.getSession(e);i?._acceptNameChanged(t)}async $acceptDebugSessionCustomEvent(e,t){const i={session:(await this.getSession(e)).api,event:t.event,body:t.body};this._onDidReceiveDebugSessionCustomEvent.fire(i)}convertToDto(e){if(e instanceof p.FLm)return{type:"executable",command:e.command,args:e.args,options:e.options};if(e instanceof p.cZI)return{type:"server",port:e.port,host:e.host};if(e instanceof p.HGt)return{type:"pipeServer",path:e.path};if(e instanceof p.yr7)return{type:"implementation",implementation:e.implementation};throw new Error("convertToDto unexpected type")}getAdapterDescriptorFactoryByType(e){const t=this._adapterFactories.filter((t=>t.type===e));if(t.length>0)return t[0].factory}getAdapterDescriptorFactoryByHandle(e){const t=this._adapterFactories.filter((t=>t.handle===e));if(t.length>0)return t[0].factory}getConfigProviderByHandle(e){const t=this._configProviders.filter((t=>t.handle===e));if(t.length>0)return t[0].provider}definesDebugType(e,t){if(e.contributes){const i=e.contributes.debuggers;if(i&&i.length>0)for(const e of i)if(e.label&&e.type&&e.type===t)return!0}return!1}getDebugAdapterTrackers(e){const t=e.configuration.type,i=this._trackerFactories.filter((e=>e.type===t||"*"===e.type)).map((t=>(0,n.OH)((()=>t.factory.createDebugAdapterTracker(e.api))).then((e=>e),(e=>null))));return Promise.race([Promise.all(i).then((e=>{const t=e.filter((e=>!!e));if(t.length>0)return new k(t)})),new Promise((e=>setTimeout((()=>e(void 0)),1e3)))]).catch((e=>{}))}async getAdapterDescriptor(e,t){const i=t.configuration.debugServer;if("number"==typeof i)return Promise.resolve(new p.cZI(i));if(e){const i=await this._extensionService.getExtensionRegistry();return(0,n.OH)((()=>e.createDebugAdapterDescriptor(t.api,this.daExecutableFromPackage(t,i)))).then((e=>{if(e)return e}))}const r=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(t,r))}daExecutableFromPackage(e,t){}fireBreakpointChanges(e,t,i){(e.length>0||t.length>0||i.length>0)&&this._onDidChangeBreakpoints.fire(Object.freeze({added:e,removed:t,changed:i}))}async getSession(e){if(e){if("string"!=typeof e){let t=this._debugSessions.get(e.id);if(!t){const i=await this.getFolder(e.folderUri),r=e.parent?this._debugSessions.get(e.parent):void 0;t=new E(this._debugServiceProxy,e.id,e.type,e.name,i,e.configuration,r?.api),this._debugSessions.set(t.id,t),this._debugServiceProxy.$sessionCached(t.id)}return t}{const t=this._debugSessions.get(e);if(t)return t}}throw new Error("cannot find session")}getFolder(e){if(e){const t=o.ov.revive(e);return this._workspaceService.resolveWorkspaceFolder(t)}return Promise.resolve(void 0)}extensionVisKey(e,t){return`${e}\0${t}`}serializeVisualization(e,t){if(t){if("title"in t&&"command"in t)return{type:0};if("treeId"in t)return{type:1,id:`${e}\0${t.treeId}`};throw new Error("Unsupported debug visualization type")}}getIconPathOrClass(e){const t=this.getIconUris(e);let i,r;return"id"in t?r=w.kS.asClassName(t):i=t,{iconPath:i,iconClass:r}}getIconUris(e){if(e instanceof p.kS8)return{id:e.id};const t="object"==typeof e&&"dark"in e?e.dark:e,i="object"==typeof e&&"light"in e?e.light:e;return{dark:"string"==typeof t?o.ov.file(t):t,light:"string"==typeof i?o.ov.file(i):i}}};S=(0,r.g)([(0,r.f)(0,h.O),(0,r.f)(1,m.w),(0,r.f)(2,u.k2),(0,r.f)(3,v.E1),(0,r.f)(4,d.v),(0,r.f)(5,_.w),(0,r.f)(6,y.f7)],S);class E{constructor(e,t,i,r,n,s,o){this._debugServiceProxy=e,this._id=t,this._type=i,this._name=r,this._workspaceFolder=n,this._configuration=s,this._parentSession=o}get api(){const e=this;return this.apiSession??=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(t){e._name=t,e._debugServiceProxy.$setDebugSessionName(e._id,t)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(t,i){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,t,i)},getDebugProtocolBreakpoint(t){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,t.id)}})}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}}class D{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(e){this.append(e+"\n")}})}}class k{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach((e=>e.onWillStartSession?e.onWillStartSession():void 0))}onWillReceiveMessage(e){this.trackers.forEach((t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0))}onDidSendMessage(e){this.trackers.forEach((t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0))}onWillStopSession(){this.trackers.forEach((e=>e.onWillStopSession?e.onWillStopSession():void 0))}onError(e){this.trackers.forEach((t=>t.onError?t.onError(e):void 0))}onExit(e,t){this.trackers.forEach((i=>i.onExit?i.onExit(e,t):void 0))}}class I extends f.o{constructor(e){super(),this.implementation=e,e.onDidSendMessage((e=>{this.acceptMessage(e)}))}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){return this.implementation.dispose(),Promise.resolve(void 0)}}let P=class extends S{constructor(e,t,i,r,n,s,o){super(e,t,i,r,n,s,o)}};P=(0,r.g)([(0,r.f)(0,h.O),(0,r.f)(1,m.w),(0,r.f)(2,u.k2),(0,r.f)(3,v.E1),(0,r.f)(4,d.v),(0,r.f)(5,_.w),(0,r.f)(6,y.f7)],P)},50365:function(e,t,i){i.d(t,{W:function(){return g},w:function(){return f}});var r,n=i(45493),s=i(42731),o=i(78293),a=i(30874),c=i(28019),l=i(82722),d=i(26713),u=i(78074),h=i(88023),p=i(15229),m=i(22423);let f=class{static{r=this}static{this._handlePool=0}static{this._maxEventSize=250}constructor(e,t){this._logService=t,this._provider=new Map,this._proxy=e.getProxy(o.Tr.MainThreadDecorations)}registerFileDecorationProvider(e,t){const i=r._handlePool++;this._provider.set(i,{provider:e,extensionDescription:t}),this._proxy.$registerDecorationProvider(i,t.identifier.value);const n=e.onDidChangeFileDecorations&&e.onDidChangeFileDecorations((e=>{if(!e)return void this._proxy.$onDidChange(i,null);const n=(0,u._2)(e);if(n.length<=r._maxEventSize)return void this._proxy.$onDidChange(i,n);this._logService.warn("[Decorations] CAPPING events from decorations provider",t.identifier.value,n.length);const s=n.map((e=>({uri:e,rank:(0,h.QX)(e.path,"/")}))),o=(0,u.vM)(s,((e,t)=>e.rank-t.rank||(0,h.qu)(e.uri.path,t.uri.path))),a=[];e:for(const e of o){let t;for(const i of e){const e=(0,p.XX)(i.uri.path);if(t!==e&&(t=e,a.push(i.uri)>=r._maxEventSize))break e}}this._proxy.$onDidChange(i,a)}));return new a.JTr((()=>{n?.dispose(),this._proxy.$unregisterDecorationProvider(i),this._provider.delete(i)}))}async $provideDecorations(e,t,i){if(!this._provider.has(e))return Object.create(null);const r=Object.create(null),{provider:n,extensionDescription:o}=this._provider.get(e);return await Promise.all(t.map((async e=>{try{const{uri:t,id:c}=e,l=await Promise.resolve(n.provideFileDecoration(s.ov.revive(t),i));if(!l)return;try{a.unW.validate(l),l.badge&&"string"!=typeof l.badge&&(0,m.H5)(o,"codiconDecoration"),r[c]=[l.propagate,l.tooltip,l.badge,l.color]}catch(e){this._logService.warn(`INVALID decoration from extension '${o.identifier.value}': ${e}`)}}catch(e){this._logService.error(e)}}))),r}};f=r=(0,n.g)([(0,n.f)(0,l.O),(0,n.f)(1,d.V)],f);const g=(0,c.yh)("IExtHostDecorations")},10456:function(e,t,i){i.d(t,{T7:function(){return u},gR:function(){return h}});var r=i(23088),n=i(59301),s=i(88023),o=i(17263),a=i(17936),c=i(30874),l=i(78074);const d=new Map;function u(e,t){t?d.set(e,t):d.delete(e)}class h extends o.v{constructor(e,t,i,r,n,s,o){super(t,i,r,n),this._proxy=e,this._languageId=s,this._isDirty=o,this._isDisposed=!1}dispose(){(0,r.ok)(!this._isDisposed),this._isDisposed=!0,this._isDirty=!1}equalLines(e){return(0,l.fS)(this._lines,e)}get document(){if(!this._document){const e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===n.lg.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},save(){return e._save()},getText(t){return t?e._getTextInRange(t):e.getText()},get eol(){return"\n"===e._eol?c.b6q.LF:c.b6q.CRLF},get lineCount(){return e._lines.length},lineAt(t){return e._lineAt(t)},offsetAt(t){return e._offsetAt(t)},positionAt(t){return e._positionAt(t)},validateRange(t){return e._validateRange(t)},validatePosition(t){return e._validatePosition(t)},getWordRangeAtPosition(t,i){return e._getWordRangeAtPosition(t,i)}}}return Object.freeze(this._document)}_acceptLanguageId(e){(0,r.ok)(!this._isDisposed),this._languageId=e}_acceptIsDirty(e){(0,r.ok)(!this._isDisposed),this._isDirty=e}_save(){return this._isDisposed?Promise.reject(new Error("Document has been closed")):this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){const t=this._validateRange(e);if(t.isEmpty)return"";if(t.isSingleLine)return this._lines[t.start.line].substring(t.start.character,t.end.character);const i=this._eol,r=t.start.line,n=t.end.line,s=[];s.push(this._lines[r].substring(t.start.character));for(let e=r+1;e<n;e++)s.push(this._lines[e]);return s.push(this._lines[n].substring(0,t.end.character)),s.join(i)}_lineAt(e){let t;if(e instanceof c.Lyo?t=e.line:"number"==typeof e&&(t=e),"number"!=typeof t||t<0||t>=this._lines.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new p(t,this._lines[t],t===this._lines.length-1)}_offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return new c.Lyo(t.index,Math.min(t.remainder,i))}_validateRange(e){if(!(e instanceof c.e6w))throw new Error("Invalid argument");const t=this._validatePosition(e.start),i=this._validatePosition(e.end);return t===e.start&&i===e.end?e:new c.e6w(t.line,t.character,i.line,i.character)}_validatePosition(e){if(!(e instanceof c.Lyo))throw new Error("Invalid argument");if(0===this._lines.length)return e.with(0,0);let{line:t,character:i}=e,r=!1;if(t<0)t=0,i=0,r=!0;else if(t>=this._lines.length)t=this._lines.length-1,i=this._lines[t].length,r=!0;else{const e=this._lines[t].length;i<0?(i=0,r=!0):i>e&&(i=e,r=!0)}return r?new c.Lyo(t,i):e}_getWordRangeAtPosition(e,t){const i=this._validatePosition(e);if(t){if((0,s.IO)(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`)}else r=this._languageId,t=d.get(r);var r;const n=(0,a.t2)(i.character+1,(0,a.eq)(t),this._lines[i.line],0);if(n)return new c.e6w(i.line,n.startColumn-1,i.line,n.endColumn-1)}}class p{constructor(e,t,i){this._line=e,this._text=t,this._isLastLine=i}get lineNumber(){return this._line}get text(){return this._text}get range(){return new c.e6w(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){return this._isLastLine?this.range:new c.e6w(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}}},1663:function(e,t,i){i.d(t,{T:function(){return y},W:function(){return w}});var r=i(45493),n=i(23088),s=i(81557),o=i(7428),a=i(42731),c=i(28019),l=i(78293),d=i(10456),u=i(82722),h=i(45107),p=i(17430),m=i(26713),f=i(18910),g=i(59301),v=i(97698),_=i(40048);class b{constructor(e){this.value=e,this._count=0}ref(){this._count++}unref(){return 0==--this._count}}let w=class{constructor(e,t){this._extHostRpc=e,this._logService=t,this._activeEditorId=null,this._editors=new Map,this._documents=new f.Y9,this._onDidAddDocuments=new s.Q5,this._onDidRemoveDocuments=new s.Q5,this._onDidChangeVisibleTextEditors=new s.Q5,this._onDidChangeActiveTextEditor=new s.Q5,this.onDidAddDocuments=this._onDidAddDocuments.event,this.onDidRemoveDocuments=this._onDidRemoveDocuments.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(e){this.acceptDocumentsAndEditorsDelta(e)}acceptDocumentsAndEditorsDelta(e){const t=[],i=[],r=[];if(e.removedDocuments)for(const i of e.removedDocuments){const e=a.ov.revive(i),r=this._documents.get(e);r?.unref()&&(this._documents.delete(e),t.push(r.value))}if(e.addedDocuments)for(const t of e.addedDocuments){const e=a.ov.revive(t.uri);let r=this._documents.get(e);if(r&&e.scheme!==g.lg.vscodeNotebookCell&&e.scheme!==g.lg.vscodeInteractiveInput)throw new Error(`document '${e} already exists!'`);r||(r=new b(new d.gR(this._extHostRpc.getProxy(l.Tr.MainThreadDocuments),e,t.lines,t.EOL,t.versionId,t.languageId,t.isDirty)),this._documents.set(e,r),i.push(r.value)),r.ref()}if(e.removedEditors)for(const t of e.removedEditors){const e=this._editors.get(t);this._editors.delete(t),e&&r.push(e)}if(e.addedEditors)for(const t of e.addedEditors){const e=a.ov.revive(t.documentUri);(0,n.ok)(this._documents.has(e),`document '${e}' does not exist`),(0,n.ok)(!this._editors.has(t.id),`editor '${t.id}' already exists!`);const i=this._documents.get(e).value,r=new h.aQ(t.id,this._extHostRpc.getProxy(l.Tr.MainThreadTextEditors),this._logService,new _.o((()=>i.document)),t.selections.map(p.Y1.to),t.options,t.visibleRanges.map((e=>p.e6.to(e))),"number"==typeof t.editorPosition?p.eI.to(t.editorPosition):void 0);this._editors.set(t.id,r)}void 0!==e.newActiveEditor&&((0,n.ok)(null===e.newActiveEditor||this._editors.has(e.newActiveEditor),`active editor '${e.newActiveEditor}' does not exist`),this._activeEditorId=e.newActiveEditor),(0,o.B9)(t),(0,o.B9)(r),e.removedDocuments&&this._onDidRemoveDocuments.fire(t),e.addedDocuments&&this._onDidAddDocuments.fire(i),(e.removedEditors||e.addedEditors)&&this._onDidChangeVisibleTextEditors.fire(this.allEditors().map((e=>e.value))),void 0!==e.newActiveEditor&&this._onDidChangeActiveTextEditor.fire(this.activeEditor())}getDocument(e){return this._documents.get(e)?.value}allDocuments(){return v.$.map(this._documents.values(),(e=>e.value))}getEditor(e){return this._editors.get(e)}activeEditor(e){if(!this._activeEditorId)return;const t=this._editors.get(this._activeEditorId);return e?t:t?.value}allEditors(){return[...this._editors.values()]}};w=(0,r.g)([(0,r.f)(0,u.O),(0,r.f)(1,m.V)],w);const y=(0,c.yh)("IExtHostDocumentsAndEditors")},53917:function(e,t,i){i.d(t,{v:function(){return p},y:function(){return g}});var r=i(45493),n=i(39841),s=i(81557),o=i(47635),a=i(42731),c=i(28019),l=i(78293),d=i(82722),u=i(17430),h=i(30874);const p=(0,c.yh)("IExtHostEditorTabs");class m{constructor(e,t,i){this._activeTabIdGetter=i,this._parentGroup=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(t)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e,this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case 1:return new h.Y_o(a.ov.revive(this._dto.input.uri));case 2:return new h.lF4(a.ov.revive(this._dto.input.original),a.ov.revive(this._dto.input.modified));case 3:return new h.kiP(a.ov.revive(this._dto.input.base),a.ov.revive(this._dto.input.input1),a.ov.revive(this._dto.input.input2),a.ov.revive(this._dto.input.result));case 6:return new h.zwE(a.ov.revive(this._dto.input.uri),this._dto.input.viewType);case 7:return new h.kU2(this._dto.input.viewType);case 4:return new h.IAb(a.ov.revive(this._dto.input.uri),this._dto.input.notebookType);case 5:return new h.ogl(a.ov.revive(this._dto.input.original),a.ov.revive(this._dto.input.modified),this._dto.input.notebookType);case 8:return new h.UyC;case 9:return new h.Ngc(a.ov.revive(this._dto.input.uri),a.ov.revive(this._dto.input.inputBoxUri));case 10:return new h.XgO;case 11:return new h.UwW(this._dto.input.diffEditors.map((e=>new h.lF4(a.ov.revive(e.original),a.ov.revive(e.modified)))));default:return}}}class f{constructor(e,t){this._tabs=[],this._activeTabId="",this._dto=e,this._activeGroupIdGetter=t;for(const t of e.tabs)t.isActive&&(this._activeTabId=t.id),this._tabs.push(new m(t,this,(()=>this.activeTabId())))}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return u.eI.to(e._dto.viewColumn)},get activeTab(){return e._tabs.find((t=>t.tabId===e._activeTabId))?.apiObject},get tabs(){return Object.freeze(e._tabs.map((e=>e.apiObject)))}};this._apiObject=Object.freeze(t)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(0===e.kind){const t=new m(e.tabDto,this,(()=>this.activeTabId()));return this._tabs.splice(e.index,0,t),e.tabDto.isActive&&(this._activeTabId=t.tabId),t}if(1===e.kind){const t=this._tabs.splice(e.index,1)[0];if(!t)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return t.tabId===this._activeTabId&&(this._activeTabId=""),t}if(3===e.kind){if(void 0===e.oldIndex)throw new Error("Invalid old index on move IPC");const t=this._tabs.splice(e.oldIndex,1)[0];if(!t)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this._tabs.splice(e.index,0,t),t}const t=this._tabs.find((t=>t.tabId===e.tabDto.id));if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this._activeTabId=e.tabDto.id:this._activeTabId!==e.tabDto.id||e.tabDto.isActive||(this._activeTabId=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this._activeTabId}}let g=class{constructor(e){this._onDidChangeTabs=new s.Q5,this._onDidChangeTabGroups=new s.Q5,this._extHostTabGroups=[],this._proxy=e.getProxy(l.Tr.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){const e=this,t={onDidChangeTabGroups:e._onDidChangeTabGroups.event,onDidChangeTabs:e._onDidChangeTabs.event,get all(){return Object.freeze(e._extHostTabGroups.map((e=>e.apiObject)))},get activeTabGroup(){const t=e._activeGroupId;return(0,o.cW)(e._extHostTabGroups.find((e=>e.groupId===t))?.apiObject)},close:async(e,t)=>{const i=Array.isArray(e)?e:[e];return!i.length||(function(e){const t=e;if(void 0!==t.tabs)return!0;return!1}(i[0])?this._closeGroups(i,t):this._closeTabs(i,t))}};this._apiObject=Object.freeze(t)}return this._apiObject}$acceptEditorTabModel(e){const t=new Set(this._extHostTabGroups.map((e=>e.groupId))),i=new Set(e.map((e=>e.groupId))),r=(0,n.qP)(t,i),s=this._extHostTabGroups.filter((e=>r.removed.includes(e.groupId))).map((e=>e.apiObject)),a=[],c=[];this._extHostTabGroups=e.map((e=>{const t=new f(e,(()=>this._activeGroupId));return r.added.includes(t.groupId)?a.push(t.apiObject):c.push(t.apiObject),t}));const l=(0,o.cW)(e.find((e=>!0===e.isActive))?.groupId);void 0!==l&&this._activeGroupId!==l&&(this._activeGroupId=l),this._onDidChangeTabGroups.fire(Object.freeze({opened:a,closed:s,changed:c}))}$acceptTabGroupUpdate(e){const t=this._extHostTabGroups.find((t=>t.groupId===e.groupId));if(!t)throw new Error("Update Group IPC call received before group creation.");t.acceptGroupDtoUpdate(e),e.isActive&&(this._activeGroupId=e.groupId),this._onDidChangeTabGroups.fire(Object.freeze({changed:[t.apiObject],opened:[],closed:[]}))}$acceptTabOperation(e){const t=this._extHostTabGroups.find((t=>t.groupId===e.groupId));if(!t)throw new Error("Update Tabs IPC call received before group creation.");const i=t.acceptTabOperation(e);switch(e.kind){case 0:return void this._onDidChangeTabs.fire(Object.freeze({opened:[i.apiObject],closed:[],changed:[]}));case 1:return void this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[i.apiObject],changed:[]}));case 3:case 2:return void this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[i.apiObject]}))}}_findExtHostTabFromApi(e){for(const t of this._extHostTabGroups)for(const i of t.tabs)if(i.apiObject===e)return i}_findExtHostTabGroupFromApi(e){return this._extHostTabGroups.find((t=>t.apiObject===e))}async _closeTabs(e,t){const i=[];for(const t of e){const e=this._findExtHostTabFromApi(t);if(!e)throw new Error("Tab close: Invalid tab not found!");i.push(e.tabId)}return this._proxy.$closeTab(i,t)}async _closeGroups(e,t){const i=[];for(const t of e){const e=this._findExtHostTabGroupFromApi(t);if(!e)throw new Error("Group close: Invalid group not found!");i.push(e.groupId)}return this._proxy.$closeGroup(i,t)}};g=(0,r.g)([(0,r.f)(0,d.O)],g)},26841:function(e,t,i){i.d(t,{Qx:function(){return ee},hj:function(){return se},k2:function(){return ne},vM:function(){return Z}});var r=i(45493),n=i(67525),s=i(15229),o=i(61826),a=i(81647),c=i(35820),l=i(7428),d=i(57386),u=i(42731),h=i(26713),p=i(78293),m=i(63537),f=i(54316),g=i(90466),v=i(26258),_=i(22423);class b{static{this.NONE=new b(!1,-1,-1,-1)}constructor(e,t,i,r){this.startup=e,this.codeLoadingTime=t,this.activateCallTime=i,this.activateResolvedTime=r}}class w{constructor(e){this._startup=e,this._codeLoadingStart=-1,this._codeLoadingStop=-1,this._activateCallStart=-1,this._activateCallStop=-1,this._activateResolveStart=-1,this._activateResolveStop=-1}_delta(e,t){return-1===e||-1===t?-1:t-e}build(){return new b(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}}class y{constructor(e,t,i,r,n,s){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=i,this.module=r,this.exports=n,this.subscriptions=s}}class x extends y{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,[])}}class C extends y{constructor(){super(!1,null,b.NONE,{activate:void 0,deactivate:void 0},void 0,[])}}class S extends y{constructor(e){super(!0,e,b.NONE,{activate:void 0,deactivate:void 0},void 0,[])}}let E=class{constructor(e,t,i,r){this._logService=r,this._registry=e,this._globalRegistry=t,this._host=i,this._operations=new v.C1,this._alreadyActivatedEvents=Object.create(null)}dispose(){for(const[e,t]of this._operations)t.dispose()}async waitForActivatingExtensions(){const e=[];for(const[t,i]of this._operations)e.push(i.wait());await Promise.all(e)}isActivated(e){const t=this._operations.get(e);return Boolean(t&&t.value)}getActivatedExtension(e){const t=this._operations.get(e);if(!t||!t.value)throw new Error(`Extension '${e.value}' is not known or not activated`);return t.value}async activateByEvent(e,t){if(this._alreadyActivatedEvents[e])return;const i=this._registry.getExtensionDescriptionsForActivationEvent(e);await this._activateExtensions(i.map((i=>({id:i.identifier,reason:{startup:t,extensionId:i.identifier,activationEvent:e}})))),this._alreadyActivatedEvents[e]=!0}activateById(e,t){const i=this._registry.getExtensionDescription(e);if(!i)throw new Error(`Extension '${e.value}' is not known`);return this._activateExtensions([{id:i.identifier,reason:t}])}async _activateExtensions(e){const t=e.filter((e=>!this.isActivated(e.id))).map((e=>this._handleActivationRequest(e)));await Promise.all(t.map((e=>e.wait())))}_handleActivationRequest(e){if(this._operations.has(e.id))return this._operations.get(e.id);if(this._isHostExtension(e.id))return this._createAndSaveOperation(e,null,[],null);const t=this._registry.getExtensionDescription(e.id);if(!t){const t=new Error(`Cannot activate unknown extension '${e.id.value}'`),i=this._createAndSaveOperation(e,null,[],new S(t));return this._host.onExtensionActivationError(e.id,t,new _.$V(e.id.value)),i}const i=[],r=void 0===t.extensionDependencies?[]:t.extensionDependencies;for(const n of r){if(this._isResolvedExtension(n))continue;const r=this._operations.get(n);if(r){i.push(r);continue}if(this._isHostExtension(n)){i.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(n).identifier,reason:e.reason}));continue}const s=this._registry.getExtensionDescription(n);if(s){if(!s.main&&!s.browser)continue;i.push(this._handleActivationRequest({id:s.identifier,reason:e.reason}));continue}const o=t.displayName||t.identifier.value,a=new Error(`Cannot activate the '${o}' extension because it depends on unknown extension '${n}'`),c=this._createAndSaveOperation(e,t.displayName,[],new S(a));return this._host.onExtensionActivationError(t.identifier,a,new _.$V(n)),c}return this._createAndSaveOperation(e,t.displayName,i,null)}_createAndSaveOperation(e,t,i,r){const n=new D(e.id,t,e.reason,i,r,this._host,this._logService);return this._operations.set(e.id,n),n}_isHostExtension(e){return g.ci.isHostExtension(e,this._registry,this._globalRegistry)}_isResolvedExtension(e){const t=this._globalRegistry.getExtensionDescription(e);return!!t&&(!t.main&&!t.browser)}};E=(0,r.g)([(0,r.f)(3,h.V)],E);let D=class{get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(e,t,i,r,n,s,o){this._id=e,this._displayName=t,this._reason=i,this._deps=r,this._value=n,this._host=s,this._logService=o,this._barrier=new c.U8,this._isDisposed=!1,this._initialize()}dispose(){this._isDisposed=!0}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate(),this._barrier.open()}async _waitForDepsThenActivate(){if(!this._value){for(;this._deps.length>0;){for(let e=0;e<this._deps.length;e++){const t=this._deps[e];if(!t.value||t.value.activationFailed){if(t.value&&t.value.activationFailed){const e=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${t.friendlyName}' failed to activate`);return e.detail=t.value.activationFailedError,this._value=new S(e),void this._host.onExtensionActivationError(this._id,e,null)}}else this._deps.splice(e,1),e--}this._deps.length>0&&await Promise.race(this._deps.map((e=>e.wait())))}await this._activate()}}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(e){const t=new Error;if(e&&e.name&&(t.name=e.name),e&&e.message?t.message=`Activating extension '${this._id.value}' failed: ${e.message}.`:t.message=`Activating extension '${this._id.value}' failed: ${e}.`,e&&e.stack&&(t.stack=e.stack),this._value=new S(t),this._isDisposed&&(0,f.n2)(e))return;this._host.onExtensionActivationError(this._id,t,null),this._logService.error(`Activating extension ${this._id.value} failed due to an error:`),this._logService.error(e)}}};D=(0,r.g)([(0,r.f)(6,h.V)],D);var k=i(34142),I=i(89608),P=i(53976);class T{constructor(e,t,i){this._deferredPromises=new Map,this._id=e,this._shared=t,this._storage=i,this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then((e=>(this._value=e,this))),this._storageListener=this._storage.onDidChangeStorage((e=>{e.shared===this._shared&&e.key===this._id&&(this._value=e.value)})),this._scheduler=new c.pY((()=>{const e=this._deferredPromises;this._deferredPromises=new Map,(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(const t of e.values())t.complete()}catch(t){for(const i of e.values())i.error(t)}})()}),0)}keys(){return Object.entries(this._value??{}).filter((([,e])=>void 0!==e)).map((([e])=>e))}get whenReady(){return this._init}get(e,t){let i=this._value[e];return void 0===i&&(i=t),i}update(e,t){this._value[e]=t;const i=this._deferredPromises.get(e);if(void 0!==i)return i.p;const r=new c.CR;return this._deferredPromises.set(e,r),this._scheduler.isScheduled()||this._scheduler.schedule(),r.p}dispose(){this._storageListener.dispose()}}class A extends T{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this._extension=e}}var R=i(30874),$=i(59822),L=i(28019),N=i(73820),z=i(3621),F=i(82722),M=i(80195),O=i(80974),H=i(82209),U=i(76870),B=i(81557),W=i(83704),V=i(8685);class q{#r;constructor(e,t){this._onDidChange=new B.Q5,this.onDidChange=this._onDidChange.event,this._id=v.kP.toKey(e.identifier),this.#r=t,this.#r.onDidChangePassword((e=>{e.extensionId===this._id&&this._onDidChange.fire({key:e.key})}))}get(e){return this.#r.get(this._id,e)}store(e,t){return this.#r.store(this._id,e,t)}delete(e){return this.#r.delete(this._id,e)}}var j,K=i(59301),Q=i(86540),G=i(43064),J=i(11547),Y=i(6263);const X="vs/workbench/api/common/extHostExtensionService",Z=(0,L.yh)("IHostUtils");let ee=j=class extends l.JT{constructor(e,t,i,r,n,s,o,a,l,d,u,h,m){super(),this._extHostManagedSockets=h,this._extHostLanguageModels=m,this._onDidChangeRemoteConnectionData=this._register(new B.Q5),this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event,this._realPathCache=new Map,this._isTerminating=!1,this._hostUtils=t,this._extHostContext=i,this._initData=o,this._extHostWorkspace=r,this._extHostConfiguration=n,this._logService=s,this._extHostTunnelService=l,this._extHostTerminalService=d,this._extHostLocalizationService=u,this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(p.Tr.MainThreadWorkspace),this._mainThreadTelemetryProxy=this._extHostContext.getProxy(p.Tr.MainThreadTelemetry),this._mainThreadExtensionsProxy=this._extHostContext.getProxy(p.Tr.MainThreadExtensionService),this._almostReadyToRunExtensions=new c.U8,this._readyToStartExtensionHost=new c.U8,this._readyToRunExtensions=new c.U8,this._eagerExtensionsActivated=new c.U8,this._activationEventsReader=new ce(this._initData.extensions.activationEvents),this._globalRegistry=new g.ci(this._activationEventsReader,this._initData.extensions.allExtensions);const _=new v.o$(this._initData.extensions.myExtensions);this._myRegistry=new g.ci(this._activationEventsReader,oe(this._globalRegistry,_)),J.yg&&(this._logService.info(`Creating extension host with the following global extensions: ${re(this._globalRegistry)}`),this._logService.info(`Creating extension host with the following local extensions: ${re(this._myRegistry)}`)),this._storage=new k.Y(this._extHostContext,this._logService),this._secretState=new V.p(this._extHostContext),this._storagePath=a,this._instaService=e.createChild(new M.y([k.W,this._storage],[V.Z,this._secretState])),this._activator=this._register(new E(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(e,t,i)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(e,(0,f.ri)(t),i)},actualActivateExtension:async(e,t)=>{if(g.ci.isHostExtension(e,this._myRegistry,this._globalRegistry))return await this._mainThreadExtensionsProxy.$activateExtension(e,t),new C;const i=this._myRegistry.getExtensionDescription(e);return this._activateExtension(i,t)}},this._logService)),this._extensionPathIndex=null,this._resolvers=Object.create(null),this._started=!1,this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions(),this._almostReadyToRunExtensions.open(),await this._extHostWorkspace.waitForInitializeCall(),(0,o.B)("code/extHost/ready"),this._readyToStartExtensionHost.open(),this._initData.autoStart&&this._startExtensionHost()}catch(e){(0,f.dL)(e)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let e=[];try{const t=this._myRegistry.getAllExtensionDescriptions().map((e=>e.identifier));e=t.filter((e=>this.isActivated(e))).map((e=>this._deactivate(e)))}catch(e){}await Promise.all(e)}terminate(e,t=0){if(this._isTerminating)return;this._isTerminating=!0,this._logService.info(`Extension host terminating: ${e}`),this._logService.flush(),this._extHostTerminalService.dispose(),this._activator.dispose(),J.n2&&(0,f.sH)((e=>{this._logService.error(e)})),this._extHostContext.dispose();const i=this._deactivateAll();Promise.race([(0,c.Vs)(5e3),i]).finally((()=>{this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${t}`):this._logService.info(`Extension host exiting with code ${t}`),this._logService.flush(),this._logService.dispose(),this._hostUtils.exit(t)}))}isActivated(e){return!!this._readyToRunExtensions.isOpen()&&this._activator.isActivated(e)}async getExtension(e){const t=await this._mainThreadExtensionsProxy.$getExtension(e);return t&&{...t,identifier:new v.kP(t.identifier.value),extensionLocation:u.ov.revive(t.extensionLocation)}}_activateByEvent(e,t){return this._activator.activateByEvent(e,t)}_activateById(e,t){return this._activator.activateById(e,t)}activateByIdWithErrors(e,t){return this._activateById(e,t).then((()=>{const t=this._activator.getActivatedExtension(e);if(t.activationFailed)return Promise.reject(t.activationFailedError)}))}getExtensionRegistry(){return this._readyToRunExtensions.wait().then((e=>this._myRegistry))}getExtensionExports(e){if(this._readyToRunExtensions.isOpen())return this._activator.getActivatedExtension(e).exports;try{return this._activator.getActivatedExtension(e).exports}catch(e){return null}}async _realPathExtensionUri(e){if(e.scheme===K.lg.file&&this._hostUtils.fsRealpath){const t=e.fsPath;this._realPathCache.has(t)||this._realPathCache.set(t,this._hostUtils.fsRealpath(t));const i=await this._realPathCache.get(t);return u.ov.file(i)}return e}async getExtensionPathIndex(){return this._extensionPathIndex||(this._extensionPathIndex=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then((e=>new ae(e)))),this._extensionPathIndex}async _createExtensionPathIndex(e){const t=d.Id.forUris((e=>a.wi.ignorePathCasing(e)));return await Promise.all(e.map((async e=>{if(this._getEntryPoint(e)){const i=await this._realPathExtensionUri(e.extensionLocation);t.set(i,e)}}))),t}_deactivate(e){let t=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen())return t;if(!this._activator.isActivated(e))return t;const i=this._activator.getActivatedExtension(e);if(!i)return t;try{"function"==typeof i.module.deactivate&&(t=Promise.resolve(i.module.deactivate()).then(void 0,(e=>(this._logService.error(e),Promise.resolve(void 0)))))}catch(t){this._logService.error(`An error occurred when deactivating the extension '${e.value}':`),this._logService.error(t)}try{(0,l.B9)(i.subscriptions)}catch(t){this._logService.error(`An error occurred when deactivating the subscriptions for extension '${e.value}':`),this._logService.error(t)}return t}async _activateExtension(e,t){return this._initData.remote.isRemote?this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier):await this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier),this._doActivateExtension(e,t).then((i=>{const r=i.activationTimes;return this._mainThreadExtensionsProxy.$onDidActivateExtension(e.identifier,r.codeLoadingTime,r.activateCallTime,r.activateResolvedTime,t),this._logExtensionActivationTimes(e,t,"success",r),i}),(i=>{throw this._logExtensionActivationTimes(e,t,"failure"),i}))}_logExtensionActivationTimes(e,t,i,r){const n=ie(e,t);this._mainThreadTelemetryProxy.$publicLog2("extensionActivationTimes",{...n,...r||{},outcome:i})}_doActivateExtension(e,t){const i=ie(e,t);this._mainThreadTelemetryProxy.$publicLog2("activatePlugin",i);const r=this._getEntryPoint(e);if(!r)return Promise.resolve(new x(b.NONE));this._logService.info(`ExtensionService#_doActivateExtension ${e.identifier.value}, startup: ${t.startup}, activationEvent: '${t.activationEvent}'${e.identifier.value!==t.extensionId.value?`, root cause: ${t.extensionId.value}`:""}`),this._logService.flush();const n=new w(t.startup);return Promise.all([this._loadCommonJSModule(e,(0,a.Vo)(e.extensionLocation,r),n),this._loadExtensionContext(e)]).then((t=>((0,o.B)(`code/extHost/willActivateExtension/${e.identifier.value}`),j._callActivate(this._logService,e.identifier,t[0],t[1],n)))).then((t=>((0,o.B)(`code/extHost/didActivateExtension/${e.identifier.value}`),t)))}_loadExtensionContext(e){const t=this._extHostLanguageModels.createLanguageModelAccessInformation(e),i=new A(e,this._storage),r=new T(e.identifier.value,!1,this._storage),n=new q(e,this._secretState),o=e.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?R.UCC.Test:R.UCC.Development:R.UCC.Production,a=this._initData.remote.isRemote?R.TPH.Workspace:R.TPH.UI;return this._logService.trace(`ExtensionService#loadExtensionContext ${e.identifier.value}`),Promise.all([i.whenReady,r.whenReady,this._storagePath.whenReady]).then((()=>{const c=this;let l,d;const h=(0,_.$x)(e,"ipc")?this._initData.messagePorts?.get(v.kP.toKey(e.identifier)):void 0;return Object.freeze({globalState:i,workspaceState:r,secrets:n,subscriptions:[],get languageModelAccessInformation(){return t},get extensionUri(){return e.extensionLocation},get extensionPath(){return e.extensionLocation.fsPath},asAbsolutePath(t){return(0,s.v_)(e.extensionLocation.fsPath,t)},get storagePath(){return c._storagePath.workspaceValue(e)?.fsPath},get globalStoragePath(){return c._storagePath.globalValue(e).fsPath},get logPath(){return(0,s.v_)(c._initData.logsLocation.fsPath,e.identifier.value)},get logUri(){return u.ov.joinPath(c._initData.logsLocation,e.identifier.value)},get storageUri(){return c._storagePath.workspaceValue(e)},get globalStorageUri(){return c._storagePath.globalValue(e)},get extensionMode(){return o},get extension(){return void 0===l&&(l=new se(c,e.identifier,e,a,!1)),l},get extensionRuntime(){return(0,_.H5)(e,"extensionRuntime"),c.extensionRuntime},get environmentVariableCollection(){return c._extHostTerminalService.getEnvironmentVariableCollection(e)},get messagePassingProtocol(){if(!d){if(!h)return;const e=B.ju.buffer(B.ju.fromDOMEventEmitter(h,"message",(e=>e.data)));h.start(),d={onDidReceiveMessage:e,postMessage:h.postMessage.bind(h)}}return d}})}))}static _callActivate(e,t,i,r,n){return i=i||{activate:void 0,deactivate:void 0},this._callActivateOptional(e,t,i,r,n).then((e=>new y(!1,null,n.build(),i,e,r.subscriptions)))}static _callActivateOptional(e,t,i,r,n){if("function"!=typeof i.activate)return Promise.resolve(i);try{n.activateCallStart(),e.trace(`ExtensionService#_callActivateOptional ${t.value}`);const s="object"==typeof global?global:self,o=i.activate.apply(s,[r]);return n.activateCallStop(),n.activateResolveStart(),Promise.resolve(o).then((e=>(n.activateResolveStop(),e)))}catch(e){return Promise.reject(e)}}_activateOneStartupFinished(e,t){this._activateById(e.identifier,{startup:!1,extensionId:e.identifier,activationEvent:t}).then(void 0,(e=>{this._logService.error(e)}))}_activateAllStartupFinishedDeferred(e,t=0){const i=Date.now();(0,J.fn)((()=>{for(let r=t;r<e.length;r+=1){const t=e[r];for(const n of t.activationEvents??[])if("onStartupFinished"===n){if(Date.now()-i>50){this._activateAllStartupFinishedDeferred(e,r);break}this._activateOneStartupFinished(t,n)}}}))}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks((0,o._)()),this._extHostConfiguration.getConfigProvider().then((e=>{const t=e.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),i=this._myRegistry.getAllExtensionDescriptions();if(t)this._activateAllStartupFinishedDeferred(i);else for(const e of i)if(e.activationEvents)for(const t of e.activationEvents)"onStartupFinished"===t&&this._activateOneStartupFinished(e,t)}))}_handleEagerExtensions(){const e=this._activateByEvent("*",!0).then(void 0,(e=>{this._logService.error(e)}));this._register(this._extHostWorkspace.onDidChangeWorkspace((e=>this._handleWorkspaceContainsEagerExtensions(e.added))));const t=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[],i=this._handleWorkspaceContainsEagerExtensions(t),r=this._handleRemoteResolverEagerExtensions(),n=Promise.all([r,e,i]).then((()=>{}));return Promise.race([n,(0,c.Vs)(1e4)]).then((()=>{this._activateAllStartupFinished()})),n}_handleWorkspaceContainsEagerExtensions(e){return 0===e.length?Promise.resolve(void 0):Promise.all(this._myRegistry.getAllExtensionDescriptions().map((t=>this._handleWorkspaceContainsEagerExtension(e,t)))).then((()=>{}))}async _handleWorkspaceContainsEagerExtension(e,t){if(this.isActivated(t.identifier))return;const i=!this._initData.remote.isRemote&&!!this._initData.remote.authority,r={logService:this._logService,folders:e.map((e=>e.uri)),forceUsingSearch:i||!this._hostUtils.fsExists,exists:e=>this._hostUtils.fsExists(e.fsPath),checkExists:(e,t,i)=>this._mainThreadWorkspaceProxy.$checkExists(e,t,i)},n=await(0,W.U)(r,t);return n?this._activateById(t.identifier,{startup:!0,extensionId:t.identifier,activationEvent:n.activationEvent}).then(void 0,(e=>this._logService.error(e))):void 0}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority)return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,!1)}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(e){throw console.error(e),e}}async _doHandleExtensionTests(){const{extensionDevelopmentLocationURI:e,extensionTestsLocationURI:t}=this._initData.environment;if(!e||!t)throw new Error((0,n.C$)(X,0,"Cannot load test runner."));const i=await this._loadCommonJSModule(null,t,new w(!1));if(!i||"function"!=typeof i.run)throw new Error((0,n.C$)(X,1,"Path {0} does not point to a valid extension test runner.",t.toString()));return new Promise(((e,r)=>{const n=(0,a.z_)(t),s=i.run(n,((t,i)=>{t?(J.yg&&this._logService.error("Test runner called back with error",t),r(t)):(J.yg&&(i?this._logService.info(`Test runner called back with ${i} failures.`):this._logService.info("Test runner called back with successful outcome.")),e("number"==typeof i&&i>0?1:0))}));s&&s.then&&s.then((()=>{J.yg&&this._logService.info("Test runner finished successfully."),e(0)})).catch((e=>{J.yg&&this._logService.error("Test runner finished with error",e),r(e instanceof Error&&e.stack?e.stack:String(e))}))}))}_startExtensionHost(){if(this._started)throw new Error("Extension host is already started!");return this._started=!0,this._readyToStartExtensionHost.wait().then((()=>this._readyToRunExtensions.open())).then((()=>Promise.race([this._activator.waitForActivatingExtensions(),(0,c.Vs)(1e3)]))).then((()=>this._handleEagerExtensions())).then((()=>{this._eagerExtensionsActivated.open(),this._logService.info("Eager extensions activated")}))}registerRemoteAuthorityResolver(e,t){return this._resolvers[e]=t,(0,l.OF)((()=>{delete this._resolvers[e]}))}async getRemoteExecServer(e){const{resolver:t}=await this._activateAndGetResolver(e);return t?.resolveExecServer?.(e,{resolveAttempt:0})}async _activateAndGetResolver(e){const t=e.indexOf("+");if(-1===t)throw new R.qaI("Not an authority that can be resolved!",$.XP.InvalidAuthority);const i=e.substr(0,t);return await this._almostReadyToRunExtensions.wait(),await this._activateByEvent(`onResolveRemoteAuthority:${i}`,!1),{authorityPrefix:i,resolver:this._resolvers[i]}}async $resolveAuthority(e,t){const i=G.G.create(!1),r=()=>`[resolveAuthority(${(0,$.lt)(e)},${t})][${i.elapsed()}ms] `,n=e=>this._logService.info(`${r()}${e}`),s=e=>this._logService.warn(`${r()}${e}`),a=(e,t=void 0)=>this._logService.error(`${r()}${e}`,t),l=e=>{if(e instanceof R.qaI)return{type:"error",error:{code:e._code,message:e._message,detail:e._detail}};throw e},d=async e=>{n(`activating resolver for ${e}...`);const{resolver:t,authorityPrefix:i}=await this._activateAndGetResolver(e);if(!t)throw a(`no resolver for ${i}`),new R.qaI(`No remote extension installed to resolve ${i}.`,$.XP.NoResolverFound);return{resolver:t,authorityPrefix:i,remoteAuthority:e}},u=e.split(/@|%40/g).reverse();let h;n(`activating remote resolvers ${u.join(" -> ")}`);try{h=await Promise.all(u.map(d)).catch((async t=>{if(!(t instanceof R.qaI)||t._code!==$.XP.InvalidAuthority)throw t;return s(`resolving nested authorities failed: ${t.message}`),[await d(e)]}))}catch(e){return l(e)}const p=new c.zh;let m,f;p.cancelAndSet((()=>n("waiting...")),1e3);for(const[e,{authorityPrefix:i,resolver:r,remoteAuthority:s}]of h.entries())try{if(e===h.length-1)n("invoking final resolve()..."),(0,o.B)(`code/extHost/willResolveAuthority/${i}`),m=await r.resolve(s,{resolveAttempt:t,execServer:f}),(0,o.B)(`code/extHost/didResolveAuthorityOK/${i}`),n("setting tunnel factory..."),this._register(await this._extHostTunnelService.setTunnelFactory(r,R.ryi.isManagedResolvedAuthority(m)?m:void 0));else{if(n(`invoking resolveExecServer() for ${s}`),(0,o.B)(`code/extHost/willResolveExecServer/${i}`),f=await(r.resolveExecServer?.(s,{resolveAttempt:t,execServer:f})),!f)throw new R.qaI(`Exec server was not available for ${s}`,$.XP.NoResolverFound);(0,o.B)(`code/extHost/didResolveExecServerOK/${i}`)}}catch(e){return(0,o.B)(`code/extHost/didResolveAuthorityError/${i}`),a("returned an error",e),p.dispose(),l(e)}p.dispose();const g={environmentTunnels:m.environmentTunnels,features:m.tunnelFeatures?{elevation:m.tunnelFeatures.elevation,privacyOptions:m.tunnelFeatures.privacyOptions,protocol:void 0===m.tunnelFeatures.protocol||m.tunnelFeatures.protocol}:void 0},v={extensionHostEnv:m.extensionHostEnv,isTrusted:m.isTrusted,authenticationSession:m.authenticationSessionForInitializingExtensions?{id:m.authenticationSessionForInitializingExtensions.id,providerId:m.authenticationSessionForInitializingExtensions.providerId}:void 0};let _;if(n("returned "+(R.ryi.isManagedResolvedAuthority(m)?"managed authority":`${m.host}:${m.port}`)),R.ryi.isManagedResolvedAuthority(m)){const i=t;this._extHostManagedSockets.setFactory(i,m.makeConnection),_={authority:e,connectTo:new $.xf(i),connectionToken:m.connectionToken}}else _={authority:e,connectTo:new $.JE(m.host,m.port),connectionToken:m.connectionToken};return{type:"ok",value:{authority:_,options:v,tunnelInformation:g}}}async $getCanonicalURI(e,t){this._logService.info(`$getCanonicalURI invoked for authority (${(0,$.lt)(e)})`);const{resolver:i}=await this._activateAndGetResolver(e);if(!i)return null;const r=u.ov.revive(t);if(void 0===i.getCanonicalURI)return r;const n=await(0,c.OH)((()=>i.getCanonicalURI(r)));return n||r}async $startExtensionHost(e){e.toAdd.forEach((e=>e.extensionLocation=u.ov.revive(e.extensionLocation)));const{globalRegistry:t,myExtensions:i}=te(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),r=await this._createExtensionPathIndex(i);return(await this.getExtensionPathIndex()).setSearchTree(r),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(i),J.yg&&(this._logService.info(`$startExtensionHost: global extensions: ${re(this._globalRegistry)}`),this._logService.info(`$startExtensionHost: local extensions: ${re(this._myRegistry)}`)),this._startExtensionHost()}$activateByEvent(e,t){return 1===t?this._almostReadyToRunExtensions.wait().then((t=>this._activateByEvent(e,!1))):this._readyToRunExtensions.wait().then((t=>this._activateByEvent(e,!1)))}async $activate(e,t){return await this._readyToRunExtensions.wait(),!!this._myRegistry.getExtensionDescription(e)&&(await this._activateById(e,t),!0)}async $deltaExtensions(e){e.toAdd.forEach((e=>e.extensionLocation=u.ov.revive(e.extensionLocation)));const{globalRegistry:t,myExtensions:i}=te(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),r=await this._createExtensionPathIndex(i);return(await this.getExtensionPathIndex()).setSearchTree(r),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(i),J.yg&&(this._logService.info(`$deltaExtensions: global extensions: ${re(this._globalRegistry)}`),this._logService.info(`$deltaExtensions: local extensions: ${re(this._myRegistry)}`)),Promise.resolve(void 0)}async $test_latency(e){return e}async $test_up(e){return e.byteLength}async $test_down(e){const t=P.KN.alloc(e),i=Math.random()%256;for(let r=0;r<e;r++)t.writeUInt8(i,r);return t}async $updateRemoteConnectionData(e){this._remoteConnectionData=e,this._onDidChangeRemoteConnectionData.fire()}};function te(e,t,i,r){e.addActivationEvents(r.addActivationEvents);const n=new g.ci(e,t.getAllExtensionDescriptions());n.deltaExtensions(r.toAdd,r.toRemove);const s=new v.o$(i.getAllExtensionDescriptions().map((e=>e.identifier)));for(const e of r.myToRemove)s.delete(e);for(const e of r.myToAdd)s.add(e);return{globalRegistry:n,myExtensions:oe(n,s)}}function ie(e,t){return{id:e.identifier.value,name:e.name,extensionVersion:e.version,publisherDisplayName:e.publisher,activationEvents:e.activationEvents?e.activationEvents.join(","):null,isBuiltin:e.isBuiltin,reason:t.activationEvent,reasonId:t.extensionId.value}}function re(e){return e.getAllExtensionDescriptions().map((e=>e.identifier.value)).join(",")}ee=j=(0,r.g)([(0,r.f)(0,L.TG),(0,r.f)(1,Z),(0,r.f)(2,F.O),(0,r.f)(3,I.w),(0,r.f)(4,m.E1),(0,r.f)(5,h.V),(0,r.f)(6,N.$),(0,r.f)(7,z.L),(0,r.f)(8,O.rd),(0,r.f)(9,H.$3),(0,r.f)(10,Q.O),(0,r.f)(11,Y.W),(0,r.f)(12,U.X)],ee);const ne=(0,L.yh)("IExtHostExtensionService");class se{#n;#s;#o;constructor(e,t,i,r,n){this.#n=e,this.#s=t,this.#o=i.identifier,this.id=i.identifier.value,this.extensionUri=i.extensionLocation,this.extensionPath=(0,s.Fv)((0,a.z_)(i.extensionLocation)),this.packageJSON=i,this.extensionKind=r,this.isFromDifferentExtensionHost=n}get isActive(){return this.#n.isActivated(this.#o)}get exports(){if("none"!==this.packageJSON.api&&!this.isFromDifferentExtensionHost)return this.#n.getExtensionExports(this.#o)}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await this.#n.activateByIdWithErrors(this.#o,{startup:!1,extensionId:this.#s,activationEvent:"api"}),this.exports}}function oe(e,t){return e.getAllExtensionDescriptions().filter((e=>t.has(e.identifier)))}class ae{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}}class ce{constructor(e){this._map=new v.C1,this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this._map.set(t,e[t])}}},77600:function(e,t,i){i.d(t,{L:function(){return g},a:function(){return v}});var r,n=i(45493),s=i(78293),o=i(28698),a=i(30874),c=i(53976),l=i(28019),d=i(82722),u=i(52202),h=i(7428),p=i(35820),m=i(81647),f=i(59301);let g=r=class{constructor(e,t){this._fileSystemProvider=new Map,this._writeQueue=new p.sW,this._proxy=e.getProxy(s.Tr.MainThreadFileSystem);const i=this;this.value=Object.freeze({async stat(e){try{let t;const r=i._fileSystemProvider.get(e.scheme);return r?(await i._proxy.$ensureActivation(e.scheme),t=await r.impl.stat(e)):t=await i._proxy.$stat(e),{type:t.type,ctime:t.ctime,mtime:t.mtime,size:t.size,permissions:t.permissions===o.rM.Readonly?1:void 0}}catch(e){r._handleError(e)}},async readDirectory(e){try{const t=i._fileSystemProvider.get(e.scheme);return t?(await i._proxy.$ensureActivation(e.scheme),(await t.impl.readDirectory(e)).slice()):await i._proxy.$readdir(e)}catch(e){return r._handleError(e)}},async createDirectory(e){try{const t=i._fileSystemProvider.get(e.scheme);return t&&!t.isReadonly?(await i._proxy.$ensureActivation(e.scheme),await i.mkdirp(t.impl,t.extUri,e)):await i._proxy.$mkdir(e)}catch(e){return r._handleError(e)}},async readFile(e){try{const t=i._fileSystemProvider.get(e.scheme);if(t)return await i._proxy.$ensureActivation(e.scheme),(await t.impl.readFile(e)).slice();return(await i._proxy.$readFile(e)).buffer}catch(e){return r._handleError(e)}},async writeFile(e,t){try{const r=i._fileSystemProvider.get(e.scheme);return r&&!r.isReadonly?(await i._proxy.$ensureActivation(e.scheme),await i.mkdirp(r.impl,r.extUri,r.extUri.dirname(e)),await i._writeQueue.queueFor(e,(()=>Promise.resolve(r.impl.writeFile(e,t,{create:!0,overwrite:!0}))))):await i._proxy.$writeFile(e,c.KN.wrap(t))}catch(e){return r._handleError(e)}},async delete(e,t){try{const r=i._fileSystemProvider.get(e.scheme);return!r||r.isReadonly||t?.useTrash?await i._proxy.$delete(e,{recursive:!1,useTrash:!1,atomic:!1,...t}):(await i._proxy.$ensureActivation(e.scheme),await r.impl.delete(e,{recursive:!1,...t}))}catch(e){return r._handleError(e)}},async rename(e,t,n){try{return await i._proxy.$rename(e,t,{overwrite:!1,...n})}catch(e){return r._handleError(e)}},async copy(e,t,n){try{return await i._proxy.$copy(e,t,{overwrite:!1,...n})}catch(e){return r._handleError(e)}},isWritableFileSystem(e){const i=t.getCapabilities(e);if("number"==typeof i)return!(2048&i)}})}async mkdirp(e,t,i){const r=[];for(;!t.isEqual(i,t.dirname(i));)try{if(!((await e.stat(i)).type&o.Tv.Directory))throw a.yNx.FileExists(`Unable to create folder '${i.scheme===f.lg.file?i.fsPath:i.toString(!0)}' that already exists but is not a directory`);break}catch(e){if((0,o.q9)(e)!==o.bH.FileNotFound)throw e;r.push(t.basename(i)),i=t.dirname(i)}for(let n=r.length-1;n>=0;n--){i=t.joinPath(i,r[n]);try{await e.createDirectory(i)}catch(e){if((0,o.q9)(e)!==o.bH.FileExists)throw e}}}static _handleError(e){if(e instanceof a.yNx)throw e;if(e instanceof o.lR)switch(e.code){case o.bH.FileExists:throw a.yNx.FileExists(e.message);case o.bH.FileNotFound:throw a.yNx.FileNotFound(e.message);case o.bH.FileNotADirectory:throw a.yNx.FileNotADirectory(e.message);case o.bH.FileIsADirectory:throw a.yNx.FileIsADirectory(e.message);case o.bH.NoPermissions:throw a.yNx.NoPermissions(e.message);case o.bH.Unavailable:throw a.yNx.Unavailable(e.message);default:throw new a.yNx(e.message,e.name)}if(!(e instanceof Error))throw new a.yNx(String(e));if("ENOPRO"===e.name||e.message.includes("ENOPRO"))throw a.yNx.Unavailable(e.message);switch(e.name){case o.bH.FileExists:throw a.yNx.FileExists(e.message);case o.bH.FileNotFound:throw a.yNx.FileNotFound(e.message);case o.bH.FileNotADirectory:throw a.yNx.FileNotADirectory(e.message);case o.bH.FileIsADirectory:throw a.yNx.FileIsADirectory(e.message);case o.bH.NoPermissions:throw a.yNx.NoPermissions(e.message);case o.bH.Unavailable:throw a.yNx.Unavailable(e.message);default:throw new a.yNx(e.message,e.name)}}addFileSystemProvider(e,t,i){return this._fileSystemProvider.set(e,{impl:t,extUri:i?.isCaseSensitive?m.SF:m.F_,isReadonly:!!i?.isReadonly}),(0,h.OF)((()=>this._fileSystemProvider.delete(e)))}getFileSystemProviderExtUri(e){return this._fileSystemProvider.get(e)?.extUri??m.SF}};g=r=(0,n.g)([(0,n.f)(0,d.O),(0,n.f)(1,u.G)],g);const v=(0,l.yh)("IExtHostConsumerFileSystem")},52202:function(e,t,i){i.d(t,{G:function(){return a},J:function(){return o}});var r=i(59301),n=i(81647),s=i(28019);class o{constructor(){this._systemSchemes=new Set(Object.keys(r.lg)),this._providerInfo=new Map,this.extUri=new n.U9((e=>{const t=this._providerInfo.get(e.scheme);return void 0!==t&&!(1024&t)}))}$acceptProviderInfos(e,t){null===t?this._providerInfo.delete(e.scheme):this._providerInfo.set(e.scheme,t)}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}}const a=(0,s.yh)("IExtHostFileSystemInfo")},73820:function(e,t,i){i.d(t,{$:function(){return r}});const r=(0,i(28019).yh)("IExtHostInitDataService")},76870:function(e,t,i){i.d(t,{Q:function(){return E},X:function(){return x}});var r,n=i(45493),s=i(7428),o=i(78293),a=i(17430),c=i(30874),l=i(28855),d=i(26258),u=i(35820),h=i(81557),p=i(67525),m=i(22837),f=i(54316),g=i(28019),v=i(82722),_=i(11301),b=i(26713),w=i(97698);const y="vs/workbench/api/common/extHostLanguageModels",x=(0,g.yh)("IExtHostLanguageModels");class C{constructor(e,t){this.option=e,this.stream=new u.lK,this.stream=t??new u.lK}}class S{constructor(){this._responseStreams=new Map,this._defaultStream=new u.lK,this._isDone=!1,this._isStreaming=!1;this.apiObject={stream:this._defaultStream.asyncIterable}}*_streams(){if(this._responseStreams.size>0)for(const[,e]of this._responseStreams)yield e.stream;else yield this._defaultStream}handleFragment(e){if(this._isDone)return;this._isStreaming=!0;let t=this._responseStreams.get(e.index);t||(t=0===this._responseStreams.size?new C(e.index,this._defaultStream):new C(e.index),this._responseStreams.set(e.index,t)),t.stream.emitOne(e.part)}get isStreaming(){return this._isStreaming}reject(e){this._isDone=!0;for(const t of this._streams())t.reject(e)}resolve(){this._isDone=!0;for(const e of this._streams())e.resolve()}}let E=class{static{r=this}static{this._idPool=1}constructor(e,t,i){this._logService=t,this._extHostAuthentication=i,this._onDidChangeModelAccess=new h.Q5,this._onDidChangeProviders=new h.Q5,this.onDidChangeProviders=this._onDidChangeProviders.event,this._languageModels=new Map,this._allLanguageModelData=new Map,this._modelAccessList=new d.C1,this._pendingRequest=new Map,this._languageAccessInformationExtensions=new Set,this._proxy=e.getProxy(o.Tr.MainThreadLanguageModels)}dispose(){this._onDidChangeModelAccess.dispose(),this._onDidChangeProviders.dispose()}registerLanguageModel(e,t,i,n){const o=r._idPool++;let a;this._languageModels.set(o,{extension:e.identifier,provider:i,languageModelId:t}),n.auth&&(a={providerLabel:e.displayName||e.name,accountLabel:"object"==typeof n.auth?n.auth.label:void 0}),this._proxy.$registerLanguageModelProvider(o,t,{extension:e.identifier,identifier:t,name:n.name??"",version:n.version,tokens:n.tokens,auth:a});const c=i.onDidReceiveLanguageModelResponse2?.((({extensionId:e,participant:i,tokenCount:r})=>{this._proxy.$whenLanguageModelChatRequestMade(t,new d.kP(e),i,r)}));return(0,s.OF)((()=>{this._languageModels.delete(o),this._proxy.$unregisterProvider(o),c?.dispose()}))}async $provideLanguageModelResponse(e,t,i,r,n,s){const o=this._languageModels.get(e);if(!o)return;const c=new l.Ex((async e=>{s.isCancellationRequested?this._logService.warn(`[CHAT](${o.extension.value}) CANNOT send progress because the REQUEST IS CANCELLED`):this._proxy.$handleProgressChunk(t,{index:e.index,part:e.part})}));return o.provider.provideLanguageModelResponse2(r.map(a.YR.to),n,d.kP.toKey(i),c,s)}$provideTokenLength(e,t,i){const r=this._languageModels.get(e);return r?Promise.resolve(r.provider.provideTokenCount(t,i)):Promise.resolve(0)}$updateLanguageModels(e){const t=[],i=[];if(e.added)for(const i of e.added)this._allLanguageModelData.set(i.identifier,i),t.push(i.identifier);if(e.removed)for(const t of e.removed){this._allLanguageModelData.delete(t),i.push(t);for(const[e,i]of this._pendingRequest)i.languageModelId===t&&(i.res.reject(new f.FU),this._pendingRequest.delete(e))}this._onDidChangeProviders.fire(Object.freeze({added:Object.freeze(t),removed:Object.freeze(i)})),e.added?.forEach(this._fakeAuthPopulate,this)}getLanguageModelIds(){return Array.from(this._allLanguageModelData.keys())}$updateModelAccesslist(e){const t=new Array;for(const{from:i,to:r,enabled:n}of e){const e=this._modelAccessList.get(i)??new d.o$;if(e.has(r)!==n){n?e.add(r):e.delete(r),this._modelAccessList.set(i,e);const s={from:i,to:r};t.push(s),this._onDidChangeModelAccess.fire(s)}}}async sendChatRequest(e,t,i,r,n){const s=e.identifier,o=await this._proxy.$prepareChatAccess(s,t,r.justification);if(!o||!this._allLanguageModelData.has(t))throw c.tHl.NotFound(`Language model '${t}' is unknown.`);if(this._isUsingAuth(s,o)){if(!await this._getAuthAccess(e,{identifier:o.extension,displayName:o.auth.providerLabel},r.justification,r.silent)||!this._modelAccessList.get(s)?.has(o.extension))throw c.tHl.NoPermissions(`Language model '${t}' cannot be used by '${s.value}'.`)}const l=1e6*Math.random()|0,d=this._proxy.$fetchResponse(s,t,l,i.map(a.YR.from),r.modelOptions??{},n),h=new u.U8,p=new S;let m;if(this._pendingRequest.set(l,{languageModelId:t,res:p}),d.catch((e=>{h.isOpen()?p.reject(e):m=e})).finally((()=>{this._pendingRequest.delete(l),p.resolve(),h.open()})),await h.wait(),m)throw new c.tHl(`Language model '${t}' errored, check cause for more details`,"Unknown",m);return p.apiObject}async $handleResponseFragment(e,t){const i=this._pendingRequest.get(e);i&&i.res.handleFragment(t)}async _getAuthAccess(e,t,i,r){const n=m.b+t.identifier.value;if(await this._extHostAuthentication.getSession(e,n,[],{silent:!0}))return this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0;if(r)return!1;try{const r=i?(0,p.C$)(y,0,"To allow access to the language models provided by {0}. Justification:\n\n{1}",t.displayName,i):(0,p.C$)(y,1,"To allow access to the language models provided by {0}",t.displayName);return await this._extHostAuthentication.getSession(e,n,[],{forceNewSession:{detail:r}}),this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0}catch(e){return!1}}_isUsingAuth(e,t){return!!t.auth&&!d.kP.equals(t.extension,e)}async _fakeAuthPopulate(e){for(const t of this._languageAccessInformationExtensions)try{await this._getAuthAccess(t,{identifier:e.extension,displayName:""},void 0,!0)}catch(e){this._logService.error("Fake Auth request failed"),this._logService.error(e)}}async computeTokenLength(e,t,i){const r=this._allLanguageModelData.get(e);if(!r)throw c.tHl.NotFound(`Language model '${e}' is unknown.`);const n=w.$.find(this._languageModels.values(),(t=>t.languageModelId===e));return n?n.provider.provideTokenCount(t,i):this._proxy.$countTokens(r.identifier,"string"==typeof t?t:a.YR.from(t),i)}getLanguageModelInfo(e){const t=this._allLanguageModelData.get(e);if(t)return{id:t.identifier,name:t.name,version:t.version,tokens:t.tokens}}createLanguageModelAccessInformation(e){this._languageAccessInformationExtensions.add(e);const t=this,i=h.ju.signal(h.ju.filter(this._onDidChangeModelAccess.event,(t=>d.kP.equals(t.from,e.identifier)))),r=h.ju.signal(this._onDidChangeProviders.event);return{get onDidChange(){return h.ju.any(i,r)},canSendRequest(i){const r=t._allLanguageModelData.get(i);if(!r)return;if(!t._isUsingAuth(e.identifier,r))return!0;const n=t._modelAccessList.get(e.identifier);return n?n.has(r.extension):void 0}}}};E=r=(0,n.g)([(0,n.f)(0,v.O),(0,n.f)(1,b.V),(0,n.f)(2,_.E)],E)},86540:function(e,t,i){i.d(t,{I:function(){return h},O:function(){return p}});var r=i(45493),n=i(11547),s=i(88023),o=i(42731),a=i(28019),c=i(26713),l=i(78293),d=i(73820),u=i(82722);let h=class{constructor(e,t,i){this.logService=i,this.bundleCache=new Map,this._proxy=t.getProxy(l.Tr.MainThreadLocalization),this.currentLanguage=e.environment.appLanguage,this.isDefaultLanguage=this.currentLanguage===n.cr}getMessage(e,t){const{message:i,args:r,comment:n}=t;if(this.isDefaultLanguage)return(0,s.F9)(i,r??{});let o=i;n&&n.length>0&&(o+=`/${Array.isArray(n)?n.join(""):n}`);const a=this.bundleCache.get(e)?.contents[o];return a||this.logService.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`),(0,s.F9)(a??i,r??{})}getBundle(e){return this.bundleCache.get(e)?.contents}getBundleUri(e){return this.bundleCache.get(e)?.uri}async initializeLocalizedMessages(e){if(this.isDefaultLanguage||!e.l10n&&!e.isBuiltin)return;if(this.bundleCache.has(e.identifier.value))return;let t;const i=await this.getBundleLocation(e);if(i){try{const r=await this._proxy.$fetchBundleContents(i),n=JSON.parse(r);t=e.isBuiltin?n.contents?.bundle:n}catch(t){return void this.logService.error(`Failed to load translations for ${e.identifier.value} from ${i}: ${t.message}`)}t&&this.bundleCache.set(e.identifier.value,{contents:t,uri:i})}else this.logService.error(`No bundle location found for extension ${e.identifier.value}`)}async getBundleLocation(e){if(e.isBuiltin){const t=await this._proxy.$fetchBuiltInBundleUri(e.identifier.value,this.currentLanguage);return o.ov.revive(t)}return e.l10n?o.ov.joinPath(e.extensionLocation,e.l10n,`bundle.l10n.${this.currentLanguage}.json`):void 0}};h=(0,r.g)([(0,r.f)(0,d.$),(0,r.f)(1,u.O),(0,r.f)(2,c.V)],h);const p=(0,a.yh)("IExtHostLocalizationService")},71484:function(e,t,i){i.d(t,{m:function(){return d}});var r=i(45493),n=i(525),s=i(78293),o=i(73820),a=i(82722),c=i(42731),l=i(59267);let d=class extends n.sc{constructor(e,t){super(t.logLevel,t.logsLocation,t.loggers.map((e=>(0,l.wL)(e)))),this._proxy=e.getProxy(s.Tr.MainThreadLogger)}$setLogLevel(e,t){t?this.setLogLevel(c.ov.revive(t),e):this.setLogLevel(e)}setVisibility(e,t){super.setVisibility(e,t),this._proxy.$setVisibility(e,t)}doCreateLogger(e,t,i){return new u(this._proxy,e,t,i)}};d=(0,r.g)([(0,r.f)(0,a.O),(0,r.f)(1,o.$)],d);class u extends n.Li{constructor(e,t,i,r){super("always"===r?.logLevel),this.proxy=e,this.file=t,this.isLoggerCreated=!1,this.buffer=[],this.setLevel(i),this.proxy.$createLogger(t,r).then((()=>{this.doLog(this.buffer),this.isLoggerCreated=!0}))}log(e,t){const i=[[e,t]];this.isLoggerCreated?this.doLog(i):this.buffer.push(...i)}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}}},6263:function(e,t,i){i.d(t,{W:function(){return l},b:function(){return d}});var r=i(45493),n=i(78293),s=i(28019),o=i(7428),a=i(82722),c=i(53976);const l=(0,s.yh)("IExtHostManagedSockets");let d=class{constructor(e){this._remoteSocketIdCounter=0,this._factory=null,this._managedRemoteSockets=new Map,this._proxy=e.getProxy(n.Tr.MainThreadManagedSockets)}setFactory(e,t){for(const e of this._managedRemoteSockets.values())e.dispose();this._factory&&this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId),this._factory=new u(e,t),this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(e){if(!this._factory||this._factory.socketFactoryId!==e)throw new Error(`No socket factory with id ${e}`);const t=++this._remoteSocketIdCounter,i=await this._factory.makeConnection(),r=new o.SL;return this._managedRemoteSockets.set(t,new h(t,i,r)),r.add((0,o.OF)((()=>this._managedRemoteSockets.delete(t)))),r.add(i.onDidEnd((()=>{this._proxy.$onDidManagedSocketEnd(t),r.dispose()}))),r.add(i.onDidClose((e=>{this._proxy.$onDidManagedSocketClose(t,e?.stack??e?.message),r.dispose()}))),r.add(i.onDidReceiveMessage((e=>this._proxy.$onDidManagedSocketHaveData(t,c.KN.wrap(e))))),t}$remoteSocketWrite(e,t){this._managedRemoteSockets.get(e)?.actual.send(t.buffer)}$remoteSocketEnd(e){const t=this._managedRemoteSockets.get(e);t&&(t.actual.end(),t.dispose())}async $remoteSocketDrain(e){await(this._managedRemoteSockets.get(e)?.actual.drain?.())}};d=(0,r.g)([(0,r.f)(0,a.O)],d);class u{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}}class h extends o.JT{constructor(e,t,i){super(),this.socketId=e,this.actual=t,this._register(i)}}},92231:function(e,t,i){i.d(t,{U:function(){return C},X:function(){return x}});var r=i(45493),n=i(78293),s=i(28019),o=i(82722),a=i(26258),c=i(525),l=i(26713),d=i(43179),u=i(77600),h=i(73820),p=i(52202),m=i(8210),f=i(53976),g=i(47635),v=i(28698),_=i(81557),b=i(7428);class w extends c.Li{get disposed(){return this._disposed}constructor(e,t,i,r,n){super(),this.id=e,this.name=t,this.logger=i,this.proxy=r,this.extension=n,this.offset=0,this._disposed=!1,this.visible=!1,this.setLevel(i.getLevel()),this._register(i.onDidChangeLogLevel((e=>this.setLevel(e))))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+"\n")}append(e){this.info(e)}clear(){const e=this.offset;this.logger.flush(),this.proxy.$update(this.id,d.Ed.Clear,e)}replace(e){const t=this.offset;this.info(e),this.proxy.$update(this.id,d.Ed.Replace,t),this.visible&&this.logger.flush()}show(e,t){this.logger.flush(),this.proxy.$reveal(this.id,!!("boolean"==typeof e?e:t))}hide(){this.proxy.$close(this.id)}log(e,t){this.offset+=f.KN.fromString(t).byteLength,(0,c.cM)(this.logger,e,t),this.visible&&(this.logger.flush(),this.proxy.$update(this.id,d.Ed.Append))}dispose(){super.dispose(),this._disposed||(this.proxy.$dispose(this.id),this._disposed=!0)}}class y extends w{appendLine(e){this.append(e)}}let x=class{constructor(e,t,i,r,s,o){this.initData=t,this.extHostFileSystem=i,this.extHostFileSystemInfo=r,this.loggerService=s,this.logService=o,this.extensionLogDirectoryPromise=new Map,this.namePool=1,this.channels=new Map,this.visibleChannelId=null,this.proxy=e.getProxy(n.Tr.MainThreadOutputService),this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(t.logsLocation,`output_logging_${(0,m.rL)(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(e){this.visibleChannelId=e;for(const[e,t]of this.channels)t.visible=e===this.visibleChannelId}createOutputChannel(e,t,i){if(!(e=e.trim()))throw new Error("illegal argument `name`. must not be falsy");const r="object"==typeof t&&t.log,n=(0,g.HD)(t)?t:void 0;if((0,g.HD)(n)&&!n.trim())throw new Error("illegal argument `languageId`. must not be empty");let s;const o=this.initData.environment.extensionLogLevel?.find((([e])=>a.kP.equals(i.identifier,e)))?.[1];o&&(s=(0,c.AW)(o));const l=r?this.doCreateLogOutputChannel(e,s,i):this.doCreateOutputChannel(e,n,i);return l.then((e=>{this.channels.set(e.id,e),e.visible=e.id===this.visibleChannelId})),r?this.createExtHostLogOutputChannel(e,s??this.logService.getLevel(),l):this.createExtHostOutputChannel(e,l)}async doCreateOutputChannel(e,t,i){this.outputDirectoryPromise||(this.outputDirectoryPromise=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then((()=>this.outputsLocation)));const r=await this.outputDirectoryPromise,n=this.extHostFileSystemInfo.extUri.joinPath(r,`${this.namePool++}-${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),s=this.loggerService.createLogger(n,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0}),o=await this.proxy.$register(e,n,t,i.identifier.value);return new w(o,e,s,this.proxy,i)}async doCreateLogOutputChannel(e,t,i){const r=await this.createExtensionLogDirectory(i),n=e.replace(/[\\/:\*\?"<>\|]/g,""),s=this.extHostFileSystemInfo.extUri.joinPath(r,`${n}.log`),o=`${i.identifier.value}.${n}`,a=this.loggerService.createLogger(s,{id:o,name:e,logLevel:t,extensionId:i.identifier.value});return new y(o,e,a,this.proxy,i)}createExtensionLogDirectory(e){let t=this.extensionLogDirectoryPromise.get(e.identifier.value);if(!t){const i=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,e.identifier.value);this.extensionLogDirectoryPromise.set(e.identifier.value,t=(async()=>{try{await this.extHostFileSystem.value.createDirectory(i)}catch(e){if((0,v.q9)(e)!==v.bH.FileExists)throw e}return i})())}return t}createExtHostOutputChannel(e,t){let i=!1;const r=()=>{if(i)throw new Error("Channel has been closed")};return{get name(){return e},append(e){r(),t.then((t=>t.append(e)))},appendLine(e){r(),t.then((t=>t.appendLine(e)))},clear(){r(),t.then((e=>e.clear()))},replace(e){r(),t.then((t=>t.replace(e)))},show(e,i){r(),t.then((t=>t.show(e,i)))},hide(){r(),t.then((e=>e.hide()))},dispose(){i=!0,t.then((e=>e.dispose()))}}}createExtHostLogOutputChannel(e,t,i){const r=new b.SL,n=()=>{if(r.isDisposed)throw new Error("Channel has been closed")},s=r.add(new _.Q5);function o(e){t=e,s.fire(e)}return i.then((e=>{r.add(e),e.logLevel!==t&&o(e.logLevel),r.add(e.onDidChangeLogLevel((e=>o(e))))})),{...this.createExtHostOutputChannel(e,i),get logLevel(){return t},onDidChangeLogLevel:s.event,trace(e,...t){n(),i.then((i=>i.trace(e,...t)))},debug(e,...t){n(),i.then((i=>i.debug(e,...t)))},info(e,...t){n(),i.then((i=>i.info(e,...t)))},warn(e,...t){n(),i.then((i=>i.warn(e,...t)))},error(e,...t){n(),i.then((i=>i.error(e,...t)))},dispose(){r.dispose()}}}};x=(0,r.g)([(0,r.f)(0,o.O),(0,r.f)(1,h.$),(0,r.f)(2,u.a),(0,r.f)(3,p.G),(0,r.f)(4,l.y),(0,r.f)(5,l.V)],x);const C=(0,s.yh)("IExtHostOutputService")},82722:function(e,t,i){i.d(t,{O:function(){return r},i:function(){return n}});const r=(0,i(28019).yh)("IExtHostRpcService");class n{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}}},28200:function(e,t,i){i.d(t,{dX:function(){return I},FR:function(){return k}});var r=i(45493),n=i(7428),s=i(78293),o=i(28019),a=i(15229),c=i(17126),l=i(36994),d=i(22200),u=i(81647),h=i(43064),p=i(45630);class m{constructor(e,t,i){this.config=e,this.provider=t,this.sessionToken=i,this.isLimitHit=!1,this.resultCount=0,this.isCanceled=!1,this.filePattern=e.filePattern,this.includePattern=e.includePattern&&(0,d.Qc)(e.includePattern),this.maxResults=e.maxResults||void 0,this.exists=e.exists,this.activeCancellationTokens=new Set,this.globalExcludePattern=e.excludePattern&&(0,d.Qc)(e.excludePattern)}cancel(){this.isCanceled=!0,this.activeCancellationTokens.forEach((e=>e.cancel())),this.activeCancellationTokens=new Set}search(e){const t=this.config.folderQueries||[];return new Promise(((i,r)=>{const n=t=>{this.resultCount++,e(t)};if(this.isCanceled)return i({limitHit:this.isLimitHit});this.config.extraFileResources&&this.config.extraFileResources.forEach((e=>{const t=e.toString(),i=(0,a.EZ)(t);this.globalExcludePattern&&this.globalExcludePattern(t,i)||this.matchFile(n,{base:e,basename:i})})),Promise.all(t.map((e=>this.searchInFolder(e,n)))).then((e=>{i({limitHit:this.isLimitHit,stats:e[0]||void 0})}),(e=>{r(new Error((0,l.yJ)(e)))}))}))}async searchInFolder(e,t){const i=new c.AU,r=this.getSearchOptionsForFolder(e),n=this.initDirectoryTree(),s=new p.u2(this.config,e),o=!s.hasSiblingExcludeClauses();let l;try{this.activeCancellationTokens.add(i),l=h.G.create();const c=await this.provider.provideFileSearchResults({pattern:this.config.filePattern||""},r,i.token),d=l.elapsed(),u=h.G.create();return this.isCanceled&&!this.isLimitHit?null:(c&&c.forEach((i=>{const r=a.KR.relative(e.folder.path,i.path);if(o){const n=(0,a.EZ)(i.path);this.matchFile(t,{base:e.folder,relativePath:r,basename:n})}else this.addDirectoryEntries(n,e.folder,r,t)})),this.isCanceled&&!this.isLimitHit?null:(this.matchDirectoryTree(n,s,t),{providerTime:d,postProcessTime:u.elapsed()}))}finally{i.dispose(),this.activeCancellationTokens.delete(i)}}getSearchOptionsForFolder(e){const t=(0,p.fV)(this.config.includePattern,e.includePattern),i=(0,p.fV)(this.config.excludePattern,e.excludePattern);return{folder:e.folder,excludes:i,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,maxResults:this.config.maxResults,session:this.sessionToken}}initDirectoryTree(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}addDirectoryEntries({pathToEntries:e},t,i,r){if(i===this.filePattern){const e=(0,a.EZ)(this.filePattern);this.matchFile(r,{base:t,relativePath:this.filePattern,basename:e})}!function i(r){const n=(0,a.EZ)(r),s=(0,a.XX)(r);let o=e[s];o||(o=e[s]=[],i(s)),o.push({base:t,relativePath:r,basename:n})}(i)}matchDirectoryTree({rootEntries:e,pathToEntries:t},i,r){const n=this,s=this.filePattern;!function e(o){const a=(0,p.x2)((()=>o.map((e=>e.basename))));for(let c=0,l=o.length;c<l;c++){const l=o[c],{relativePath:d,basename:u}=l;if(i.matchesExcludesSync(d,u,s!==u?a:void 0))continue;const h=t[d];if(h)e(h);else{if(d===s)continue;n.matchFile(r,l)}if(n.isLimitHit)break}}(e)}matchFile(e,t){(!this.includePattern||t.relativePath&&this.includePattern(t.relativePath,t.basename))&&((this.exists||this.maxResults&&this.resultCount>=this.maxResults)&&(this.isLimitHit=!0,this.cancel()),this.isLimitHit||e(t))}}class f{constructor(){this.sessions=new Map}static{this.BATCH_SIZE=512}fileSearch(e,t,i,r){const n=this.getSessionTokenSource(e.cacheKey),s=new m(e,t,n&&n.token);let o=0;return this.doSearch(s,f.BATCH_SIZE,(e=>{o+=e.length,i(e.map((e=>this.rawMatchToSearchItem(e))))}),r).then((e=>({limitHit:e.limitHit,stats:{fromCache:!1,type:"fileSearchProvider",resultCount:o,detailStats:e.stats}})))}clearCache(e){const t=this.getSessionTokenSource(e);t?.cancel()}getSessionTokenSource(e){if(e)return this.sessions.has(e)||this.sessions.set(e,new c.AU),this.sessions.get(e)}rawMatchToSearchItem(e){return e.relativePath?{resource:(0,u.Vo)(e.base,e.relativePath)}:{resource:e.base}}doSearch(e,t,i,r){const n=r.onCancellationRequested((()=>{e.cancel()}));let s=[];return e.search((e=>{e&&(s.push(e),t>0&&s.length>=t&&(i(s),s=[]))})).then((e=>(s.length&&i(s),n.dispose(),e)),(e=>(s.length&&i(s),n.dispose(),Promise.reject(e))))}}var g=i(82722),v=i(76221),_=i(26713),b=i(42731),w=i(78074),y=i(35820),x=i(59301);class C{constructor(e,t,i){this.queryProviderPair=e,this.fileUtils=t,this.processType=i,this.collector=null,this.isLimitHit=!1,this.resultCount=0}get query(){return this.queryProviderPair.query}search(e,t){const i=this.query.folderQueries||[],r=new c.AU(t);return new Promise(((t,n)=>{this.collector=new S(e);let s=!1;const o=(e,t)=>{if(!s&&!this.isLimitHit){const i=this.resultSize(e);E(e)&&"number"==typeof this.query.maxResults&&this.resultCount+i>this.query.maxResults&&(this.isLimitHit=!0,s=!0,r.cancel(),e=this.trimResultToSize(e,this.query.maxResults-this.resultCount));const n=this.resultSize(e);this.resultCount+=n,(n>0||!E(e))&&this.collector.add(e,t)}};Promise.all(i.map(((e,t)=>this.searchInFolder(e,(e=>o(e,t)),r.token)))).then((e=>{r.dispose(),this.collector.flush();const i=e.some((e=>!!e&&!!e.limitHit));t({limitHit:this.isLimitHit||i,messages:(0,w.xH)(e.map((e=>e?.message?Array.isArray(e.message)?e.message:[e.message]:[]))),stats:{type:this.processType}})}),(e=>{r.dispose();const t=(0,l.yJ)(e);n(new Error(t))}))}))}resultSize(e){return E(e)?Array.isArray(e.ranges)?e.ranges.length:1:0}trimResultToSize(e,t){const i=Array.isArray(e.ranges)?e.ranges:[e.ranges],r=Array.isArray(e.preview.matches)?e.preview.matches:[e.preview.matches];return{ranges:i.slice(0,t),preview:{matches:r.slice(0,t),text:e.preview.text},uri:e.uri}}async searchInFolder(e,t,i){const r=new p.u2(this.query,e),n=[],s={report:i=>{if(!this.validateProviderResult(i))return;const s=e.folder.scheme===x.lg.file?(0,p.tZ)((()=>this.fileUtils.readdir((0,u.XX)(i.uri)))):void 0,o=(0,u.lX)(e.folder,i.uri);if(o){const e=r.includedInQuery(o,(0,a.EZ)(o),s);(0,y.J8)(e)?n.push(e.then((e=>{e&&t(i)}))):e&&t(i)}}},o=this.getSearchOptionsForFolder(e);let c;var l;return c=3===this.queryProviderPair.query.type?await this.queryProviderPair.provider.provideAITextSearchResults(this.queryProviderPair.query.contentPattern,o,s,i):await this.queryProviderPair.provider.provideTextSearchResults((l=this.queryProviderPair.query.contentPattern,{isCaseSensitive:l.isCaseSensitive||!1,isRegExp:l.isRegExp||!1,isWordMatch:l.isWordMatch||!1,isMultiline:l.isMultiline||!1,pattern:l.pattern}),o,s,i),n.length&&await Promise.all(n),c}validateProviderResult(e){if(E(e))if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1;return!0}getSearchOptionsForFolder(e){const t=(0,p.fV)(this.query.includePattern,e.includePattern),i=(0,p.fV)(this.query.excludePattern,e.excludePattern),r={folder:b.ov.from(e.folder),excludes:i,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,encoding:e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding),maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults,previewOptions:this.query.previewOptions,afterContext:this.query.afterContext,beforeContext:this.query.beforeContext};return"usePCRE2"in this.query&&(r.usePCRE2=this.query.usePCRE2),r}}class S{constructor(e){this._onResult=e,this._currentFolderIdx=-1,this._currentFileMatch=null,this._batchedCollector=new D(512,(e=>this.sendItems(e)))}add(e,t){!this._currentFileMatch||this._currentFolderIdx===t&&(0,u.Xy)(this._currentUri,e.uri)||(this.pushToCollector(),this._currentFileMatch=null),this._currentFileMatch||(this._currentFolderIdx=t,this._currentFileMatch={resource:e.uri,results:[]}),this._currentFileMatch.results.push(function(e){return E(e)?{preview:{matches:(0,w.Gb)(e.preview.matches,(e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character}))),text:e.preview.text},ranges:(0,w.Gb)(e.ranges,(e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character})))}:{text:e.text,lineNumber:e.lineNumber}}(e))}pushToCollector(){const e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector(),this._batchedCollector.flush()}sendItems(e){this._onResult(e)}}function E(e){return!!e.preview}class D{static{this.TIMEOUT=4e3}static{this.START_BATCH_AFTER_COUNT=50}constructor(e,t){this.maxBatchSize=e,this.cb=t,this.totalNumberCompleted=0,this.batch=[],this.batchSize=0}addItem(e,t){e&&this.addItemToBatch(e,t)}addItems(e,t){e&&this.addItemsToBatch(e,t)}addItemToBatch(e,t){this.batch.push(e),this.batchSize+=t,this.onUpdate()}addItemsToBatch(e,t){this.batch=this.batch.concat(e),this.batchSize+=t,this.onUpdate()}onUpdate(){this.totalNumberCompleted<D.START_BATCH_AFTER_COUNT||this.batchSize>=this.maxBatchSize?this.flush():this.timeoutHandle||(this.timeoutHandle=setTimeout((()=>{this.flush()}),D.TIMEOUT))}flush(){this.batchSize&&(this.totalNumberCompleted+=this.batchSize,this.cb(this.batch),this.batch=[],this.batchSize=0,this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=0))}}const k=(0,o.yh)("IExtHostSearch");let I=class{constructor(e,t,i){this.extHostRpc=e,this._uriTransformer=t,this._logService=i,this._proxy=this.extHostRpc.getProxy(s.Tr.MainThreadSearch),this._handlePool=0,this._textSearchProvider=new Map,this._textSearchUsedSchemes=new Set,this._aiTextSearchProvider=new Map,this._aiTextSearchUsedSchemes=new Set,this._fileSearchProvider=new Map,this._fileSearchUsedSchemes=new Set,this._fileSearchManager=new f}_transformScheme(e){return this._uriTransformer.transformOutgoingScheme(e)}registerTextSearchProvider(e,t){if(this._textSearchUsedSchemes.has(e))throw new Error(`a text search provider for the scheme '${e}' is already registered`);this._textSearchUsedSchemes.add(e);const i=this._handlePool++;return this._textSearchProvider.set(i,t),this._proxy.$registerTextSearchProvider(i,this._transformScheme(e)),(0,n.OF)((()=>{this._textSearchUsedSchemes.delete(e),this._textSearchProvider.delete(i),this._proxy.$unregisterProvider(i)}))}registerAITextSearchProvider(e,t){if(this._aiTextSearchUsedSchemes.has(e))throw new Error(`an AI text search provider for the scheme '${e}'is already registered`);this._aiTextSearchUsedSchemes.add(e);const i=this._handlePool++;return this._aiTextSearchProvider.set(i,t),this._proxy.$registerAITextSearchProvider(i,this._transformScheme(e)),(0,n.OF)((()=>{this._aiTextSearchUsedSchemes.delete(e),this._aiTextSearchProvider.delete(i),this._proxy.$unregisterProvider(i)}))}registerFileSearchProvider(e,t){if(this._fileSearchUsedSchemes.has(e))throw new Error(`a file search provider for the scheme '${e}' is already registered`);this._fileSearchUsedSchemes.add(e);const i=this._handlePool++;return this._fileSearchProvider.set(i,t),this._proxy.$registerFileSearchProvider(i,this._transformScheme(e)),(0,n.OF)((()=>{this._fileSearchUsedSchemes.delete(e),this._fileSearchProvider.delete(i),this._proxy.$unregisterProvider(i)}))}$provideFileSearchResults(e,t,i,r){const n=P(i),s=this._fileSearchProvider.get(e);if(s)return this._fileSearchManager.fileSearch(n,s,(i=>{this._proxy.$handleFileMatch(e,t,i.map((e=>e.resource)))}),r);throw new Error("3 unknown provider: "+e)}async doInternalFileSearchWithCustomCallback(e,t,i){return{messages:[]}}$clearCache(e){return this._fileSearchManager.clearCache(e),Promise.resolve(void 0)}$provideTextSearchResults(e,t,i,r){const n=this._textSearchProvider.get(e);if(!n||!n.provideTextSearchResults)throw new Error(`2 Unknown provider ${e}`);const s=P(i);return this.createTextSearchManager(s,n).search((i=>this._proxy.$handleTextMatch(e,t,i)),r)}$provideAITextSearchResults(e,t,i,r){const n=this._aiTextSearchProvider.get(e);if(!n||!n.provideAITextSearchResults)throw new Error(`1 Unknown provider ${e}`);const s=P(i);return this.createAITextSearchManager(s,n).search((i=>this._proxy.$handleTextMatch(e,t,i)),r)}$enableExtensionHostSearch(){}createTextSearchManager(e,t){return new C({query:e,provider:t},{readdir:e=>Promise.resolve([]),toCanonicalName:e=>e},"textSearchProvider")}createAITextSearchManager(e,t){return new C({query:e,provider:t},{readdir:e=>Promise.resolve([]),toCanonicalName:e=>e},"aiTextSearchProvider")}};function P(e){return{...e,folderQueries:e.folderQueries&&e.folderQueries.map(T),extraFileResources:e.extraFileResources&&e.extraFileResources.map((e=>b.ov.revive(e)))}}function T(e){return{...e,folder:b.ov.revive(e.folder)}}I=(0,r.g)([(0,r.f)(0,g.O),(0,r.f)(1,v.F),(0,r.f)(2,_.V)],I)},8685:function(e,t,i){i.d(t,{Z:function(){return a},p:function(){return o}});var r=i(78293),n=i(81557),s=i(28019);class o{constructor(e){this._onDidChangePassword=new n.Q5,this.onDidChangePassword=this._onDidChangePassword.event,this._proxy=e.getProxy(r.Tr.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,t){return this._proxy.$getPassword(e,t)}store(e,t,i){return this._proxy.$setPassword(e,t,i)}delete(e,t){return this._proxy.$deletePassword(e,t)}}const a=(0,s.yh)("IExtHostSecretState")},34142:function(e,t,i){i.d(t,{W:function(){return a},Y:function(){return o}});var r=i(78293),n=i(81557),s=i(28019);class o{constructor(e,t){this._logService=t,this._onDidChangeStorage=new n.Q5,this.onDidChangeStorage=this._onDidChangeStorage.event,this._proxy=e.getProxy(r.Tr.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this._proxy.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,i){const r=await this._proxy.$initializeExtensionStorage(e,t);let n;return r&&(n=this.safeParseValue(e,t,r)),n||i}setValue(e,t,i){return this._proxy.$setValue(e,t,i)}$acceptValue(e,t,i){const r=this.safeParseValue(e,t,i);r&&this._onDidChangeStorage.fire({shared:e,key:t,value:r})}safeParseValue(e,t,i){try{return JSON.parse(i)}catch(i){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${i}`)}}}const a=(0,s.yh)("IExtHostStorage")},3621:function(e,t,i){i.d(t,{L:function(){return l},j:function(){return d}});var r=i(45493),n=i(28019),s=i(73820),o=i(26713),a=i(77600),c=i(42731);const l=(0,n.yh)("IExtensionStoragePaths");let d=class{constructor(e,t,i){this._logService=t,this._extHostFileSystem=i,this._workspace=e.workspace??void 0,this._environment=e.environment,this.whenReady=this._getOrCreateWorkspaceStoragePath().then((e=>this._value=e))}async _getWorkspaceStorageURI(e){return c.ov.joinPath(this._environment.workspaceStorageHome,e)}async _getOrCreateWorkspaceStoragePath(){if(!this._workspace)return Promise.resolve(void 0);const e=this._workspace.id,t=await this._getWorkspaceStorageURI(e);try{return await this._extHostFileSystem.value.stat(t),this._logService.trace("[ExtHostStorage] storage dir already exists",t),t}catch{}try{return this._logService.trace("[ExtHostStorage] creating dir and metadata-file",t),await this._extHostFileSystem.value.createDirectory(t),await this._extHostFileSystem.value.writeFile(c.ov.joinPath(t,"meta.json"),(new TextEncoder).encode(JSON.stringify({id:this._workspace.id,configuration:c.ov.revive(this._workspace.configuration)?.toString(),name:this._workspace.name},void 0,2))),t}catch(e){return void this._logService.error("[ExtHostStorage]",e)}}workspaceValue(e){if(this._value)return c.ov.joinPath(this._value,e.identifier.value)}globalValue(e){return c.ov.joinPath(this._environment.globalStorageHome,e.identifier.value.toLowerCase())}onWillDeactivateAll(){}};d=(0,r.g)([(0,r.f)(0,s.$),(0,r.f)(1,o.V),(0,r.f)(2,a.a)],d)},87958:function(e,t,i){i.d(t,{TE:function(){return L},h2:function(){return N}});var r,n,s,o,a,c,l,d,u,h,p=i(45493),m=i(42731),f=i(35820),g=i(81557),v=i(78293),_=i(30874),b=i(89608),w=i(1663),y=i(63537),x=i(17126),C=i(82209),S=i(82722),E=i(73820),D=i(28019),k=i(59301),I=i(11547),P=i(26713),T=i(43878),A=(i(81048),i(54316));!function(e){e.from=function(e){if(null!=e)return e},e.to=function(e){if(null!=e)return e}}(r||(r={})),function(e){e.from=function(e){if(null!=e)return e},e.to=function(e){if(null!=e)return e}}(n||(n={})),function(e){e.from=function(e){if(null!=e)return e},e.to=function(e){if(null!=e)return e}}(s||(s={})),function(e){e.is=function(e){if(e){return e&&!!e.process}return!1},e.from=function(e){if(null==e)return;const t={process:e.process,args:e.args};return e.options&&(t.options=s.from(e.options)),t},e.to=function(e){if(null!=e)return new _.OLe(e.process,e.args,e.options)}}(o||(o={})),function(e){e.from=function(e){if(null!=e)return e},e.to=function(e){if(null!=e)return e}}(a||(a={})),function(e){e.is=function(e){if(e){const t=e;return t&&(!!t.commandLine||!!t.command)}return!1},e.from=function(e){if(null==e)return;const t={};return void 0!==e.commandLine?t.commandLine=e.commandLine:(t.command=e.command,t.args=e.args),e.options&&(t.options=a.from(e.options)),t},e.to=function(e){if(null!=e&&(void 0!==e.command||void 0!==e.commandLine))return e.commandLine?new _.yGk(e.commandLine,e.options):new _.yGk(e.command,e.args?e.args:[],e.options)}}(c||(c={})),function(e){e.is=function(e){if(e){return e&&"customExecution"===e.customExecution}return!1},e.from=function(e){return{customExecution:"customExecution"}},e.to=function(e,t){return t.get(e)}}(l||(l={})),function(e){e.from=function(e){if(null!=e)return{_id:e.id,isDefault:e.isDefault}}}(d||(d={})),function(e){function t(e,t){if(null==e)return;let i;e.execution instanceof _.OLe?i=o.from(e.execution):e.execution instanceof _.yGk?i=c.from(e.execution):e.execution&&e.execution instanceof _.mgN&&(i=l.from(e.execution));const s=r.from(e.definition);let a;if(a=e.scope?"number"==typeof e.scope?e.scope:e.scope.uri:_.qNe.Workspace,!s||!a)return;return{_id:e._id,definition:s,name:e.name,source:{extensionId:t.identifier.value,label:e.source,scope:a},execution:i,isBackground:e.isBackground,group:d.from(e.group),presentationOptions:n.from(e.presentationOptions),problemMatchers:e.problemMatchers,hasDefinedMatchers:e.hasDefinedMatchers,runOptions:e.runOptions?e.runOptions:{reevaluateOnRerun:!0},detail:e.detail}}e.fromMany=function(e,i){if(null==e)return[];const r=[];for(const n of e){const e=t(n,i);e&&r.push(e)}return r},e.from=t,e.to=async function(e,t,i){if(null==e)return;let s;o.is(e.execution)?s=o.to(e.execution):c.is(e.execution)?s=c.to(e.execution):l.is(e.execution)&&(s=l.to(e._id,i));const a=r.to(e.definition);let d;if(e.source&&(d=void 0!==e.source.scope?"number"==typeof e.source.scope?e.source.scope:await t.resolveWorkspaceFolder(m.ov.revive(e.source.scope)):_.qNe.Workspace),!a||!d)return;const u=new _.iQE(a,d,e.name,e.source.label,s,e.problemMatchers);return void 0!==e.isBackground&&(u.isBackground=e.isBackground),void 0!==e.group&&(u.group=_.p5U.from(e.group._id),u.group&&e.group.isDefault&&(u.group=new _.p5U(u.group.id,u.group.label),!0===e.group.isDefault&&(u.group.isDefault=e.group.isDefault))),e.presentationOptions&&(u.presentationOptions=n.to(e.presentationOptions)),e._id&&(u._id=e._id),e.detail&&(u.detail=e.detail),u}}(u||(u={})),function(e){e.from=function(e){return e},e.to=function(e){if(e)return Object.assign(Object.create(null),e)}}(h||(h={}));class R{#a;constructor(e,t,i){this._id=t,this._task=i,this.#a=e}get task(){return this._task}terminate(){this.#a.terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}}let $=class{constructor(e,t,i,r,n,s,o,a){this._onDidExecuteTask=new g.Q5,this._onDidTerminateTask=new g.Q5,this._onDidTaskProcessStarted=new g.Q5,this._onDidTaskProcessEnded=new g.Q5,this._proxy=e.getProxy(v.Tr.MainThreadTask),this._workspaceProvider=i,this._editorService=r,this._configurationService=n,this._terminalService=s,this._handleCounter=0,this._handlers=new Map,this._taskExecutions=new Map,this._taskExecutionPromises=new Map,this._providedCustomExecutions2=new Map,this._notProvidedCustomExecutions=new Set,this._activeCustomExecutions2=new Map,this._logService=o,this._deprecationService=a,this._proxy.$registerSupportedExecutions(!0)}registerTaskProvider(e,t,i){if(!i)return new _.JTr((()=>{}));const r=this.nextHandle();return this._handlers.set(r,{type:t,provider:i,extension:e}),this._proxy.$registerTaskProvider(r,t),new _.JTr((()=>{this._handlers.delete(r),this._proxy.$unregisterTaskProvider(r)}))}registerTaskSystem(e,t){this._proxy.$registerTaskSystem(e,t)}fetchTasks(e){return this._proxy.$fetchTasks(h.from(e)).then((async e=>{const t=[];for(const i of e){const e=await u.to(i,this._workspaceProvider,this._providedCustomExecutions2);e&&t.push(e)}return t}))}get taskExecutions(){const e=[];return this._taskExecutions.forEach((t=>e.push(t))),e}terminateTask(e){if(!(e instanceof R))throw new Error("No valid task execution provided");return this._proxy.$terminateTask(e._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(e,t,i){const r=this._providedCustomExecutions2.get(e.id);r&&(this._activeCustomExecutions2.set(e.id,r),this._terminalService.attachPtyToTerminal(t,await r.callback(i))),this._lastStartedTask=e.id,this._onDidExecuteTask.fire({execution:await this.getTaskExecution(e)})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(e){if(!this._taskExecutionPromises.has(e.id))return;const t=await this.getTaskExecution(e);this._taskExecutionPromises.delete(e.id),this._taskExecutions.delete(e.id),this.customExecutionComplete(e),this._onDidTerminateTask.fire({execution:t})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessStarted.fire({execution:t,processId:e.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessEnded.fire({execution:t,exitCode:e.exitCode})}$provideTasks(e,t){const i=this._handlers.get(e);if(!i)return Promise.reject(new Error("no handler found"));const r=[],n=(0,f.OH)((()=>i.provider.provideTasks(x.Ts.None))).then((e=>this.provideTasksInternal(t,r,i,e)));return new Promise((e=>{n.then((t=>{Promise.all(r).then((()=>{e(t)}))}))}))}async $resolveTask(e,t){const i=this._handlers.get(e);if(!i)return Promise.reject(new Error("no handler found"));if(t.definition.type!==i.type)throw new Error(`Unexpected: Task of type [${t.definition.type}] cannot be resolved by provider of type [${i.type}].`);const r=await u.to(t,this._workspaceProvider,this._providedCustomExecutions2);if(!r)throw new Error("Unexpected: Task cannot be resolved.");const n=await i.provider.resolveTask(r,x.Ts.None);if(!n)return;this.checkDeprecation(n,i);const s=u.from(n,i.extension);if(!s)throw new Error("Unexpected: Task cannot be resolved.");if(n.definition!==r.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return l.is(s.execution)&&await this.addCustomExecution(s,n,!0),await this.resolveTaskInternal(s)}nextHandle(){return this._handleCounter++}async addCustomExecution(e,t,i){const r=await this._proxy.$createTaskId(e);i||this._providedCustomExecutions2.has(r)||(this._notProvidedCustomExecutions.add(r),this._activeCustomExecutions2.set(r,t.execution)),this._providedCustomExecutions2.set(r,t.execution)}async getTaskExecution(e,t){if("string"==typeof e){const t=this._taskExecutionPromises.get(e);if(!t)throw new A.QD("Unexpected: The specified task is missing an execution");return t}const i=this._taskExecutionPromises.get(e.id);if(i)return i;let r;return r=t?Promise.resolve(new R(this,e.id,t)):u.to(e.task,this._workspaceProvider,this._providedCustomExecutions2).then((t=>{if(!t)throw new A.QD("Unexpected: Task does not exist.");return new R(this,e.id,t)})),this._taskExecutionPromises.set(e.id,r),r.then((t=>(this._taskExecutions.set(e.id,t),t)))}checkDeprecation(e,t){e._deprecated&&this._deprecationService.report("Task.constructor",t.extension,"Use the Task constructor that takes a `scope` instead.")}customExecutionComplete(e){this._activeCustomExecutions2.get(e.id)&&this._activeCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.has(e.id)&&this._lastStartedTask!==e.id&&(this._providedCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.delete(e.id));const t=this._notProvidedCustomExecutions.values();let i=t.next();for(;!i.done;)this._activeCustomExecutions2.has(i.value)||this._lastStartedTask===i.value||(this._providedCustomExecutions2.delete(i.value),this._notProvidedCustomExecutions.delete(i.value)),i=t.next()}};$=(0,p.g)([(0,p.f)(0,S.O),(0,p.f)(1,E.$),(0,p.f)(2,b.w),(0,p.f)(3,w.T),(0,p.f)(4,y.E1),(0,p.f)(5,C.$3),(0,p.f)(6,P.V),(0,p.f)(7,T.J)],$);let L=class extends ${constructor(e,t,i,r,n,s,o,a){super(e,t,i,r,n,s,o,a),this.registerTaskSystem(k.lg.vscodeRemote,{scheme:k.lg.vscodeRemote,authority:"",platform:(0,I.PW)(0)})}async executeTask(e,t){if(!t.execution)throw new Error("Tasks to execute must include an execution");const i=u.from(t,e);if(void 0===i)throw new Error("Task is not valid");if(!l.is(i.execution))throw new A.B8;await this.addCustomExecution(i,t,!1);const r=await this.getTaskExecution(await this._proxy.$getTaskExecution(i),t);return this._proxy.$executeTask(i).catch((e=>{throw new Error(e)})),r}provideTasksInternal(e,t,i,r){const n=[];if(r)for(const s of r){if(this.checkDeprecation(s,i),!s.definition||!e[s.definition.type]){const e=s.source?s.source:"No task source";this._logService.warn(`The task [${e}, ${s.name}] uses an undefined task type. The task will be ignored in the future.`)}const r=u.from(s,i.extension);r&&l.is(r.execution)?(n.push(r),t.push(this.addCustomExecution(r,s,!0))):this._logService.warn("Only custom execution tasks supported.")}return{tasks:n,extension:i.extension}}async resolveTaskInternal(e){if(l.is(e.execution))return e;this._logService.warn("Only custom execution tasks supported.")}async $resolveVariables(e,t){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(e,t,i){}};L=(0,p.g)([(0,p.f)(0,S.O),(0,p.f)(1,E.$),(0,p.f)(2,b.w),(0,p.f)(3,w.T),(0,p.f)(4,y.E1),(0,p.f)(5,C.$3),(0,p.f)(6,P.V),(0,p.f)(7,T.J)],L);const N=(0,D.yh)("IExtHostTask")},3560:function(e,t,i){i.d(t,{fv:function(){return b},jQ:function(){return v},oI:function(){return _},wM:function(){return g}});var r=i(45493),n=i(28019),s=i(81557),o=i(525),a=i(26713),c=i(73820),l=i(14879),d=i(16585),u=i(73426),h=i(82998),p=i(42731),m=i(7428),f=i(67525);let g=class extends m.JT{constructor(e,t){super(),this.initData=e,this.loggerService=t,this._onDidChangeTelemetryEnabled=this._register(new s.Q5),this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event,this._onDidChangeTelemetryConfiguration=this._register(new s.Q5),this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event,this._productConfig={usage:!0,error:!0},this._level=0,this._telemetryIsSupported=!1,this._inLoggingOnlyMode=!1,this._telemetryLoggers=new Map,this.extHostTelemetryLogFile=p.ov.revive(this.initData.environment.extensionTelemetryLogResource),this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly,this._outputLogger=t.createLogger(this.extHostTelemetryLogFile,{id:u.kG,name:(0,f.C$)("vs/workbench/api/common/extHostTelemetry",0,"Extension Telemetry{0}",this._inLoggingOnlyMode?" (Not Sent)":""),hidden:!0}),this._register(this._outputLogger),this._register(t.onDidChangeLogLevel((e=>{(0,o.w7)(e)&&this.updateLoggerVisibility()}))),this._outputLogger.info("Below are logs for extension telemetry events sent to the telemetry output channel API once the log level is set to trace."),this._outputLogger.info("===========================================================")}updateLoggerVisibility(){this.loggerService.setVisibility(this.extHostTelemetryLogFile,this._telemetryIsSupported&&this.loggerService.getLogLevel()===o.in.Trace)}getTelemetryConfiguration(){return 3===this._level}getTelemetryDetails(){return{isCrashEnabled:this._level>=1,isErrorsEnabled:!!this._productConfig.error&&this._level>=2,isUsageEnabled:!!this._productConfig.usage&&this._level>=3}}instantiateLogger(e,t,i){const r=this.getTelemetryDetails(),n=new v(t,i,e,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(e),{isUsageEnabled:r.isUsageEnabled,isErrorsEnabled:r.isErrorsEnabled}),s=this._telemetryLoggers.get(e.identifier.value)??[];return this._telemetryLoggers.set(e.identifier.value,[...s,n]),n.apiTelemetryLogger}$initializeTelemetryLevel(e,t,i){this._level=e,this._telemetryIsSupported=t,this._productConfig=i??{usage:!0,error:!0},this.updateLoggerVisibility()}getBuiltInCommonProperties(e){const t=Object.create(null);switch(t["common.extname"]=`${e.publisher}.${e.name}`,t["common.extversion"]=e.version,t["common.vscodemachineid"]=this.initData.telemetryInfo.machineId,t["common.vscodesessionid"]=this.initData.telemetryInfo.sessionId,t["common.sqmid"]=this.initData.telemetryInfo.sqmId,t["common.vscodeversion"]=this.initData.version,t["common.isnewappinstall"]=_(this.initData.telemetryInfo.firstSessionDate),t["common.product"]=this.initData.environment.appHost,this.initData.uiKind){case l.D$.Web:t["common.uikind"]="web";break;case l.D$.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}return t["common.remotename"]=(0,d.WX)((0,u.x0)(this.initData.remote.authority)),t}$onDidChangeTelemetryLevel(e){this._oldTelemetryEnablement=this.getTelemetryConfiguration(),this._level=e;const t=this.getTelemetryDetails();this._telemetryLoggers.forEach(((e,t)=>{const i=e.filter((e=>!e.isDisposed));0===i.length?this._telemetryLoggers.delete(t):this._telemetryLoggers.set(t,i)})),this._telemetryLoggers.forEach((e=>{for(const i of e)i.updateTelemetryEnablements(t.isUsageEnabled,t.isErrorsEnabled)})),this._oldTelemetryEnablement!==this.getTelemetryConfiguration()&&this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration()),this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails()),this.updateLoggerVisibility()}onExtensionError(e,t){const i=this._telemetryLoggers.get(e.value),r=i?.filter((e=>!e.isDisposed));if(!r)return this._telemetryLoggers.delete(e.value),!1;let n=!1;for(const e of r)e.ignoreUnhandledExtHostErrors||(e.logError(t),n=!0);return n}};g=(0,r.g)([(0,r.f)(0,c.$),(0,r.f)(1,a.y)],g);class v{static validateSender(e){if("object"!=typeof e)throw new TypeError("TelemetrySender argument is invalid");if("function"!=typeof e.sendEventData)throw new TypeError("TelemetrySender.sendEventData must be a function");if("function"!=typeof e.sendErrorData)throw new TypeError("TelemetrySender.sendErrorData must be a function");if(void 0!==e.flush&&"function"!=typeof e.flush)throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,i,r,n,o,a){this._extension=i,this._logger=r,this._inLoggingOnlyMode=n,this._commonProperties=o,this._onDidChangeEnableStates=new s.Q5,this.ignoreUnhandledExtHostErrors=t?.ignoreUnhandledErrors??!1,this._ignoreBuiltinCommonProperties=t?.ignoreBuiltInCommonProperties??!1,this._additionalCommonProperties=t?.additionalCommonProperties,this._sender=e,this._telemetryEnablements={isUsageEnabled:a.isUsageEnabled,isErrorsEnabled:a.isErrorsEnabled}}updateTelemetryEnablements(e,t){this._apiObject&&(this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:t},this._onDidChangeEnableStates.fire(this._apiObject))}mixInCommonPropsAndCleanData(e){let t="properties"in e?e.properties??{}:e;return t=(0,u.cG)(t,[]),this._additionalCommonProperties&&(t=(0,h.jB)(t,this._additionalCommonProperties)),this._ignoreBuiltinCommonProperties||(t=(0,h.jB)(t,this._commonProperties)),"properties"in e?e.properties=t:e=t,e}logEvent(e,t){this._sender&&(e="vscode"===this._extension.publisher?this._extension.name+"/"+e:this._extension.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender?.sendEventData(e,t),this._logger.trace(e,t))}logUsage(e,t){this._telemetryEnablements.isUsageEnabled&&this.logEvent(e,t)}logError(e,t){if(this._telemetryEnablements.isErrorsEnabled&&this._sender)if("string"==typeof e)this.logEvent(e,t);else{const i={name:e.name,message:e.message,stack:e.stack,cause:e.cause},r=(0,u.cG)(i,[]),n=new Error(r.message,{cause:r.cause});n.stack=r.stack,n.name=r.name,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender.sendErrorData(n,t),this._logger.trace("exception",t)}}get apiTelemetryLogger(){if(!this._apiObject){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(t)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){if(this._sender?.flush){let e=this._sender;this._sender=void 0,Promise.resolve(e.flush()).then(e=void 0),this._apiObject=void 0}else this._sender=void 0}}function _(e){const t=Date.now()-new Date(e).getTime();return!isNaN(t)&&t<864e5}const b=(0,n.yh)("IExtHostTelemetry")},82209:function(e,t,i){i.d(t,{$3:function(){return y},Ry:function(){return I}});var r=i(45493),n=i(81557),s=i(78293),o=i(28019),a=i(42731),c=i(82722),l=i(7428),d=i(30874),u=i(67525),h=i(54316),p=i(83856),m=i(17126),f=i(92004),g=i(92206),v=i(27528),_=i(35820),b=i(17430),w=i(85315);const y=(0,o.yh)("IExtHostTerminalService");class x extends l.JT{constructor(e,t,i,r){super(),this._proxy=e,this._id=t,this._creationOptions=i,this._name=r,this._disposed=!1,this._state={isInteractedWith:!1},this.isOpen=!1,this._onWillDispose=this._register(new n.Q5),this.onWillDispose=this._onWillDispose.event,this._creationOptions=Object.freeze(this._creationOptions),this._pidPromise=new Promise((e=>this._pidPromiseComplete=e));const s=this;this.value={get name(){return s._name||""},get processId(){return s._pidPromise},get creationOptions(){return s._creationOptions},get exitStatus(){return s._exitStatus},get state(){return s._state},get selection(){return s._selection},get shellIntegration(){return s.shellIntegration},sendText(e,t=!0){s._checkDisposed(),s._proxy.$sendText(s._id,e,t)},show(e){s._checkDisposed(),s._proxy.$show(s._id,e)},hide(){s._checkDisposed(),s._proxy.$hide(s._id)},dispose(){s._disposed||(s._disposed=!0,s._proxy.$dispose(s._id))},get dimensions(){if(void 0!==s._cols&&void 0!==s._rows)return{columns:s._cols,rows:s._rows}}}}dispose(){this._onWillDispose.fire(),super.dispose()}async create(e,t){if("string"!=typeof this._id)throw new Error("Terminal has already been created");await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??t?.cwd??void 0,env:e.env??void 0,icon:P(e.iconPath)??void 0,color:v.tP.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:t?.forceShellIntegration??void 0,isFeatureTerminal:t?.isFeatureTerminal??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:t?.useShellEnvironment??void 0,location:t?.location||this._serializeParentTerminal(e.location,t?.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0})}async createExtensionTerminal(e,t,i,r,n){if("string"!=typeof this._id)throw new Error("Terminal has already been created");if(await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:!0,icon:r,color:v.tP.isThemeColor(n)?n.id:void 0,location:t?.location||this._serializeParentTerminal(e,i),isTransient:!0}),"string"==typeof this._id)throw new Error("Terminal creation failed");return this._id}_serializeParentTerminal(e,t){return"object"==typeof e?"parentTerminal"in e&&e.parentTerminal&&t?{parentTerminal:t}:"viewColumn"in e?{viewColumn:b.eI.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}_checkDisposed(){if(this._disposed)throw new Error("Terminal has already been disposed")}set name(e){this._name=e}setExitStatus(e,t){this._exitStatus=Object.freeze({code:e,reason:t})}setDimensions(e,t){return(e!==this._cols||t!==this._rows)&&(0!==e&&0!==t&&(this._cols=e,this._rows=t,!0))}setInteractedWith(){return!this._state.isInteractedWith&&(this._state={isInteractedWith:!0},!0)}setSelection(e){this._selection=e}_setProcessId(e){this._pidPromiseComplete?(this._pidPromiseComplete(e),this._pidPromiseComplete=void 0):this._pidPromise.then((t=>{t!==e&&(this._pidPromise=Promise.resolve(e))}))}}class C{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e,this.id=0,this.shouldPersist=!1,this._onProcessData=new n.Q5,this.onProcessData=this._onProcessData.event,this._onProcessReady=new n.Q5,this._onDidChangeProperty=new n.Q5,this.onDidChangeProperty=this._onDidChangeProperty.event,this._onProcessExit=new n.Q5,this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this._pty.close()}input(e){this._pty.handleInput?.(e)}resize(e,t){this._pty.setDimensions?.({columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){this._pty.onDidWrite((e=>this._onProcessData.fire(e))),this._pty.onDidClose?.(((e=void 0)=>{this._onProcessExit.fire(void 0===e?void 0:e)})),this._pty.onDidOverrideDimensions?.((e=>{e&&this._onDidChangeProperty.fire({type:"overrideDimensions",value:{cols:e.columns,rows:e.rows}})})),this._pty.onDidChangeName?.((e=>{this._onDidChangeProperty.fire({type:"title",value:e})})),this._pty.open(e||void 0),e&&this._pty.setDimensions?.(e),this._onProcessReady.fire({pid:-1,cwd:"",windowsPty:void 0})}}let S=1,E=class extends l.JT{get activeTerminal(){return this._activeTerminal?.value}get terminals(){return this._terminals.map((e=>e.value))}constructor(e,t,i){super(),this._extHostCommands=t,this._terminals=[],this._terminalProcesses=new Map,this._terminalProcessDisposables={},this._extensionTerminalAwaitingStart={},this._getTerminalPromises={},this._environmentVariableCollections=new Map,this._lastQuickFixCommands=this._register(new l.XK),this._linkProviders=new Set,this._profileProviders=new Map,this._quickFixProviders=new Map,this._terminalLinkCache=new Map,this._terminalLinkCancellationSource=new Map,this._onDidCloseTerminal=new n.Q5,this.onDidCloseTerminal=this._onDidCloseTerminal.event,this._onDidOpenTerminal=new n.Q5,this.onDidOpenTerminal=this._onDidOpenTerminal.event,this._onDidChangeActiveTerminal=new n.Q5,this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event,this._onDidChangeTerminalDimensions=new n.Q5,this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event,this._onDidChangeTerminalState=new n.Q5,this.onDidChangeTerminalState=this._onDidChangeTerminalState.event,this._onDidChangeShell=new n.Q5,this.onDidChangeShell=this._onDidChangeShell.event,this._onDidWriteTerminalData=new n.Q5({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this._onDidWriteTerminalData.event,this._onDidExecuteCommand=new n.Q5({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event,this._proxy=i.getProxy(s.Tr.MainThreadTerminalService),this._bufferer=new g.$(this._proxy.$sendProcessData),this._proxy.$registerProcessSupport(e),this._extHostCommands.registerArgumentProcessor({processArgument:e=>{const t=e=>{const t=e;return this.getTerminalById(t.instanceId)?.value};if(15===e?.$mid)return t(e);if(Array.isArray(e))for(let i=0;i<e.length&&15===e[i].$mid;i++)e[i]=t(e[i]);return e}}),this._register({dispose:()=>{for(const[e,t]of this._terminalProcesses)t.shutdown(!0)}})}getDefaultShell(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return t?.path||""}getDefaultShellArgs(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return t?.args||[]}createExtensionTerminal(e,t){const i=new x(this._proxy,(0,f.R)(),e,e.name),r=new C(e.pty);var n;return i.createExtensionTerminal(e.location,t,this._serializeParentTerminal(e,t).resolvedExtHostIdentifier,P(e.iconPath),(n=e.color,v.tP.isThemeColor(n)?n:void 0)).then((e=>{const t=this._setupExtHostProcessListeners(e,r);this._terminalProcessDisposables[e]=t})),this._terminals.push(i),i.value}_serializeParentTerminal(e,t){if(t=t||{},e.location&&"object"==typeof e.location&&"parentTerminal"in e.location){const i=e.location.parentTerminal;if(i){const e=this._terminals.find((e=>e.value===i));e&&(t.resolvedExtHostIdentifier=e._id)}}else e.location&&"object"!=typeof e.location?t.location=e.location:t.location&&"object"==typeof t.location&&"splitActiveTerminal"in t.location&&(t.location={splitActiveTerminal:!0});return t}attachPtyToTerminal(e,t){if(!this.getTerminalById(e))throw new Error(`Cannot resolve terminal with id ${e} for virtual process`);const i=new C(t),r=this._setupExtHostProcessListeners(e,i);this._terminalProcessDisposables[e]=r}async $acceptActiveTerminalChanged(e){const t=this._activeTerminal;if(null===e)return this._activeTerminal=void 0,void(t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal));const i=this.getTerminalById(e);i&&(this._activeTerminal=i,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal.value))}async $acceptTerminalProcessData(e,t){const i=this.getTerminalById(e);i&&this._onDidWriteTerminalData.fire({terminal:i.value,data:t})}async $acceptTerminalDimensions(e,t,i){const r=this.getTerminalById(e);r&&r.setDimensions(t,i)&&this._onDidChangeTerminalDimensions.fire({terminal:r.value,dimensions:r.value.dimensions})}async $acceptDidExecuteCommand(e,t){const i=this.getTerminalById(e);i&&this._onDidExecuteCommand.fire({terminal:i.value,...t})}async $acceptTerminalMaximumDimensions(e,t,i){this._terminalProcesses.get(e)?.resize(t,i)}async $acceptTerminalTitleChange(e,t){const i=this.getTerminalById(e);i&&(i.name=t)}async $acceptTerminalClosed(e,t,i){const r=this._getTerminalObjectIndexById(this._terminals,e);if(null!==r){const e=this._terminals.splice(r,1)[0];e.setExitStatus(t,i),this._onDidCloseTerminal.fire(e.value)}}$acceptTerminalOpened(e,t,i,r){if(t){const i=this._getTerminalObjectIndexById(this._terminals,t);if(null!==i)return this._terminals[i]._id=e,this._onDidOpenTerminal.fire(this.terminals[i]),void(this._terminals[i].isOpen=!0)}const n={name:r.name,shellPath:r.executable,shellArgs:r.args,cwd:"string"==typeof r.cwd?r.cwd:a.ov.revive(r.cwd),env:r.env,hideFromUser:r.hideFromUser},s=new x(this._proxy,e,n,i);this._terminals.push(s),this._onDidOpenTerminal.fire(s.value),s.isOpen=!0}async $acceptTerminalProcessId(e,t){const i=this.getTerminalById(e);i?._setProcessId(t)}async $startExtensionTerminal(e,t){const i=this.getTerminalById(e);if(!i)return{message:(0,u.C$)("vs/workbench/api/common/extHostTerminalService",0,"Could not find the terminal with id {0} on the extension host",e)};i.isOpen||await new Promise((e=>{const t=this.onDidOpenTerminal((async r=>{r===i.value&&(t.dispose(),e())}))}));const r=this._terminalProcesses.get(e);r?r.startSendingEvents(t):this._extensionTerminalAwaitingStart[e]={initialDimensions:t}}_setupExtHostProcessListeners(e,t){const i=new l.SL;i.add(t.onProcessReady((t=>this._proxy.$sendProcessReady(e,t.pid,t.cwd,t.windowsPty)))),i.add(t.onDidChangeProperty((t=>this._proxy.$sendProcessProperty(e,t)))),this._bufferer.startBuffering(e,t.onProcessData),i.add(t.onProcessExit((t=>this._onProcessExit(e,t)))),this._terminalProcesses.set(e,t);const r=this._extensionTerminalAwaitingStart[e];return r&&t instanceof C&&(t.startSendingEvents(r.initialDimensions),delete this._extensionTerminalAwaitingStart[e]),i}$acceptProcessAckDataEvent(e,t){this._terminalProcesses.get(e)?.acknowledgeDataEvent(t)}$acceptProcessInput(e,t){this._terminalProcesses.get(e)?.input(t)}$acceptTerminalInteraction(e){const t=this.getTerminalById(e);t?.setInteractedWith()&&this._onDidChangeTerminalState.fire(t.value)}$acceptTerminalSelection(e,t){this.getTerminalById(e)?.setSelection(t)}$acceptProcessResize(e,t,i){try{this._terminalProcesses.get(e)?.resize(t,i)}catch(e){if("EPIPE"!==e.code&&"ERR_IPC_CHANNEL_CLOSED"!==e.code)throw e}}$acceptProcessShutdown(e,t){this._terminalProcesses.get(e)?.shutdown(t)}$acceptProcessRequestInitialCwd(e){this._terminalProcesses.get(e)?.getInitialCwd().then((t=>this._proxy.$sendProcessProperty(e,{type:"initialCwd",value:t})))}$acceptProcessRequestCwd(e){this._terminalProcesses.get(e)?.getCwd().then((t=>this._proxy.$sendProcessProperty(e,{type:"cwd",value:t})))}$acceptProcessRequestLatency(e){return Promise.resolve(e)}registerLinkProvider(e){return this._linkProviders.add(e),1===this._linkProviders.size&&this._proxy.$startLinkProvider(),new d.JTr((()=>{this._linkProviders.delete(e),0===this._linkProviders.size&&this._proxy.$stopLinkProvider()}))}registerProfileProvider(e,t,i){if(this._profileProviders.has(t))throw new Error(`Terminal profile provider "${t}" already registered`);return this._profileProviders.set(t,i),this._proxy.$registerProfileProvider(t,e.identifier.value),new d.JTr((()=>{this._profileProviders.delete(t),this._proxy.$unregisterProfileProvider(t)}))}registerTerminalQuickFixProvider(e,t,i){if(this._quickFixProviders.has(e))throw new Error(`Terminal quick fix provider "${e}" is already registered`);return this._quickFixProviders.set(e,i),this._proxy.$registerQuickFixProvider(e,t),new d.JTr((()=>{this._quickFixProviders.delete(e),this._proxy.$unregisterQuickFixProvider(e)}))}async $provideTerminalQuickFixes(e,t){const i=(new m.AU).token;if(i.isCancellationRequested)return;const r=this._quickFixProviders.get(e);if(!r)return;const n=await r.provideTerminalQuickFixes(t,i);if(null===n||Array.isArray(n)&&0===n.length)return;const s=new l.SL;if(this._lastQuickFixCommands.value=s,!Array.isArray(n))return n?b.w7.from(n,this._extHostCommands.converter,s):void 0;const o=[];for(const e of n){const t=b.w7.from(e,this._extHostCommands.converter,s);t&&o.push(t)}return o}async $createContributedProfileTerminal(e,t){const i=(new m.AU).token;let r=await(this._profileProviders.get(e)?.provideTerminalProfile(i));if(!i.isCancellationRequested){if(r&&!("options"in r)&&(r={options:r}),!r||!("options"in r))throw new Error(`No terminal profile options provided for id "${e}"`);"pty"in r.options?this.createExtensionTerminal(r.options,t):this.createTerminalFromOptions(r.options,t)}}async $provideLinks(e,t){const i=this.getTerminalById(e);if(!i)return[];this._terminalLinkCache.delete(e);const r=this._terminalLinkCancellationSource.get(e);r?.dispose(!0);const n=new m.AU;this._terminalLinkCancellationSource.set(e,n);const s=[],o={terminal:i.value,line:t},a=[];for(const e of this._linkProviders)a.push(_.jT.withAsyncBody((async t=>{n.token.onCancellationRequested((()=>t({provider:e,links:[]})));const i=await e.provideTerminalLinks(o,n.token)||[];n.token.isCancellationRequested||t({provider:e,links:i})})));const c=await Promise.all(a);if(n.token.isCancellationRequested)return[];const l=new Map;for(const e of c)e&&e.links.length>0&&s.push(...e.links.map((t=>{const i={id:S++,startIndex:t.startIndex,length:t.length,label:t.tooltip};return l.set(i.id,{provider:e.provider,link:t}),i})));return this._terminalLinkCache.set(e,l),s}$activateLink(e,t){const i=this._terminalLinkCache.get(e)?.get(t);i&&i.provider.handleTerminalLink(i.link)}_onProcessExit(e,t){this._bufferer.stopBuffering(e),this._terminalProcesses.delete(e),delete this._extensionTerminalAwaitingStart[e];const i=this._terminalProcessDisposables[e];i&&(i.dispose(),delete this._terminalProcessDisposables[e]),this._proxy.$sendProcessExit(e,t)}getTerminalById(e){return this._getTerminalObjectById(this._terminals,e)}getTerminalIdByApiObject(e){const t=this._terminals.findIndex((t=>t.value===e));return t>=0?t:null}_getTerminalObjectById(e,t){const i=this._getTerminalObjectIndexById(e,t);return null!==i?e[i]:null}_getTerminalObjectIndexById(e,t){const i=e.findIndex((e=>e._id===t));return i>=0?i:null}getEnvironmentVariableCollection(e){let t=this._environmentVariableCollections.get(e.identifier.value);return t||(t=new D,this._setEnvironmentVariableCollection(e.identifier.value,t)),t.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(e,t){const i=(0,p.Fi)(t.map),r=(0,p.hd)(t.descriptionMap);this._proxy.$setEnvironmentVariableCollection(e,t.persistent,0===i.length?void 0:i,r)}$initEnvironmentVariableCollections(e){e.forEach((e=>{const t=e[0],i=new D(e[1]);this._setEnvironmentVariableCollection(t,i)}))}$acceptDefaultProfile(e,t){const i=this._defaultProfile;this._defaultProfile=e,this._defaultAutomationProfile=t,i?.path!==e.path&&this._onDidChangeShell.fire(e.path)}_setEnvironmentVariableCollection(e,t){this._environmentVariableCollections.set(e,t),t.onDidChangeCollection((()=>{this._syncEnvironmentVariableCollection(e,t)}))}};E=(0,r.g)([(0,r.f)(1,w.f7),(0,r.f)(2,c.O)],E);class D{get persistent(){return this._persistent}set persistent(e){this._persistent=e,this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){this.map=new Map,this.scopedCollections=new Map,this.descriptionMap=new Map,this._persistent=!0,this._onDidChangeCollection=new n.Q5,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.getScopeKey(e);let i=this.scopedCollections.get(t);return i||(i=new k(this,e),this.scopedCollections.set(t,i),i.onDidChangeCollection((()=>this._onDidChangeCollection.fire()))),i}replace(e,t,i,r){this._setIfDiffers(e,{value:t,type:d.vGG.Replace,options:i??{applyAtProcessCreation:!0},scope:r})}append(e,t,i,r){this._setIfDiffers(e,{value:t,type:d.vGG.Append,options:i??{applyAtProcessCreation:!0},scope:r})}prepend(e,t,i,r){this._setIfDiffers(e,{value:t,type:d.vGG.Prepend,options:i??{applyAtProcessCreation:!0},scope:r})}_setIfDiffers(e,t){if(t.options&&!1===t.options.applyAtProcessCreation&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const i=this.getKey(e,t.scope),r=this.map.get(i),n=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!r||r.value!==t.value||r.type!==t.type||r.options?.applyAtProcessCreation!==n.applyAtProcessCreation||r.options?.applyAtShellIntegration!==n.applyAtShellIntegration||r.scope?.workspaceFolder?.index!==t.scope?.workspaceFolder?.index){const i=this.getKey(e,t.scope),r={variable:e,...t,options:n};this.map.set(i,r),this._onDidChangeCollection.fire()}}get(e,t){const i=this.getKey(e,t),r=this.map.get(i);return r?T(r):void 0}getKey(e,t){const i=this.getScopeKey(t);return i.length?`${e}:::${i}`:e}getScopeKey(e){return this.getWorkspaceKey(e?.workspaceFolder)??""}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[i,r]of this.map)this.getScopeKey(r.scope)===this.getScopeKey(e)&&t.set(r.variable,T(r));return t}delete(e,t){const i=this.getKey(e,t);this.map.delete(i),this._onDidChangeCollection.fire()}clear(e){if(e?.workspaceFolder){for(const[t,i]of this.map)i.scope?.workspaceFolder?.index===e.workspaceFolder.index&&this.map.delete(t);this.clearDescription(e)}else this.map.clear(),this.descriptionMap.clear();this._onDidChangeCollection.fire()}setDescription(e,t){const i=this.getScopeKey(t),r=this.descriptionMap.get(i);if(!r||r.description!==e){let r;r="string"==typeof e?e:e?.value.split("\n\n")[0];const n={description:r,scope:t};this.descriptionMap.set(i,n),this._onDidChangeCollection.fire()}}getDescription(e){const t=this.getScopeKey(e);return this.descriptionMap.get(t)?.description}clearDescription(e){const t=this.getScopeKey(e);this.descriptionMap.delete(t)}}class k{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,t){this.collection=e,this.scope=t,this._onDidChangeCollection=new n.Q5}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,t,i){this.collection.replace(e,t,i,this.scope)}append(e,t,i){this.collection.append(e,t,i,this.scope)}prepend(e,t,i){this.collection.prepend(e,t,i,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,t){this.collection.getVariableMap(this.scope).forEach(((i,r)=>e.call(t,r,i,this)),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope),this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}}let I=class extends E{constructor(e,t){super(!1,e,t)}createTerminal(e,t,i){throw new h.B8}createTerminalFromOptions(e,t){throw new h.B8}};function P(e){if(e&&"string"!=typeof e)return"id"in e?{id:e.id,color:e.color}:e}function T(e){const t={...e};return delete t.scope,t.options=t.options??void 0,delete t.variable,t}I=(0,r.g)([(0,r.f)(0,w.f7),(0,r.f)(1,c.O)],I)},60192:function(e,t,i){i.d(t,{C:function(){return m},P:function(){return p}});var r=i(45493),n=i(30874),s=i(7428),o=i(28019),a=i(78293),c=i(82722),l=i(82209),d=i(81557),u=i(42731),h=i(35820);const p=(0,o.yh)("IExtHostTerminalShellIntegration");let m=class extends s.JT{constructor(e,t){super(),this._extHostTerminalService=t,this._activeShellIntegrations=new Map,this._onDidChangeTerminalShellIntegration=new d.Q5,this.onDidChangeTerminalShellIntegration=this._onDidChangeTerminalShellIntegration.event,this._onDidStartTerminalShellExecution=new d.Q5,this.onDidStartTerminalShellExecution=this._onDidStartTerminalShellExecution.event,this._onDidEndTerminalShellExecution=new d.Q5,this.onDidEndTerminalShellExecution=this._onDidEndTerminalShellExecution.event,this._proxy=e.getProxy(a.Tr.MainThreadTerminalShellIntegration),this._register((0,s.OF)((()=>{for(const[e,t]of this._activeShellIntegrations)t.dispose();this._activeShellIntegrations.clear()})))}$shellIntegrationChange(e){const t=this._extHostTerminalService.getTerminalById(e);if(!t)return;const i=t.value;let r=this._activeShellIntegrations.get(e);r||(r=new f(t.value,this._onDidStartTerminalShellExecution),this._activeShellIntegrations.set(e,r),r.store.add(t.onWillDispose((()=>this._activeShellIntegrations.get(e)?.dispose()))),r.store.add(r.onDidRequestShellExecution((t=>this._proxy.$executeCommand(e,t)))),r.store.add(r.onDidRequestEndExecution((e=>this._onDidEndTerminalShellExecution.fire(e)))),r.store.add(r.onDidRequestChangeShellIntegration((e=>this._onDidChangeTerminalShellIntegration.fire(e)))),t.shellIntegration=r.value),this._onDidChangeTerminalShellIntegration.fire({terminal:i,shellIntegration:r.value})}$shellExecutionStart(e,t,i,r,n){this._activeShellIntegrations.has(e)||this.$shellIntegrationChange(e);const s={value:t,confidence:i,isTrusted:r};this._activeShellIntegrations.get(e)?.startShellExecution(s,n)}$shellExecutionEnd(e,t,i,r,n){const s={value:t,confidence:i,isTrusted:r};this._activeShellIntegrations.get(e)?.endShellExecution(s,n)}$shellExecutionData(e,t){this._activeShellIntegrations.get(e)?.emitData(t)}$cwdChange(e,t){this._activeShellIntegrations.get(e)?.setCwd((0,u._9)(t)?u.ov.revive(t):t)}$closeTerminal(e){this._activeShellIntegrations.get(e)?.dispose(),this._activeShellIntegrations.delete(e)}};m=(0,r.g)([(0,r.f)(0,c.O),(0,r.f)(1,l.$3)],m);class f extends s.JT{get currentExecution(){return this._currentExecution}constructor(e,t){super(),this._terminal=e,this._onDidStartTerminalShellExecution=t,this._ignoreNextExecution=!1,this.store=this._register(new s.SL),this._onDidRequestChangeShellIntegration=this._register(new d.Q5),this.onDidRequestChangeShellIntegration=this._onDidRequestChangeShellIntegration.event,this._onDidRequestShellExecution=this._register(new d.Q5),this.onDidRequestShellExecution=this._onDidRequestShellExecution.event,this._onDidRequestEndExecution=this._register(new d.Q5),this.onDidRequestEndExecution=this._onDidRequestEndExecution.event;const i=this;this.value={get cwd(){return i._cwd},executeCommand(e,t){let r=e;t&&(r+=` "${t.map((e=>`${e.replaceAll('"','\\"')}`)).join('" "')}"`),i._onDidRequestShellExecution.fire(r);const s={value:r,confidence:n.I82.High,isTrusted:!0},o=i.startShellExecution(s,i._cwd,!0).value;return i._ignoreNextExecution=!0,o}}}startShellExecution(e,t,i){if(this._ignoreNextExecution&&this._currentExecution)this._ignoreNextExecution=!1;else{this._currentExecution&&(this._currentExecution.endExecution(void 0),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:void 0}));const r=this._currentExecution=new g(e,t);i?queueMicrotask((()=>this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:r.value}))):this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value})}return this._currentExecution}emitData(e){this.currentExecution?.emitData(e)}endShellExecution(e,t){this._currentExecution&&(this._currentExecution.endExecution(e),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:t}),this._currentExecution=void 0)}setCwd(e){let t=!1;u.ov.isUri(this._cwd)?t=!u.ov.isUri(e)||this._cwd.toString()!==e.toString():this._cwd!==e&&(t=!0),t&&(this._cwd=e,this._onDidRequestChangeShellIntegration.fire({terminal:this._terminal,shellIntegration:this.value}))}}class g{constructor(e,t){this._commandLine=e,this.cwd=t,this._ended=!1;const i=this;this.value={get commandLine(){return i._commandLine},get cwd(){return i.cwd},read(){return i._createDataStream()}}}_createDataStream(){if(!this._dataStream){if(this._ended)return h.Aq.EMPTY;this._dataStream=new v}return this._dataStream.createIterable()}emitData(e){this._dataStream?.emitData(e)}endExecution(e){e&&(this._commandLine=e),this._dataStream?.endExecution(),this._dataStream=void 0,this._ended=!0}}class v extends s.JT{constructor(){super(...arguments),this._emitters=[]}createIterable(){this._barrier||(this._barrier=new h.U8);const e=this._barrier;return new h.Aq((async t=>{this._emitters.push(t),await e.wait()}))}emitData(e){for(const t of this._emitters)t.emitOne(e)}endExecution(){this._barrier?.open(),this._barrier=void 0}}},34472:function(e,t,i){i.d(t,{Hb:function(){return D},SJ:function(){return S},n2:function(){return C},qN:function(){return E}});var r=i(3918),n=i(60411),s=i(45675),o=i(44383),a=i(33089),c=i(17430),l=i(42731);const d=(e,t,i,r)=>{let n=t;return{enumerable:!0,configurable:!1,get(){return n},set(t){if(!i(n,t)){const i=n;n=t,e.listener?.(r(t,i))}}}},u=(e,t)=>e===t,h=(e,t)=>e===t||!(!e||!t)&&e.isEqual(t),p=u,m=u,f=u,g=u,v=u,_=u,b=(e,t)=>e.length===t.length&&!e.some((e=>!t.find((t=>e.id===t.id)))),w=e=>t=>({op:4,update:e(t)}),y=(e,t)=>({range:(()=>{let t;const i=w((e=>({range:r.e.lift(c.e6.from(e))})));return{enumerable:!0,configurable:!1,get(){return t},set(r){e.listener?.({op:6}),h(t,r)||(t=r,e.listener?.(i(r)))}}})(),label:d(e,t,p,w((e=>({label:e})))),description:d(e,void 0,m,w((e=>({description:e})))),sortText:d(e,void 0,f,w((e=>({sortText:e})))),canResolveChildren:d(e,!1,_,(e=>({op:2,state:e}))),busy:d(e,!1,g,w((e=>({busy:e})))),error:d(e,void 0,v,w((e=>({error:c.W5.fromStrict(e)||null})))),tags:d(e,[],b,((e,t)=>({op:1,new:e.map(c.Ld.from),old:t.map(c.Ld.from)})))}),x=e=>{const t=s.u.fromString(e.extId),i=new S(t.controllerId,t.localId,e.label,l.ov.revive(e.uri)||void 0);return i.range=c.e6.to(e.range||void 0),i.description=e.description||void 0,i.sortText=e.sortText||void 0,i.tags=e.tags.map((e=>c.Ld.to({id:(0,a._v)(e).tagId}))),i},C=e=>{let t;for(const i of e.tests){const e=x(i.item);(0,n.l)(e).parent=t,t=e}return t};class S{constructor(e,t,i,r){if(t.includes("\0"))throw new Error(`Test IDs may not include the ${JSON.stringify(t)} symbol`);const s=(0,n.b)(this,e);Object.defineProperties(this,{id:{value:t,enumerable:!0,writable:!1},uri:{value:r,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return s.parent instanceof E?void 0:s.parent}},children:{value:(0,o.Hx)(s,n.l,S),enumerable:!0,writable:!1},...y(s,i)})}}class E extends S{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}}class D extends o.$z{constructor(e,t,i){super({controllerId:e,getDocumentVersion:e=>e&&i.getDocument(e)?.version,getApiFor:n.l,getChildren:e=>e.children,root:new E(e,t),toITestItem:c.UK.from})}}},60411:function(e,t,i){i.d(t,{b:function(){return s},l:function(){return o}});var r=i(44383);const n=new WeakMap,s=(e,t)=>{const i={controllerId:t};return n.set(e,i),i},o=e=>{const t=n.get(e);if(!t)throw new r.Mh(e?.id||"<unknown>");return t}},45107:function(e,t,i){i.d(t,{TE:function(){return c},aQ:function(){return u}});var r=i(23088),n=i(54316),s=i(73053),o=i(17430),a=i(30874);class c{static{this._Keys=new s.R("TextEditorDecorationType")}constructor(e,t,i){const r=c._Keys.nextId();e.$registerTextEditorDecorationType(t.identifier,r,o.aw.from(i)),this.value=Object.freeze({key:r,dispose(){e.$removeTextEditorDecorationType(r)}})}}class l{constructor(e,t){this._collectedEdits=[],this._setEndOfLine=void 0,this._finalized=!1,this._document=e,this._documentVersionId=e.version,this._undoStopBefore=t.undoStopBefore,this._undoStopAfter=t.undoStopAfter}finalize(){return this._finalized=!0,{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized)throw new Error("Edit is only valid while callback runs")}replace(e,t){this._throwIfFinalized();let i=null;if(e instanceof a.Lyo)i=new a.e6w(e,e);else{if(!(e instanceof a.e6w))throw new Error("Unrecognized location");i=e}this._pushEdit(i,t,!1)}insert(e,t){this._throwIfFinalized(),this._pushEdit(new a.e6w(e,e),t,!0)}delete(e){this._throwIfFinalized();let t=null;if(!(e instanceof a.e6w))throw new Error("Unrecognized location");t=e,this._pushEdit(t,null,!0)}_pushEdit(e,t,i){const r=this._document.validateRange(e);this._collectedEdits.push({range:r,text:t,forceMoveMarkers:i})}setEndOfLine(e){if(this._throwIfFinalized(),e!==a.b6q.LF&&e!==a.b6q.CRLF)throw(0,n.b1)("endOfLine");this._setEndOfLine=e}}class d{constructor(e,t,i,r){this._proxy=e,this._id=t,this._accept(i),this._logService=r;const n=this;this.value={get tabSize(){return n._tabSize},set tabSize(e){n._setTabSize(e)},get indentSize(){return n._indentSize},set indentSize(e){n._setIndentSize(e)},get insertSpaces(){return n._insertSpaces},set insertSpaces(e){n._setInsertSpaces(e)},get cursorStyle(){return n._cursorStyle},set cursorStyle(e){n._setCursorStyle(e)},get lineNumbers(){return n._lineNumbers},set lineNumbers(e){n._setLineNumbers(e)}}}_accept(e){this._tabSize=e.tabSize,this._indentSize=e.indentSize,this._originalIndentSize=e.originalIndentSize,this._insertSpaces=e.insertSpaces,this._cursorStyle=e.cursorStyle,this._lineNumbers=o.lP.to(e.lineNumbers)}_validateTabSize(e){if("auto"===e)return"auto";if("number"==typeof e){const t=Math.floor(e);return t>0?t:null}if("string"==typeof e){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setTabSize(e){const t=this._validateTabSize(e);if(null!==t){if("number"==typeof t){if(this._tabSize===t)return;this._tabSize=t}this._warnOnError("setTabSize",this._proxy.$trySetOptions(this._id,{tabSize:t}))}}_validateIndentSize(e){if("tabSize"===e)return"tabSize";if("number"==typeof e){const t=Math.floor(e);return t>0?t:null}if("string"==typeof e){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setIndentSize(e){const t=this._validateIndentSize(e);if(null!==t){if("number"==typeof t){if(this._originalIndentSize===t)return;this._indentSize=t,this._originalIndentSize=t}this._warnOnError("setIndentSize",this._proxy.$trySetOptions(this._id,{indentSize:t}))}}_validateInsertSpaces(e){return"auto"===e?"auto":"false"!==e&&Boolean(e)}_setInsertSpaces(e){const t=this._validateInsertSpaces(e);if("boolean"==typeof t){if(this._insertSpaces===t)return;this._insertSpaces=t}this._warnOnError("setInsertSpaces",this._proxy.$trySetOptions(this._id,{insertSpaces:t}))}_setCursorStyle(e){this._cursorStyle!==e&&(this._cursorStyle=e,this._warnOnError("setCursorStyle",this._proxy.$trySetOptions(this._id,{cursorStyle:e})))}_setLineNumbers(e){this._lineNumbers!==e&&(this._lineNumbers=e,this._warnOnError("setLineNumbers",this._proxy.$trySetOptions(this._id,{lineNumbers:o.lP.from(e)})))}assign(e){const t={};let i=!1;if(void 0!==e.tabSize){const r=this._validateTabSize(e.tabSize);"auto"===r?(i=!0,t.tabSize=r):"number"==typeof r&&this._tabSize!==r&&(this._tabSize=r,i=!0,t.tabSize=r)}if(void 0!==e.indentSize){const r=this._validateIndentSize(e.indentSize);"tabSize"===r?(i=!0,t.indentSize=r):"number"==typeof r&&this._originalIndentSize!==r&&(this._indentSize=r,this._originalIndentSize=r,i=!0,t.indentSize=r)}if(void 0!==e.insertSpaces){const r=this._validateInsertSpaces(e.insertSpaces);"auto"===r?(i=!0,t.insertSpaces=r):this._insertSpaces!==r&&(this._insertSpaces=r,i=!0,t.insertSpaces=r)}void 0!==e.cursorStyle&&this._cursorStyle!==e.cursorStyle&&(this._cursorStyle=e.cursorStyle,i=!0,t.cursorStyle=e.cursorStyle),void 0!==e.lineNumbers&&this._lineNumbers!==e.lineNumbers&&(this._lineNumbers=e.lineNumbers,i=!0,t.lineNumbers=o.lP.from(e.lineNumbers)),i&&this._warnOnError("setOptions",this._proxy.$trySetOptions(this._id,t))}_warnOnError(e,t){t.catch((t=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this._logService.warn(t)}))}}class u{constructor(e,t,i,r,s,c,u,h){this.id=e,this._proxy=t,this._logService=i,this._disposed=!1,this._hasDecorationsForKey=new Set,this._selections=s,this._options=new d(this._proxy,this.id,c,i),this._visibleRanges=u,this._viewColumn=h;const p=this;this.value=Object.freeze({get document(){return r.value},set document(e){throw new n.Tu("document")},get selection(){return p._selections&&p._selections[0]},set selection(e){if(!(e instanceof a.Y19))throw(0,n.b1)("selection");p._selections=[e],p._trySetSelection()},get selections(){return p._selections},set selections(e){if(!Array.isArray(e)||e.some((e=>!(e instanceof a.Y19))))throw(0,n.b1)("selections");p._selections=e,p._trySetSelection()},get visibleRanges(){return p._visibleRanges},set visibleRanges(e){throw new n.Tu("visibleRanges")},get options(){return p._options.value},set options(e){p._disposed||p._options.assign(e)},get viewColumn(){return p._viewColumn},set viewColumn(e){throw new n.Tu("viewColumn")},edit(e,t={undoStopBefore:!0,undoStopAfter:!0}){if(p._disposed)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const i=new l(r.value,t);return e(i),p._applyEdit(i)},insertSnippet(i,n,s={undoStopBefore:!0,undoStopAfter:!0}){if(p._disposed)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let c;if(!n||Array.isArray(n)&&0===n.length)c=p._selections.map((e=>o.e6.from(e)));else if(n instanceof a.Lyo){const{lineNumber:e,column:t}=o.Ly.from(n);c=[{startLineNumber:e,startColumn:t,endLineNumber:e,endColumn:t}]}else if(n instanceof a.e6w)c=[o.e6.from(n)];else{c=[];for(const e of n)if(e instanceof a.e6w)c.push(o.e6.from(e));else{const{lineNumber:t,column:i}=o.Ly.from(e);c.push({startLineNumber:t,startColumn:i,endLineNumber:t,endColumn:i})}}return t.$tryInsertSnippet(e,r.value.version,i.value,c,s)},setDecorations(i,r){const n=0===r.length;n&&!p._hasDecorationsForKey.has(i.key)||(n?p._hasDecorationsForKey.delete(i.key):p._hasDecorationsForKey.add(i.key),p._runOnProxy((()=>{if((0,o.J1)(r))return t.$trySetDecorations(e,i.key,(0,o.MA)(r));{const n=new Array(4*r.length);for(let e=0,t=r.length;e<t;e++){const t=r[e];n[4*e]=t.start.line+1,n[4*e+1]=t.start.character+1,n[4*e+2]=t.end.line+1,n[4*e+3]=t.end.character+1}return t.$trySetDecorationsFast(e,i.key,n)}})))},revealRange(i,r){p._runOnProxy((()=>t.$tryRevealRange(e,o.e6.from(i),r||a._VK.Default)))},show(i){t.$tryShowEditor(e,o.eI.from(i))},hide(){t.$tryHideEditor(e)}})}dispose(){(0,r.ok)(!this._disposed),this._disposed=!0}_acceptOptions(e){(0,r.ok)(!this._disposed),this._options._accept(e)}_acceptVisibleRanges(e){(0,r.ok)(!this._disposed),this._visibleRanges=e}_acceptViewColumn(e){(0,r.ok)(!this._disposed),this._viewColumn=e}_acceptSelections(e){(0,r.ok)(!this._disposed),this._selections=e}async _trySetSelection(){const e=this._selections.map(o.Y1.from);return await this._runOnProxy((()=>this._proxy.$trySetSelections(this.id,e))),this.value}_applyEdit(e){const t=e.finalize();if(0===t.edits.length&&!t.setEndOfLine)return Promise.resolve(!0);const i=t.edits.map((e=>e.range));i.sort(((e,t)=>e.end.line===t.end.line?e.end.character===t.end.character?e.start.line===t.start.line?e.start.character-t.start.character:e.start.line-t.start.line:e.end.character-t.end.character:e.end.line-t.end.line));for(let e=0,t=i.length-1;e<t;e++){const t=i[e].end;if(i[e+1].start.isBefore(t))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const r=t.edits.map((e=>({range:o.e6.from(e.range),text:e.text,forceMoveMarkers:e.forceMoveMarkers})));return this._proxy.$tryApplyEdits(this.id,t.documentVersionId,r,{setEndOfLine:"number"==typeof t.setEndOfLine?o.b6.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}_runOnProxy(e){return this._disposed?(this._logService.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then((()=>this),(e=>(e instanceof Error&&"DISPOSED"===e.name||this._logService.warn(e),null)))}}},17430:function(e,t,i){i.d(t,{$P:function(){return C},$l:function(){return Ye},$z:function(){return se},CD:function(){return Ee},CR:function(){return R},Db:function(){return w},FG:function(){return H},GS:function(){return $},Gl:function(){return Ue},HY:function(){return ze},Ht:function(){return Ve},Il:function(){return G},J1:function(){return It},JO:function(){return me},KP:function(){return le},Ld:function(){return ye},Lq:function(){return c},Ly:function(){return a},MA:function(){return Pt},MP:function(){return D},OU:function(){return oe},P1:function(){return Ce},P5:function(){return re},PY:function(){return b},R9:function(){return d},RG:function(){return _e},RV:function(){return k},RW:function(){return ne},Ru:function(){return Tt},Sm:function(){return qe},TK:function(){return F},TM:function(){return T},TU:function(){return je},UK:function(){return xe},W5:function(){return m},WT:function(){return Be},Xs:function(){return ae},Y1:function(){return r},YR:function(){return Re},ZJ:function(){return Oe},Zg:function(){return Fe},_2:function(){return ce},a8:function(){return Te},ac:function(){return ve},aw:function(){return _},b$:function(){return ge},b6:function(){return Z},c4:function(){return ue},cG:function(){return We},cR:function(){return y},cm:function(){return O},e5:function(){return Ge},e6:function(){return n},eI:function(){return p},eh:function(){return L},fQ:function(){return De},gl:function(){return j},hI:function(){return Ze},hf:function(){return A},hq:function(){return Je},iv:function(){return o},jW:function(){return K},lM:function(){return N},lP:function(){return X},ll:function(){return E},lt:function(){return we},nc:function(){return P},oY:function(){return Ke},oi:function(){return Q},oy:function(){return Ae},r4:function(){return x},rT:function(){return tt},s8:function(){return Me},so:function(){return te},t7:function(){return V},tn:function(){return Pe},tr:function(){return He},uT:function(){return ee},vy:function(){return W},w6:function(){return S},w7:function(){return Xe},wD:function(){return Y},wN:function(){return fe},wU:function(){return de},wZ:function(){return $e},we:function(){return M},x$:function(){return pe},xC:function(){return Se},xT:function(){return be},xh:function(){return I},xj:function(){return Qe},xm:function(){return J},yS:function(){return Ne},z0:function(){return ke}});var r,n,s,o,a,c,l,d,u,h,p,m,f,g,v,_,b,w,y,x,C,S,E,D,k,I,P,T,A,R,$,L,N,z,F,M,O,H,U,B,W,V,q,j,K,Q,G,J,Y,X,Z,ee,te,ie,re,ne,se,oe,ae,ce,le,de,ue,he,pe,me,fe,ge,ve,_e,be,we,ye,xe,Ce,Se,Ee,De,ke,Ie,Pe,Te,Ae,Re,$e,Le,Ne,ze,Fe,Me,Oe,He,Ue,Be,We,Ve,qe,je,Ke,Qe,Ge,Je,Ye,Xe,Ze,et,tt,it=i(78074),rt=i(53976),nt=i(33555),st=i(21033),ot=i(99360),at=i(18910),ct=i(51254),lt=i(59267),dt=i(95960),ut=i(82998),ht=i(93293),pt=i(81647),mt=i(47635),ft=i(42731),gt=i(3918),vt=i(27291),_t=i(82380),bt=i(60411),wt=i(79837),yt=i(64696),xt=i(30170),Ct=i(45675),St=i(33089),Et=i(23820),Dt=i(30874),kt=i(27528);function It(e){return 0===e.length||!!function(e){return void 0!==e.range}(e[0])}function Pt(e){return It(e)?e.map((e=>({range:n.from(e.range),hoverMessage:Array.isArray(e.hoverMessage)?m.fromMany(e.hoverMessage):e.hoverMessage?m.from(e.hoverMessage):void 0,renderOptions:e.renderOptions}))):e.map((e=>({range:n.from(e)})))}function Tt(e){return void 0===e?e:"string"==typeof e?ft.ov.file(e):e}!function(e){e.to=function(e){const{selectionStartLineNumber:t,selectionStartColumn:i,positionLineNumber:r,positionColumn:n}=e,s=new Dt.Lyo(t-1,i-1),o=new Dt.Lyo(r-1,n-1);return new Dt.Y19(s,o)},e.from=function(e){const{anchor:t,active:i}=e;return{selectionStartLineNumber:t.line+1,selectionStartColumn:t.character+1,positionLineNumber:i.line+1,positionColumn:i.character+1}}}(r||(r={})),function(e){e.from=function(e){if(!e)return;const{start:t,end:i}=e;return{startLineNumber:t.line+1,startColumn:t.character+1,endLineNumber:i.line+1,endColumn:i.character+1}},e.to=function(e){if(!e)return;const{startLineNumber:t,startColumn:i,endLineNumber:r,endColumn:n}=e;return new Dt.e6w(t-1,i-1,r-1,n-1)}}(n||(n={})),function(e){e.from=function(e){return{uri:e.uri,range:n.from(e.range)}},e.to=function(e){return new Dt.YeX(ft.ov.revive(e.uri),n.to(e.range))}}(s||(s={})),function(e){e.to=function(e){switch(e){case 1:return Dt.xJH.Comment;case 0:return Dt.xJH.Other;case 3:return Dt.xJH.RegEx;case 2:return Dt.xJH.String}}}(o||(o={})),function(e){e.to=function(e){return new Dt.Lyo(e.lineNumber-1,e.column-1)},e.from=function(e){return{lineNumber:e.line+1,column:e.character+1}}}(a||(a={})),function(e){function t(e,t){return t&&"string"==typeof e?t.transformOutgoingScheme(e):e}e.from=function(e,i,r){return(0,it.kX)((0,it._2)(e).map((e=>function(e,i,r){if("string"==typeof e)return{$serialized:!0,language:e,isBuiltin:r?.isBuiltin};if(e)return{$serialized:!0,language:e.language,scheme:t(e.scheme,i),pattern:ne.from(e.pattern)??void 0,exclusive:e.exclusive,notebookType:e.notebookType,isBuiltin:r?.isBuiltin};return}(e,i,r))))}}(c||(c={})),function(e){e.from=function(e){switch(e){case Dt.$uQ.Unnecessary:return 1;case Dt.$uQ.Deprecated:return 2}},e.to=function(e){switch(e){case 1:return Dt.$uQ.Unnecessary;case 2:return Dt.$uQ.Deprecated;default:return}}}(l||(l={})),function(e){e.from=function(e){let t;return e.code&&(t=(0,mt.HD)(e.code)||(0,mt.hj)(e.code)?String(e.code):{value:String(e.code.value),target:e.code.target}),{...n.from(e.range),message:e.message,source:e.source,code:t,severity:h.from(e.severity),relatedInformation:e.relatedInformation&&e.relatedInformation.map(u.from),tags:Array.isArray(e.tags)?(0,it.kX)(e.tags.map(l.from)):void 0}},e.to=function(e){const t=new Dt.R9_(n.to(e),e.message,h.to(e.severity));return t.source=e.source,t.code=(0,mt.HD)(e.code)?e.code:e.code?.value,t.relatedInformation=e.relatedInformation&&e.relatedInformation.map(u.to),t.tags=e.tags&&(0,it.kX)(e.tags.map(l.to)),t}}(d||(d={})),function(e){e.from=function(e){return{...n.from(e.location.range),message:e.message,resource:e.location.uri}},e.to=function(e){return new Dt.va0(new Dt.YeX(e.resource,n.to(e)),e.message)}}(u||(u={})),function(e){e.from=function(e){switch(e){case Dt.H_B.Error:return _t.Z.Error;case Dt.H_B.Warning:return _t.Z.Warning;case Dt.H_B.Information:return _t.Z.Info;case Dt.H_B.Hint:return _t.Z.Hint}return _t.Z.Error},e.to=function(e){switch(e){case _t.Z.Info:return Dt.H_B.Information;case _t.Z.Warning:return Dt.H_B.Warning;case _t.Z.Error:return Dt.H_B.Error;case _t.Z.Hint:return Dt.H_B.Hint;default:return Dt.H_B.Error}}}(h||(h={})),function(e){e.from=function(e){return"number"==typeof e&&e>=Dt.eIC.One?e-1:e===Dt.eIC.Beside?Et.O3:Et.LP},e.to=function(e){if("number"==typeof e&&e>=0)return e+1;throw new Error("invalid 'EditorGroupColumn'")}}(p||(p={})),function(e){function t(e,t){if(!e)return e;let i;try{i=(0,lt.Qc)(e)}catch(e){}if(!i)return e;let r=!1;return i=(0,ut.rs)(i,(e=>{if(ft.ov.isUri(e)){const i=`__uri_${Math.random().toString(16).slice(2,8)}`;return t[i]=e,r=!0,i}})),r?JSON.stringify(i):e}e.fromMany=function(t){return t.map(e.from)},e.from=function(e){let i;if((r=e)&&"object"==typeof r&&"string"==typeof r.language&&"string"==typeof r.value){const{language:t,value:r}=e;i={value:"```"+t+"\n"+r+"\n```\n"}}else i=Dt.W5C.isMarkdownString(e)?{value:e.value,isTrusted:e.isTrusted,supportThemeIcons:e.supportThemeIcons,supportHtml:e.supportHtml,baseUri:e.baseUri}:"string"==typeof e?{value:e}:{value:""};var r;const n=Object.create(null);i.uris=n;const s=e=>{try{let i=ft.ov.parse(e,!0);i=i.with({query:t(i.query,n)}),n[e]=i}catch(e){}return""},o=new ct.Z.Renderer;return o.link=s,o.image=e=>"string"==typeof e?s((0,ot.v1)(e).href):"",(0,ct.Z)(i.value,{renderer:o}),i},e.to=function(e){const t=new Dt.W5C(e.value,e.supportThemeIcons);return t.isTrusted=e.isTrusted,t.supportHtml=e.supportHtml,t.baseUri=e.baseUri?ft.ov.from(e.baseUri):void 0,t},e.fromStrict=function(t){if(t)return"string"==typeof t?t:e.from(t)}}(m||(m={})),function(e){e.from=function(e){return void 0===e?e:{contentText:e.contentText,contentIconPath:e.contentIconPath?Tt(e.contentIconPath):void 0,border:e.border,borderColor:e.borderColor,fontStyle:e.fontStyle,fontWeight:e.fontWeight,textDecoration:e.textDecoration,color:e.color,backgroundColor:e.backgroundColor,margin:e.margin,width:e.width,height:e.height}}}(f||(f={})),function(e){e.from=function(e){return void 0===e?e:{backgroundColor:e.backgroundColor,outline:e.outline,outlineColor:e.outlineColor,outlineStyle:e.outlineStyle,outlineWidth:e.outlineWidth,border:e.border,borderColor:e.borderColor,borderRadius:e.borderRadius,borderSpacing:e.borderSpacing,borderStyle:e.borderStyle,borderWidth:e.borderWidth,fontStyle:e.fontStyle,fontWeight:e.fontWeight,textDecoration:e.textDecoration,cursor:e.cursor,color:e.color,opacity:e.opacity,letterSpacing:e.letterSpacing,gutterIconPath:e.gutterIconPath?Tt(e.gutterIconPath):void 0,gutterIconSize:e.gutterIconSize,overviewRulerColor:e.overviewRulerColor,before:e.before?f.from(e.before):void 0,after:e.after?f.from(e.after):void 0}}}(g||(g={})),function(e){e.from=function(e){if(void 0===e)return e;switch(e){case Dt.TED.OpenOpen:return 0;case Dt.TED.ClosedClosed:return 1;case Dt.TED.OpenClosed:return 2;case Dt.TED.ClosedOpen:return 3}}}(v||(v={})),function(e){e.from=function(e){return{isWholeLine:e.isWholeLine,rangeBehavior:e.rangeBehavior?v.from(e.rangeBehavior):void 0,overviewRulerLane:e.overviewRulerLane,light:e.light?g.from(e.light):void 0,dark:e.dark?g.from(e.dark):void 0,backgroundColor:e.backgroundColor,outline:e.outline,outlineColor:e.outlineColor,outlineStyle:e.outlineStyle,outlineWidth:e.outlineWidth,border:e.border,borderColor:e.borderColor,borderRadius:e.borderRadius,borderSpacing:e.borderSpacing,borderStyle:e.borderStyle,borderWidth:e.borderWidth,fontStyle:e.fontStyle,fontWeight:e.fontWeight,textDecoration:e.textDecoration,cursor:e.cursor,color:e.color,opacity:e.opacity,letterSpacing:e.letterSpacing,gutterIconPath:e.gutterIconPath?Tt(e.gutterIconPath):void 0,gutterIconSize:e.gutterIconSize,overviewRulerColor:e.overviewRulerColor,before:e.before?f.from(e.before):void 0,after:e.after?f.from(e.after):void 0}}}(_||(_={})),function(e){e.from=function(e){return{text:e.newText,eol:e.newEol&&Z.from(e.newEol),range:n.from(e.range)}},e.to=function(e){const t=new Dt.PYv(n.to(e.range),e.text);return t.newEol=void 0===e.eol?void 0:Z.to(e.eol),t}}(b||(b={})),function(e){e.from=function(e,t){const i={edits:[]};if(e instanceof Dt.DbP){const r=new at.XV;for(const t of e._allEntries())1===t._type&&ft.ov.isUri(t.to)&&void 0===t.from&&r.add(t.to);for(const s of e._allEntries())if(1===s._type){let e;s.options?.contents&&(e=ArrayBuffer.isView(s.options.contents)?{type:"base64",value:(0,rt.oF)(rt.KN.wrap(s.options.contents))}:{type:"dataTransferItem",id:s.options.contents._itemId}),i.edits.push({oldResource:s.from,newResource:s.to,options:{...s.options,contents:e},metadata:s.metadata})}else 2===s._type?i.edits.push({resource:s.uri,textEdit:b.from(s.edit),versionId:r.has(s.uri)?void 0:t?.getTextDocumentVersion(s.uri),metadata:s.metadata}):6===s._type?i.edits.push({resource:s.uri,textEdit:{range:n.from(s.range),text:s.edit.value,insertAsSnippet:!0},versionId:r.has(s.uri)?void 0:t?.getTextDocumentVersion(s.uri),metadata:s.metadata}):3===s._type?i.edits.push({metadata:s.metadata,resource:s.uri,cellEdit:s.edit,notebookMetadata:s.notebookMetadata,notebookVersionId:t?.getNotebookDocumentVersion(s.uri)}):5===s._type&&i.edits.push({metadata:s.metadata,resource:s.uri,notebookVersionId:t?.getNotebookDocumentVersion(s.uri),cellEdit:{editType:1,index:s.index,count:s.count,cells:s.cells.map(he.from)}})}return i},e.to=function(e){const t=new Dt.DbP,i=new at.Y9;for(const r of e.edits)if(r.textEdit){const e=r,t=ft.ov.revive(e.resource),s=n.to(e.textEdit.range),o=e.textEdit.text;let a;a=e.textEdit.insertAsSnippet?Dt.M0$.replace(s,new Dt.EG5(o)):Dt.PYv.replace(s,o);const c=i.get(t);c?c.push(a):i.set(t,[a])}else t.renameFile(ft.ov.revive(r.oldResource),ft.ov.revive(r.newResource),r.options);for(const[e,r]of i)t.set(e,r);return t}}(w||(w={})),function(e){const t=Object.create(null);t[Dt.cRn.File]=0,t[Dt.cRn.Module]=1,t[Dt.cRn.Namespace]=2,t[Dt.cRn.Package]=3,t[Dt.cRn.Class]=4,t[Dt.cRn.Method]=5,t[Dt.cRn.Property]=6,t[Dt.cRn.Field]=7,t[Dt.cRn.Constructor]=8,t[Dt.cRn.Enum]=9,t[Dt.cRn.Interface]=10,t[Dt.cRn.Function]=11,t[Dt.cRn.Variable]=12,t[Dt.cRn.Constant]=13,t[Dt.cRn.String]=14,t[Dt.cRn.Number]=15,t[Dt.cRn.Boolean]=16,t[Dt.cRn.Array]=17,t[Dt.cRn.Object]=18,t[Dt.cRn.Key]=19,t[Dt.cRn.Null]=20,t[Dt.cRn.EnumMember]=21,t[Dt.cRn.Struct]=22,t[Dt.cRn.Event]=23,t[Dt.cRn.Operator]=24,t[Dt.cRn.TypeParameter]=25,e.from=function(e){return"number"==typeof t[e]?t[e]:6},e.to=function(e){for(const i in t)if(t[i]===e)return Number(i);return Dt.cRn.Property}}(y||(y={})),function(e){e.from=function(e){if(e===Dt.r4c.Deprecated)return 1},e.to=function(e){if(1===e)return Dt.r4c.Deprecated}}(x||(x={})),function(e){e.from=function(e){return{name:e.name,kind:y.from(e.kind),tags:e.tags&&e.tags.map(x.from),containerName:e.containerName,location:I.from(e.location)}},e.to=function(e){const t=new Dt.JNW(e.name,y.to(e.kind),e.containerName,I.to(e.location));return t.tags=e.tags&&e.tags.map(x.to),t}}(C||(C={})),function(e){e.from=function e(t){const i={name:t.name||"!!MISSING: name!!",detail:t.detail,range:n.from(t.range),selectionRange:n.from(t.selectionRange),kind:y.from(t.kind),tags:t.tags?.map(x.from)??[]};return t.children&&(i.children=t.children.map(e)),i},e.to=function e(t){const i=new Dt.w6Q(t.name,t.detail,y.to(t.kind),n.to(t.range),n.to(t.selectionRange));return(0,it.Of)(t.tags)&&(i.tags=t.tags.map(x.to)),t.children&&(i.children=t.children.map(e)),i}}(S||(S={})),function(e){e.to=function(e){const t=new Dt.llk(y.to(e.kind),e.name,e.detail||"",ft.ov.revive(e.uri),n.to(e.range),n.to(e.selectionRange));return t._sessionId=e._sessionId,t._itemId=e._itemId,t},e.from=function(e,t,i){if(t=t??e._sessionId,i=i??e._itemId,void 0===t||void 0===i)throw new Error("invalid item");return{_sessionId:t,_itemId:i,name:e.name,detail:e.detail,kind:y.from(e.kind),uri:e.uri,range:n.from(e.range),selectionRange:n.from(e.selectionRange),tags:e.tags?.map(x.from)}}}(E||(E={})),function(e){e.to=function(e){return new Dt.MPI(E.to(e.from),e.fromRanges.map((e=>n.to(e))))}}(D||(D={})),function(e){e.to=function(e){return new Dt.RVV(E.to(e.to),e.fromRanges.map((e=>n.to(e))))}}(k||(k={})),function(e){e.from=function(e){return{range:e.range&&n.from(e.range),uri:e.uri}},e.to=function(e){return new Dt.YeX(ft.ov.revive(e.uri),n.to(e.range))}}(I||(I={})),function(e){e.from=function(e){const t=e,i=e;return{originSelectionRange:t.originSelectionRange?n.from(t.originSelectionRange):void 0,uri:t.targetUri?t.targetUri:i.uri,range:n.from(t.targetRange?t.targetRange:i.range),targetSelectionRange:t.targetSelectionRange?n.from(t.targetSelectionRange):void 0}},e.to=function(e){return{targetUri:ft.ov.revive(e.uri),targetRange:n.to(e.range),targetSelectionRange:e.targetSelectionRange?n.to(e.targetSelectionRange):void 0,originSelectionRange:e.originSelectionRange?n.to(e.originSelectionRange):void 0}}}(P||(P={})),function(e){e.from=function(e){return{range:n.from(e.range),contents:m.fromMany(e.contents),canIncreaseVerbosity:e.canIncreaseVerbosity,canDecreaseVerbosity:e.canDecreaseVerbosity}},e.to=function(e){const t=e.contents.map(m.to),i=n.to(e.range),r=e.canIncreaseVerbosity,s=e.canDecreaseVerbosity;return new Dt.GLX(t,i,r,s)}}(T||(T={})),function(e){e.from=function(e){return{range:n.from(e.range),expression:e.expression}},e.to=function(e){return new Dt.hfl(n.to(e.range),e.expression)}}(A||(A={})),function(e){e.from=function(e){if(e instanceof Dt.$KE)return{type:"text",range:n.from(e.range),text:e.text};if(e instanceof Dt.wJF)return{type:"variable",range:n.from(e.range),variableName:e.variableName,caseSensitiveLookup:e.caseSensitiveLookup};if(e instanceof Dt.rLr)return{type:"expression",range:n.from(e.range),expression:e.expression};throw new Error("Unknown 'InlineValue' type")},e.to=function(e){switch(e.type){case"text":return{range:n.to(e.range),text:e.text};case"variable":return{range:n.to(e.range),variableName:e.variableName,caseSensitiveLookup:e.caseSensitiveLookup};case"expression":return{range:n.to(e.range),expression:e.expression}}}}(R||(R={})),function(e){e.from=function(e){return{frameId:e.frameId,stoppedLocation:n.from(e.stoppedLocation)}},e.to=function(e){return new Dt.GSm(e.frameId,n.to(e.stoppedLocation))}}($||($={})),function(e){e.from=function(e){return{range:n.from(e.range),kind:e.kind}},e.to=function(e){return new Dt.ehQ(n.to(e.range),e.kind)}}(L||(L={})),function(e){e.from=function(e){return{uri:e.uri,highlights:e.highlights.map(L.from)}},e.to=function(e){return new Dt.lMH(ft.ov.revive(e.uri),e.highlights.map(L.to))}}(N||(N={})),function(e){e.to=function(e){switch(e){case 1:return Dt.IjA.TriggerCharacter;case 2:return Dt.IjA.TriggerForIncompleteCompletions;default:return Dt.IjA.Invoke}}}(z||(z={})),function(e){e.to=function(e){return{triggerKind:z.to(e.triggerKind),triggerCharacter:e.triggerCharacter}}}(F||(F={})),function(e){e.from=function(e){if(e===Dt.weh.Deprecated)return 1},e.to=function(e){if(1===e)return Dt.weh.Deprecated}}(M||(M={})),function(e){const t=new Map([[Dt.cmM.Method,0],[Dt.cmM.Function,1],[Dt.cmM.Constructor,2],[Dt.cmM.Field,3],[Dt.cmM.Variable,4],[Dt.cmM.Class,5],[Dt.cmM.Interface,7],[Dt.cmM.Struct,6],[Dt.cmM.Module,8],[Dt.cmM.Property,9],[Dt.cmM.Unit,12],[Dt.cmM.Value,13],[Dt.cmM.Constant,14],[Dt.cmM.Enum,15],[Dt.cmM.EnumMember,16],[Dt.cmM.Keyword,17],[Dt.cmM.Snippet,27],[Dt.cmM.Text,18],[Dt.cmM.Color,19],[Dt.cmM.File,20],[Dt.cmM.Reference,21],[Dt.cmM.Folder,23],[Dt.cmM.Event,10],[Dt.cmM.Operator,11],[Dt.cmM.TypeParameter,24],[Dt.cmM.Issue,26],[Dt.cmM.User,25]]);e.from=function(e){return t.get(e)??9};const i=new Map([[0,Dt.cmM.Method],[1,Dt.cmM.Function],[2,Dt.cmM.Constructor],[3,Dt.cmM.Field],[4,Dt.cmM.Variable],[5,Dt.cmM.Class],[7,Dt.cmM.Interface],[6,Dt.cmM.Struct],[8,Dt.cmM.Module],[9,Dt.cmM.Property],[12,Dt.cmM.Unit],[13,Dt.cmM.Value],[14,Dt.cmM.Constant],[15,Dt.cmM.Enum],[16,Dt.cmM.EnumMember],[17,Dt.cmM.Keyword],[27,Dt.cmM.Snippet],[18,Dt.cmM.Text],[19,Dt.cmM.Color],[20,Dt.cmM.File],[21,Dt.cmM.Reference],[23,Dt.cmM.Folder],[10,Dt.cmM.Event],[11,Dt.cmM.Operator],[24,Dt.cmM.TypeParameter],[25,Dt.cmM.User],[26,Dt.cmM.Issue]]);e.to=function(e){return i.get(e)??Dt.cmM.Property}}(O||(O={})),function(e){e.to=function(e,t){const i=new Dt.FGT(e.label);return i.insertText=e.insertText,i.kind=O.to(e.kind),i.tags=e.tags?.map(M.to),i.detail=e.detail,i.documentation=(0,ot.Fr)(e.documentation)?m.to(e.documentation):e.documentation,i.sortText=e.sortText,i.filterText=e.filterText,i.preselect=e.preselect,i.commitCharacters=e.commitCharacters,gt.e.isIRange(e.range)?i.range=n.to(e.range):"object"==typeof e.range&&(i.range={inserting:n.to(e.range.insert),replacing:n.to(e.range.replace)}),i.keepWhitespace=void 0!==e.insertTextRules&&Boolean(1&e.insertTextRules),void 0!==e.insertTextRules&&4&e.insertTextRules?i.insertText=new Dt.EG5(e.insertText):(i.insertText=e.insertText,i.textEdit=i.range instanceof Dt.e6w?new Dt.PYv(i.range,i.insertText):void 0),e.additionalTextEdits&&e.additionalTextEdits.length>0&&(i.additionalTextEdits=e.additionalTextEdits.map((e=>b.to(e)))),i.command=t&&e.command?t.fromInternal(e.command):void 0,i}}(H||(H={})),function(e){e.from=function(e){if("string"!=typeof e.label&&!Array.isArray(e.label))throw new TypeError("Invalid label");return{label:e.label,documentation:m.fromStrict(e.documentation)}},e.to=function(e){return{label:e.label,documentation:(0,ot.Fr)(e.documentation)?m.to(e.documentation):e.documentation}}}(U||(U={})),function(e){e.from=function(e){return{label:e.label,documentation:m.fromStrict(e.documentation),parameters:Array.isArray(e.parameters)?e.parameters.map(U.from):[],activeParameter:e.activeParameter}},e.to=function(e){return{label:e.label,documentation:(0,ot.Fr)(e.documentation)?m.to(e.documentation):e.documentation,parameters:Array.isArray(e.parameters)?e.parameters.map(U.to):[],activeParameter:e.activeParameter}}}(B||(B={})),function(e){e.from=function(e){return{activeSignature:e.activeSignature,activeParameter:e.activeParameter,signatures:Array.isArray(e.signatures)?e.signatures.map(B.from):[]}},e.to=function(e){return{activeSignature:e.activeSignature,activeParameter:e.activeParameter,signatures:Array.isArray(e.signatures)?e.signatures.map(B.to):[]}}}(W||(W={})),function(e){e.to=function(e,t){const i=new Dt.t7_(a.to(t.position),"string"==typeof t.label?t.label:t.label.map(q.to.bind(void 0,e)),t.kind&&j.to(t.kind));return i.textEdits=t.textEdits&&t.textEdits.map(b.to),i.tooltip=(0,ot.Fr)(t.tooltip)?m.to(t.tooltip):t.tooltip,i.paddingLeft=t.paddingLeft,i.paddingRight=t.paddingRight,i}}(V||(V={})),function(e){e.to=function(e,t){const i=new Dt.qR(t.label);return i.tooltip=(0,ot.Fr)(t.tooltip)?m.to(t.tooltip):t.tooltip,vt.mY.is(t.command)&&(i.command=e.fromInternal(t.command)),t.location&&(i.location=I.to(t.location)),i}}(q||(q={})),function(e){e.from=function(e){return e},e.to=function(e){return e}}(j||(j={})),function(e){e.from=function(e){return{range:n.from(e.range),url:e.target,tooltip:e.tooltip}},e.to=function(e){let t;if(e.url)try{t="string"==typeof e.url?ft.ov.parse(e.url,!0):ft.ov.revive(e.url)}catch(e){}return new Dt.jWy(n.to(e.range),t)}}(K||(K={})),function(e){e.to=function(e){const t=new Dt.oi2(e.label);return e.textEdit&&(t.textEdit=b.to(e.textEdit)),e.additionalTextEdits&&(t.additionalTextEdits=e.additionalTextEdits.map((e=>b.to(e)))),t},e.from=function(e){return{label:e.label,textEdit:e.textEdit?b.from(e.textEdit):void 0,additionalTextEdits:e.additionalTextEdits?e.additionalTextEdits.map((e=>b.from(e))):void 0}}}(Q||(Q={})),function(e){e.to=function(e){return new Dt.Ilk(e[0],e[1],e[2],e[3])},e.from=function(e){return[e.red,e.green,e.blue,e.alpha]}}(G||(G={})),function(e){e.from=function(e){return{range:n.from(e.range)}},e.to=function(e){return new Dt.xm7(n.to(e.range))}}(J||(J={})),function(e){e.to=function(e){switch(e){case 2:return Dt.wDJ.AfterDelay;case 1:return Dt.wDJ.Manual;case 3:case 4:return Dt.wDJ.FocusOut}}}(Y||(Y={})),function(e){e.from=function(e){switch(e){case Dt.lP6.Off:return 0;case Dt.lP6.Relative:return 2;case Dt.lP6.Interval:return 3;case Dt.lP6.On:default:return 1}},e.to=function(e){switch(e){case 0:return Dt.lP6.Off;case 2:return Dt.lP6.Relative;case 3:return Dt.lP6.Interval;default:return Dt.lP6.On}}}(X||(X={})),function(e){e.from=function(e){return e===Dt.b6q.CRLF?1:e===Dt.b6q.LF?0:void 0},e.to=function(e){return 1===e?Dt.b6q.CRLF:0===e?Dt.b6q.LF:void 0}}(Z||(Z={})),function(e){e.from=function(e){if("object"==typeof e)return e.viewId;switch(e){case Dt.uTI.SourceControl:return 3;case Dt.uTI.Window:return 10;case Dt.uTI.Notification:return 15}throw new Error("Unknown 'ProgressLocation'")}}(ee||(ee={})),function(e){e.from=function(e){const t={start:e.start+1,end:e.end+1};return e.kind&&(t.kind=ie.from(e.kind)),t},e.to=function(e){const t={start:e.start-1,end:e.end-1};return e.kind&&(t.kind=ie.to(e.kind)),t}}(te||(te={})),function(e){e.from=function(e){if(e)switch(e){case Dt.ADb.Comment:return vt.AD.Comment;case Dt.ADb.Imports:return vt.AD.Imports;case Dt.ADb.Region:return vt.AD.Region}},e.to=function(e){if(e)switch(e.value){case vt.AD.Comment.value:return Dt.ADb.Comment;case vt.AD.Imports.value:return Dt.ADb.Imports;case vt.AD.Region.value:return Dt.ADb.Region}}}(ie||(ie={})),function(e){e.from=function(e){if(e)return{pinned:"boolean"==typeof e.preview?!e.preview:void 0,inactive:e.background,preserveFocus:e.preserveFocus,selection:"object"==typeof e.selection?n.from(e.selection):void 0,override:"boolean"==typeof e.override?wt.Cr.id:void 0}}}(re||(re={})),function(e){e.from=function(e){return e instanceof Dt.sUC?e.toJSON():"string"==typeof e?e:function(e){const t=e;if(!t)return!1;return ft.ov.isUri(t.baseUri)&&"string"==typeof t.pattern}(e)||function(e){const t=e;if(!t)return!1;return"string"==typeof t.base&&"string"==typeof t.pattern}(e)?new Dt.sUC(e.baseUri??e.base,e.pattern).toJSON():e},e.to=function(e){return"string"==typeof e?e:new Dt.sUC(ft.ov.revive(e.baseUri),e.pattern)}}(ne||(ne={})),function(e){e.from=function e(t){if(t){if(Array.isArray(t))return t.map(e);if("string"==typeof t)return t;{const e=t;return{language:e.language,scheme:e.scheme,pattern:ne.from(e.pattern),exclusive:e.exclusive,notebookType:e.notebookType}}}}}(se||(se={})),function(e){e.is=function(e){return!!e&&"object"==typeof e&&"documents"in e&&Array.isArray(e.documents)&&e.documents.every((e=>Array.isArray(e)&&e.every((e=>e&&"object"==typeof e&&"uri"in e&&ft.ov.isUri(e.uri)&&"version"in e&&"number"==typeof e.version&&"ranges"in e&&Array.isArray(e.ranges)&&e.ranges.every((e=>e instanceof Dt.e6w))))))},e.from=function(e){return{documents:e.documents.map((e=>e.map((e=>({uri:ft.ov.from(e.uri),version:e.version,ranges:e.ranges.map((e=>n.from(e)))})))))}}}(oe||(oe={})),function(e){e.from=function(e){return{start:e.start,end:e.end}},e.to=function(e){return new Dt.XsU(e.start,e.end)}}(ae||(ae={})),function(e){e.to=function(e){return{timing:"number"==typeof e.runStartTime&&"number"==typeof e.runEndTime?{startTime:e.runStartTime,endTime:e.runEndTime}:void 0,executionOrder:e.executionOrder,success:e.lastRunSuccess}},e.from=function(e){return{lastRunSuccess:e.success,runStartTime:e.timing?.startTime,runEndTime:e.timing?.endTime,executionOrder:e.executionOrder}}}(ce||(ce={})),function(e){e.to=function(e){if(e===xt.KP.Unconfirmed)return Dt.KPz.Pending;if(e!==xt.KP.Pending){if(e===xt.KP.Executing)return Dt.KPz.Executing;throw new Error(`Unknown state: ${e}`)}}}(le||(le={})),function(e){e.from=function(e){switch(e){case Dt.wUy.Markup:return xt.gM.Markup;case Dt.wUy.Code:default:return xt.gM.Code}},e.to=function(e){switch(e){case xt.gM.Markup:return Dt.wUy.Markup;case xt.gM.Code:default:return Dt.wUy.Code}}}(de||(de={})),function(e){e.from=function(e){const t={metadata:e.metadata??Object.create(null),cells:[]};for(const i of e.cells)Dt.Ul.validate(i),t.cells.push(he.from(i));return t},e.to=function(e){const t=new Dt.c4G(e.cells.map(he.to));return(0,mt.Qr)(e.metadata)||(t.metadata=e.metadata),t}}(ue||(ue={})),function(e){e.from=function(e){return{cellKind:de.from(e.kind),language:e.languageId,mime:e.mime,source:e.value,metadata:e.metadata,internalMetadata:ce.from(e.executionSummary??{}),outputs:e.outputs?e.outputs.map(me.from):[]}},e.to=function(e){return new Dt.Ul(de.to(e.cellKind),e.source,e.language,e.mime,e.outputs?e.outputs.map(me.to):void 0,e.metadata,e.internalMetadata?ce.to(e.internalMetadata):void 0)}}(he||(he={})),function(e){e.from=function(e){return{mime:e.mime,valueBytes:rt.KN.wrap(e.data)}},e.to=function(e){return new Dt.x$B(e.valueBytes.buffer,e.mime)}}(pe||(pe={})),function(e){e.from=function(e){return{outputId:e.id,items:e.items.map(pe.from),metadata:e.metadata}},e.to=function(e){const t=e.items.map(pe.to);return new Dt.JOq(t,e.outputId,e.metadata)}}(me||(me={})),function(e){function t(e){const t=e;return!!t&&(!(0,mt.Jp)(t.include)&&!(0,mt.Jp)(t.exclude))}e.from=function(e){return t(e)?{include:ne.from(e.include)??void 0,exclude:ne.from(e.exclude)??void 0}:ne.from(e)??void 0},e.to=function(e){return t(e)?{include:ne.to(e.include),exclude:ne.to(e.exclude)}:ne.to(e)}}(fe||(fe={})),function(e){e.from=function(e,t,i){const r="string"==typeof e.command?{title:"",command:e.command}:e.command;return{alignment:e.alignment===Dt.F3Y.Left?1:2,command:t.toInternal(r,i),text:e.text,tooltip:e.tooltip,accessibilityInformation:e.accessibilityInformation,priority:e.priority}}}(ge||(ge={})),function(e){e.from=function(e,t,i){const r="string"==typeof e.command?{title:"",command:e.command}:e.command;return{command:t.toInternal(r,i),label:e.label,description:e.description,detail:e.detail,documentation:e.documentation}}}(ve||(ve={})),function(e){e.from=function(e){return{transientOutputs:e?.transientOutputs??!1,transientCellMetadata:e?.transientCellMetadata??{},transientDocumentMetadata:e?.transientDocumentMetadata??{},cellContentMetadata:e?.cellContentMetadata??{}}}}(_e||(_e={})),function(e){e.from=function(e){return{uri:e.uri,provides:e.provides}},e.to=function(e){return new Dt.xTW(ft.ov.revive(e.uri),e.provides)}}(be||(be={})),function(e){e.from=function(e){return{message:m.fromStrict(e.message)||"",type:0,expected:e.expectedOutput,actual:e.actualOutput,contextValue:e.contextValue,location:e.location&&{range:n.from(e.location.range),uri:e.location.uri}}},e.to=function(e){const t=new Dt.ltp("string"==typeof e.message?e.message:m.to(e.message));return t.actualOutput=e.actual,t.expectedOutput=e.expected,t.contextValue=e.contextValue,t.location=e.location?I.to(e.location):void 0,t}}(we||(we={})),function(e){e.namespace=St.B2,e.denamespace=St._v}(ye||(ye={})),function(e){e.from=function(e){const t=(0,bt.l)(e).controllerId;return{extId:Ct.u.fromExtHostTestItem(e,t).toString(),label:e.label,uri:ft.ov.revive(e.uri),busy:e.busy,tags:e.tags.map((e=>ye.namespace(t,e.id))),range:gt.e.lift(n.from(e.range)),description:e.description||null,sortText:e.sortText||null,error:e.error&&m.fromStrict(e.error)||null}},e.toPlain=function(e){return{parent:void 0,error:void 0,id:Ct.u.fromString(e.extId).localId,label:e.label,uri:ft.ov.revive(e.uri),tags:(e.tags||[]).map((e=>{const{tagId:t}=ye.denamespace(e);return new Dt.LdD(t)})),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:n.to(e.range||void 0),canResolveChildren:!1,busy:e.busy,description:e.description||void 0,sortText:e.sortText||void 0}}}(xe||(xe={})),function(e){e.from=function(e){return{id:e.id}},e.to=function(e){return new Dt.LdD(e.id)}}(ye||(ye={})),function(e){const t=(e,i)=>{const r=e.value;if(!r)return;const n={...xe.toPlain(r.item),parent:i,taskStates:r.tasks.map((e=>({state:e.state,duration:e.duration,messages:e.messages.filter((e=>0===e.type)).map(we.to)}))),children:[]};if(e.children)for(const i of e.children.values()){const e=t(i,n);e&&n.children.push(e)}return n};e.to=function(e){const i=new ht.F;for(const t of e.items)i.insert(Ct.u.fromString(t.item.extId).path,t);const r=[i.nodes],n=[];for(;r.length;)for(const e of r.pop())e.value?n.push(e):e.children&&r.push(e.children.values());return{completedAt:e.completedAt,results:n.map((e=>t(e))).filter(mt.$K)}}}(Ce||(Ce={})),function(e){function t(e){return{covered:e.covered,total:e.total}}function i(e){return"line"in e?a.from(e):n.from(e)}e.fromDetails=function(e){if("number"==typeof e.executed&&e.executed<0)throw new Error(`Invalid coverage count ${e.executed}`);return"branches"in e?{count:e.executed,location:i(e.location),type:1,branches:e.branches.length?e.branches.map((e=>({count:e.executed,location:e.location&&i(e.location),label:e.label}))):void 0}:{type:0,name:e.name,count:e.executed,location:i(e.location)}},e.fromFile=function(e,i){return(0,Dt.kGi)(i.statementCoverage),(0,Dt.kGi)(i.branchCoverage),(0,Dt.kGi)(i.declarationCoverage),{id:e,uri:i.uri,statement:t(i.statementCoverage),branch:i.branchCoverage&&t(i.branchCoverage),declaration:i.declarationCoverage&&t(i.declarationCoverage)}}}(Se||(Se={})),function(e){e.to=function(e){switch(e){case 1:return Dt.CDv.Invoke;case 2:return Dt.CDv.Automatic}}}(Ee||(Ee={})),function(e){e.to=function(e){const t=new Dt.fQK(y.to(e.kind),e.name,e.detail||"",ft.ov.revive(e.uri),n.to(e.range),n.to(e.selectionRange));return t._sessionId=e._sessionId,t._itemId=e._itemId,t},e.from=function(e,t,i){if(t=t??e._sessionId,i=i??e._itemId,void 0===t||void 0===i)throw new Error("invalid item");return{_sessionId:t,_itemId:i,kind:y.from(e.kind),name:e.name,detail:e.detail??"",uri:e.uri,range:n.from(e.range),selectionRange:n.from(e.selectionRange),tags:e.tags?.map(x.from)}}}(De||(De={})),function(e){e.from=function(e){if(e)return{value:e.value,tooltip:e.tooltip}}}(ke||(ke={})),function(e){function t(e){return nt.Z0.split(e).map((e=>{if(e.startsWith("#"))return e;try{return ft.ov.parse(e)}catch{}return e}))}e.to=function(e,t,i){const r=t.fileData;return r?new Dt.ctj(new Dt.kaV(r.name,ft.ov.revive(r.uri),r.id,(0,st.M)((()=>i(r.id))))):e===dt.vW.uriList&&t.uriListData?new Dt.qDr((n=t.uriListData,nt.Z0.create(n.map((e=>"string"==typeof e?e:ft.ov.revive(e)))))):new Dt.qDr(t.asString);var n},e.from=async function(e,i){const r=await i.asString();if(e===dt.vW.uriList)return{asString:r,fileData:void 0,uriListData:t(r)};const n=i.asFile();return{asString:r,fileData:n?{name:n.name,uri:n.uri,id:n._itemId??n.id}:void 0}}}(Ie||(Ie={})),function(e){e.toDataTransfer=function(e,t){const i=e.items.map((([e,i])=>[e,Ie.to(e,i,t)]));return new Dt.tnH(i)},e.from=async function(e){const t={items:[]},i=[];for(const[r,n]of e)i.push((async()=>{t.items.push([r,await Ie.from(r,n)])})());return await Promise.all(i),t}}(Pe||(Pe={})),function(e){e.from=function(e,t){return{kind:"reply",agentId:e.participant??t?.agentId??"",subCommand:e.command??t?.command,message:e.prompt,title:e.label}},e.to=function(e){return{prompt:e.message,label:e.title,participant:e.agentId,command:e.subCommand}}}(Te||(Te={})),function(e){e.from=function(e){return"commandId"in e?{kind:"command",title:e.title??"",commandId:e.commandId??"",when:e.when??"",args:e.args}:{kind:"reply",message:e.message,title:e.title,tooltip:e.tooltip}}}(Ae||(Ae={})),function(e){e.to=function(e){switch(e.role){case 0:return new Dt.ORh(e.content);case 1:return new Dt.Tax(e.content);case 2:return new Dt.I01(e.content)}},e.from=function(e){if(e instanceof Dt.ORh)return{role:0,content:e.content};if(e instanceof Dt.Tax)return{role:1,content:e.content};if(e instanceof Dt.I01)return{role:2,content:e.content};throw new Error("Invalid LanguageModelMessage")}}(Re||(Re={})),function(e){e.objectTo=function(t){const i={};for(const r of Object.keys(t))i[r]=t[r].map(e.to);return i},e.to=function(e){return{level:Le.to(e.level),kind:e.kind,value:(0,ft._9)(e.value)?ft.ov.revive(e.value):e.value,description:e.description}},e.from=function(e){return{level:Le.from(e.level),kind:e.kind,value:e.value,description:e.description}}}($e||($e={})),function(e){e.to=function(e){switch(e){case"short":return Dt.Xfu.Short;case"medium":return Dt.Xfu.Medium;default:return Dt.Xfu.Full}},e.from=function(e){switch(e){case Dt.Xfu.Short:return"short";case Dt.Xfu.Medium:return"medium";case Dt.Xfu.Full:default:return"full"}}}(Le||(Le={})),function(e){e.to=function(e){switch(e){case 1:return Dt.ySx.Helpful;case 0:return Dt.ySx.Unhelpful;case 2:return Dt.ySx.Undone;case 3:return Dt.ySx.Accepted;case 4:return Dt.ySx.Bug}}}(Ne||(Ne={})),function(e){e.from=function(e){return{kind:"markdownContent",content:m.from(e.value)}},e.to=function(e){return new Dt.HYr(m.to(e.content))}}(ze||(ze={})),function(e){e.from=function(e){return{kind:"markdownVuln",content:m.from(e.value),vulnerabilities:e.vulnerabilities}},e.to=function(e){return new Dt.Zgy(m.to(e.content),e.vulnerabilities)}}(Fe||(Fe={})),function(e){e.from=function(e){return{kind:"agentDetection",agentId:e.participant,command:e.command}},e.to=function(e){return new Dt.s8P(e.agentId,e.command)}}(Me||(Me={})),function(e){e.from=function(e){const{value:t,baseUri:i}=e;return{kind:"treeData",treeData:{label:(0,pt.EZ)(i),uri:i,children:function e(t,i){return t.map((t=>{const r=ft.ov.joinPath(i,t.name);return{label:t.name,uri:r,children:t.children&&e(t.children,r)}}))}(t,i)}}},e.to=function(e){const t=(0,lt.wL)(e.treeData),i=t.uri,r=t.children?function e(t){return t.map((t=>({name:t.label,children:t.children&&e(t.children)})))}(t.children):[];return new Dt.Y08(r,i)}}(Oe||(Oe={})),function(e){e.from=function(e){return{kind:"inlineReference",name:e.title,inlineReference:ft.ov.isUri(e.value)?e.value:s.from(e.value)}},e.to=function(e){const t=(0,lt.wL)(e);return new Dt.trJ(ft.ov.isUri(t.inlineReference)?t.inlineReference:s.to(t.inlineReference),e.name)}}(He||(He={})),function(e){e.from=function(e){return{kind:"progressMessage",content:m.from(e.value)}},e.to=function(e){return new Dt.Gli(e.content.value)}}(Ue||(Ue={})),function(e){e.from=function(e,t,i){return{kind:"command",command:t.toInternal(e.value,i)??{command:e.value.command,title:e.value.title}}},e.to=function(e,t){return new Dt.WTw(t.fromInternal(e.command)??{command:e.command.id,title:e.command.title})}}(Be||(Be={})),function(e){e.from=function(e){return{kind:"textEdit",uri:e.uri,edits:e.edits.map((e=>b.from(e)))}},e.to=function(e){return new Dt.cGf(ft.ov.revive(e.uri),e.edits.map((e=>b.to(e))))}}(We||(We={})),function(e){e.from=function(e){const t=kt.kS.isThemeIcon(e.iconPath)?e.iconPath:void 0;return"variableName"in e.value?{kind:"reference",reference:{variableName:e.value.variableName,value:ft.ov.isUri(e.value.value)||!e.value.value?e.value.value:s.from(e.value.value)},iconPath:t}:{kind:"reference",reference:ft.ov.isUri(e.value)?e.value:s.from(e.value),iconPath:t}},e.to=function(e){const t=(0,lt.wL)(e),i=e=>ft.ov.isUri(e)?e:s.to(e);return new Dt.Ht3("variableName"in t.reference?{variableName:t.reference.variableName,value:t.reference.value&&i(t.reference.value)}:i(t.reference))}}(Ve||(Ve={})),function(e){function t(e,t){switch(e.kind){case"markdownContent":return ze.to(e);case"inlineReference":return He.to(e);case"progressMessage":return;case"treeData":return Oe.to(e);case"command":return Be.to(e,t)}}e.from=function(e,t,i){return e instanceof Dt.HYr?ze.from(e):e instanceof Dt.trJ?He.from(e):e instanceof Dt.Ht3?Ve.from(e):e instanceof Dt.Gli?Ue.from(e):e instanceof Dt.Y08?Oe.from(e):e instanceof Dt.WTw?Be.from(e,t,i):e instanceof Dt.cGf?We.from(e):e instanceof Dt.Zgy?Fe.from(e):e instanceof Dt.s8P?Me.from(e):{kind:"markdownContent",content:m.from("")}},e.to=function(e,i){switch(e.kind){case"reference":return Ve.to(e);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return t(e,i)}},e.toContent=t}(qe||(qe={})),function(e){e.to=function(e){return{prompt:e.message,command:e.command,attempt:e.attempt??0,enableCommandDetection:e.enableCommandDetection??!0,variables:e.variables.variables.map(Qe.to),location:Ke.to(e.location)}}}(je||(je={})),function(e){e.to=function(e){switch(e){case yt.O$.Notebook:return Dt.oYl.Notebook;case yt.O$.Terminal:return Dt.oYl.Terminal;case yt.O$.Panel:return Dt.oYl.Panel;case yt.O$.Editor:return Dt.oYl.Editor}}}(Ke||(Ke={})),function(e){e.to=function(e){return{name:e.name,range:e.range&&[e.range.start,e.range.endExclusive],values:e.values.map($e.to)}}}(Qe||(Qe={})),function(e){e.from=function(e,t,i){return{label:e.label,values:e.values.map($e.from),insertText:e.insertText,detail:e.detail,documentation:e.documentation,command:t.toInternal(e.command,i)}}}(Ge||(Ge={})),function(e){e.to=function(e){return{errorDetails:e.errorDetails,metadata:e.metadata}}}(Je||(Je={})),function(e){e.to=function(e,t,i){if("vote"===t.action.kind)return;const r=Je.to(e);if("command"===t.action.kind){const e=t.action.commandButton.command;return{action:{kind:"command",commandButton:{command:i.fromInternal(e)??{command:e.id,title:e.title}}},result:r}}if("followUp"===t.action.kind){return{action:{kind:"followUp",followup:Te.to(t.action.followup)},result:r}}return"inlineChat"===t.action.kind?{action:{kind:"editor",accepted:"accepted"===t.action.action},result:r}:{action:t.action,result:r}}}(Ye||(Ye={})),function(e){e.from=function(e,t,i){return"terminalCommand"in e?{terminalCommand:e.terminalCommand,shouldExecute:e.shouldExecute}:"uri"in e?{uri:e.uri}:t.toInternal(e,i)}}(Xe||(Xe={})),function(e){e.to=function(e){return{kind:et.to(e.kind)}}}(Ze||(Ze={})),function(e){e.to=function(e){switch(e){case 0:return Dt.NAb.Word;case 1:return Dt.NAb.Line;case 2:return Dt.NAb.Suggest;default:return Dt.NAb.Unknown}}}(et||(et={})),function(e){e.from=function(e,t){return{id:t,label:e.label,description:e.description,canEdit:e.canEdit,collapsibleState:e.collapsibleState||0,contextValue:e.contextValue}}}(tt||(tt={}))},30874:function(e,t,i){i.d(t,{$KE:function(){return Kt},$R:function(){return hr},$hL:function(){return ji},$uQ:function(){return Y},ADb:function(){return ri},AIo:function(){return qi},ApZ:function(){return gi},Ay:function(){return Di},B2n:function(){return pe},CDv:function(){return he},Cgf:function(){return Br},Coj:function(){return Le},DKv:function(){return Et},DbP:function(){return G},EG5:function(){return J},EU7:function(){return sr},F3Y:function(){return Ei},FGT:function(){return Re},FLm:function(){return Ot},FR$:function(){return pi},FZl:function(){return tt},GLX:function(){return re},GSm:function(){return Jt},Gli:function(){return Rr},HCM:function(){return K},HGt:function(){return Ut},HYr:function(){return kr},H_B:function(){return X},Ht3:function(){return Lr},Hu0:function(){return Ii},I01:function(){return Hr},I82:function(){return Ze},IAb:function(){return wr},IAe:function(){return nr},IQN:function(){return Fr},IjA:function(){return Pe},Ilk:function(){return Qe},InX:function(){return Wi},JCu:function(){return ot},JDx:function(){return At},JFR:function(){return we},JNW:function(){return de},JOq:function(){return Li},JQb:function(){return mi},JTr:function(){return z},K1l:function(){return Mt},KHd:function(){return bt},KPz:function(){return Si},LdD:function(){return Qi},Llw:function(){return Xt},Lyo:function(){return F},M$5:function(){return xe},M0$:function(){return Q},MIn:function(){return Me},MPI:function(){return ve},MXZ:function(){return kt},MYA:function(){return se},N$N:function(){return oi},NAb:function(){return ze},Ngc:function(){return Cr},NqL:function(){return Dt},OLe:function(){return lt},ORh:function(){return Mr},OTk:function(){return ai},PYv:function(){return j},Pts:function(){return di},QII:function(){return nt},R9_:function(){return te},RVV:function(){return _e},Rxm:function(){return be},S$x:function(){return _i},TED:function(){return Ve},TGJ:function(){return zt},TMt:function(){return Ye},TMw:function(){return ie},TPH:function(){return bi},TWf:function(){return rt},Tax:function(){return Or},TpX:function(){return Ft},U07:function(){return Wt},UCC:function(){return Oi},UPf:function(){return yi},Ub$:function(){return $e},Ul:function(){return Ai},UoH:function(){return Nt},Usx:function(){return Hi},UwW:function(){return Er},UyC:function(){return xr},Uzh:function(){return hi},W5C:function(){return ye},WBl:function(){return ut},WTw:function(){return $r},WW0:function(){return Ee},Xdk:function(){return ei},Xfu:function(){return or},XgO:function(){return Sr},XsU:function(){return Ti},XuI:function(){return Yi},Y08:function(){return Tr},Y0F:function(){return ir},Y19:function(){return O},YED:function(){return Vi},YL6:function(){return Lt},Y_o:function(){return fr},YeX:function(){return Z},YjK:function(){return ki},ZMD:function(){return Bi},Zgy:function(){return Ir},_AT:function(){return si},_VK:function(){return Ue},_x0:function(){return Xe},acJ:function(){return Fi},azK:function(){return dr},b6q:function(){return V},bZY:function(){return xi},bqK:function(){return ne},bur:function(){return We},bwv:function(){return jt},c4G:function(){return Ri},cGf:function(){return Nr},cRn:function(){return ce},cYW:function(){return tr},cZI:function(){return Ht},cmM:function(){return Te},ctj:function(){return xt},dEe:function(){return er},dWA:function(){return Be},dql:function(){return ci},e2j:function(){return it},e6w:function(){return M},eIC:function(){return Fe},eg0:function(){return zr},ehQ:function(){return oe},fQK:function(){return mr},fyj:function(){return Zi},gl:function(){return De},hNq:function(){return Vt},hfl:function(){return qt},i23:function(){return et},iQE:function(){return mt},jWy:function(){return Ke},jqr:function(){return Mi},kGi:function(){return Ji},kS8:function(){return Pt},kU2:function(){return br},kaV:function(){return Ct},kfG:function(){return vt},kiP:function(){return vr},lF4:function(){return gr},lMH:function(){return ae},lP6:function(){return Oe},lSh:function(){return wt},lZM:function(){return li},llk:function(){return ge},ltp:function(){return Ki},mgN:function(){return pt},n2H:function(){return ui},oCf:function(){return _t},oYl:function(){return lr},ogl:function(){return yr},oi2:function(){return Je},p5U:function(){return at},pdQ:function(){return rr},pr0:function(){return Ge},qDr:function(){return yt},qIz:function(){return Ce},qNe:function(){return ht},qR:function(){return ke},qRu:function(){return Gi},qaI:function(){return W},qlg:function(){return vi},r4c:function(){return le},rLr:function(){return Gt},rbC:function(){return Pi},rnR:function(){return pr},ryi:function(){return B},s8P:function(){return Pr},sUC:function(){return Rt},sfZ:function(){return Ni},sof:function(){return ii},sz_:function(){return U},t5:function(){return st},t7_:function(){return Ie},tHl:function(){return Ur},tPk:function(){return Tt},tfP:function(){return Ne},tnH:function(){return St},trJ:function(){return Ar},u8m:function(){return cr},uOQ:function(){return Dr},uTI:function(){return ft},unW:function(){return wi},vGG:function(){return q},va0:function(){return ee},vvd:function(){return w},vyX:function(){return Se},w6Q:function(){return ue},wDJ:function(){return He},wJF:function(){return Qt},wUy:function(){return Ci},wa0:function(){return Yt},weh:function(){return Ae},wxO:function(){return qe},x$B:function(){return $i},xJH:function(){return Ui},xJu:function(){return ur},xKz:function(){return ni},xTW:function(){return zi},xm7:function(){return fe},xmj:function(){return Xi},xwm:function(){return It},yGk:function(){return dt},yHy:function(){return je},yNd:function(){return me},yNx:function(){return ti},ySx:function(){return ar},yr7:function(){return Bt},yzl:function(){return fi},z0r:function(){return gt},zR2:function(){return Zt},zwE:function(){return _r}});var r,n,s,o,a,c,l,d,u,h,p,m,f,g,v,_,b,w,y=i(45493),x=i(78074),C=i(54316),S=i(99360),E=i(18910),D=i(95960),k=i(88023),I=i(47635),P=i(42731),T=i(92004),A=i(26258),R=i(28698),$=i(59822),L=i(30170);function N(e){const t={apply:function(...t){if(0===t.length)return Reflect.construct(e,[]);{const i=1===t.length?[]:t[1];return Reflect.construct(e,i,t[0].constructor)}},call:function(...t){if(0===t.length)return Reflect.construct(e,[]);{const[i,...r]=t;return Reflect.construct(e,r,i.constructor)}}};return Object.assign(e,t)}!function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom"}(w||(w={}));let z=r=class{static from(...e){let t=e;return new r((function(){if(t){for(const e of t)e&&"function"==typeof e.dispose&&e.dispose();t=void 0}}))}#c;constructor(e){this.#c=e}dispose(){"function"==typeof this.#c&&(this.#c(),this.#c=void 0)}};z=r=(0,y.g)([N],z);let F=n=class{static Min(...e){if(0===e.length)throw new TypeError;let t=e[0];for(let i=1;i<e.length;i++){const r=e[i];r.isBefore(t)&&(t=r)}return t}static Max(...e){if(0===e.length)throw new TypeError;let t=e[0];for(let i=1;i<e.length;i++){const r=e[i];r.isAfter(t)&&(t=r)}return t}static isPosition(e){if(!e)return!1;if(e instanceof n)return!0;const{line:t,character:i}=e;return"number"==typeof t&&"number"==typeof i}static of(e){if(e instanceof n)return e;if(this.isPosition(e))return new n(e.line,e.character);throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this._line}get character(){return this._character}constructor(e,t){if(e<0)throw(0,C.b1)("line must be non-negative");if(t<0)throw(0,C.b1)("character must be non-negative");this._line=e,this._character=t}isBefore(e){return this._line<e._line||!(e._line<this._line)&&this._character<e._character}isBeforeOrEqual(e){return this._line<e._line||!(e._line<this._line)&&this._character<=e._character}isAfter(e){return!this.isBeforeOrEqual(e)}isAfterOrEqual(e){return!this.isBefore(e)}isEqual(e){return this._line===e._line&&this._character===e._character}compareTo(e){return this._line<e._line?-1:this._line>e.line?1:this._character<e._character?-1:this._character>e._character?1:0}translate(e,t=0){if(null===e||null===t)throw(0,C.b1)();let i;return void 0===e?i=0:"number"==typeof e?i=e:(i="number"==typeof e.lineDelta?e.lineDelta:0,t="number"==typeof e.characterDelta?e.characterDelta:0),0===i&&0===t?this:new n(this.line+i,this.character+t)}with(e,t=this.character){if(null===e||null===t)throw(0,C.b1)();let i;return void 0===e?i=this.line:"number"==typeof e?i=e:(i="number"==typeof e.line?e.line:this.line,t="number"==typeof e.character?e.character:this.character),i===this.line&&t===this.character?this:new n(i,t)}toJSON(){return{line:this.line,character:this.character}}};F=n=(0,y.g)([N],F);let M=s=class{static isRange(e){return e instanceof s||!!e&&(F.isPosition(e.start)&&F.isPosition(e.end))}static of(e){if(e instanceof s)return e;if(this.isRange(e))return new s(e.start,e.end);throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this._start}get end(){return this._end}constructor(e,t,i,r){let n,s;if("number"==typeof e&&"number"==typeof t&&"number"==typeof i&&"number"==typeof r?(n=new F(e,t),s=new F(i,r)):F.isPosition(e)&&F.isPosition(t)&&(n=F.of(e),s=F.of(t)),!n||!s)throw new Error("Invalid arguments");n.isBefore(s)?(this._start=n,this._end=s):(this._start=s,this._end=n)}contains(e){return s.isRange(e)?this.contains(e.start)&&this.contains(e.end):!!F.isPosition(e)&&(!F.of(e).isBefore(this._start)&&!this._end.isBefore(e))}isEqual(e){return this._start.isEqual(e._start)&&this._end.isEqual(e._end)}intersection(e){const t=F.Max(e.start,this._start),i=F.Min(e.end,this._end);if(!t.isAfter(i))return new s(t,i)}union(e){if(this.contains(e))return this;if(e.contains(this))return e;const t=F.Min(e.start,this._start),i=F.Max(e.end,this.end);return new s(t,i)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(e,t=this.end){if(null===e||null===t)throw(0,C.b1)();let i;return e?F.isPosition(e)?i=e:(i=e.start||this.start,t=e.end||this.end):i=this.start,i.isEqual(this._start)&&t.isEqual(this.end)?this:new s(i,t)}toJSON(){return[this.start,this.end]}};M=s=(0,y.g)([N],M);let O=o=class extends M{static isSelection(e){return e instanceof o||!!e&&(M.isRange(e)&&F.isPosition(e.anchor)&&F.isPosition(e.active)&&"boolean"==typeof e.isReversed)}get anchor(){return this._anchor}get active(){return this._active}constructor(e,t,i,r){let n,s;if("number"==typeof e&&"number"==typeof t&&"number"==typeof i&&"number"==typeof r?(n=new F(e,t),s=new F(i,r)):F.isPosition(e)&&F.isPosition(t)&&(n=F.of(e),s=F.of(t)),!n||!s)throw new Error("Invalid arguments");super(n,s),this._anchor=n,this._active=s}get isReversed(){return this._anchor===this._end}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}};O=o=(0,y.g)([N],O);const H=e=>{if("string"!=typeof e||0===e.length||!/^[0-9A-Za-z_\-]+$/.test(e))throw(0,C.b1)("connectionToken")};class U{static isResolvedAuthority(e){return e&&"object"==typeof e&&"string"==typeof e.host&&"number"==typeof e.port&&(void 0===e.connectionToken||"string"==typeof e.connectionToken)}constructor(e,t,i){if("string"!=typeof e||0===e.length)throw(0,C.b1)("host");if("number"!=typeof t||0===t||Math.round(t)!==t)throw(0,C.b1)("port");void 0!==i&&H(i),this.host=e,this.port=Math.round(t),this.connectionToken=i}}class B{static isManagedResolvedAuthority(e){return e&&"object"==typeof e&&"function"==typeof e.makeConnection&&(void 0===e.connectionToken||"string"==typeof e.connectionToken)}constructor(e,t){this.makeConnection=e,this.connectionToken=t,void 0!==t&&H(t)}}class W extends Error{static NotAvailable(e,t){return new W(e,$.XP.NotAvailable,t)}static TemporarilyNotAvailable(e){return new W(e,$.XP.TemporarilyNotAvailable)}constructor(e,t=$.XP.Unknown,i){super(e),this._message=e,this._code=t,this._detail=i,Object.setPrototypeOf(this,W.prototype)}}var V,q;!function(e){e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"}(V||(V={})),function(e){e[e.Replace=1]="Replace",e[e.Append=2]="Append",e[e.Prepend=3]="Prepend"}(q||(q={}));let j=a=class{static isTextEdit(e){return e instanceof a||!!e&&(M.isRange(e)&&"string"==typeof e.newText)}static replace(e,t){return new a(e,t)}static insert(e,t){return a.replace(new M(e,e),t)}static delete(e){return a.replace(e,"")}static setEndOfLine(e){const t=new a(new M(new F(0,0),new F(0,0)),"");return t.newEol=e,t}get range(){return this._range}set range(e){if(e&&!M.isRange(e))throw(0,C.b1)("range");this._range=e}get newText(){return this._newText||""}set newText(e){if(e&&"string"!=typeof e)throw(0,C.b1)("newText");this._newText=e}get newEol(){return this._newEol}set newEol(e){if(e&&"number"!=typeof e)throw(0,C.b1)("newEol");this._newEol=e}constructor(e,t){this._range=e,this._newText=t}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};j=a=(0,y.g)([N],j);let K=c=class{static isNotebookCellEdit(e){return e instanceof c||!!e&&(Ti.isNotebookRange(e)&&Array.isArray(e.newCells))}static replaceCells(e,t){return new c(e,t)}static insertCells(e,t){return new c(new Ti(e,e),t)}static deleteCells(e){return new c(e,[])}static updateCellMetadata(e,t){const i=new c(new Ti(e,e),[]);return i.newCellMetadata=t,i}static updateNotebookMetadata(e){const t=new c(new Ti(0,0),[]);return t.newNotebookMetadata=e,t}constructor(e,t){this.range=e,this.newCells=t}};K=c=(0,y.g)([N],K);class Q{static isSnippetTextEdit(e){return e instanceof Q||!!e&&(M.isRange(e.range)&&J.isSnippetString(e.snippet))}static replace(e,t){return new Q(e,t)}static insert(e,t){return Q.replace(new M(e,e),t)}constructor(e,t){this.range=e,this.snippet=t}}let G=class{constructor(){this._edits=[]}_allEntries(){return this._edits}renameFile(e,t,i,r){this._edits.push({_type:1,from:e,to:t,options:i,metadata:r})}createFile(e,t,i){this._edits.push({_type:1,from:void 0,to:e,options:t,metadata:i})}deleteFile(e,t,i){this._edits.push({_type:1,from:e,to:void 0,options:t,metadata:i})}replaceNotebookMetadata(e,t,i){this._edits.push({_type:3,metadata:i,uri:e,edit:{editType:5,metadata:t},notebookMetadata:t})}replaceNotebookCells(e,t,i,r){const n=t.start,s=t.end;(n!==s||i.length>0)&&this._edits.push({_type:5,uri:e,index:n,count:s-n,cells:i,metadata:r})}replaceNotebookCellMetadata(e,t,i,r){this._edits.push({_type:3,metadata:r,uri:e,edit:{editType:3,index:t,metadata:i}})}replace(e,t,i,r){this._edits.push({_type:2,uri:e,edit:new j(t,i),metadata:r})}insert(e,t,i,r){this.replace(e,new M(t,t),i,r)}delete(e,t,i){this.replace(e,t,"",i)}has(e){return this._edits.some((t=>2===t._type&&t.uri.toString()===e.toString()))}set(e,t){if(t)for(const i of t){if(!i)continue;let t,r;Array.isArray(i)?(t=i[0],r=i[1]):t=i,K.isNotebookCellEdit(t)?t.newCellMetadata?this.replaceNotebookCellMetadata(e,t.range.start,t.newCellMetadata,r):t.newNotebookMetadata?this.replaceNotebookMetadata(e,t.newNotebookMetadata,r):this.replaceNotebookCells(e,t.range,t.newCells,r):Q.isSnippetTextEdit(t)?this._edits.push({_type:6,uri:e,range:t.range,edit:t.snippet,metadata:r}):this._edits.push({_type:2,uri:e,edit:t,metadata:r})}else{for(let t=0;t<this._edits.length;t++){const i=this._edits[t];switch(i._type){case 2:case 6:case 3:case 5:i.uri.toString()===e.toString()&&(this._edits[t]=void 0)}}(0,x.Rs)(this._edits)}}get(e){const t=[];for(const i of this._edits)2===i._type&&i.uri.toString()===e.toString()&&t.push(i.edit);return t}entries(){const e=new E.Y9;for(const t of this._edits)if(2===t._type){let i=e.get(t.uri);i||(i=[t.uri,[]],e.set(t.uri,i)),i[1].push(t.edit)}return[...e.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};G=(0,y.g)([N],G);let J=l=class{static isSnippetString(e){return e instanceof l||!!e&&"string"==typeof e.value}static _escape(e){return e.replace(/\$|}|\\/g,"\\$&")}constructor(e){this._tabstop=1,this.value=e||""}appendText(e){return this.value+=l._escape(e),this}appendTabstop(e=this._tabstop++){return this.value+="$",this.value+=e,this}appendPlaceholder(e,t=this._tabstop++){if("function"==typeof e){const t=new l;t._tabstop=this._tabstop,e(t),this._tabstop=t._tabstop,e=t.value}else e=l._escape(e);return this.value+="${",this.value+=t,this.value+=":",this.value+=e,this.value+="}",this}appendChoice(e,t=this._tabstop++){const i=e.map((e=>e.replaceAll(/[|\\,]/g,"\\$&"))).join(",");return this.value+="${",this.value+=t,this.value+="|",this.value+=i,this.value+="|}",this}appendVariable(e,t){if("function"==typeof t){const e=new l;e._tabstop=this._tabstop,t(e),this._tabstop=e._tabstop,t=e.value}else"string"==typeof t&&(t=t.replace(/\$|}/g,"\\$&"));return this.value+="${",this.value+=e,t&&(this.value+=":",this.value+=t),this.value+="}",this}};var Y,X;J=l=(0,y.g)([N],J),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(Y||(Y={})),function(e){e[e.Hint=3]="Hint",e[e.Information=2]="Information",e[e.Warning=1]="Warning",e[e.Error=0]="Error"}(X||(X={}));let Z=d=class{static isLocation(e){return e instanceof d||!!e&&(M.isRange(e.range)&&P.ov.isUri(e.uri))}constructor(e,t){if(this.uri=e,t)if(M.isRange(t))this.range=M.of(t);else{if(!F.isPosition(t))throw new Error("Illegal argument");this.range=new M(t,t)}else;}toJSON(){return{uri:this.uri,range:this.range}}};Z=d=(0,y.g)([N],Z);let ee=class{static is(e){return!!e&&("string"==typeof e.message&&e.location&&M.isRange(e.location.range)&&P.ov.isUri(e.location.uri))}constructor(e,t){this.location=e,this.message=t}static isEqual(e,t){return e===t||!(!e||!t)&&(e.message===t.message&&e.location.range.isEqual(t.location.range)&&e.location.uri.toString()===t.location.uri.toString())}};ee=(0,y.g)([N],ee);let te=class{constructor(e,t,i=X.Error){if(!M.isRange(e))throw new TypeError("range must be set");if(!t)throw new TypeError("message must be set");this.range=e,this.message=t,this.severity=i}toJSON(){return{severity:X[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(e,t){return e===t||!(!e||!t)&&(e.message===t.message&&e.severity===t.severity&&e.code===t.code&&e.severity===t.severity&&e.source===t.source&&e.range.isEqual(t.range)&&(0,x.fS)(e.tags,t.tags)&&(0,x.fS)(e.relatedInformation,t.relatedInformation,ee.isEqual))}};te=(0,y.g)([N],te);let ie=class{constructor(e,t){if(!e)throw new Error("Illegal argument, contents must be defined");Array.isArray(e)?this.contents=e:this.contents=[e],this.range=t}};ie=(0,y.g)([N],ie);let re=class extends ie{constructor(e,t,i,r){super(e,t),this.canIncreaseHover=i,this.canDecreaseHover=r}};var ne,se;re=(0,y.g)([N],re),function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(ne||(ne={})),function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"}(se||(se={}));let oe=class{constructor(e,t=se.Text){this.range=e,this.kind=t}toJSON(){return{range:this.range,kind:se[this.kind]}}};oe=(0,y.g)([N],oe);let ae=class{constructor(e,t){this.uri=e,this.highlights=t}toJSON(){return{uri:this.uri,highlights:this.highlights.map((e=>e.toJSON()))}}};var ce,le;ae=(0,y.g)([N],ae),function(e){e[e.File=0]="File",e[e.Module=1]="Module",e[e.Namespace=2]="Namespace",e[e.Package=3]="Package",e[e.Class=4]="Class",e[e.Method=5]="Method",e[e.Property=6]="Property",e[e.Field=7]="Field",e[e.Constructor=8]="Constructor",e[e.Enum=9]="Enum",e[e.Interface=10]="Interface",e[e.Function=11]="Function",e[e.Variable=12]="Variable",e[e.Constant=13]="Constant",e[e.String=14]="String",e[e.Number=15]="Number",e[e.Boolean=16]="Boolean",e[e.Array=17]="Array",e[e.Object=18]="Object",e[e.Key=19]="Key",e[e.Null=20]="Null",e[e.EnumMember=21]="EnumMember",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter"}(ce||(ce={})),function(e){e[e.Deprecated=1]="Deprecated"}(le||(le={}));let de=u=class{static validate(e){if(!e.name)throw new Error("name must not be falsy")}constructor(e,t,i,r,n){this.name=e,this.kind=t,this.containerName=n,"string"==typeof i&&(this.containerName=i),r instanceof Z?this.location=r:i instanceof M&&(this.location=new Z(r,i)),u.validate(this)}toJSON(){return{name:this.name,kind:ce[this.kind],location:this.location,containerName:this.containerName}}};de=u=(0,y.g)([N],de);let ue=h=class{static validate(e){if(!e.name)throw new Error("name must not be falsy");if(!e.range.contains(e.selectionRange))throw new Error("selectionRange must be contained in fullRange");e.children?.forEach(h.validate)}constructor(e,t,i,r,n){this.name=e,this.detail=t,this.kind=i,this.range=r,this.selectionRange=n,this.children=[],h.validate(this)}};var he;ue=h=(0,y.g)([N],ue),function(e){e[e.Invoke=1]="Invoke",e[e.Automatic=2]="Automatic"}(he||(he={}));let pe=class{constructor(e,t){this.title=e,this.kind=t}};pe=(0,y.g)([N],pe);let me=class{static{p=this}static{this.sep="."}constructor(e){this.value=e}append(e){return new p(this.value?this.value+p.sep+e:e)}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+p.sep)}};me=p=(0,y.g)([N],me),me.Empty=new me(""),me.QuickFix=me.Empty.append("quickfix"),me.Refactor=me.Empty.append("refactor"),me.RefactorExtract=me.Refactor.append("extract"),me.RefactorInline=me.Refactor.append("inline"),me.RefactorMove=me.Refactor.append("move"),me.RefactorRewrite=me.Refactor.append("rewrite"),me.Source=me.Empty.append("source"),me.SourceOrganizeImports=me.Source.append("organizeImports"),me.SourceFixAll=me.Source.append("fixAll"),me.Notebook=me.Empty.append("notebook");let fe=class{constructor(e,t){if(this.range=e,this.parent=t,t&&!t.range.contains(this.range))throw new Error("Invalid argument: parent must contain this range")}};fe=(0,y.g)([N],fe);class ge{constructor(e,t,i,r,n,s){this.kind=e,this.name=t,this.detail=i,this.uri=r,this.range=n,this.selectionRange=s}}class ve{constructor(e,t){this.fromRanges=t,this.from=e}}class _e{constructor(e,t){this.fromRanges=t,this.to=e}}var be;!function(e){e[e.Information=0]="Information",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(be||(be={}));let we=class{constructor(e,t){this.range=e,this.command=t}get isResolved(){return!!this.command}};we=(0,y.g)([N],we);let ye=m=class{#l;static isMarkdownString(e){return e instanceof m||e&&e.appendCodeblock&&e.appendMarkdown&&e.appendText&&void 0!==e.value}constructor(e,t=!1){this.#l=new S.W5(e,{supportThemeIcons:t})}get value(){return this.#l.value}set value(e){this.#l.value=e}get isTrusted(){return this.#l.isTrusted}set isTrusted(e){this.#l.isTrusted=e}get supportThemeIcons(){return this.#l.supportThemeIcons}set supportThemeIcons(e){this.#l.supportThemeIcons=e}get supportHtml(){return this.#l.supportHtml}set supportHtml(e){this.#l.supportHtml=e}get baseUri(){return this.#l.baseUri}set baseUri(e){this.#l.baseUri=e}appendText(e){return this.#l.appendText(e),this}appendMarkdown(e){return this.#l.appendMarkdown(e),this}appendCodeblock(e,t){return this.#l.appendCodeblock(t??"",e),this}};ye=m=(0,y.g)([N],ye);let xe=class{constructor(e,t){this.label=e,this.documentation=t}};xe=(0,y.g)([N],xe);let Ce=class{constructor(e,t){this.label=e,this.documentation=t,this.parameters=[]}};Ce=(0,y.g)([N],Ce);let Se=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};var Ee,De;Se=(0,y.g)([N],Se),function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"}(Ee||(Ee={})),function(e){e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"}(De||(De={}));let ke=class{constructor(e){this.value=e}};ke=(0,y.g)([N],ke);let Ie=class{constructor(e,t,i){this.position=e,this.label=t,this.kind=i}};var Pe,Te,Ae;Ie=(0,y.g)([N],Ie),function(e){e[e.Invoke=0]="Invoke",e[e.TriggerCharacter=1]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"}(Pe||(Pe={})),function(e){e[e.Text=0]="Text",e[e.Method=1]="Method",e[e.Function=2]="Function",e[e.Constructor=3]="Constructor",e[e.Field=4]="Field",e[e.Variable=5]="Variable",e[e.Class=6]="Class",e[e.Interface=7]="Interface",e[e.Module=8]="Module",e[e.Property=9]="Property",e[e.Unit=10]="Unit",e[e.Value=11]="Value",e[e.Enum=12]="Enum",e[e.Keyword=13]="Keyword",e[e.Snippet=14]="Snippet",e[e.Color=15]="Color",e[e.File=16]="File",e[e.Reference=17]="Reference",e[e.Folder=18]="Folder",e[e.EnumMember=19]="EnumMember",e[e.Constant=20]="Constant",e[e.Struct=21]="Struct",e[e.Event=22]="Event",e[e.Operator=23]="Operator",e[e.TypeParameter=24]="TypeParameter",e[e.User=25]="User",e[e.Issue=26]="Issue"}(Te||(Te={})),function(e){e[e.Deprecated=1]="Deprecated"}(Ae||(Ae={}));let Re=class{constructor(e,t){this.label=e,this.kind=t}toJSON(){return{label:this.label,kind:this.kind&&Te[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};Re=(0,y.g)([N],Re);let $e=class{constructor(e=[],t=!1){this.items=e,this.isIncomplete=t}};$e=(0,y.g)([N],$e);let Le=class{constructor(e,t,i){this.insertText=e,this.range=t,this.command=i}};Le=(0,y.g)([N],Le);let Ne=class{constructor(e){this.commands=void 0,this.suppressSuggestions=void 0,this.items=e}};var ze,Fe,Me,Oe,He,Ue,Be,We,Ve,qe;function je(e,t){return`${A.kP.toKey(e)}.${t}`}Ne=(0,y.g)([N],Ne),function(e){e[e.Unknown=0]="Unknown",e[e.Word=1]="Word",e[e.Line=2]="Line",e[e.Suggest=3]="Suggest"}(ze||(ze={})),function(e){e[e.Active=-1]="Active",e[e.Beside=-2]="Beside",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e[e.Six=6]="Six",e[e.Seven=7]="Seven",e[e.Eight=8]="Eight",e[e.Nine=9]="Nine"}(Fe||(Fe={})),function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"}(Me||(Me={})),function(e){e[e.Off=0]="Off",e[e.On=1]="On",e[e.Relative=2]="Relative",e[e.Interval=3]="Interval"}(Oe||(Oe={})),function(e){e[e.Manual=1]="Manual",e[e.AfterDelay=2]="AfterDelay",e[e.FocusOut=3]="FocusOut"}(He||(He={})),function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"}(Ue||(Ue={})),function(e){e[e.Keyboard=1]="Keyboard",e[e.Mouse=2]="Mouse",e[e.Command=3]="Command"}(Be||(Be={})),function(e){e[e.Undo=1]="Undo",e[e.Redo=2]="Redo"}(We||(We={})),function(e){e[e.OpenOpen=0]="OpenOpen",e[e.ClosedClosed=1]="ClosedClosed",e[e.OpenClosed=2]="OpenClosed",e[e.ClosedOpen=3]="ClosedOpen"}(Ve||(Ve={})),function(e){e.fromValue=function(t){switch(t){case"keyboard":return e.Keyboard;case"mouse":return e.Mouse;case"api":return e.Command}}}(Be||(Be={})),function(e){e[e.Other=0]="Other",e[e.Comment=1]="Comment",e[e.String=2]="String",e[e.RegEx=3]="RegEx"}(qe||(qe={})),function(e){e.toString=function(t){switch(t){case e.Other:return"other";case e.Comment:return"comment";case e.String:return"string";case e.RegEx:return"regex"}return"other"}}(qe||(qe={}));let Ke=class{constructor(e,t){if(t&&!P.ov.isUri(t))throw(0,C.b1)("target");if(!M.isRange(e)||e.isEmpty)throw(0,C.b1)("range");this.range=e,this.target=t}};Ke=(0,y.g)([N],Ke);let Qe=class{constructor(e,t,i,r){this.red=e,this.green=t,this.blue=i,this.alpha=r}};Qe=(0,y.g)([N],Qe);let Ge=class{constructor(e,t){if(t&&!(t instanceof Qe))throw(0,C.b1)("color");if(!M.isRange(e)||e.isEmpty)throw(0,C.b1)("range");this.range=e,this.color=t}};Ge=(0,y.g)([N],Ge);let Je=class{constructor(e){if(!e||"string"!=typeof e)throw(0,C.b1)("label");this.label=e}};var Ye,Xe,Ze,et,tt,it;Je=(0,y.g)([N],Je),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Information=2]="Information"}(Ye||(Ye={})),function(e){e[e.Unknown=0]="Unknown",e[e.Shutdown=1]="Shutdown",e[e.Process=2]="Process",e[e.User=3]="User",e[e.Extension=4]="Extension"}(Xe||(Xe={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(Ze||(Ze={}));class rt{constructor(e,t,i){if(this.startIndex=e,this.length=t,this.tooltip=i,"number"!=typeof e||e<0)throw(0,C.b1)("startIndex");if("number"!=typeof t||t<1)throw(0,C.b1)("length");if(void 0!==i&&"string"!=typeof i)throw(0,C.b1)("tooltip")}}class nt{constructor(e){this.uri=e}}class st{constructor(e){this.terminalCommand=e}}!function(e){e[e.Panel=1]="Panel",e[e.Editor=2]="Editor"}(et||(et={}));class ot{constructor(e){if(this.options=e,"object"!=typeof e)throw(0,C.b1)("options")}}!function(e){e[e.Always=1]="Always",e[e.Silent=2]="Silent",e[e.Never=3]="Never"}(tt||(tt={})),function(e){e[e.Shared=1]="Shared",e[e.Dedicated=2]="Dedicated",e[e.New=3]="New"}(it||(it={}));let at=class{static{f=this}static{this.Clean=new f("clean","Clean")}static{this.Build=new f("build","Build")}static{this.Rebuild=new f("rebuild","Rebuild")}static{this.Test=new f("test","Test")}static from(e){switch(e){case"clean":return f.Clean;case"build":return f.Build;case"rebuild":return f.Rebuild;case"test":return f.Test;default:return}}constructor(e,t){if(this.label=t,"string"!=typeof e)throw(0,C.b1)("name");if("string"!=typeof t)throw(0,C.b1)("name");this._id=e}get id(){return this._id}};function ct(e){let t="";for(let i=0;i<e.length;i++)t+=e[i].replace(/,/g,",,")+",";return t}at=f=(0,y.g)([N],at);let lt=class{constructor(e,t,i){if("string"!=typeof e)throw(0,C.b1)("process");this._args=[],this._process=e,void 0!==t&&(Array.isArray(t)?(this._args=t,this._options=i):this._options=t)}get process(){return this._process}set process(e){if("string"!=typeof e)throw(0,C.b1)("process");this._process=e}get args(){return this._args}set args(e){Array.isArray(e)||(e=[]),this._args=e}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("process"),void 0!==this._process&&e.push(this._process),this._args&&this._args.length>0)for(const t of this._args)e.push(t);return ct(e)}};lt=(0,y.g)([N],lt);let dt=class{constructor(e,t,i){if(this._args=[],Array.isArray(t)){if(!e)throw(0,C.b1)("command can't be undefined or null");if("string"!=typeof e&&"string"!=typeof e.value)throw(0,C.b1)("command");this._command=e,this._args=t,this._options=i}else{if("string"!=typeof e)throw(0,C.b1)("commandLine");this._commandLine=e,this._options=t}}get commandLine(){return this._commandLine}set commandLine(e){if("string"!=typeof e)throw(0,C.b1)("commandLine");this._commandLine=e}get command(){return this._command?this._command:""}set command(e){if("string"!=typeof e&&"string"!=typeof e.value)throw(0,C.b1)("command");this._command=e}get args(){return this._args}set args(e){this._args=e||[]}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("shell"),void 0!==this._commandLine&&e.push(this._commandLine),void 0!==this._command&&e.push("string"==typeof this._command?this._command:this._command.value),this._args&&this._args.length>0)for(const t of this._args)e.push("string"==typeof t?t:t.value);return ct(e)}};var ut,ht;dt=(0,y.g)([N],dt),function(e){e[e.Escape=1]="Escape",e[e.Strong=2]="Strong",e[e.Weak=3]="Weak"}(ut||(ut={})),function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace"}(ht||(ht={}));class pt{constructor(e){this._callback=e}computeId(){return"customExecution"+(0,T.R)()}set callback(e){this._callback=e}get callback(){return this._callback}}let mt=class{static{g=this}static{this.ExtensionCallbackType="customExecution"}static{this.ProcessType="process"}static{this.ShellType="shell"}static{this.EmptyType="$empty"}constructor(e,t,i,r,n,s){let o;this.__deprecated=!1,this._definition=this.definition=e,"string"==typeof t?(this._name=this.name=t,this._source=this.source=i,this.execution=r,o=n,this.__deprecated=!0):(t===ht.Global||ht.Workspace,this.target=t,this._name=this.name=i,this._source=this.source=r,this.execution=n,o=s),"string"==typeof o?(this._problemMatchers=[o],this._hasDefinedMatchers=!0):Array.isArray(o)?(this._problemMatchers=o,this._hasDefinedMatchers=!0):(this._problemMatchers=[],this._hasDefinedMatchers=!1),this._isBackground=!1,this._presentationOptions=Object.create(null),this._runOptions=Object.create(null)}get _id(){return this.__id}set _id(e){this.__id=e}get _deprecated(){return this.__deprecated}clear(){void 0!==this.__id&&(this.__id=void 0,this._scope=void 0,this.computeDefinitionBasedOnExecution())}computeDefinitionBasedOnExecution(){this._execution instanceof lt?this._definition={type:g.ProcessType,id:this._execution.computeId()}:this._execution instanceof dt?this._definition={type:g.ShellType,id:this._execution.computeId()}:this._execution instanceof pt?this._definition={type:g.ExtensionCallbackType,id:this._execution.computeId()}:this._definition={type:g.EmptyType,id:(0,T.R)()}}get definition(){return this._definition}set definition(e){if(null==e)throw(0,C.b1)("Kind can't be undefined or null");this.clear(),this._definition=e}get scope(){return this._scope}set target(e){this.clear(),this._scope=e}get name(){return this._name}set name(e){if("string"!=typeof e)throw(0,C.b1)("name");this.clear(),this._name=e}get execution(){return this._execution}set execution(e){null===e&&(e=void 0),this.clear(),this._execution=e;const t=this._definition.type;g.EmptyType!==t&&g.ProcessType!==t&&g.ShellType!==t&&g.ExtensionCallbackType!==t||this.computeDefinitionBasedOnExecution()}get problemMatchers(){return this._problemMatchers}set problemMatchers(e){if(!Array.isArray(e))return this.clear(),this._problemMatchers=[],void(this._hasDefinedMatchers=!1);this.clear(),this._problemMatchers=e,this._hasDefinedMatchers=!0}get hasDefinedMatchers(){return this._hasDefinedMatchers}get isBackground(){return this._isBackground}set isBackground(e){!0!==e&&!1!==e&&(e=!1),this.clear(),this._isBackground=e}get source(){return this._source}set source(e){if("string"!=typeof e||0===e.length)throw(0,C.b1)("source must be a string of length > 0");this.clear(),this._source=e}get group(){return this._group}set group(e){null===e&&(e=void 0),this.clear(),this._group=e}get detail(){return this._detail}set detail(e){null===e&&(e=void 0),this._detail=e}get presentationOptions(){return this._presentationOptions}set presentationOptions(e){null==e&&(e=Object.create(null)),this.clear(),this._presentationOptions=e}get runOptions(){return this._runOptions}set runOptions(e){null==e&&(e=Object.create(null)),this.clear(),this._runOptions=e}};var ft,gt;mt=g=(0,y.g)([N],mt),function(e){e[e.SourceControl=1]="SourceControl",e[e.Window=10]="Window",e[e.Notification=15]="Notification"}(ft||(ft={})),function(e){e.isViewBadge=function(e){const t=e;return(0,I.hj)(t.value)?!(t.tooltip&&!(0,I.HD)(t.tooltip))||(console.log("INVALID view badge, invalid tooltip",t.tooltip),!1):(console.log("INVALID view badge, invalid value",t.value),!1)}}(gt||(gt={}));let vt=v=class{static isTreeItem(e,t){const i=e;if(void 0!==i.checkboxState){const e=(0,I.hj)(i.checkboxState)?i.checkboxState:(0,I.Kn)(i.checkboxState)&&(0,I.hj)(i.checkboxState.state)?i.checkboxState.state:void 0,t=!(0,I.hj)(i.checkboxState)&&(0,I.Kn)(i.checkboxState)?i.checkboxState.tooltip:void 0;if(void 0===e||e!==bt.Checked&&e!==bt.Unchecked||void 0!==t&&!(0,I.HD)(t))return console.log("INVALID tree item, invalid checkboxState",i.checkboxState),!1}if(e instanceof v)return!0;if(void 0!==i.label&&!(0,I.HD)(i.label)&&!i.label?.label)return console.log("INVALID tree item, invalid label",i.label),!1;if(void 0!==i.id&&!(0,I.HD)(i.id))return console.log("INVALID tree item, invalid id",i.id),!1;if(!(void 0===i.iconPath||(0,I.HD)(i.iconPath)||P.ov.isUri(i.iconPath)||i.iconPath&&(0,I.HD)(i.iconPath.id))){const e=i.iconPath;if(!e||!(0,I.HD)(e.light)&&!P.ov.isUri(e.light)&&!(0,I.HD)(e.dark)&&!P.ov.isUri(e.dark))return console.log("INVALID tree item, invalid iconPath",i.iconPath),!1}return void 0===i.description||(0,I.HD)(i.description)||"boolean"==typeof i.description?void 0===i.resourceUri||P.ov.isUri(i.resourceUri)?void 0===i.tooltip||(0,I.HD)(i.tooltip)||i.tooltip instanceof ye?void 0===i.command||i.command.command?void 0!==i.collapsibleState&&i.collapsibleState<_t.None&&i.collapsibleState>_t.Expanded?(console.log("INVALID tree item, invalid collapsibleState",i.collapsibleState),!1):void 0===i.contextValue||(0,I.HD)(i.contextValue)?!(void 0!==i.accessibilityInformation&&!i.accessibilityInformation?.label)||(console.log("INVALID tree item, invalid accessibilityInformation",i.accessibilityInformation),!1):(console.log("INVALID tree item, invalid contextValue",i.contextValue),!1):(console.log("INVALID tree item, invalid command",i.command),!1):(console.log("INVALID tree item, invalid tooltip",i.tooltip),!1):(console.log("INVALID tree item, invalid resourceUri",i.resourceUri),!1):(console.log("INVALID tree item, invalid description",i.description),!1)}constructor(e,t=_t.None){this.collapsibleState=t,P.ov.isUri(e)?this.resourceUri=e:this.label=e}};var _t,bt;vt=v=(0,y.g)([N],vt),function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"}(_t||(_t={})),function(e){e[e.Unchecked=0]="Unchecked",e[e.Checked=1]="Checked"}(bt||(bt={}));let wt=class{async asString(){return"string"==typeof this.value?this.value:JSON.stringify(this.value)}asFile(){}constructor(e){this.value=e}};wt=(0,y.g)([N],wt);class yt extends wt{}class xt extends yt{#d;constructor(e){super(""),this.#d=e}asFile(){return this.#d}}class Ct{constructor(e,t,i,r){this.name=e,this.uri=t,this._itemId=i,this._getData=r}data(){return this._getData()}}let St=class{#u=new Map;constructor(e){for(const[t,i]of e??[]){const e=this.#u.get(this.#h(t));e?e.push(i):this.#u.set(this.#h(t),[i])}}get(e){return this.#u.get(this.#h(e))?.[0]}set(e,t){this.#u.set(this.#h(e),[t])}forEach(e,t){for(const[i,r]of this.#u)for(const n of r)e.call(t,n,i,this)}*[Symbol.iterator](){for(const[e,t]of this.#u)for(const i of t)yield[e,i]}#h(e){return e.toLowerCase()}};St=(0,y.g)([N],St);let Et=class{constructor(e,t,i){this.insertText=e,this.title=t,this.kind=i}};var Dt;Et=(0,y.g)([N],Et),function(e){e[e.Automatic=0]="Automatic",e[e.PasteAs=1]="PasteAs"}(Dt||(Dt={}));class kt{static{this.sep="."}constructor(e){this.value=e}append(...e){return new kt((this.value?[this.value,...e]:e).join(kt.sep))}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+kt.sep)}}kt.Empty=new kt("");class It{constructor(e,t,i){this.title=t,this.insertText=e,this.kind=i}}let Pt=class{constructor(e,t){this.id=e,this.color=t}static isThemeIcon(e){return"string"==typeof e.id||(console.log("INVALID ThemeIcon, invalid id",e.id),!1)}};Pt=(0,y.g)([N],Pt),Pt.File=new Pt("file"),Pt.Folder=new Pt("folder");let Tt=class{constructor(e){this.id=e}};var At;Tt=(0,y.g)([N],Tt),function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace",e[e.WorkspaceFolder=3]="WorkspaceFolder"}(At||(At={}));let Rt=class{get base(){return this._base}set base(e){this._base=e,this._baseUri=P.ov.file(e)}get baseUri(){return this._baseUri}set baseUri(e){this._baseUri=e,this._base=e.fsPath}constructor(e,t){if("string"!=typeof e&&(!e||!P.ov.isUri(e)&&!P.ov.isUri(e.uri)))throw(0,C.b1)("base");if("string"!=typeof t)throw(0,C.b1)("pattern");"string"==typeof e?this.baseUri=P.ov.file(e):P.ov.isUri(e)?this.baseUri=e:this.baseUri=e.uri,this.pattern=t}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};Rt=(0,y.g)([N],Rt);const $t=new WeakMap;function Lt(e,t){$t.set(e,t)}let Nt=class{constructor(e,t,i,r,n){this.enabled="boolean"!=typeof e||e,"string"==typeof t&&(this.condition=t),"string"==typeof i&&(this.hitCondition=i),"string"==typeof r&&(this.logMessage=r),"string"==typeof n&&(this.mode=n)}get id(){return this._id||(this._id=$t.get(this)??(0,T.R)()),this._id}};Nt=(0,y.g)([N],Nt);let zt=class extends Nt{constructor(e,t,i,r,n,s){if(super(t,i,r,n,s),null===e)throw(0,C.b1)("location");this.location=e}};zt=(0,y.g)([N],zt);let Ft=class extends Nt{constructor(e,t,i,r,n,s){super(t,i,r,n,s),this.functionName=e}};Ft=(0,y.g)([N],Ft);let Mt=class extends Nt{constructor(e,t,i,r,n,s,o,a){if(super(r,n,s,o,a),!t)throw(0,C.b1)("dataId");this.label=e,this.dataId=t,this.canPersist=i}};Mt=(0,y.g)([N],Mt);let Ot=class{constructor(e,t,i){this.command=e,this.args=t||[],this.options=i}};Ot=(0,y.g)([N],Ot);let Ht=class{constructor(e,t){this.port=e,this.host=t}};Ht=(0,y.g)([N],Ht);let Ut=class{constructor(e){this.path=e}};Ut=(0,y.g)([N],Ut);let Bt=class{constructor(e){this.implementation=e}};Bt=(0,y.g)([N],Bt);class Wt{constructor(e,t,i){this.session=e,this.threadId=t,this.frameId=i}}class Vt{constructor(e,t){this.session=e,this.threadId=t}}let qt=class{constructor(e,t){this.range=e,this.expression=t}};var jt;qt=(0,y.g)([N],qt),function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"}(jt||(jt={}));let Kt=class{constructor(e,t){this.range=e,this.text=t}};Kt=(0,y.g)([N],Kt);let Qt=class{constructor(e,t,i=!0){this.range=e,this.variableName=t,this.caseSensitiveLookup=i}};Qt=(0,y.g)([N],Qt);let Gt=class{constructor(e,t){this.range=e,this.expression=t}};Gt=(0,y.g)([N],Gt);let Jt=class{constructor(e,t){this.frameId=e,this.stoppedLocation=t}};var Yt,Xt,Zt;Jt=(0,y.g)([N],Jt),function(e){e[e.AIGenerated=1]="AIGenerated"}(Yt||(Yt={})),function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"}(Xt||(Xt={}));class ei{constructor(e,t){this.newSymbolName=e,this.tags=t}}!function(e){e[e.Changed=1]="Changed",e[e.Created=2]="Created",e[e.Deleted=3]="Deleted"}(Zt||(Zt={}));let ti=_=class extends Error{static FileExists(e){return new _(e,R.bH.FileExists,_.FileExists)}static FileNotFound(e){return new _(e,R.bH.FileNotFound,_.FileNotFound)}static FileNotADirectory(e){return new _(e,R.bH.FileNotADirectory,_.FileNotADirectory)}static FileIsADirectory(e){return new _(e,R.bH.FileIsADirectory,_.FileIsADirectory)}static NoPermissions(e){return new _(e,R.bH.NoPermissions,_.NoPermissions)}static Unavailable(e){return new _(e,R.bH.Unavailable,_.Unavailable)}constructor(e,t=R.bH.Unknown,i){super(P.ov.isUri(e)?e.toString(!0):e),this.code=i?.name??"Unknown",(0,R.q5)(this,t),Object.setPrototypeOf(this,_.prototype),"function"==typeof Error.captureStackTrace&&"function"==typeof i&&Error.captureStackTrace(this,i)}};ti=_=(0,y.g)([N],ti);let ii=class{constructor(e,t,i){this.start=e,this.end=t,this.kind=i}};var ri,ni,si,oi,ai,ci,li;ii=(0,y.g)([N],ii),function(e){e[e.Comment=1]="Comment",e[e.Imports=2]="Imports",e[e.Region=3]="Region"}(ri||(ri={})),function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"}(ni||(ni={})),function(e){e[e.Editing=0]="Editing",e[e.Preview=1]="Preview"}(si||(si={})),function(e){e[e.Published=0]="Published",e[e.Draft=1]="Draft"}(oi||(oi={})),function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"}(ai||(ai={})),function(e){e[e.Current=0]="Current",e[e.Outdated=1]="Outdated"}(ci||(ci={}));class di{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}}class ui{constructor(e){if(this._prevLine=0,this._prevChar=0,this._dataIsSortedAndDeltaEncoded=!0,this._data=[],this._dataLen=0,this._tokenTypeStrToInt=new Map,this._tokenModifierStrToInt=new Map,this._hasLegend=!1,e){this._hasLegend=!0;for(let t=0,i=e.tokenTypes.length;t<i;t++)this._tokenTypeStrToInt.set(e.tokenTypes[t],t);for(let t=0,i=e.tokenModifiers.length;t<i;t++)this._tokenModifierStrToInt.set(e.tokenModifiers[t],t)}}push(e,t,i,r,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof i&&"number"==typeof r&&("number"==typeof n||void 0===n))return void 0===n&&(n=0),this._pushEncoded(e,t,i,r,n);if(M.isRange(e)&&"string"==typeof t&&(void 0===(s=i)||(0,I.GI)(s)))return this._push(e,t,i);var s;throw(0,C.b1)()}_push(e,t,i){if(!this._hasLegend)throw new Error("Legend must be provided in constructor");if(e.start.line!==e.end.line)throw new Error("`range` cannot span multiple lines");if(!this._tokenTypeStrToInt.has(t))throw new Error("`tokenType` is not in the provided legend");const r=e.start.line,n=e.start.character,s=e.end.character-e.start.character,o=this._tokenTypeStrToInt.get(t);let a=0;if(i)for(const e of i){if(!this._tokenModifierStrToInt.has(e))throw new Error("`tokenModifier` is not in the provided legend");a|=1<<this._tokenModifierStrToInt.get(e)>>>0}this._pushEncoded(r,n,s,o,a)}_pushEncoded(e,t,i,r,n){if(this._dataIsSortedAndDeltaEncoded&&(e<this._prevLine||e===this._prevLine&&t<this._prevChar)){this._dataIsSortedAndDeltaEncoded=!1;const e=this._data.length/5|0;let t=0,i=0;for(let r=0;r<e;r++){let e=this._data[5*r],n=this._data[5*r+1];0===e?(e=t,n+=i):e+=t,this._data[5*r]=e,this._data[5*r+1]=n,t=e,i=n}}let s=e,o=t;this._dataIsSortedAndDeltaEncoded&&this._dataLen>0&&(s-=this._prevLine,0===s&&(o-=this._prevChar)),this._data[this._dataLen++]=s,this._data[this._dataLen++]=o,this._data[this._dataLen++]=i,this._data[this._dataLen++]=r,this._data[this._dataLen++]=n,this._prevLine=e,this._prevChar=t}static _sortAndDeltaEncode(e){const t=[],i=e.length/5|0;for(let e=0;e<i;e++)t[e]=e;t.sort(((t,i)=>{const r=e[5*t],n=e[5*i];if(r===n){return e[5*t+1]-e[5*i+1]}return r-n}));const r=new Uint32Array(e.length);let n=0,s=0;for(let o=0;o<i;o++){const i=5*t[o],a=e[i+0],c=e[i+1],l=e[i+2],d=e[i+3],u=e[i+4],h=a-n,p=0===h?c-s:c,m=5*o;r[m+0]=h,r[m+1]=p,r[m+2]=l,r[m+3]=d,r[m+4]=u,n=a,s=c}return r}build(e){return this._dataIsSortedAndDeltaEncoded?new hi(new Uint32Array(this._data),e):new hi(ui._sortAndDeltaEncode(this._data),e)}}class hi{constructor(e,t){this.resultId=t,this.data=e}}class pi{constructor(e,t,i){this.start=e,this.deleteCount=t,this.data=i}}class mi{constructor(e,t){this.resultId=t,this.edits=e}}!function(e){e[e.Separate=0]="Separate",e[e.MergeWithParent=1]="MergeWithParent"}(li||(li={}));class fi{constructor(e){this.name=e}}let gi=class{static{this.Back={iconPath:new Pt("arrow-left")}}constructor(){}};var vi,_i,bi;gi=(0,y.g)([N],gi),function(e){e[e.Separator=-1]="Separator",e[e.Default=0]="Default"}(vi||(vi={})),function(e){e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(_i||(_i={})),function(e){e[e.UI=1]="UI",e[e.Workspace=2]="Workspace"}(bi||(bi={}));class wi{static validate(e){if("string"==typeof e.badge){let t=(0,k.vH)(e.badge,0);if(t<e.badge.length&&(t+=(0,k.vH)(e.badge,t)),e.badge.length>t)throw new Error("The 'badge'-property must be undefined or a short character")}else if(e.badge&&!Pt.isThemeIcon(e.badge))throw new Error("The 'badge'-property is not a valid ThemeIcon");if(!e.color&&!e.badge&&!e.tooltip)throw new Error("The decoration is empty");return!0}constructor(e,t,i){this.badge=e,this.tooltip=t,this.color=i}}let yi=class{constructor(e){this.kind=e}};var xi,Ci,Si,Ei,Di,ki,Ii,Pi;yi=(0,y.g)([N],yi),function(e){e[e.Light=1]="Light",e[e.Dark=2]="Dark",e[e.HighContrast=3]="HighContrast",e[e.HighContrastLight=4]="HighContrastLight"}(xi||(xi={}));class Ti{static isNotebookRange(e){return e instanceof Ti||!!e&&("number"==typeof e.start&&"number"==typeof e.end)}get start(){return this._start}get end(){return this._end}get isEmpty(){return this._start===this._end}constructor(e,t){if(e<0)throw(0,C.b1)("start must be positive");if(t<0)throw(0,C.b1)("end must be positive");e<=t?(this._start=e,this._end=t):(this._start=t,this._end=e)}with(e){let t=this._start,i=this._end;return void 0!==e.start&&(t=e.start),void 0!==e.end&&(i=e.end),t===this._start&&i===this._end?this:new Ti(t,i)}}class Ai{static validate(e){if("number"!=typeof e.kind)throw new Error("NotebookCellData MUST have 'kind' property");if("string"!=typeof e.value)throw new Error("NotebookCellData MUST have 'value' property");if("string"!=typeof e.languageId)throw new Error("NotebookCellData MUST have 'languageId' property")}static isNotebookCellDataArray(e){return Array.isArray(e)&&e.every((e=>Ai.isNotebookCellData(e)))}static isNotebookCellData(e){return!0}constructor(e,t,i,r,n,s,o){this.kind=e,this.value=t,this.languageId=i,this.mime=r,this.outputs=n??[],this.metadata=s,this.executionSummary=o,Ai.validate(this)}}class Ri{constructor(e){this.cells=e}}class $i{static isNotebookCellOutputItem(e){return e instanceof $i||!!e&&("string"==typeof e.mime&&e.data instanceof Uint8Array)}static error(e){const t={name:e.name,message:e.message,stack:e.stack};return $i.json(t,"application/vnd.code.notebook.error")}static stdout(e){return $i.text(e,"application/vnd.code.notebook.stdout")}static stderr(e){return $i.text(e,"application/vnd.code.notebook.stderr")}static bytes(e,t="application/octet-stream"){return new $i(e,t)}static#p=new TextEncoder;static text(e,t=D.vW.text){const i=$i.#p.encode(String(e));return new $i(i,t)}static json(e,t="text/x-json"){const i=JSON.stringify(e,void 0,"\t");return $i.text(i,t)}constructor(e,t){this.data=e,this.mime=t;const i=(0,D.PP)(t,!0);if(!i)throw new Error(`INVALID mime type: ${t}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=i}}class Li{static isNotebookCellOutput(e){return e instanceof Li||!(!e||"object"!=typeof e)&&("string"==typeof e.id&&Array.isArray(e.items))}static ensureUniqueMimeTypes(e,t=!1){const i=new Set,r=new Set;for(let n=0;n<e.length;n++){const s=e[n],o=(0,D.PP)(s.mime);i.has(o)&&!(0,L.OT)(o)?(r.add(n),t&&console.warn(`DUPLICATED mime type '${s.mime}' will be dropped`)):i.add(o)}return 0===r.size?e:e.filter(((e,t)=>!r.has(t)))}constructor(e,t,i){this.items=Li.ensureUniqueMimeTypes(e,!0),"string"==typeof t?(this.id=t,this.metadata=i):(this.id=(0,T.R)(),this.metadata=t??i)}}!function(e){e[e.Markup=1]="Markup",e[e.Code=2]="Code"}(Ci||(Ci={})),function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"}(Si||(Si={})),function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"}(Ei||(Ei={})),function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"}(Di||(Di={}));class Ni{constructor(e,t){this.text=e,this.alignment=t}}!function(e){e[e.Default=1]="Default",e[e.Preferred=2]="Preferred"}(ki||(ki={})),function(e){e[e.Default=1]="Default",e[e.Preferred=2]="Preferred",e[e.Hidden=-1]="Hidden"}(Ii||(Ii={}));class zi{constructor(e,t=[]){this.uri=e,this.provides=(0,x._2)(t)}}class Fi{constructor(e){this.label=e}}!function(e){e[e.Named=1]="Named",e[e.Indexed=2]="Indexed"}(Pi||(Pi={}));let Mi=class{constructor(e,t){this.label=e,this.timestamp=t}};var Oi,Hi,Ui,Bi,Wi;Mi=(0,y.g)([N],Mi),function(e){e[e.Production=1]="Production",e[e.Development=2]="Development",e[e.Test=3]="Test"}(Oi||(Oi={})),function(e){e[e.Node=1]="Node",e[e.Webworker=2]="Webworker"}(Hi||(Hi={})),function(e){e[e.Other=0]="Other",e[e.Comment=1]="Comment",e[e.String=2]="String",e[e.RegEx=3]="RegEx"}(Ui||(Ui={}));class Vi{constructor(e,t){this.ranges=e,this.wordPattern=t}}class qi{constructor(e){this._autoForwardAction=e}get autoForwardAction(){return this._autoForwardAction}}!function(e){e[e.Queued=1]="Queued",e[e.Running=2]="Running",e[e.Passed=3]="Passed",e[e.Failed=4]="Failed",e[e.Skipped=5]="Skipped",e[e.Errored=6]="Errored"}(Bi||(Bi={})),function(e){e[e.Run=1]="Run",e[e.Debug=2]="Debug",e[e.Coverage=3]="Coverage"}(Wi||(Wi={}));let ji=class{constructor(e=void 0,t=void 0,i=void 0,r=!1,n=!0){this.include=e,this.exclude=t,this.profile=i,this.continuous=r,this.preserveFocus=n}};ji=(0,y.g)([N],ji);let Ki=b=class{static diff(e,t,i){const r=new b(e);return r.expectedOutput=t,r.actualOutput=i,r}constructor(e){this.message=e}};Ki=b=(0,y.g)([N],Ki);let Qi=class{constructor(e){this.id=e}};Qi=(0,y.g)([N],Qi);class Gi{constructor(e,t){this.covered=e,this.total=t,Ji(this)}}function Ji(e){if(e){if(e.covered>e.total)throw new Error(`The total number of covered items (${e.covered}) cannot be greater than the total (${e.total})`);if(e.total<0)throw new Error(`The number of covered items (${e.total}) cannot be negative`)}}class Yi{static fromDetails(e,t){const i=new Gi(0,0),r=new Gi(0,0),n=new Gi(0,0);for(const e of t)if("branches"in e){i.total+=1,i.covered+=e.executed?1:0;for(const t of e.branches)r.total+=1,r.covered+=t.executed?1:0}else n.total+=1,n.covered+=e.executed?1:0;const s=new Yi(e,i,r.total>0?r:void 0,n.total>0?n:void 0);return s.detailedCoverage=t,s}constructor(e,t,i,r){this.uri=e,this.statementCoverage=t,this.branchCoverage=i,this.declarationCoverage=r}}class Xi{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i=[]){this.executed=e,this.location=t,this.branches=i}}class Zi{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.executed=e,this.location=t,this.label=i}}class er{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.name=e,this.executed=t,this.location=i}}var tr,ir,rr,nr,sr,or,ar,cr,lr,dr,ur,hr,pr;!function(e){e[e.None=0]="None",e[e.Option=1]="Option",e[e.Default=2]="Default",e[e.Preferred=3]="Preferred"}(tr||(tr={})),function(e){e[e.Untrusted=0]="Untrusted",e[e.Trusted=1]="Trusted",e[e.Unspecified=2]="Unspecified"}(ir||(ir={})),function(e){e[e.Notify=1]="Notify",e[e.OpenBrowser=2]="OpenBrowser",e[e.OpenPreview=3]="OpenPreview",e[e.Silent=4]="Silent",e[e.Ignore=5]="Ignore",e[e.OpenBrowserOnce=6]="OpenBrowserOnce"}(rr||(rr={}));class mr{constructor(e,t,i,r,n,s){this.kind=e,this.name=t,this.detail=i,this.uri=r,this.range=n,this.selectionRange=s}}class fr{constructor(e){this.uri=e}}class gr{constructor(e,t){this.original=e,this.modified=t}}class vr{constructor(e,t,i,r){this.base=e,this.input1=t,this.input2=i,this.result=r}}class _r{constructor(e,t){this.uri=e,this.viewType=t}}class br{constructor(e){this.viewType=e}}class wr{constructor(e,t){this.uri=e,this.notebookType=t}}class yr{constructor(e,t,i){this.original=e,this.modified=t,this.notebookType=i}}class xr{constructor(){}}class Cr{constructor(e,t){this.uri=e,this.inputBoxUri=t}}class Sr{constructor(){}}class Er{constructor(e){this.textDiffs=e}}!function(e){e[e.Down=0]="Down",e[e.Up=1]="Up"}(nr||(nr={})),function(e){e[e.Action=1]="Action",e[e.Toolbar=2]="Toolbar"}(sr||(sr={})),function(e){e[e.Short=1]="Short",e[e.Medium=2]="Medium",e[e.Full=3]="Full"}(or||(or={}));class Dr{constructor(e,t){this.label=e,this.values=t}}!function(e){e[e.Unhelpful=0]="Unhelpful",e[e.Helpful=1]="Helpful",e[e.Undone=2]="Undone",e[e.Accepted=3]="Accepted",e[e.Bug=4]="Bug"}(ar||(ar={})),function(e){e[e.Unhelpful=0]="Unhelpful",e[e.Helpful=1]="Helpful"}(cr||(cr={}));class kr{constructor(e){if("string"!=typeof e&&!0===e.isTrusted)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value="string"==typeof e?new ye(e):e}}class Ir{constructor(e,t){if("string"!=typeof e&&!0===e.isTrusted)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value="string"==typeof e?new ye(e):e,this.vulnerabilities=t}}class Pr{constructor(e,t){this.participant=e,this.command=t}}class Tr{constructor(e,t){this.value=e,this.baseUri=t}}class Ar{constructor(e,t){this.value=e,this.title=t}}class Rr{constructor(e){this.value=e}}class $r{constructor(e){this.value=e}}class Lr{constructor(e,t){this.value=e,this.iconPath=t}}class Nr{constructor(e,t){this.uri=e,this.edits=Array.isArray(t)?t:[t]}}class zr{constructor(e,t,i,r){this.prompt=e,this.command=t,this.variables=i,this.participant=r}}class Fr{constructor(e,t,i,r){this.response=e,this.result=t,this.participant=i,this.command=r}}!function(e){e[e.Panel=1]="Panel",e[e.Terminal=2]="Terminal",e[e.Notebook=3]="Notebook",e[e.Editor=4]="Editor"}(lr||(lr={}));class Mr{constructor(e){this.content=e}}class Or{constructor(e,t){this.content=e,this.name=t}}class Hr{constructor(e,t){this.content=e,this.name=t}}class Ur extends Error{static NotFound(e){return new Ur(e,Ur.NotFound.name)}static NoPermissions(e){return new Ur(e,Ur.NoPermissions.name)}constructor(e,t,i){super(e,{cause:i}),this.name="LanguageModelError",this.code=t??""}}!function(e){e[e.SymbolInformation=1]="SymbolInformation",e[e.CommandInformation=2]="CommandInformation",e[e.SearchInformation=3]="SearchInformation",e[e.SettingInformation=4]="SettingInformation"}(dr||(dr={})),function(e){e[e.Started=1]="Started",e[e.Recognizing=2]="Recognizing",e[e.Recognized=3]="Recognized",e[e.Stopped=4]="Stopped",e[e.Error=5]="Error"}(ur||(ur={})),function(e){e[e.Recognized=1]="Recognized",e[e.Stopped=2]="Stopped"}(hr||(hr={}));class Br{constructor(e,t){this.text=e,this.range=t}}!function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"}(pr||(pr={}))},76221:function(e,t,i){i.d(t,{F:function(){return r},Z:function(){return n}});const r=(0,i(28019).yh)("IURITransformerService");class n{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=e=>e,this.transformOutgoing=e=>e,this.transformOutgoingURI=e=>e,this.transformOutgoingScheme=e=>e)}}},98668:function(e,t,i){i.d(t,{Y:function(){return k},w:function(){return E}});var r,n=i(45493),s=i(40048),o=i(7428),a=i(15229),c=i(57585),l=i(28019),d=i(1663),u=i(53917),h=i(26841),p=i(30874),m=i(89608),f=i(47635),g=i(82998),v=i(11547),_=i(1991),b=i(67525);!function(e){e.Unknown="unknown",e.Env="env",e.Config="config",e.Command="command",e.Input="input",e.ExtensionInstallFolder="extensionInstallFolder",e.WorkspaceFolder="workspaceFolder",e.Cwd="cwd",e.WorkspaceFolderBasename="workspaceFolderBasename",e.UserHome="userHome",e.LineNumber="lineNumber",e.SelectedText="selectedText",e.File="file",e.FileWorkspaceFolder="fileWorkspaceFolder",e.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",e.RelativeFile="relativeFile",e.RelativeFileDirname="relativeFileDirname",e.FileDirname="fileDirname",e.FileExtname="fileExtname",e.FileBasename="fileBasename",e.FileBasenameNoExtension="fileBasenameNoExtension",e.FileDirnameBasename="fileDirnameBasename",e.ExecPath="execPath",e.ExecInstallFolder="execInstallFolder",e.PathSeparator="pathSeparator",e.PathSeparatorAlias="/"}(r||(r={}));class w extends Error{constructor(e,t){super(t),this.variable=e}}var y=i(88023);const x="vs/workbench/services/configurationResolver/common/variableResolver";class C{static{this.VARIABLE_LHS="${"}static{this.VARIABLE_REGEXP=/\$\{(.*?)\}/g}constructor(e,t,i,r){this._contributedVariables=new Map,this._context=e,this._labelService=t,this._userHomePromise=i,r&&(this._envVariablesPromise=r.then((e=>this.prepareEnv(e))))}prepareEnv(e){if(v.ED){const t=Object.create(null);return Object.keys(e).forEach((i=>{t[i.toLowerCase()]=e[i]})),t}return e}resolveWithEnvironment(e,t,i){return this.recursiveResolve({env:this.prepareEnv(e),userHome:void 0},t?t.uri:void 0,i)}async resolveAsync(e,t){const i={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(i,e?e.uri:void 0,t)}async resolveAnyBase(e,t,i,r){const n=(0,g.I8)(t);v.ED&&n.windows?Object.keys(n.windows).forEach((e=>n[e]=n.windows[e])):v.dz&&n.osx?Object.keys(n.osx).forEach((e=>n[e]=n.osx[e])):v.IJ&&n.linux&&Object.keys(n.linux).forEach((e=>n[e]=n.linux[e])),delete n.windows,delete n.osx,delete n.linux;const s={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(s,e?e.uri:void 0,n,i,r)}async resolveAnyAsync(e,t,i){return this.resolveAnyBase(e,t,i)}async resolveAnyMap(e,t,i){const r=new Map;return{newConfig:await this.resolveAnyBase(e,t,i,r),resolvedVariables:r}}resolveWithInteractionReplace(e,t,i,r){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t,i,r){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this._contributedVariables.has(e))throw new Error("Variable "+e+" is contributed twice.");this._contributedVariables.set(e,t)}async recursiveResolve(e,t,i,r,n){if((0,f.HD)(i))return this.resolveString(e,t,i,r,n);if(Array.isArray(i))return Promise.all(i.map((i=>this.recursiveResolve(e,t,i,r,n))));if((0,f.Kn)(i)){const s=Object.create(null),o=await Promise.all(Object.keys(i).map((async s=>[await this.resolveString(e,t,s,r,n),await this.recursiveResolve(e,t,i[s],r,n)])));for(const[e,t]of o)s[e]=t;return s}return i}resolveString(e,t,i,r,n){return(0,y.s$)(i,C.VARIABLE_REGEXP,(async(i,s)=>{if(s.includes(C.VARIABLE_LHS))return i;let o=await this.evaluateSingleVariable(e,i,s,t,r);return n?.set(s,o),o!==i&&(0,f.HD)(o)&&o.match(C.VARIABLE_REGEXP)&&(o=await this.resolveString(e,t,o,r,n)),o}))}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:!0}):e.fsPath}async evaluateSingleVariable(e,t,i,n,s){let o;const l=i.split(":");l.length>1&&(i=l[0],o=l[1]);const d=e=>{const i=this._context.getFilePath();if(i)return(0,_.DT)(i);throw new w(e,(0,b.C$)(x,0,"Variable {0} can not be resolved. Please open an editor.",t))},u=e=>{const i=d(e);if(this._context.getWorkspaceFolderPathForFile){const e=this._context.getWorkspaceFolderPathForFile();if(e)return(0,_.DT)(e)}throw new w(e,(0,b.C$)(x,1,"Variable {0}: can not find workspace folder of '{1}'.",t,(0,a.EZ)(i)))},h=e=>{if(o){const i=this._context.getFolderUri(o);if(i)return i;throw new w(e,(0,b.C$)(x,2,"Variable {0} can not be resolved. No such folder '{1}'.",t,o))}if(n)return n;if(this._context.getWorkspaceFolderCount()>1)throw new w(e,(0,b.C$)(x,3,"Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.",t));throw new w(e,(0,b.C$)(x,4,"Variable {0} can not be resolved. Please open a folder.",t))};switch(i){case"env":if(o){if(e.env){const t=e.env[v.ED?o.toLowerCase():o];if((0,f.HD)(t))return t}return""}throw new w(r.Env,(0,b.C$)(x,5,"Variable {0} can not be resolved because no environment variable name is given.",t));case"config":if(o){const e=this._context.getConfigurationValue(n,o);if((0,f.Jp)(e))throw new w(r.Config,(0,b.C$)(x,6,"Variable {0} can not be resolved because setting '{1}' not found.",t,o));if((0,f.Kn)(e))throw new w(r.Config,(0,b.C$)(x,7,"Variable {0} can not be resolved because '{1}' is a structured value.",t,o));return e}throw new w(r.Config,(0,b.C$)(x,8,"Variable {0} can not be resolved because no settings name is given.",t));case"command":return this.resolveFromMap(r.Command,t,o,s,"command");case"input":return this.resolveFromMap(r.Input,t,o,s,"input");case"extensionInstallFolder":if(o){const e=await this._context.getExtension(o);if(!e)throw new w(r.ExtensionInstallFolder,(0,b.C$)(x,9,"Variable {0} can not be resolved because the extension {1} is not installed.",t,o));return this.fsPath(e.extensionLocation)}throw new w(r.ExtensionInstallFolder,(0,b.C$)(x,10,"Variable {0} can not be resolved because no extension name is given.",t));default:switch(i){case"workspaceRoot":case"workspaceFolder":return(0,_.DT)(this.fsPath(h(r.WorkspaceFolder)));case"cwd":return n||o?(0,_.DT)(this.fsPath(h(r.Cwd))):(0,c.Vj)();case"workspaceRootFolderName":case"workspaceFolderBasename":return(0,_.DT)((0,a.EZ)(this.fsPath(h(r.WorkspaceFolderBasename))));case"userHome":if(e.userHome)return e.userHome;throw new w(r.UserHome,(0,b.C$)(x,11,"Variable {0} can not be resolved. UserHome path is not defined",t));case"lineNumber":{const e=this._context.getLineNumber();if(e)return e;throw new w(r.LineNumber,(0,b.C$)(x,12,"Variable {0} can not be resolved. Make sure to have a line selected in the active editor.",t))}case"selectedText":{const e=this._context.getSelectedText();if(e)return e;throw new w(r.SelectedText,(0,b.C$)(x,13,"Variable {0} can not be resolved. Make sure to have some text selected in the active editor.",t))}case"file":return d(r.File);case"fileWorkspaceFolder":return u(r.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return(0,a.EZ)(u(r.FileWorkspaceFolderBasename));case"relativeFile":return n||o?(0,a.Gf)(this.fsPath(h(r.RelativeFile)),d(r.RelativeFile)):d(r.RelativeFile);case"relativeFileDirname":{const e=(0,a.XX)(d(r.RelativeFileDirname));if(n||o){const t=(0,a.Gf)(this.fsPath(h(r.RelativeFileDirname)),e);return 0===t.length?".":t}return e}case"fileDirname":return(0,a.XX)(d(r.FileDirname));case"fileExtname":return(0,a.DZ)(d(r.FileExtname));case"fileBasename":return(0,a.EZ)(d(r.FileBasename));case"fileBasenameNoExtension":{const e=(0,a.EZ)(d(r.FileBasenameNoExtension));return e.slice(0,e.length-(0,a.DZ)(e).length)}case"fileDirnameBasename":return(0,a.EZ)((0,a.XX)(d(r.FileDirnameBasename)));case"execPath":{const e=this._context.getExecPath();return e||t}case"execInstallFolder":{const e=this._context.getAppRoot();return e||t}case"pathSeparator":case"/":return a.ir;default:try{const e=o?`${i}:${o}`:i;return this.resolveFromMap(r.Unknown,t,e,s,void 0)}catch(e){return t}}}}resolveFromMap(e,t,i,r,n){if(i&&r){const s=void 0===n?r[i]:r[n+":"+i];if("string"==typeof s)return s;throw new w(e,(0,b.C$)(x,14,"Variable {0} can not be resolved because the command has no value.",t))}return t}}var S=i(63537);const E=(0,l.yh)("IExtHostVariableResolverProvider");class D extends C{constructor(e,t,i,r,n,s,o){function l(){if(i){const e=i.activeEditor();if(e)return e.document.uri;const t=r.tabGroups.all.find((e=>e.isActive))?.activeTab;if(void 0!==t){if(t.input instanceof p.lF4||t.input instanceof p.ogl)return t.input.modified;if(t.input instanceof p.Y_o||t.input instanceof p.IAb||t.input instanceof p.zwE)return t.input.uri}}}super({getFolderUri:e=>{const t=s.folders.filter((t=>t.name===e));if(t&&t.length>0)return t[0].uri},getWorkspaceFolderCount:()=>s.folders.length,getConfigurationValue:(e,t)=>n.getConfiguration(void 0,e).get(t),getAppRoot:()=>(0,c.Vj)(),getExecPath:()=>c.OB.VSCODE_EXEC_PATH,getFilePath:()=>{const e=l();if(e)return(0,a.Fv)(e.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const e=l();if(e){const i=t.getWorkspaceFolder(e);if(i)return(0,a.Fv)(i.uri.fsPath)}}},getSelectedText:()=>{if(i){const e=i.activeEditor();if(e&&!e.selection.isEmpty)return e.document.getText(e.selection)}},getLineNumber:()=>{if(i){const e=i.activeEditor();if(e)return String(e.selection.end.line+1)}},getExtension:t=>e.getExtension(t)},void 0,o?Promise.resolve(o):void 0,Promise.resolve(c.OB))}}let k=class extends o.JT{constructor(e,t,i,r,n){super(),this.extensionService=e,this.workspaceService=t,this.editorService=i,this.configurationService=r,this.editorTabs=n,this._resolver=new s.o((async()=>{const e=await this.configurationService.getConfigProvider(),t={folders:await this.workspaceService.getWorkspaceFolders2()||[]};return this._register(this.workspaceService.onDidChangeWorkspace((async e=>{t.folders=await this.workspaceService.getWorkspaceFolders2()||[]}))),new D(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,e,t,this.homeDir())}))}getResolver(){return this._resolver.value}homeDir(){}};k=(0,n.g)([(0,n.f)(0,h.k2),(0,n.f)(1,m.w),(0,n.f)(2,d.T),(0,n.f)(3,S.E1),(0,n.f)(4,u.v)],k)},30508:function(e,t,i){i.d(t,{j:function(){return o},m:function(){return s}});var r=i(53976);class n{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}}function s(e,t){if(t.serializeBuffersForPostMessage){const t=new n,i=(e,i)=>{if(i instanceof ArrayBuffer){return{$$vscode_array_buffer_reference$$:!0,index:t.add(i)}}if(ArrayBuffer.isView(i)){const e=function(e){switch(e.constructor.name){case"Int8Array":return 1;case"Uint8Array":return 2;case"Uint8ClampedArray":return 3;case"Int16Array":return 4;case"Uint16Array":return 5;case"Int32Array":return 6;case"Uint32Array":return 7;case"Float32Array":return 8;case"Float64Array":return 9;case"BigInt64Array":return 10;case"BigUint64Array":return 11}return}(i);if(e){return{$$vscode_array_buffer_reference$$:!0,index:t.add(i.buffer),view:{type:e,byteLength:i.byteLength,byteOffset:i.byteOffset}}}}return i};return{message:JSON.stringify(e,i),buffers:t.buffers.map((e=>{const t=new Uint8Array(e);return r.KN.wrap(t)}))}}return{message:JSON.stringify(e),buffers:[]}}function o(e,t){const i=t.map((e=>{const t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(e.buffer),t})),r=t.length?(e,t)=>{if(t&&"object"==typeof t&&t.$$vscode_array_buffer_reference$$){const e=t,{index:r}=e,n=i[r];if(e.view)switch(e.view.type){case 1:return new Int8Array(n,e.view.byteOffset,e.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case 2:return new Uint8Array(n,e.view.byteOffset,e.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case 3:return new Uint8ClampedArray(n,e.view.byteOffset,e.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case 4:return new Int16Array(n,e.view.byteOffset,e.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case 5:return new Uint16Array(n,e.view.byteOffset,e.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case 6:return new Int32Array(n,e.view.byteOffset,e.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case 7:return new Uint32Array(n,e.view.byteOffset,e.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case 8:return new Float32Array(n,e.view.byteOffset,e.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case 9:return new Float64Array(n,e.view.byteOffset,e.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case 10:return new BigInt64Array(n,e.view.byteOffset,e.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case 11:return new BigUint64Array(n,e.view.byteOffset,e.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}return n}return t}:void 0;return{message:JSON.parse(e,r),arrayBuffers:i}}},72124:function(e,t,i){i.d(t,{V:function(){return p},x:function(){return h}});var r,n=i(45493),s=i(81557),o=i(59301),a=i(88023),c=i(42731),l=i(28019),d=i(82722),u=i(78293);let h=class{static{r=this}static{this.InitialState={focused:!0,active:!0}}getState(){const e=this._state;return{get focused(){return e.focused},get active(){return e.active}}}constructor(e){this._onDidChangeWindowState=new s.Q5,this.onDidChangeWindowState=this._onDidChangeWindowState.event,this._state=r.InitialState,this._proxy=e.getProxy(u.Tr.MainThreadWindow),this._proxy.$getInitialState().then((({isFocused:e,isActive:t})=>{this.onDidChangeWindowProperty("focused",e),this.onDidChangeWindowProperty("active",t)}))}$onDidChangeWindowFocus(e){this.onDidChangeWindowProperty("focused",e)}$onDidChangeWindowActive(e){this.onDidChangeWindowProperty("active",e)}onDidChangeWindowProperty(e,t){t!==this._state[e]&&(this._state={...this._state,[e]:t},this._onDidChangeWindowState.fire(this._state))}openUri(e,t){let i;if("string"==typeof e){i=e;try{e=c.ov.parse(e)}catch(t){return Promise.reject(`Invalid uri - '${e}'`)}}return(0,a.m5)(e.scheme)?Promise.reject("Invalid scheme - cannot be empty"):e.scheme===o.lg.command?Promise.reject(`Invalid scheme '${e.scheme}'`):this._proxy.$openUri(e,i,t)}async asExternalUri(e,t){if((0,a.m5)(e.scheme))return Promise.reject("Invalid scheme - cannot be empty");const i=await this._proxy.$asExternalUri(e,t);return c.ov.from(i)}};h=r=(0,n.g)([(0,n.f)(0,d.O)],h);const p=(0,l.yh)("IExtHostWindow")},89608:function(e,t,i){i.d(t,{M:function(){return N},w:function(){return z}});var r=i(45493),n=i(78074),s=i(35820),o=i(17126),a=i(81557),c=i(7428),l=i(57386),d=i(59301),u=i(23575),h=i(81647),p=i(88023),m=i(42731),f=i(67525),g=i(28019),v=i(26713),_=(i(54253),i(56940)),b=i(52202),w=i(73820),y=i(82722),x=i(17430),C=i(30874),S=i(76221),E=i(45630),D=i(78293),k=i(59267),I=i(74120);function P(e,t,i){return new h.U9((e=>$(e,i))).isEqual(e,t)}function T(e,t,i){return P(e.uri,t.uri,i)?0:(0,p.qu)(e.uri.toString(),t.uri.toString())}function A(e,t,i){return e.index!==t.index?e.index<t.index?-1:1:P(e.uri,t.uri,i)?(0,p.qu)(e.name,t.name):(0,p.qu)(e.uri.toString(),t.uri.toString())}function R(e,t,i,r){const s=e.slice(0).sort(((e,t)=>i(e,t,r))),o=t.slice(0).sort(((e,t)=>i(e,t,r)));return(0,n.pY)(s,o,((e,t)=>i(e,t,r)))}function $(e,t){const i=t.getCapabilities(e.scheme);return!(i&&1024&i)}class L extends _.j${static toExtHostWorkspace(e,t,i,r){if(!e)return{workspace:null,added:[],removed:[]};const{id:n,name:s,folders:o,configuration:a,transient:c,isUntitled:l}=e,d=[],u=t;t?o.forEach(((e,n)=>{const s=m.ov.revive(e.uri),o=L._findFolder(i||t,s,r);o?(o.name=e.name,o.index=e.index,d.push(o)):d.push({uri:s,name:e.name,index:n})})):d.push(...o.map((({uri:e,name:t,index:i})=>({uri:m.ov.revive(e),name:t,index:i})))),d.sort(((e,t)=>e.index<t.index?-1:1));const h=new L(n,s,d,!!c,a?m.ov.revive(a):null,!!l,(e=>$(e,r))),{added:p,removed:f}=R(u?u.workspaceFolders:[],h.workspaceFolders,T,r);return{workspace:h,added:p,removed:f}}static _findFolder(e,t,i){for(let r=0;r<e.folders.length;r++){const n=e.workspaceFolders[r];if(P(n.uri,t,i))return n}}constructor(e,t,i,r,n,s,o){super(e,i.map((e=>new _.md(e))),r,n,o),this._name=t,this._isUntitled=s,this._workspaceFolders=[],this._structure=l.Id.forUris(o),i.forEach((e=>{this._workspaceFolders.push(e),this._structure.set(e.uri,e)}))}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(e,t){return t&&this._structure.get(e)&&(e=(0,h.XX)(e)),this._structure.findSubstr(e)}resolveWorkspaceFolder(e){return this._structure.get(e)}}let N=class{constructor(e,t,i,r,n){this._onDidChangeWorkspace=new a.Q5,this.onDidChangeWorkspace=this._onDidChangeWorkspace.event,this._onDidGrantWorkspaceTrust=new a.Q5,this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event,this._activeSearchCallbacks=[],this._trusted=!1,this._editSessionIdentityProviders=new Map,this._providerHandlePool=0,this._onWillCreateEditSessionIdentityEvent=new a.Qz,this._canonicalUriProviders=new Map,this._logService=r,this._extHostFileSystemInfo=i,this._uriTransformerService=n,this._requestIdProvider=new u.AT,this._barrier=new s.U8,this._proxy=e.getProxy(D.Tr.MainThreadWorkspace),this._messageService=e.getProxy(D.Tr.MainThreadMessageService);const o=t.workspace;this._confirmedWorkspace=o?new L(o.id,o.name,[],!!o.transient,o.configuration?m.ov.revive(o.configuration):null,!!o.isUntitled,(e=>$(e,i))):void 0}$initializeWorkspace(e,t){this._trusted=t,this.$acceptWorkspaceData(e),this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get workspaceFile(){if(this._actualWorkspace&&this._actualWorkspace.configuration)return this._actualWorkspace.isUntitled?m.ov.from({scheme:d.lg.untitled,path:(0,h.EZ)((0,h.XX)(this._actualWorkspace.configuration))}):this._actualWorkspace.configuration}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this._barrier.wait(),this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(e,t,i,...r){const n=[];if(Array.isArray(r)&&r.forEach((e=>{m.ov.isUri(e.uri)&&!n.some((t=>P(t.uri,e.uri,this._extHostFileSystemInfo)))&&n.push({uri:e.uri,name:e.name||(0,h.Hx)(e.uri)})})),this._unconfirmedWorkspace)return!1;if([t,i].some((e=>"number"!=typeof e||e<0)))return!1;if(0===i&&0===n.length)return!1;const s=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(t+i>s.length)return!1;const o=s.slice(0);o.splice(t,i,...n.map((e=>({uri:e.uri,name:e.name||(0,h.Hx)(e.uri),index:void 0}))));for(let e=0;e<o.length;e++){const t=o[e];if(o.some(((i,r)=>r!==e&&P(t.uri,i.uri,this._extHostFileSystemInfo))))return!1}o.forEach(((e,t)=>e.index=t));const{added:a,removed:c}=R(s,o,A,this._extHostFileSystemInfo);if(0===a.length&&0===c.length)return!1;if(this._proxy){const r=e.displayName||e.name;this._proxy.$updateWorkspaceFolders(r,t,i,n).then(void 0,(t=>{this._unconfirmedWorkspace=void 0;const i={source:{identifier:e.identifier,label:e.displayName||e.name}};this._messageService.$showMessage(I.Z.Error,(0,f.C$)("vs/workbench/api/common/extHostWorkspace",0,"Extension '{0}' failed to update workspace folders: {1}",r,t.toString()),i,[])}))}return this.trySetWorkspaceFolders(o),!0}getWorkspaceFolder(e,t){if(this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async getWorkspaceFolder2(e,t){if(await this._barrier.wait(),this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async resolveWorkspaceFolder(e){if(await this._barrier.wait(),this._actualWorkspace)return this._actualWorkspace.resolveWorkspaceFolder(e)}getPath(){if(!this._actualWorkspace)return;const{folders:e}=this._actualWorkspace;return 0!==e.length?e[0].uri.fsPath:void 0}getRelativePath(e,t){let i,r="";if("string"==typeof e?(i=m.ov.file(e),r=e):void 0!==e&&(i=e,r=e.fsPath),!i)return r;const n=this.getWorkspaceFolder(i,!0);if(!n)return r;void 0===t&&this._actualWorkspace&&(t=this._actualWorkspace.folders.length>1);let s=(0,h.lX)(n.uri,i);return t&&n.name&&(s=`${n.name}/${s}`),s}trySetWorkspaceFolders(e){this._actualWorkspace&&(this._unconfirmedWorkspace=L.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:e,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0)}$acceptWorkspaceData(e){const{workspace:t,added:i,removed:r}=L.toExtHostWorkspace(e,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=t||void 0,this._unconfirmedWorkspace=void 0,this._onDidChangeWorkspace.fire(Object.freeze({added:i,removed:r}))}findFiles(e,t,i,r,n=o.Ts.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${r.value}, entryPoint: findFiles`);let s="",a=!0;return null===t?a=!1:void 0!==t&&(s="string"==typeof t?t:t.pattern),this._findFilesImpl(e,void 0,{exclude:s,maxResults:i,useDefaultExcludes:a,useDefaultSearchExcludes:!1,useIgnoreFiles:!1},n)}findFiles2(e,t={},i,r=o.Ts.None){return this._logService.trace(`extHostWorkspace#findFiles2: fileSearch, extension: ${i.value}, entryPoint: findFiles2`),this._findFilesImpl(void 0,e,t,r)}async _findFilesImpl(e,t,i,r=o.Ts.None){if(r&&r.isCancellationRequested)return Promise.resolve([]);const n="string"==typeof i.exclude?i.exclude:i.exclude?i.exclude.pattern:void 0,s={ignoreSymlinks:"boolean"==typeof i.followSymlinks?!i.followSymlinks:void 0,disregardIgnoreFiles:"boolean"==typeof i.useIgnoreFiles?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:"boolean"==typeof i.useGlobalIgnoreFiles?!i.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:"boolean"==typeof i.useParentIgnoreFiles?!i.useParentIgnoreFiles:void 0,disregardExcludeSettings:"boolean"==typeof i.useDefaultExcludes&&!i.useDefaultExcludes,disregardSearchExcludeSettings:"boolean"==typeof i.useDefaultSearchExcludes&&!i.useDefaultSearchExcludes,maxResults:i.maxResults,excludePattern:n,shouldGlobSearch:"boolean"!=typeof i.fuzzy||!i.fuzzy,_reason:"startFileSearch"};let a;if(e){const{includePattern:t,folder:i}=F(x.RW.from(e));a=i,s.includePattern=t}else{const{includePattern:e,folder:i}=F(x.RW.from(t));a=i,s.filePattern=e}return this._proxy.$startFileSearch(a??null,s,r).then((e=>Array.isArray(e)?e.map((e=>m.ov.revive(e))):[]))}async findTextInFiles(e,t,i,r,s=o.Ts.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${r.value}, entryPoint: findTextInFiles`);const a=this._requestIdProvider.getNext(),c=void 0===t.previewOptions?{matchLines:100,charsPerLine:1e4}:t.previewOptions,{includePattern:l,folder:d}=F(x.RW.from(t.include)),u="string"==typeof t.exclude?t.exclude:t.exclude?t.exclude.pattern:void 0,h={ignoreSymlinks:"boolean"==typeof t.followSymlinks?!t.followSymlinks:void 0,disregardIgnoreFiles:"boolean"==typeof t.useIgnoreFiles?!t.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:"boolean"==typeof t.useGlobalIgnoreFiles?!t.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:"boolean"==typeof t.useParentIgnoreFiles?!t.useParentIgnoreFiles:void 0,disregardExcludeSettings:"boolean"!=typeof t.useDefaultExcludes||!t.useDefaultExcludes,fileEncoding:t.encoding,maxResults:t.maxResults,previewOptions:c,afterContext:t.afterContext,beforeContext:t.beforeContext,includePattern:l,excludePattern:u};if(this._activeSearchCallbacks[a]=e=>{const t=m.ov.revive(e.resource);e.results.forEach((e=>{const r=(0,k.wL)(e);(0,E.k5)(r)?i({uri:t,preview:{text:r.preview.text,matches:(0,n.Gb)(r.preview.matches,(e=>new C.e6w(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)))},ranges:(0,n.Gb)(r.ranges,(e=>new C.e6w(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)))}):i({uri:t,text:r.text,lineNumber:r.lineNumber})}))},s.isCancellationRequested)return{};try{const t=await this._proxy.$startTextSearch(e,d??null,h,a,s);return delete this._activeSearchCallbacks[a],t||{}}catch(e){throw delete this._activeSearchCallbacks[a],e}}$handleTextSearchResult(e,t){this._activeSearchCallbacks[t]?.(e)}async save(e){const t=await this._proxy.$save(e,{saveAs:!1});return m.ov.revive(t)}async saveAs(e){const t=await this._proxy.$save(e,{saveAs:!0});return m.ov.revive(t)}saveAll(e){return this._proxy.$saveAll(e)}resolveProxy(e){return this._proxy.$resolveProxy(e)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestWorkspaceTrust(e){return this._proxy.$requestWorkspaceTrust(e)}$onDidGrantWorkspaceTrust(){this._trusted||(this._trusted=!0,this._onDidGrantWorkspaceTrust.fire())}registerEditSessionIdentityProvider(e,t){if(this._editSessionIdentityProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._editSessionIdentityProviders.set(e,t);const i=this._uriTransformerService.transformOutgoingScheme(e),r=this._providerHandlePool++;return this._proxy.$registerEditSessionIdentityProvider(r,i),(0,c.OF)((()=>{this._editSessionIdentityProviders.delete(e),this._proxy.$unregisterEditSessionIdentityProvider(r)}))}async $getEditSessionIdentifier(e,t){this._logService.info("Getting edit session identifier for workspaceFolder",e);const i=await this.resolveWorkspaceFolder(m.ov.revive(e));if(!i)return void this._logService.warn("Unable to resolve workspace folder");this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",i);const r=this._editSessionIdentityProviders.get(i.uri.scheme);if(this._logService.info(`Provider for scheme ${i.uri.scheme} is defined: `,!!r),!r)return;const n=await r.provideEditSessionIdentity(i,t);return this._logService.info("Provider returned edit session identifier: ",n),n||void 0}async $provideEditSessionIdentityMatch(e,t,i,r){this._logService.info("Getting edit session identifier for workspaceFolder",e);const n=await this.resolveWorkspaceFolder(m.ov.revive(e));if(!n)return void this._logService.warn("Unable to resolve workspace folder");this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",n);const s=this._editSessionIdentityProviders.get(n.uri.scheme);if(this._logService.info(`Provider for scheme ${n.uri.scheme} is defined: `,!!s),!s)return;const o=await(s.provideEditSessionIdentityMatch?.(t,i,r));return this._logService.info("Provider returned edit session identifier match result: ",o),o||void 0}getOnWillCreateEditSessionIdentityEvent(e){return(t,i,r)=>{const n=function(e){t.call(i,e)};return n.extension=e,this._onWillCreateEditSessionIdentityEvent.event(n,void 0,r)}}async $onWillCreateEditSessionIdentity(e,t,i){const r=await this.resolveWorkspaceFolder(m.ov.revive(e));if(void 0===r)throw new Error("Unable to resolve workspace folder");await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:r},t,(async(e,t)=>{const r=Date.now();await Promise.resolve(e),Date.now()-r>i&&this._logService.warn("SLOW edit session create-participant",t.extension.identifier)})),t.isCancellationRequested}registerCanonicalUriProvider(e,t){if(this._canonicalUriProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._canonicalUriProviders.set(e,t);const i=this._uriTransformerService.transformOutgoingScheme(e),r=this._providerHandlePool++;return this._proxy.$registerCanonicalUriProvider(r,i),(0,c.OF)((()=>{this._canonicalUriProviders.delete(e),this._proxy.$unregisterCanonicalUriProvider(r)}))}async provideCanonicalUri(e,t,i){const r=this._canonicalUriProviders.get(e.scheme);if(!r)return;const n=await(r.provideCanonicalUri?.(m.ov.revive(e),t,i));return n||void 0}async $provideCanonicalUri(e,t,i){return this.provideCanonicalUri(m.ov.revive(e),{targetScheme:t},i)}};N=(0,r.g)([(0,r.f)(0,y.O),(0,r.f)(1,w.$),(0,r.f)(2,b.G),(0,r.f)(3,v.V),(0,r.f)(4,S.F)],N);const z=(0,g.yh)("IExtHostWorkspace");function F(e){let t,i;return e&&("string"==typeof e?t=e:(t=e.pattern,i=m.ov.revive(e.baseUri))),{includePattern:t,folder:i}}},54498:function(e,t,i){i.d(t,{m:function(){return D}});var r=i(54316),n=i(61826),s=i(42731),o=i(78293),a=i(17315),c=i(26713),l=i(20658),d=i(80195),u=i(73820),h=i(99911),p=i(82722),m=i(76221),f=i(26841),g=i(3560),v=i(11547),_=i(45493),b=i(67525),w=i(80661);const y="vs/workbench/api/common/extHostLogService";let x=class extends w.${constructor(e,t,i){const r=i.remote.isRemote?"remoteexthost":e?"workerexthost":"exthost",n=i.remote.isRemote?(0,b.C$)(y,0,"Extension Host (Remote)"):e?(0,b.C$)(y,1,"Extension Host (Worker)"):(0,b.C$)(y,2,"Extension Host");super(t.createLogger(r,{name:n}))}};x=(0,_.g)([(0,_.f)(1,c.y),(0,_.f)(2,u.$)],x);var C=i(80165),S=i(71484);class E{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(c.V),i=e.get(p.O).getProxy(o.Tr.MainThreadErrors);(0,r.sH)((e=>{t.error(e);const n=(0,r.ri)(e);i.$onUnexpectedError(n)}))}static async installFullHandler(e){const t=e.get(c.V),i=e.get(p.O),n=e.get(f.k2),a=e.get(g.fv),l=i.getProxy(o.Tr.MainThreadExtensionService),d=i.getProxy(o.Tr.MainThreadErrors),u=await n.getExtensionPathIndex(),h=new WeakMap;function m(e,t){if(h.has(e))return h.get(e).stack;let i,r,n="";for(const e of t)n+=`\n\tat ${e.toString()}`,r=e.getFileName(),!i&&r&&(i=u.findSubstr(s.ov.file(r)));const o=`${e.name||"Error"}: ${e.message||""}${n}`;return h.set(e,{extensionIdentifier:i?.identifier,stack:o}),o}const v=Symbol("prepareStackTrace wrapped");let _=m;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return _},set(e){e!==m&&e&&!e[v]?(_=function(t,i){return m(t,i),e.call(Error,t,i)},Object.assign(_,{[v]:!0})):_=e||m}}),(0,r.sH)((e=>{t.error(e);const i=(0,r.ri)(e),n=h.get(e);if(!n?.extensionIdentifier)return void d.$onUnexpectedError(i);l.$onExtensionRuntimeError(n.extensionIdentifier,i);const s=a.onExtensionError(n.extensionIdentifier,e);t.trace("forwarded error to extension?",s,n)}))}}class D{constructor(e,t,i,r,s){this._hostUtils=i,this._rpcProtocol=new a.Ui(e,null,r),t=D._transform(t,this._rpcProtocol);const o=new d.y(...(0,l.d)());o.set(u.$,{_serviceBrand:void 0,...t,messagePorts:s}),o.set(p.O,new p.i(this._rpcProtocol)),o.set(m.F,new m.Z(r)),o.set(f.vM,i),o.set(c.V,new C.M(x,[!0],!0)),o.set(c.y,new C.M(S.m,[],!0));const g=new h.F(o,!0);v.n2&&g.invokeFunction(E.installEarlyHandler),this._logService=g.invokeFunction((e=>e.get(c.V))),(0,n.B)("code/extHost/didCreateServices"),this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`):this._logService.info("Extension host started"),this._logService.trace("initData",t),this._extensionService=g.invokeFunction((e=>e.get(f.k2))),this._extensionService.initialize(),v.n2&&g.invokeFunction(E.installFullHandler)}async asBrowserUri(e){const t=this._rpcProtocol.getProxy(o.Tr.MainThreadExtensionService);return s.ov.revive(await t.$asBrowserUri(e))}async getAllStaticBrowserUris(){const e=this._rpcProtocol.getProxy(o.Tr.MainThreadExtensionService);return(await e.$getAllStaticBrowserUris()).map((([e,t])=>[s.ov.revive(e),s.ov.revive(t)]))}terminate(e){this._extensionService.terminate(e)}getExtHostExtensionService(){return this._extensionService}static _transform(e,t){e.extensions.allExtensions.forEach((e=>{e.extensionLocation=s.ov.revive(t.transformIncomingURIs(e.extensionLocation))})),e.environment.appRoot=s.ov.revive(t.transformIncomingURIs(e.environment.appRoot));const i=e.environment.extensionDevelopmentLocationURI;return i&&(e.environment.extensionDevelopmentLocationURI=i.map((e=>s.ov.revive(t.transformIncomingURIs(e))))),e.environment.extensionTestsLocationURI=s.ov.revive(t.transformIncomingURIs(e.environment.extensionTestsLocationURI)),e.environment.globalStorageHome=s.ov.revive(t.transformIncomingURIs(e.environment.globalStorageHome)),e.environment.workspaceStorageHome=s.ov.revive(t.transformIncomingURIs(e.environment.workspaceStorageHome)),e.environment.extensionTelemetryLogResource=s.ov.revive(t.transformIncomingURIs(e.environment.extensionTelemetryLogResource)),e.nlsBaseUrl=s.ov.revive(t.transformIncomingURIs(e.nlsBaseUrl)),e.logsLocation=s.ov.revive(t.transformIncomingURIs(e.logsLocation)),e.workspace=t.transformIncomingURIs(e.workspace),e}}},16710:function(e,t,i){i.d(t,{x:function(){return hn}});var r=i(17126),n=i(54316),s=i(81557),o=i(7428),a=i(59301),c=i(74120),l=i(42731),d=i(51083),u=i(71709),h=i(18503),p=i(82416),m=i(26258),f=i(28698),g=i(525),v=i(26713),_=i(16585),b=i(73426),w=i(14375),y=i(78293),x=i(30874);class C{constructor(e){this._relatedInformationProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(y.Tr.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,i){if(0===this._relatedInformationProviders.size)throw new Error("No related information providers registered");const r=this._relatedInformationProviders.get(e);if(!r)throw new Error("related information provider not found");return await r.provideRelatedInformation(t,i)??[]}getRelatedInformation(e,t,i){return this._proxy.$getAiRelatedInformation(t,i)}registerRelatedInformationProvider(e,t,i){const r=this._nextHandle;return this._nextHandle++,this._relatedInformationProviders.set(r,i),this._proxy.$registerAiRelatedInformationProvider(r,t),new x.JTr((()=>{this._proxy.$unregisterAiRelatedInformationProvider(r),this._relatedInformationProviders.delete(r)}))}}var S=i(78074),E=i(27291),D=i(9362),k=i(83101),I=i(85315),P=i(17430);const T=[new I.b9("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[I.SF.Uri,I.SF.Position],new I._m("A promise that resolves to an array of DocumentHighlight-instances.",R(P.eh.to))),new I.b9("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[I.SF.Uri],new I._m("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",((e,t)=>{if(!(0,S.XY)(e)){class i extends x.JNW{static to(e){const r=new i(e.name,P.cR.to(e.kind),e.containerName||"",new x.YeX(t[0],P.e6.to(e.range)));return r.detail=e.detail,r.range=r.location.range,r.selectionRange=P.e6.to(e.selectionRange),r.children=e.children?e.children.map(i.to):[],r}}return e.map(i.to)}}))),new I.b9("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[I.SF.Uri,new I.SF("options","Formatting options",(e=>!0),(e=>e))],new I._m("A promise that resolves to an array of TextEdits.",R(P.PY.to))),new I.b9("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[I.SF.Uri,I.SF.Range,new I.SF("options","Formatting options",(e=>!0),(e=>e))],new I._m("A promise that resolves to an array of TextEdits.",R(P.PY.to))),new I.b9("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[I.SF.Uri,I.SF.Position,new I.SF("ch","Trigger character",(e=>"string"==typeof e),(e=>e)),new I.SF("options","Formatting options",(e=>!0),(e=>e))],new I._m("A promise that resolves to an array of TextEdits.",R(P.PY.to))),new I.b9("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[I.SF.Uri,I.SF.Position],new I._m("A promise that resolves to an array of Location or LocationLink instances.",$)),new I.b9("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[I.SF.Uri,I.SF.Position],new I._m("A promise that resolves to an array of Location or LocationLink instances.",$)),new I.b9("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[I.SF.Uri,I.SF.Position],new I._m("A promise that resolves to an array of Location or LocationLink instances.",$)),new I.b9("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[I.SF.Uri,I.SF.Position],new I._m("A promise that resolves to an array of Location or LocationLink instances.",$)),new I.b9("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[I.SF.Uri,I.SF.Position],new I._m("A promise that resolves to an array of Location-instances.",R(P.xh.to))),new I.b9("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[I.SF.Uri,I.SF.Position],new I._m("A promise that resolves to an array of Hover-instances.",R(P.TM.to))),new I.b9("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[I.SF.Uri,new I.SF("position","A position in a text document",(e=>Array.isArray(e)&&e.every((e=>x.Lyo.isPosition(e)))),(e=>e.map(P.Ly.from)))],new I._m("A promise that resolves to an array of ranges.",(e=>e.map((e=>{let t;for(const i of e.reverse())t=new x.xm7(P.e6.to(i),t);return t}))))),new I.b9("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[I.SF.String.with("query","Search string")],new I._m("A promise that resolves to an array of SymbolInformation-instances.",(e=>e.map(P.$P.to)))),new I.b9("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[I.SF.Uri,I.SF.Position],new I._m("A promise that resolves to an array of CallHierarchyItem-instances",(e=>e.map(P.ll.to)))),new I.b9("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[I.SF.CallHierarchyItem],new I._m("A promise that resolves to an array of CallHierarchyIncomingCall-instances",(e=>e.map(P.MP.to)))),new I.b9("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[I.SF.CallHierarchyItem],new I._m("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",(e=>e.map(P.RV.to)))),new I.b9("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[I.SF.Uri,I.SF.Position],new I._m("A promise that resolves to a range and placeholder text.",(e=>{if(e)return{range:P.e6.to(e.range),placeholder:e.text}}))),new I.b9("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[I.SF.Uri,I.SF.Position,I.SF.String.with("newName","The new symbol name")],new I._m("A promise that resolves to a WorkspaceEdit.",(e=>{if(e){if(e.rejectReason)throw new Error(e.rejectReason);return P.Db.to(e)}}))),new I.b9("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[I.SF.Uri,I.SF.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new I._m("A promise that resolves to an array of DocumentLink-instances.",(e=>e.map(P.jW.to)))),new I.b9("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[I.SF.Uri],new I._m("A promise that resolves to SemanticTokensLegend.",(e=>{if(e)return new x.Pts(e.tokenTypes,e.tokenModifiers)}))),new I.b9("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[I.SF.Uri],new I._m("A promise that resolves to SemanticTokens.",(e=>{if(!e)return;const t=(0,D.O)(e);return"full"===t.type?new x.Uzh(t.data,void 0):void 0}))),new I.b9("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[I.SF.Uri,I.SF.Range.optional()],new I._m("A promise that resolves to SemanticTokensLegend.",(e=>{if(e)return new x.Pts(e.tokenTypes,e.tokenModifiers)}))),new I.b9("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[I.SF.Uri,I.SF.Range],new I._m("A promise that resolves to SemanticTokens.",(e=>{if(!e)return;const t=(0,D.O)(e);return"full"===t.type?new x.Uzh(t.data,void 0):void 0}))),new I.b9("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[I.SF.Uri,I.SF.Position,I.SF.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),I.SF.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new I._m("A promise that resolves to a CompletionList-instance.",((e,t,i)=>{if(!e)return new x.Ub$([]);const r=e.suggestions.map((e=>P.FG.to(e,i)));return new x.Ub$(r,e.incomplete)}))),new I.b9("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[I.SF.Uri,I.SF.Position,I.SF.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new I._m("A promise that resolves to SignatureHelp.",(e=>{if(e)return P.vy.to(e)}))),new I.b9("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[I.SF.Uri,I.SF.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new I._m("A promise that resolves to an array of CodeLens-instances.",((e,t,i)=>R((e=>new x.JFR(P.e6.to(e.range),e.command&&i.fromInternal(e.command))))(e)))),new I.b9("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[I.SF.Uri,new I.SF("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",(e=>x.e6w.isRange(e)),(e=>x.Y19.isSelection(e)?P.Y1.from(e):P.e6.from(e))),I.SF.String.with("kind","Code action kind to return code actions for").optional(),I.SF.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new I._m("A promise that resolves to an array of Command-instances.",((e,t,i)=>R((e=>{if(e._isSynthetic){if(!e.command)throw new Error("Synthetic code actions must have a command");return i.fromInternal(e.command)}{const t=new x.B2n(e.title,e.kind?new x.yNd(e.kind):void 0);return e.edit&&(t.edit=P.Db.to(e.edit)),e.command&&(t.command=i.fromInternal(e.command)),t.isPreferred=e.isPreferred,t}}))(e)))),new I.b9("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[I.SF.Uri],new I._m("A promise that resolves to an array of ColorInformation objects.",(e=>e?e.map((e=>new x.pr0(P.e6.to(e.range),P.Il.to(e.color)))):[]))),new I.b9("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new I.SF("color","The color to show and insert",(e=>e instanceof x.Ilk),P.Il.from),new I.SF("context","Context object with uri and range",(e=>!0),(e=>({uri:e.uri,range:P.e6.from(e.range)})))],new I._m("A promise that resolves to an array of ColorPresentation objects.",(e=>e?e.map(P.oi.to):[]))),new I.b9("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[I.SF.Uri,I.SF.Range],new I._m("A promise that resolves to an array of Inlay objects",((e,t,i)=>e.map(P.t7.to.bind(void 0,i))))),new I.b9("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[I.SF.Uri],new I._m("A promise that resolves to an array of FoldingRange objects",((e,t)=>{if(e)return e.map(P.so.to)}))),new I.b9("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new I._m("A promise that resolves to an array of NotebookContentProvider static info objects.",R((e=>({viewType:e.viewType,displayName:e.displayName,options:{transientOutputs:e.options.transientOutputs,transientCellMetadata:e.options.transientCellMetadata,transientDocumentMetadata:e.options.transientDocumentMetadata},filenamePattern:e.filenamePattern.map((e=>P.wN.to(e)))}))))),new I.b9("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[I.SF.Uri,I.SF.Range,new I.SF("context","An InlineValueContext",(e=>e&&"number"==typeof e.frameId&&e.stoppedLocation instanceof x.e6w),(e=>P.GS.from(e)))],new I._m("A promise that resolves to an array of InlineValue objects",(e=>e.map(P.CR.to)))),new I.b9("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new I.SF("uriOrString","Uri-instance or string (only http/https)",(e=>l.ov.isUri(e)||"string"==typeof e&&(0,a.Gs)(e,a.lg.http,a.lg.https)),(e=>e)),new I.SF("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",(e=>void 0===e||"number"==typeof e||"object"==typeof e),(e=>e?"number"==typeof e?[P.eI.from(e),void 0]:[P.eI.from(e.viewColumn),P.P5.from(e)]:e)).optional(),I.SF.String.with("label","").optional()],I._m.Void),new I.b9("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[I.SF.Uri.with("resource","Resource to open"),I.SF.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new I.SF("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",(e=>void 0===e||"number"==typeof e||"object"==typeof e),(e=>e?"number"==typeof e?[P.eI.from(e),void 0]:[P.eI.from(e.viewColumn),P.P5.from(e)]:e)).optional()],I._m.Void),new I.b9("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[I.SF.Uri.with("left","Left-hand side resource of the diff editor"),I.SF.Uri.with("right","Right-hand side resource of the diff editor"),I.SF.String.with("title","Human readable title for the diff editor").optional(),new I.SF("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",(e=>void 0===e||"object"==typeof e),(e=>e&&[P.eI.from(e.viewColumn),P.P5.from(e)])).optional()],I._m.Void),new I.b9("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[I.SF.String.with("title","Human readable title for the changes editor"),new I.SF("resourceList","List of resources to compare",(e=>{for(const t of e){if(3!==t.length)return!1;const[e,i,r]=t;if(!l.ov.isUri(e)||!l.ov.isUri(i)&&null!=i||!l.ov.isUri(r)&&null!=r)return!1}return!0}),(e=>e))],I._m.Void),new I.b9("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[I.SF.Uri,I.SF.Position],new I._m("A promise that resolves to an array of TypeHierarchyItem-instances",(e=>e.map(P.fQ.to)))),new I.b9("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[I.SF.TypeHierarchyItem],new I._m("A promise that resolves to an array of TypeHierarchyItem-instances",(e=>e.map(P.fQ.to)))),new I.b9("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[I.SF.TypeHierarchyItem],new I._m("A promise that resolves to an array of TypeHierarchyItem-instances",(e=>e.map(P.fQ.to)))),new I.b9("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[I.SF.TestItem],I._m.Void),new I.b9("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[I.SF.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],I._m.Void),new I.b9("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[I.SF.String.with("name","The context key name"),new I.SF("value","The context key value",(()=>!0),(e=>e))],I._m.Void),new I.b9("vscode.executeMappedEditsProvider","_executeMappedEditsProvider","Execute Mapped Edits Provider",[I.SF.Uri,I.SF.StringArray,new I.SF("MappedEditsContext","Mapped Edits Context",(e=>P.OU.is(e)),(e=>P.OU.from(e)))],new I._m("A promise that resolves to a workspace edit or null",(e=>e?P.Db.to(e):null)))];class A{static register(e){T.forEach(e.registerApiCommand,e),this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(!1,"_validateWhenClauses",k.iw)}}function R(e){return t=>{if(Array.isArray(t))return t.map(e)}}function $(e){if(!Array.isArray(e))return;const t=[];for(const i of e)(0,E.vx)(i)?t.push(P.nc.to(i)):t.push(P.xh.to(i));return t}var L=i(43878),N=i(11301),z=i(45493),F=i(82722),M=i(92962);let O=class{constructor(e,t){this._proxy=e.getProxy(y.Tr.MainThreadBulkEdits),this._versionInformationProvider={getTextDocumentVersion:e=>t.getDocument(e)?.version,getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(e,t,i){const r=new M.ky(P.Db.from(e,this._versionInformationProvider));return this._proxy.$tryApplyWorkspaceEdit(r,void 0,i?.isRefactoring??!1)}};O=(0,z.g)([(0,z.f)(0,F.O)],O);var H=i(35820),U=i(36994),B=i(97698),W=i(43064),V=i(47635),q=i(61673),j=i(22423);class K{constructor(e,t,i,r,n){this._extension=e,this._request=t,this._proxy=i,this._commandsConverter=r,this._sessionDisposables=n,this._stopWatch=W.G.create(!1),this._isClosed=!1}close(){this._isClosed=!0}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){const e=this;function t(t){if(e._isClosed){const e=new Error("Response stream has been closed");throw Error.captureStackTrace(e,t),e}}this._stopWatch.reset();const i=e=>{void 0===this._firstProgress&&"content"in e&&(this._firstProgress=this._stopWatch.elapsed()),this._proxy.$handleProgressChunk(this._request.requestId,e)};this._apiObject={markdown(e){t(this.markdown);const r=new x.HYr(e),n=P.HY.from(r);return i(n),this},markdownWithVulnerabilities(r,n){t(this.markdown),n&&(0,j.H5)(e._extension,"chatParticipantAdditions");const s=new x.Zgy(r,n),o=P.Zg.from(s);return i(o),this},filetree(e,r){t(this.filetree);const n=new x.Y08(e,r),s=P.ZJ.from(n);return i(s),this},anchor(e,r){t(this.anchor);const n=new x.trJ(e,r),s=P.tr.from(n);return i(s),this},button(r){t(this.anchor);const n=new x.WTw(r),s=P.WT.from(n,e._commandsConverter,e._sessionDisposables);return i(s),this},progress(e){t(this.progress);const r=new x.Gli(e),n=P.Gl.from(r);return i(n),this},reference(r,n){if(t(this.reference),"variableName"in r&&!r.value){const t=e._request.variables.variables.find((e=>e.name===r.variableName));if(t){let e;if(t.references?.length)e=t.references.map((e=>({kind:"reference",reference:{variableName:r.variableName,value:e.reference}})));else{const t=new x.Ht3(r,n);e=[P.Ht.from(t)]}return e.forEach((e=>i(e))),this}}else{const e=new x.Ht3(r,n),t=P.Ht.from(e);i(t)}return this},textEdit(r,n){t(this.textEdit),(0,j.H5)(e._extension,"chatParticipantAdditions");const s=new x.cGf(r,n),o=P.cG.from(s);return i(o),this},detectedParticipant(r,n){t(this.detectedParticipant),(0,j.H5)(e._extension,"chatParticipantAdditions");const s=new x.s8P(r,n),o=P.s8.from(s);return i(o),this},push(r){if(t(this.push),(r instanceof x.cGf||r instanceof x.Zgy||r instanceof x.s8P)&&(0,j.H5)(e._extension,"chatParticipantAdditions"),r instanceof x.Ht3)this.reference(r.value,r.iconPath);else{const t=P.Sm.from(r,e._commandsConverter,e._sessionDisposables);i(t)}return this}}}return this._apiObject}}class Q extends o.JT{static{this._idPool=0}constructor(e,t,i){super(),this._logService=t,this.commands=i,this._agents=new Map,this._sessionDisposables=this._register(new o.b2),this._completionDisposables=this._register(new o.SL),this._proxy=e.getProxy(y.Tr.MainThreadChatAgents2)}transferActiveChat(e){this._proxy.$transferActiveChatSession(e)}createChatAgent(e,t,i){const r=Q._idPool++,n=new G(e,t,this._proxy,r,i);return this._agents.set(r,n),this._proxy.$registerAgent(r,e.identifier,t,{},void 0),n.apiAgent}createDynamicChatAgent(e,t,i,r,n){const s=Q._idPool++,o=new G(e,t,this._proxy,s,n);return this._agents.set(s,o),this._proxy.$registerAgent(s,e.identifier,t,{isSticky:!0},{name:i,description:r}),o.apiAgent}async $invokeAgent(e,t,i,r){const n=this._agents.get(e);if(!n)throw new Error(`[CHAT](${e}) CANNOT invoke agent because the agent is not registered`);let s=this._sessionDisposables.get(t.sessionId);s||(s=new o.SL,this._sessionDisposables.set(t.sessionId,s));const a=new K(n.extension,t,this._proxy,this.commands.converter,s);try{const e=await this.prepareHistoryTurns(t.agentId,i),s=n.invoke(P.TU.to(t),{history:e},a.apiObject,r);return await(0,H.eP)(Promise.resolve(s).then((e=>{if(e?.metadata)try{JSON.stringify(e.metadata)}catch(e){const t=`result.metadata MUST be JSON.stringify-able. Got error: ${e.message}`;return this._logService.error(`[${n.extension.identifier.value}] [@${n.id}] ${t}`,n.extension),{errorDetails:{message:t},timings:a.timings}}return{errorDetails:e?.errorDetails,timings:a.timings,metadata:e?.metadata}})),r)}catch(e){return this._logService.error(e,n.extension),{errorDetails:{message:(0,U.yJ)(e),responseIsIncomplete:!0}}}finally{a.close()}}async prepareHistoryTurns(e,t){const i=[];for(const r of t.history){const t=P.hq.to(r.result),n=e===r.request.agentId?t:{...t,metadata:void 0};i.push(new x.eg0(r.request.message,r.request.command,r.request.variables.variables.map(P.xj.to),r.request.agentId));const s=(0,S.kX)(r.response.map((e=>P.Sm.toContent(e,this.commands.converter))));i.push(new x.IQN(s,n,r.request.agentId,r.request.command))}return i}$releaseSession(e){this._sessionDisposables.deleteAndDispose(e)}async $provideFollowups(e,t,i,r,n){const s=this._agents.get(t);if(!s)return Promise.resolve([]);const o=await this.prepareHistoryTurns(s.id,r),a=P.hq.to(i);return(await s.provideFollowups(a,{history:o},n)).filter((e=>{const t=!e.participant||B.$.some(this._agents.values(),(t=>t.id===e.participant&&m.kP.equals(t.extension.identifier,s.extension.identifier)));return t||this._logService.warn(`[@${s.id}] ChatFollowup refers to an unknown participant: ${e.participant}`),t})).map((t=>P.a8.from(t,e)))}$acceptFeedback(e,t,i,r){const n=this._agents.get(e);if(!n)return;const s=P.hq.to(t);let o;switch(i){case q.IA.Down:o=x.u8m.Unhelpful;break;case q.IA.Up:o=x.u8m.Helpful}n.acceptFeedback(r?Object.freeze({result:s,kind:o,reportIssue:r}):Object.freeze({result:s,kind:o}))}$acceptAction(e,t,i){const r=this._agents.get(e);if(!r)return;if("vote"===i.action.kind)return;const n=P.$l.to(t,i,this.commands.converter);n&&r.acceptAction(Object.freeze(n))}async $invokeCompletionProvider(e,t,i){const r=this._agents.get(e);if(!r)return[];return(await r.invokeCompletionProvider(t,i)).map((e=>P.e5.from(e,this.commands.converter,this._completionDisposables)))}async $provideWelcomeMessage(e,t,i){const r=this._agents.get(e);if(r)return await r.provideWelcomeMessage(P.oY.to(t),i)}async $provideSampleQuestions(e,t,i){const r=this._agents.get(e);if(r)return(await r.provideSampleQuestions(P.oY.to(t),i)).map((e=>P.a8.from(e,void 0)))}}class G{constructor(e,t,i,r,n){this.extension=e,this.id=t,this._proxy=i,this._handle=r,this._requestHandler=n,this._onDidReceiveFeedback=new s.Q5,this._onDidPerformAction=new s.Q5}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}async invokeCompletionProvider(e,t){return this._agentVariableProvider?await this._agentVariableProvider.provider.provideCompletionItems(e,t)??[]:[]}async provideFollowups(e,t,i){if(!this._followupProvider)return[];const r=await this._followupProvider.provideFollowups(e,t,i);return r?r.filter((e=>!(e&&"commandId"in e))).filter((e=>!(e&&"message"in e))):[]}async provideWelcomeMessage(e,t){if(!this._welcomeMessageProvider)return[];const i=await this._welcomeMessageProvider.provideWelcomeMessage(e,t);return i?i.map((e=>"string"==typeof e?e:P.W5.from(e))):[]}async provideSampleQuestions(e,t){if(!this._welcomeMessageProvider||!this._welcomeMessageProvider.provideSampleQuestions)return[];const i=await this._welcomeMessageProvider.provideSampleQuestions(e,t);return i||[]}get apiAgent(){let e=!1,t=!1;const i=()=>{e||t||(t=!0,queueMicrotask((()=>{this._proxy.$updateAgent(this._handle,{fullName:this._fullName,icon:this._iconPath?this._iconPath instanceof l.ov?this._iconPath:"light"in this._iconPath?this._iconPath.light:void 0:void 0,iconDark:this._iconPath&&"dark"in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof x.kS8?this._iconPath:void 0,hasFollowups:void 0!==this._followupProvider,isSecondary:this._isSecondary,helpTextPrefix:this._helpTextPrefix&&"string"!=typeof this._helpTextPrefix?P.W5.from(this._helpTextPrefix):this._helpTextPrefix,helpTextVariablesPrefix:this._helpTextVariablesPrefix&&"string"!=typeof this._helpTextVariablesPrefix?P.W5.from(this._helpTextVariablesPrefix):this._helpTextVariablesPrefix,helpTextPostfix:this._helpTextPostfix&&"string"!=typeof this._helpTextPostfix?P.W5.from(this._helpTextPostfix):this._helpTextPostfix,sampleRequest:this._sampleRequest,supportIssueReporting:this._supportIssueReporting,requester:this._requester}),t=!1})))},r=this;return{get id(){return r.id},get fullName(){return(0,j.H5)(r.extension,"defaultChatParticipant"),r._fullName??r.extension.displayName??r.extension.name},set fullName(e){(0,j.H5)(r.extension,"defaultChatParticipant"),r._fullName=e,i()},get iconPath(){return r._iconPath},set iconPath(e){r._iconPath=e,i()},get requestHandler(){return r._requestHandler},set requestHandler(e){(0,V.p_)("function"==typeof e,"Invalid request handler"),r._requestHandler=e},get followupProvider(){return r._followupProvider},set followupProvider(e){r._followupProvider=e,i()},get isDefault(){return(0,j.H5)(r.extension,"defaultChatParticipant"),r._isDefault},set isDefault(e){(0,j.H5)(r.extension,"defaultChatParticipant"),r._isDefault=e,i()},get helpTextPrefix(){return(0,j.H5)(r.extension,"defaultChatParticipant"),r._helpTextPrefix},set helpTextPrefix(e){(0,j.H5)(r.extension,"defaultChatParticipant"),r._helpTextPrefix=e,i()},get helpTextVariablesPrefix(){return(0,j.H5)(r.extension,"defaultChatParticipant"),r._helpTextVariablesPrefix},set helpTextVariablesPrefix(e){(0,j.H5)(r.extension,"defaultChatParticipant"),r._helpTextVariablesPrefix=e,i()},get helpTextPostfix(){return(0,j.H5)(r.extension,"defaultChatParticipant"),r._helpTextPostfix},set helpTextPostfix(e){(0,j.H5)(r.extension,"defaultChatParticipant"),r._helpTextPostfix=e,i()},get isSecondary(){return(0,j.H5)(r.extension,"defaultChatParticipant"),r._isSecondary},set isSecondary(e){(0,j.H5)(r.extension,"defaultChatParticipant"),r._isSecondary=e,i()},get sampleRequest(){return r._sampleRequest},set sampleRequest(e){r._sampleRequest=e,i()},get supportIssueReporting(){return(0,j.H5)(r.extension,"chatParticipantAdditions"),r._supportIssueReporting},set supportIssueReporting(e){(0,j.H5)(r.extension,"chatParticipantAdditions"),r._supportIssueReporting=e,i()},get onDidReceiveFeedback(){return r._onDidReceiveFeedback.event},set participantVariableProvider(e){if((0,j.H5)(r.extension,"chatParticipantAdditions"),r._agentVariableProvider=e,e){if(!e.triggerCharacters.length)throw new Error("triggerCharacters are required");r._proxy.$registerAgentCompletionsProvider(r._handle,e.triggerCharacters)}else r._proxy.$unregisterAgentCompletionsProvider(r._handle)},get participantVariableProvider(){return(0,j.H5)(r.extension,"chatParticipantAdditions"),r._agentVariableProvider},set welcomeMessageProvider(e){(0,j.H5)(r.extension,"defaultChatParticipant"),r._welcomeMessageProvider=e,i()},get welcomeMessageProvider(){return(0,j.H5)(r.extension,"defaultChatParticipant"),r._welcomeMessageProvider},onDidPerformAction:(0,j.$x)(this.extension,"chatParticipantAdditions")?this._onDidPerformAction.event:void 0,set requester(e){r._requester=e,i()},get requester(){return r._requester},dispose(){e=!0,r._followupProvider=void 0,r._onDidReceiveFeedback.dispose(),r._proxy.$unregisterAgent(r._handle)}}}invoke(e,t,i,r){return this._requestHandler(e,t,i,r)}}class J{static{this._idPool=0}constructor(e){this._resolver=new Map,this._proxy=e.getProxy(y.Tr.MainThreadChatVariables)}async $resolveVariable(e,t,i,r){const s=this._resolver.get(e);if(s)try{if(s.resolver.resolve2){(0,j.H5)(s.extension,"chatParticipantAdditions");const e=new Y(t,this._proxy),n=await s.resolver.resolve2(s.data.name,{prompt:i},e.apiObject,r);if(n)return n.map(P.wZ.from)}else{const e=await s.resolver.resolve(s.data.name,{prompt:i},r);if(e)return e.map(P.wZ.from)}}catch(e){(0,n.Cp)(e)}}registerVariableResolver(e,t,i,r){const n=J._idPool++;return this._resolver.set(n,{extension:e,data:{name:t,description:i},resolver:r}),this._proxy.$registerVariable(n,{name:t,description:i}),(0,o.OF)((()=>{this._resolver.delete(n),this._proxy.$unregisterVariable(n)}))}}class Y{constructor(e,t){this._requestId=e,this._proxy=t,this._isClosed=!1}close(){this._isClosed=!0}get apiObject(){if(!this._apiObject){const e=this;function t(t){if(e._isClosed){const e=new Error("Response stream has been closed");throw Error.captureStackTrace(e,t),e}}const i=e=>{this._proxy.$handleProgressChunk(this._requestId,e)};this._apiObject={progress(e){t(this.progress);const r=new x.Gli(e),n=P.Gl.from(r);return i(n),this},reference(e){t(this.reference);const r=new x.Ht3(e),n=P.Ht.from(r);return i(n),this},push(e){return t(this.push),e instanceof x.Ht3?i(P.Ht.from(e)):e instanceof x.Gli&&i(P.Gl.from(e)),this}}}return this._apiObject}}class X{constructor(e){const t=e.getProxy(y.Tr.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(e){return t.$writeText(e)}})}}const Z="vscode-cdn.net",ee=`vscode-resource.${Z}`,te=`'self' https://*.${Z}`;function ie(e,t){return e.scheme===a.lg.http||e.scheme===a.lg.https?e:(t&&t.authority&&t.isRemote&&e.scheme===a.lg.file&&(e=l.ov.from({scheme:a.lg.vscodeRemote,authority:t.authority,path:e.path})),l.ov.from({scheme:a.lg.https,authority:`${e.scheme}+${i=e.authority,i.replace(/./g,(e=>{const t=e.charCodeAt(0);return t>=97&&t<=122||t>=65&&t<=90||t>=48&&t<=57?e:"-"+t.toString(16).padStart(4,"0")}))}.${ee}`,path:e.path,fragment:e.fragment,query:e.query}));var i}class re{constructor(e,t,i){this._proxy=e,this._editors=t,this._remoteInfo=i,this._handlePool=0,this._disposables=new o.SL,this._insets=new Map,this._disposables.add(t.onDidChangeVisibleTextEditors((()=>{const e=t.getVisibleTextEditors();for(const t of this._insets.values())e.indexOf(t.editor)<0&&t.inset.dispose()})))}dispose(){this._insets.forEach((e=>e.inset.dispose())),this._disposables.dispose()}createWebviewEditorInset(e,t,i,r,n){let o;for(const t of this._editors.getVisibleTextEditors(!0))if(t.value===e){o=t;break}if(!o)throw new Error("not a visible editor");const a=this,c=this._handlePool++,l=new s.Q5,d=new s.Q5,u=new class{constructor(){this._html="",this._options=Object.create(null)}asWebviewUri(e){return ie(e,a._remoteInfo)}get cspSource(){return te}set options(e){this._options=e,a._proxy.$setOptions(c,e)}get options(){return this._options}set html(e){this._html=e,a._proxy.$setHtml(c,e)}get html(){return this._html}get onDidReceiveMessage(){return l.event}postMessage(e){return a._proxy.$postMessage(c,e)}},h=new class{constructor(){this.editor=e,this.line=t,this.height=i,this.webview=u,this.onDidDispose=d.event}dispose(){a._insets.has(c)&&(a._insets.delete(c),a._proxy.$disposeEditorInset(c),d.fire(),d.dispose(),l.dispose())}};return this._proxy.$createEditorInset(c,o.id,o.value.document.uri,t+1,i,r||{},n.identifier,n.extensionLocation),this._insets.set(c,{editor:e,inset:h,onDidReceiveMessage:l}),h}$onDidDispose(e){const t=this._insets.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){const i=this._insets.get(e);i?.onDidReceiveMessage.fire(t)}}function ne(e,t,i){const r=e.getProxy(y.Tr.MainThreadComments);class n{static{this.handlePool=0}constructor(){this._commentControllers=new Map,this._commentControllersByExtension=new m.C1,t.registerArgumentProcessor({processArgument:e=>{if(e&&6===e.$mid){const t=this._commentControllers.get(e.handle);return t?t.value:e}if(e&&7===e.$mid){const t=e,i=this._commentControllers.get(t.commentControlHandle);if(!i)return t;const r=i.getCommentThread(t.commentThreadHandle);return r?r.value:t}if(e&&(9===e.$mid||8===e.$mid)){const t=this._commentControllers.get(e.thread.commentControlHandle);if(!t)return e;const i=t.getCommentThread(e.thread.commentThreadHandle);return i?8===e.$mid?i.value:{thread:i.value,text:e.text}:e}if(e&&10===e.$mid){const t=this._commentControllers.get(e.thread.commentControlHandle);if(!t)return e;const i=t.getCommentThread(e.thread.commentThreadHandle);if(!i)return e;const r=e.commentUniqueId,n=i.getCommentByUniqueId(r);return n||e}if(e&&11===e.$mid){const t=this._commentControllers.get(e.thread.commentControlHandle);if(!t)return e;const i=t.getCommentThread(e.thread.commentThreadHandle);if(!i)return e;const r=e.text,n=e.commentUniqueId,s=i.getCommentByUniqueId(n);return s?("string"==typeof s.body?s.body=r:s.body=new x.W5C(r),s):e}return e}})}createCommentController(e,t,i){const r=n.handlePool++,s=new c(e,r,t,i);this._commentControllers.set(s.handle,s);const o=this._commentControllersByExtension.get(e.identifier)||[];return o.push(s),this._commentControllersByExtension.set(e.identifier,o),s.value}async $createCommentThreadTemplate(e,t,i){const r=this._commentControllers.get(e);r&&r.$createCommentThreadTemplate(t,i)}async $setActiveComment(e,t){const i=this._commentControllers.get(e);i&&i.$setActiveComment(t??void 0)}async $updateCommentThreadTemplate(e,t,i){const r=this._commentControllers.get(e);r&&r.$updateCommentThreadTemplate(t,i)}$deleteCommentThread(e,t){const i=this._commentControllers.get(e);i?.$deleteCommentThread(t)}async $provideCommentingRanges(e,t,r){const n=this._commentControllers.get(e);if(!n||!n.commentingRangeProvider)return Promise.resolve(void 0);const s=await i.ensureDocumentData(l.ov.revive(t));return(0,H.OH)((async()=>{const e=await n.commentingRangeProvider.provideCommentingRanges(s.document,r);let t;return t=Array.isArray(e)?{ranges:e,fileComments:!1}:e?{ranges:e.ranges||[],fileComments:e.fileComments||!1}:e??void 0,t})).then((e=>{let t;return e&&(t={ranges:e.ranges.map((e=>P.e6.from(e))),fileComments:e.fileComments}),t}))}$toggleReaction(e,t,i,r,n){const s=this._commentControllers.get(e);return s&&s.reactionHandler?(0,H.OH)((()=>{const e=s.getCommentThread(t);if(e){const t=e.getCommentByUniqueId(r.uniqueIdInThread);if(void 0!==s&&t&&s.reactionHandler)return s.reactionHandler(t,function(e){return{label:e.label||"",count:e.count||0,iconPath:e.iconPath?l.ov.revive(e.iconPath):"",authorHasReacted:e.hasReacted||!1,reactors:e.reactors?.map((e=>({name:e})))}}(n))}return Promise.resolve(void 0)})):Promise.resolve(void 0)}}class a{static{this._handlePool=0}set threadId(e){this._id=e}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(e){void 0===e==(void 0===this._range)&&e&&this._range&&e.isEqual(this._range)||(this._range=e,this.modifications.range=e,this._onDidUpdateCommentThread.fire())}get range(){return this._range}set canReply(e){this._canReply!==e&&(this._canReply=e,this.modifications.canReply=e,this._onDidUpdateCommentThread.fire())}get canReply(){return this._canReply}get label(){return this._label}set label(e){this._label=e,this.modifications.label=e,this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(e){this._contextValue=e,this.modifications.contextValue=e,this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(e){this._comments=e,this.modifications.comments=e,this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(e){this._collapseState=e,this.modifications.collapsibleState=e,this._onDidUpdateCommentThread.fire()}get state(){return this._state}set state(e){this._state=e,"object"==typeof e?((0,j.H5)(this.extensionDescription,"commentThreadApplicability"),this.modifications.state=e.resolved,this.modifications.applicability=e.applicability):this.modifications.state=e,this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(e,t,i,n,c,l,d,u){this._commentControllerHandle=t,this._id=i,this._uri=n,this._range=c,this._comments=l,this.extensionDescription=d,this._isTemplate=u,this.handle=a._handlePool++,this.commentHandle=0,this.modifications=Object.create(null),this._onDidUpdateCommentThread=new s.Q5,this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event,this._canReply=!0,this._commentsMap=new Map,this._acceptInputDisposables=new o.XK,this._acceptInputDisposables.value=new o.SL,void 0===this._id&&(this._id=`${e}.${this.handle}`),r.$createCommentThread(t,this.handle,this._id,this._uri,P.e6.from(this._range),d.identifier,this._isTemplate),this._localDisposables=[],this._isDiposed=!1,this._localDisposables.push(this.onDidUpdateCommentThread((()=>{this.eventuallyUpdateCommentThread()}))),this.comments=l,this._localDisposables.push({dispose:()=>{r.$deleteCommentThread(t,this.handle)}});const h=this;this.value={get uri(){return h.uri},get range(){return h.range},set range(e){h.range=e},get comments(){return h.comments},set comments(e){h.comments=e},get collapsibleState(){return h.collapsibleState},set collapsibleState(e){h.collapsibleState=e},get canReply(){return h.canReply},set canReply(e){h.canReply=e},get contextValue(){return h.contextValue},set contextValue(e){h.contextValue=e},get label(){return h.label},set label(e){h.label=e},get state(){return h.state},set state(e){h.state=e},dispose:()=>{h.dispose()}}}updateIsTemplate(){this._isTemplate&&(this._isTemplate=!1,this.modifications.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this._isDiposed)return;this.updateIsTemplate(),this._acceptInputDisposables.value||(this._acceptInputDisposables.value=new o.SL);const e=e=>Object.prototype.hasOwnProperty.call(this.modifications,e),t={};e("range")&&(t.range=P.e6.from(this._range)),e("label")&&(t.label=this.label),e("contextValue")&&(t.contextValue=this.contextValue??null),e("comments")&&(t.comments=this._comments.map((e=>function(e,t,i,r){let n=i.get(t);n||(n=++e.commentHandle,i.set(t,n));void 0!==t.state&&(0,j.H5)(r,"commentsDraftState");t.reactions?.some((e=>void 0!==e.reactors))&&(0,j.H5)(r,"commentReactor");return{mode:t.mode,contextValue:t.contextValue,uniqueIdInThread:n,body:"string"==typeof t.body?t.body:P.W5.from(t.body),userName:t.author.name,userIconPath:t.author.iconPath,label:t.label,commentReactions:t.reactions?t.reactions.map((e=>function(e){return{label:e.label,iconPath:e.iconPath?(0,P.Ru)(e.iconPath):void 0,count:e.count,hasReacted:e.authorHasReacted,reactors:e.reactors&&e.reactors.length>0&&"string"!=typeof e.reactors[0]?e.reactors.map((e=>e.name)):e.reactors}}(e))):void 0,state:t.state,timestamp:t.timestamp?.toJSON()}}(this,e,this._commentsMap,this.extensionDescription)))),e("collapsibleState")&&(t.collapseState=function(e){if(void 0!==e)switch(e){case x.xKz.Expanded:return E.xK.Expanded;case x.xKz.Collapsed:return E.xK.Collapsed}return E.xK.Collapsed}(this._collapseState)),e("canReply")&&(t.canReply=this.canReply),e("state")&&(t.state=function(e){let t;t="object"==typeof e?e.resolved:e;if(void 0!==t)switch(t){case x.OTk.Unresolved:return E.OT.Unresolved;case x.OTk.Resolved:return E.OT.Resolved}return E.OT.Unresolved}(this._state)),e("applicability")&&(t.applicability=function(e){let t;"object"==typeof e&&(t=e.applicability);if(void 0!==t)switch(t){case x.dql.Current:return E.dq.Current;case x.dql.Outdated:return E.dq.Outdated}return E.dq.Current}(this._state)),e("isTemplate")&&(t.isTemplate=this._isTemplate),this.modifications={},r.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,t)}getCommentByUniqueId(e){for(const t of this._commentsMap){const i=t[0];if(e===t[1])return i}}dispose(){this._isDiposed=!0,this._acceptInputDisposables.dispose(),this._localDisposables.forEach((e=>e.dispose()))}}class c{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(e){this._commentingRangeProvider=e,e?.resourceHints&&(0,j.H5)(this._extension,"commentingRangeHint"),r.$updateCommentingRanges(this.handle,e?.resourceHints)}get reactionHandler(){return this._reactionHandler}set reactionHandler(e){this._reactionHandler=e,r.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!e})}get options(){return this._options}set options(e){this._options=e,r.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){return(0,j.H5)(this._extension,"activeComment"),this._activeComment}get activeCommentThread(){return(0,j.H5)(this._extension,"activeComment"),this._activeThread}constructor(e,t,i,n){this._extension=e,this._handle=t,this._id=i,this._label=n,this._threads=new Map,r.$registerCommentController(this.handle,i,n,this._extension.identifier.value);const s=this;this.value=Object.freeze({id:s.id,label:s.label,get options(){return s.options},set options(e){s.options=e},get commentingRangeProvider(){return s.commentingRangeProvider},set commentingRangeProvider(e){s.commentingRangeProvider=e},get reactionHandler(){return s.reactionHandler},set reactionHandler(e){s.reactionHandler=e},get activeCommentThread(){return s.activeCommentThread},createCommentThread(e,t,i){return s.createCommentThread(e,t,i).value},dispose:()=>{s.dispose()}}),this._localDisposables=[],this._localDisposables.push({dispose:()=>{r.$unregisterCommentController(this.handle)}})}createCommentThread(e,t,i){void 0===t&&(0,j.H5)(this._extension,"fileComments");const r=new a(this.id,this.handle,void 0,e,t,i,this._extension,!1);return this._threads.set(r.handle,r),r}$setActiveComment(e){if(!e)return this._activeComment=void 0,void(this._activeThread=void 0);const t=this._threads.get(e.commentThreadHandle);t&&(this._activeComment=e.uniqueIdInThread?t.getCommentByUniqueId(e.uniqueIdInThread):void 0,this._activeThread=t)}$createCommentThreadTemplate(e,t){const i=new a(this.id,this.handle,void 0,l.ov.revive(e),P.e6.to(t),[],this._extension,!0);return i.collapsibleState=E.xK.Expanded,this._threads.set(i.handle,i),i}$updateCommentThreadTemplate(e,t){const i=this._threads.get(e);i&&(i.range=P.e6.to(t))}$deleteCommentThread(e){const t=this._threads.get(e);t?.dispose(),this._threads.delete(e)}getCommentThread(e){return this._threads.get(e)}dispose(){this._threads.forEach((e=>{e.dispose()})),this._localDisposables.forEach((e=>e.dispose()))}}return new n}var se=i(63537),oe=i(87884),ae=i(81647),ce=i(82998),le=i(36795),de=i(30508);class ue{#m;#e;#f;#g;#v;#_;#b;#w;#y;#x;#C;#S;constructor(e,t,i,r,n,o,a){this.#b="",this.#y=!1,this.#x=!1,this._onMessageEmitter=new s.Q5,this.onDidReceiveMessage=this._onMessageEmitter.event,this.#E=new s.Q5,this._onDidDispose=this.#E.event,this.#m=e,this.#e=t,this.#w=i,this.#g=r,this.#v=n,this.#_=o,this.#C=he(o),this.#S=function(e){try{const t=(0,le.Kt)((0,le.wy)(e.engines.vscode));return!!t&&(t.majorBase<1||1===t.majorBase&&t.minorBase<60)}catch{return!1}}(o),this.#f=a}#E;dispose(){this.#y=!0,this.#E.fire(),this.#E.dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return this.#x=!0,ie(e,this.#g)}get cspSource(){const e=this.#_.extensionLocation;if(e.scheme===a.lg.https||e.scheme===a.lg.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+te}return te}get html(){return this.assertNotDisposed(),this.#b}set html(e){this.assertNotDisposed(),this.#b!==e&&(this.#b=e,this.#S&&!this.#x&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(this.#x=!0,this.#f.report("Webview vscode-resource: uris",this.#_,"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),this.#e.$setHtml(this.#m,this.rewriteOldResourceUrlsIfNeeded(e)))}get options(){return this.assertNotDisposed(),this.#w}set options(e){this.assertNotDisposed(),(0,ce.fS)(this.#w,e)||this.#e.$setOptions(this.#m,fe(this.#_,this.#v,e)),this.#w=e}async postMessage(e){if(this.#y)return!1;const t=(0,de.m)(e,{serializeBuffersForPostMessage:this.#C});return this.#e.$postMessage(this.#m,t.message,...t.buffers)}assertNotDisposed(){if(this.#y)throw new Error("Webview is disposed")}rewriteOldResourceUrlsIfNeeded(e){if(!this.#S)return e;const t=this.#_.extensionLocation?.scheme===a.lg.vscodeRemote,i=this.#_.extensionLocation.scheme===a.lg.vscodeRemote?this.#_.extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,((e,r,n,s,o,a)=>`${r}${ie(l.ov.from({scheme:s||"file",path:decodeURIComponent(o)}),{isRemote:t,authority:i}).toString()}${a}`)).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,((e,r,n,s,o,a)=>`${r}${ie(l.ov.from({scheme:s||"file",path:decodeURIComponent(o)}),{isRemote:t,authority:i}).toString()}${a}`))}}function he(e){try{const t=(0,le.Kt)((0,le.wy)(e.engines.vscode));return!!t&&t.majorBase>=1&&t.minorBase>=57}catch{return!1}}class pe extends o.JT{constructor(e,t,i,r,n){super(),this.remoteInfo=t,this.workspace=i,this._logService=r,this._deprecationService=n,this._webviews=new Map,this._webviewProxy=e.getProxy(y.Tr.MainThreadWebviews)}dispose(){super.dispose();for(const e of this._webviews.values())e.dispose();this._webviews.clear()}$onMessage(e,t,i){const r=this.getWebview(e);if(r){const{message:e}=(0,de.j)(t,i.value);r._onMessageEmitter.fire(e)}}$onMissingCsp(e,t){this._logService.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,i){const r=new ue(e,this._webviewProxy,function(e){return{enableCommandUris:e.enableCommandUris,enableScripts:e.enableScripts,enableForms:e.enableForms,portMapping:e.portMapping,localResourceRoots:e.localResourceRoots?.map((e=>l.ov.from(e)))}}(t),this.remoteInfo,this.workspace,i,this._deprecationService);this._webviews.set(e,r);const n=r._onDidDispose((()=>{n.dispose(),this.deleteWebview(e)}));return r}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}}function me(e){return{id:e.identifier,location:e.extensionLocation}}function fe(e,t,i){return{enableCommandUris:i.enableCommandUris,enableScripts:i.enableScripts,enableForms:i.enableForms,portMapping:i.portMapping,localResourceRoots:i.localResourceRoots||ge(e,t)}}function ge(e,t){return[...(t?.getWorkspaceFolders()||[]).map((e=>e.uri)),e.extensionLocation]}class ve{static{this.enableDebugLogging=!1}constructor(e){this.id=e,this._data=new Map,this._idPool=1}add(e){const t=this._idPool++;return this._data.set(t,e),this.logDebugInfo(),t}get(e,t){return this._data.has(e)?this._data.get(e)[t]:void 0}delete(e){this._data.delete(e),this.logDebugInfo()}logDebugInfo(){ve.enableDebugLogging&&console.log(`${this.id} cache size - ${this._data.size}`)}}class _e{constructor(e,t){this.document=e,this._storagePath=t,this._backupCounter=1,this._edits=new ve("custom documents")}addEdit(e){return this._edits.add([e])}async undo(e,t){await this.getEdit(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.getEdit(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this._edits.delete(t)}getNewBackupUri(){if(!this._storagePath)throw new Error("Backup requires a valid storage path");const e=function(e){const t=e.scheme===a.lg.file||e.scheme===a.lg.untitled?e.fsPath:e.toString();return(0,oe.vp)(t)+""}(this.document.uri)+this._backupCounter++;return(0,ae.Vo)(this._storagePath,e)}updateBackup(e){this._backup?.delete(),this._backup=e}disposeBackup(){this._backup?.delete(),this._backup=void 0}getEdit(e){const t=this._edits.get(e,0);if(!t)throw new Error("No edit found");return t}}class be{constructor(){this._documents=new Map}get(e,t){return this._documents.get(this.key(e,t))}add(e,t,i){const r=this.key(e,t.uri);if(this._documents.has(r))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const n=new _e(t,i);return this._documents.set(r,n),n}delete(e,t){const i=this.key(e,t.uri);this._documents.delete(i)}key(e,t){return`${e}@@@${t}`}}class we{constructor(){this._providers=new Map}addTextProvider(e,t,i){return this.add(0,e,t,i)}addCustomProvider(e,t,i){return this.add(1,e,t,i)}get(e){return this._providers.get(e)}add(e,t,i,r){if(this._providers.has(t))throw new Error(`Provider for viewType:${t} already registered`);return this._providers.set(t,{type:e,extension:i,provider:r}),new x.JTr((()=>this._providers.delete(t)))}}class ye{constructor(e,t,i,r,n){this._extHostDocuments=t,this._extensionStoragePaths=i,this._extHostWebview=r,this._extHostWebviewPanels=n,this._editorProviders=new we,this._documents=new be,this._proxy=e.getProxy(y.Tr.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,i,r){const n=new o.SL;return!function(e){return"function"==typeof e.resolveCustomTextEditor}(i)?(n.add(this._editorProviders.addCustomProvider(t,e,i)),xe(i)&&n.add(i.onDidChangeCustomDocument((e=>{const i=this.getCustomDocumentEntry(t,e.document.uri);if(function(e){return"function"==typeof e.undo&&"function"==typeof e.redo}(e)){const r=i.addEdit(e);this._proxy.$onDidEdit(e.document.uri,t,r,e.label)}else this._proxy.$onContentChange(e.document.uri,t)}))),this._proxy.$registerCustomEditorProvider(me(e),t,r.webviewOptions||{},!!r.supportsMultipleEditorsPerDocument,he(e))):(n.add(this._editorProviders.addTextProvider(t,e,i)),this._proxy.$registerTextEditorProvider(me(e),t,r.webviewOptions||{},{supportsMove:!!i.moveCustomTextEditor},he(e))),x.JTr.from(n,new x.JTr((()=>{this._proxy.$unregisterEditorProvider(t)})))}async $createCustomDocument(e,t,i,r,n){const s=this._editorProviders.get(t);if(!s)throw new Error(`No provider found for '${t}'`);if(1!==s.type)throw new Error(`Invalid provide type for '${t}'`);const o=l.ov.revive(e),a=await s.provider.openCustomDocument(o,{backupId:i,untitledDocumentData:r?.buffer},n);let c;return xe(s.provider)&&this._extensionStoragePaths&&(c=this._extensionStoragePaths.workspaceValue(s.extension)??this._extensionStoragePaths.globalValue(s.extension)),this._documents.add(t,a,c),{editable:xe(s.provider)}}async $disposeCustomDocument(e,t){const i=this._editorProviders.get(t);if(!i)throw new Error(`No provider found for '${t}'`);if(1!==i.type)throw new Error(`Invalid provider type for '${t}'`);const r=l.ov.revive(e),{document:n}=this.getCustomDocumentEntry(t,r);this._documents.delete(t,n),n.dispose()}async $resolveCustomEditor(e,t,i,r,n,s){const o=this._editorProviders.get(i);if(!o)throw new Error(`No provider found for '${i}'`);const a=P.eI.to(n),c=this._extHostWebview.createNewWebview(t,r.contentOptions,o.extension),d=this._extHostWebviewPanels.createNewWebviewPanel(t,i,r.title,a,r.options,c,r.active),u=l.ov.revive(e);switch(o.type){case 1:{const{document:e}=this.getCustomDocumentEntry(i,u);return o.provider.resolveCustomEditor(e,d,s)}case 0:{const e=this._extHostDocuments.getDocument(u);return o.provider.resolveCustomTextEditor(e,d,s)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,i){this.getCustomDocumentEntry(t,e).disposeEdits(i)}async $onMoveCustomEditor(e,t,i){const n=this._editorProviders.get(i);if(!n)throw new Error(`No provider found for '${i}'`);if(!n.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${i}'`);const s=this._extHostWebviewPanels.getWebviewPanel(e);if(!s)throw new Error("No webview found");const o=l.ov.revive(t),a=this._extHostDocuments.getDocument(o);await n.provider.moveCustomTextEditor(a,s,r.Ts.None)}async $undo(e,t,i,r){return this.getCustomDocumentEntry(t,e).undo(i,r)}async $redo(e,t,i,r){return this.getCustomDocumentEntry(t,e).redo(i,r)}async $revert(e,t,i){const r=this.getCustomDocumentEntry(t,e),n=this.getCustomEditorProvider(t);await n.revertCustomDocument(r.document,i),r.disposeBackup()}async $onSave(e,t,i){const r=this.getCustomDocumentEntry(t,e),n=this.getCustomEditorProvider(t);await n.saveCustomDocument(r.document,i),r.disposeBackup()}async $onSaveAs(e,t,i,r){const n=this.getCustomDocumentEntry(t,e);return this.getCustomEditorProvider(t).saveCustomDocumentAs(n.document,l.ov.revive(i),r)}async $backup(e,t,i){const r=this.getCustomDocumentEntry(t,e),n=this.getCustomEditorProvider(t),s=await n.backupCustomDocument(r.document,{destination:r.getNewBackupUri()},i);return r.updateBackup(s),s.id}getCustomDocumentEntry(e,t){const i=this._documents.get(e,l.ov.revive(t));if(!i)throw new Error("No custom document found");return i}getCustomEditorProvider(e){const t=this._editorProviders.get(e),i=t?.provider;if(!i||!xe(i))throw new Error("Custom document is not editable");return i}}function xe(e){return!!e.onDidChangeCustomDocument}var Ce,Se=i(56687),Ee=i(50365),De=i(67525),ke=i(82380),Ie=i(18910),Pe=i(52202);class Te{#e;#D;#k;constructor(e,t,i,r,n,s,o,a){this._name=e,this._owner=t,this._maxDiagnosticsTotal=i,this._maxDiagnosticsPerFile=r,this._modelVersionIdProvider=n,this._isDisposed=!1,this._maxDiagnosticsTotal=Math.max(r,i),this.#k=new Ie.Y9((e=>s.getComparisonKey(e))),this.#e=o,this.#D=a}dispose(){this._isDisposed||(this.#D.fire([...this.#k.keys()]),this.#e?.$clear(this._owner),this.#k.clear(),this._isDisposed=!0)}get name(){return this._checkDisposed(),this._name}set(e,t){if(!e)return void this.clear();this._checkDisposed();let i=[];if(l.ov.isUri(e)){if(!t)return void this.delete(e);this.#k.set(e,t.slice()),i=[e]}else if(Array.isArray(e)){let t;i=[],e=[...e].sort(Te._compareIndexedTuplesByUri);for(const r of e){const[e,n]=r;if(t&&e.toString()===t.toString()||(t&&0===this.#k.get(t).length&&this.#k.delete(t),t=e,i.push(e),this.#k.set(e,[])),n){const t=this.#k.get(e);t?.push(...n)}else{const t=this.#k.get(e);t&&(t.length=0)}}}if(this.#D.fire(i),!this.#e)return;const r=[];let n=0;for(const e of i){let t=[];const i=this.#k.get(e);if(i)if(i.length>this._maxDiagnosticsPerFile){t=[];const r=[x.H_B.Error,x.H_B.Warning,x.H_B.Information,x.H_B.Hint];e:for(let n=0;n<4;n++)for(const s of i)if(s.severity===r[n]){if(t.push({...P.R9.from(s),modelVersionId:this._modelVersionIdProvider(e)})===this._maxDiagnosticsPerFile)break e}t.push({severity:ke.Z.Info,message:(0,De.C$)("vs/workbench/api/common/extHostDiagnostics",0,"Not showing {0} further errors and warnings.",i.length-this._maxDiagnosticsPerFile),startLineNumber:t[t.length-1].startLineNumber,startColumn:t[t.length-1].startColumn,endLineNumber:t[t.length-1].endLineNumber,endColumn:t[t.length-1].endColumn})}else t=i.map((t=>({...P.R9.from(t),modelVersionId:this._modelVersionIdProvider(e)})));if(r.push([e,t]),n+=t.length,n>this._maxDiagnosticsTotal)break}this.#e.$changeMany(this._owner,r)}delete(e){this._checkDisposed(),this.#D.fire([e]),this.#k.delete(e),this.#e?.$changeMany(this._owner,[[e,void 0]])}clear(){this._checkDisposed(),this.#D.fire([...this.#k.keys()]),this.#k.clear(),this.#e?.$clear(this._owner)}forEach(e,t){this._checkDisposed();for(const[i,r]of this)e.call(t,i,r,this)}*[Symbol.iterator](){this._checkDisposed();for(const e of this.#k.keys())yield[e,this.get(e)]}get(e){this._checkDisposed();const t=this.#k.get(e);return Array.isArray(t)?Object.freeze(t.slice(0)):[]}has(e){return this._checkDisposed(),Array.isArray(this.#k.get(e))}_checkDisposed(){if(this._isDisposed)throw new Error("illegal state - object is disposed")}static _compareIndexedTuplesByUri(e,t){return e[0].toString()<t[0].toString()?-1:e[0].toString()>t[0].toString()?1:0}}let Ae=class{static{Ce=this}static{this._idPool=0}static{this._maxDiagnosticsPerFile=1e3}static{this._maxDiagnosticsTotal=1.1*Ce._maxDiagnosticsPerFile}static _mapper(e){const t=new Ie.Y9;for(const i of e)t.set(i,i);return{uris:Object.freeze(Array.from(t.values()))}}constructor(e,t,i,r){this._logService=t,this._fileSystemInfoService=i,this._extHostDocumentsAndEditors=r,this._collections=new Map,this._onDidChangeDiagnostics=new s.D0({merge:e=>e.flat(),delay:50}),this.onDidChangeDiagnostics=s.ju.map(this._onDidChangeDiagnostics.event,Ce._mapper),this._proxy=e.getProxy(y.Tr.MainThreadDiagnostics)}createDiagnosticCollection(e,t){const{_collections:i,_proxy:r,_onDidChangeDiagnostics:n,_logService:s,_fileSystemInfoService:o,_extHostDocumentsAndEditors:a}=this,c=new class{$changeMany(t,i){r.$changeMany(t,i),s.trace("[DiagnosticCollection] change many (extension, owner, uris)",e.value,t,0===i.length?"CLEARING":i)}$clear(t){r.$clear(t),s.trace("[DiagnosticCollection] remove all (extension, owner)",e.value,t)}dispose(){r.dispose()}};let l;if(t)if(i.has(t)){this._logService.warn(`DiagnosticCollection with name '${t}' does already exist.`);do{l=t+Ce._idPool++}while(i.has(l))}else l=t;else t="_generated_diagnostic_collection_name_#"+Ce._idPool++,l=t;return new class extends Te{constructor(){super(t,l,Ce._maxDiagnosticsTotal,Ce._maxDiagnosticsPerFile,(e=>a.getDocument(e)?.version),o.extUri,c,n),i.set(l,this)}dispose(){super.dispose(),i.delete(l)}}}getDiagnostics(e){if(e)return this._getDiagnostics(e);{const e=new Map,t=[];for(const i of this._collections.values())i.forEach(((i,r)=>{let n=e.get(i.toString());void 0===n&&(n=t.length,e.set(i.toString(),n),t.push([i,[]])),t[n][1]=t[n][1].concat(...r)}));return t}}_getDiagnostics(e){let t=[];for(const i of this._collections.values())i.has(e)&&(t=t.concat(i.get(e)));return t}$acceptMarkersChange(e){if(!this._mirrorCollection){const e="_generated_mirror",t=new Te(e,e,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,(e=>{}),this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(e,t),this._mirrorCollection=t}for(const[t,i]of e)this._mirrorCollection.set(l.ov.revive(t),i.map(P.R9.to))}};Ae=Ce=(0,z.g)([(0,z.f)(1,v.V),(0,z.f)(2,Pe.G)],Ae);class Re{constructor(e){this._proxy=e.getProxy(y.Tr.MainThreadDialogs)}showOpenDialog(e,t){return t?.allowUIResources&&(0,j.H5)(e,"showLocal"),this._proxy.$showOpenDialog(t).then((e=>e?e.map((e=>l.ov.revive(e))):void 0))}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then((e=>e?l.ov.revive(e):void 0))}}var $e=i(88023);class Le{static{this._handlePool=0}constructor(e,t,i){this._documentsAndEditors=t,this._logService=i,this._documentContentProviders=new Map,this._proxy=e.getProxy(y.Tr.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(e,t){if(Object.keys(a.lg).indexOf(e)>=0)throw new Error(`scheme '${e}' already registered`);const i=Le._handlePool++;let r;if(this._documentContentProviders.set(i,t),this._proxy.$registerTextContentProvider(i,e),"function"==typeof t.onDidChange){let s;r=t.onDidChange((async t=>{if(t.scheme!==e)return void this._logService.warn(`Provider for scheme '${e}' is firing event for schema '${t.scheme}' which will be IGNORED`);if(!this._documentsAndEditors.getDocument(t))return;s&&await s;const r=this.$provideTextDocumentContent(i,t).then((async e=>{if(!e&&"string"!=typeof e)return;const i=this._documentsAndEditors.getDocument(t);if(!i)return;const r=(0,$e.uq)(e);return i.equalLines(r)?void 0:this._proxy.$onVirtualDocumentChange(t,e)})).catch(n.dL).finally((()=>{s===r&&(s=void 0)}));s=r}))}return new x.JTr((()=>{this._documentContentProviders.delete(i)&&this._proxy.$unregisterTextContentProvider(i),r&&(r.dispose(),r=void 0)}))}$provideTextDocumentContent(e,t){const i=this._documentContentProviders.get(e);return i?Promise.resolve(i.provideTextDocumentContent(l.ov.revive(t),r.Ts.None)):Promise.reject(new Error(`unsupported uri-scheme: ${t.scheme}`))}}var Ne=i(65161);class ze{constructor(e,t,i,r={timeout:1500,errors:3}){this._logService=e,this._documents=t,this._mainThreadBulkEdits=i,this._thresholds=r,this._callbacks=new Ne.S,this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(t,i,r)=>{const n={dispose:this._callbacks.push([t,i,e])};return Array.isArray(r)&&r.push(n),n}}async $participateInSave(e,t){const i=l.ov.revive(e);let r=!1;const n=setTimeout((()=>r=!0),this._thresholds.timeout),s=[];try{for(const e of[...this._callbacks]){if(r)break;const n=this._documents.getDocument(i),o=await this._deliverEventAsyncAndBlameBadListeners(e,{document:n,reason:P.wD.to(t)});s.push(o)}}finally{clearTimeout(n)}return s}_deliverEventAsyncAndBlameBadListeners([e,t,i],r){const n=this._badListeners.get(e);return"number"==typeof n&&n>this._thresholds.errors?Promise.resolve(!1):this._deliverEventAsync(i,e,t,r).then((()=>!0),(t=>{if(this._logService.error(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' threw ERROR`),this._logService.error(t),!(t instanceof Error)||"concurrent_edits"!==t.message){const t=this._badListeners.get(e);this._badListeners.set(e,t?t+1:1),"number"==typeof t&&t>this._thresholds.errors&&this._logService.info(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1}))}_deliverEventAsync(e,t,i,r){const s=[],o=Date.now(),{document:a,reason:c}=r,{version:l}=a,d=Object.freeze({document:a,reason:c,waitUntil(e){if(Object.isFrozen(s))throw(0,n.L6)("waitUntil can not be called async");s.push(Promise.resolve(e))}});try{t.apply(i,[d])}catch(e){return Promise.reject(e)}return new Promise(((t,i)=>{const r=setTimeout((()=>i(new Error("timeout"))),this._thresholds.timeout);return Promise.all(s).then((i=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-o}ms`),clearTimeout(r),t(i)})).catch((e=>{clearTimeout(r),i(e)}))})).then((e=>{const t={edits:[]};for(const i of e)if(Array.isArray(i)&&i.every((e=>e instanceof x.PYv)))for(const{newText:e,newEol:r,range:n}of i)t.edits.push({resource:a.uri,versionId:void 0,textEdit:{range:n&&P.e6.from(n),text:e,eol:r&&P.b6.from(r)}});if(0!==t.edits.length)return l===a.version?this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new M.ky(t)):Promise.reject(new Error("concurrent_edits"))}))}}var Fe=i(10456);class Me{constructor(e,t){this._onDidAddDocument=new s.Q5,this._onDidRemoveDocument=new s.Q5,this._onDidChangeDocument=new s.Q5,this._onDidSaveDocument=new s.Q5,this.onDidAddDocument=this._onDidAddDocument.event,this.onDidRemoveDocument=this._onDidRemoveDocument.event,this.onDidChangeDocument=this._onDidChangeDocument.event,this.onDidSaveDocument=this._onDidSaveDocument.event,this._toDispose=new o.SL,this._documentLoader=new Map,this._proxy=e.getProxy(y.Tr.MainThreadDocuments),this._documentsAndEditors=t,this._documentsAndEditors.onDidRemoveDocuments((e=>{for(const t of e)this._onDidRemoveDocument.fire(t.document)}),void 0,this._toDispose),this._documentsAndEditors.onDidAddDocuments((e=>{for(const t of e)this._onDidAddDocument.fire(t.document)}),void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e)return;const t=this._documentsAndEditors.getDocument(e);return t||void 0}getDocument(e){const t=this.getDocumentData(e);if(!t?.document)throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e){const t=this._documentsAndEditors.getDocument(e);if(t)return Promise.resolve(t);let i=this._documentLoader.get(e.toString());return i||(i=this._proxy.$tryOpenDocument(e).then((t=>{this._documentLoader.delete(e.toString());const i=l.ov.revive(t);return(0,V.cW)(this._documentsAndEditors.getDocument(i))}),(t=>(this._documentLoader.delete(e.toString()),Promise.reject(t)))),this._documentLoader.set(e.toString(),i)),i}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then((e=>l.ov.revive(e)))}$acceptModelLanguageChanged(e,t){const i=l.ov.revive(e),r=this._documentsAndEditors.getDocument(i);if(!r)throw new Error("unknown document");this._onDidRemoveDocument.fire(r.document),r._acceptLanguageId(t),this._onDidAddDocument.fire(r.document)}$acceptModelSaved(e){const t=l.ov.revive(e),i=this._documentsAndEditors.getDocument(t);if(!i)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this._onDidSaveDocument.fire(i.document)}$acceptDirtyStateChanged(e,t){const i=l.ov.revive(e),r=this._documentsAndEditors.getDocument(i);if(!r)throw new Error("unknown document");r._acceptIsDirty(t),this._onDidChangeDocument.fire({document:r.document,contentChanges:[],reason:void 0})}$acceptModelChanged(e,t,i){const r=l.ov.revive(e),n=this._documentsAndEditors.getDocument(r);if(!n)throw new Error("unknown document");let s;n._acceptIsDirty(i),n.onEvents(t),t.isUndoing?s=x.bur.Undo:t.isRedoing&&(s=x.bur.Redo),this._onDidChangeDocument.fire((0,ce._A)({document:n.document,contentChanges:t.changes.map((e=>({range:P.e6.to(e.range),rangeOffset:e.rangeOffset,rangeLength:e.rangeLength,text:e.text}))),reason:s}))}setWordDefinitionFor(e,t){(0,Fe.T7)(e,t)}}var Oe=i(1663),He=i(53917);class Ue{constructor(e){this._AiEmbeddingVectorProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(y.Tr.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,i){if(0===this._AiEmbeddingVectorProviders.size)throw new Error("No embedding vector providers registered");const r=this._AiEmbeddingVectorProviders.get(e);if(!r)throw new Error("Embedding vector provider not found");const n=await r.provideEmbeddingVector(t,i);if(!n)throw new Error("Embedding vector provider returned undefined");return n}registerEmbeddingVectorProvider(e,t,i){const r=this._nextHandle;return this._nextHandle++,this._AiEmbeddingVectorProviders.set(r,i),this._proxy.$registerAiEmbeddingVectorProvider(t,r),new x.JTr((()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(r),this._AiEmbeddingVectorProviders.delete(r)}))}}var Be=i(26841),We=i(46708),Ve=i(53976),qe=i(99360);class je{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0,this._schemes.push(e)}delete(e){const t=this._schemes.indexOf(e);t>=0&&(this._schemes.splice(t,1),this._stateMachine=void 0)}_initStateMachine(){if(!this._stateMachine){const e=this._schemes.sort(),t=[];let i,r,n=14,s=14;for(const o of e){let e=i?(0,$e.Mh)(i,o):0;for(r=0===e?1:s;e<o.length;e++)e+1===o.length?(n=s,s=9):s+=1,t.push([r,o.toUpperCase().charCodeAt(e),s]),t.push([r,o.toLowerCase().charCodeAt(e),s]),r=s;i=o,s=n}t.push([9,58,10]),t.push([10,47,12]),this._stateMachine=new We.DV(t)}}provideDocumentLinks(e){this._initStateMachine();const t=[],i=We.VD.computeLinks({getLineContent(t){return e.lineAt(t-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(const e of i){const i=P.jW.to(e);i.target&&t.push(i)}return t}}class Ke{constructor(e,t){this._extHostLanguageFeatures=t,this._linkProvider=new je,this._fsProvider=new Map,this._registeredSchemes=new Set,this._watches=new Map,this._handlePool=0,this._proxy=e.getProxy(y.Tr.MainThreadFileSystem)}dispose(){this._linkProviderRegistration?.dispose()}registerFileSystemProvider(e,t,i,r={}){if(Ke._validateFileSystemProvider(i),this._registeredSchemes.has(t))throw new Error(`a provider for the scheme '${t}' is already registered`);this._linkProviderRegistration||(this._linkProviderRegistration=this._extHostLanguageFeatures.registerDocumentLinkProvider(e,"*",this._linkProvider));const n=this._handlePool++;this._linkProvider.add(t),this._registeredSchemes.add(t),this._fsProvider.set(n,i);let s,a=2;r.isCaseSensitive&&(a+=1024),r.isReadonly&&(a+=2048),"function"==typeof i.copy&&(a+=8),"function"==typeof i.open&&"function"==typeof i.close&&"function"==typeof i.read&&"function"==typeof i.write&&((0,j.H5)(e,"fsChunks"),a+=4),r.isReadonly&&(0,qe.Fr)(r.isReadonly)&&""!==r.isReadonly.value&&(s={value:r.isReadonly.value,isTrusted:r.isReadonly.isTrusted,supportThemeIcons:r.isReadonly.supportThemeIcons,supportHtml:r.isReadonly.supportHtml,baseUri:r.isReadonly.baseUri,uris:r.isReadonly.uris}),this._proxy.$registerFileSystemProvider(n,t,a,s).catch((i=>{console.error(`FAILED to register filesystem provider of ${e.identifier.value}-extension for the scheme ${t}`),console.error(i)}));const c=i.onDidChangeFile((e=>{const i=[];for(const r of e){const{uri:e,type:n}=r;if(e.scheme!==t)continue;let s;switch(n){case x.zR2.Changed:s=0;break;case x.zR2.Created:s=1;break;case x.zR2.Deleted:s=2;break;default:throw new Error("Unknown FileChangeType")}i.push({resource:e,type:s})}this._proxy.$onFileSystemChange(n,i)}));return(0,o.OF)((()=>{c.dispose(),this._linkProvider.delete(t),this._registeredSchemes.delete(t),this._fsProvider.delete(n),this._proxy.$unregisterProvider(n)}))}static _validateFileSystemProvider(e){if(!e)throw new Error("MISSING provider");if("function"!=typeof e.watch)throw new Error("Provider does NOT implement watch");if("function"!=typeof e.stat)throw new Error("Provider does NOT implement stat");if("function"!=typeof e.readDirectory)throw new Error("Provider does NOT implement readDirectory");if("function"!=typeof e.createDirectory)throw new Error("Provider does NOT implement createDirectory");if("function"!=typeof e.readFile)throw new Error("Provider does NOT implement readFile");if("function"!=typeof e.writeFile)throw new Error("Provider does NOT implement writeFile");if("function"!=typeof e.delete)throw new Error("Provider does NOT implement delete");if("function"!=typeof e.rename)throw new Error("Provider does NOT implement rename")}static _asIStat(e){const{type:t,ctime:i,mtime:r,size:n,permissions:s}=e;return{type:t,ctime:i,mtime:r,size:n,permissions:s}}$stat(e,t){return Promise.resolve(this._getFsProvider(e).stat(l.ov.revive(t))).then((e=>Ke._asIStat(e)))}$readdir(e,t){return Promise.resolve(this._getFsProvider(e).readDirectory(l.ov.revive(t)))}$readFile(e,t){return Promise.resolve(this._getFsProvider(e).readFile(l.ov.revive(t))).then((e=>Ve.KN.wrap(e)))}$writeFile(e,t,i,r){return Promise.resolve(this._getFsProvider(e).writeFile(l.ov.revive(t),i.buffer,r))}$delete(e,t,i){return Promise.resolve(this._getFsProvider(e).delete(l.ov.revive(t),i))}$rename(e,t,i,r){return Promise.resolve(this._getFsProvider(e).rename(l.ov.revive(t),l.ov.revive(i),r))}$copy(e,t,i,r){const n=this._getFsProvider(e);if(!n.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(n.copy(l.ov.revive(t),l.ov.revive(i),r))}$mkdir(e,t){return Promise.resolve(this._getFsProvider(e).createDirectory(l.ov.revive(t)))}$watch(e,t,i,r){const n=this._getFsProvider(e).watch(l.ov.revive(i),r);this._watches.set(t,n)}$unwatch(e,t){const i=this._watches.get(t);i&&(i.dispose(),this._watches.delete(t))}$open(e,t,i){const r=this._getFsProvider(e);if(!r.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(r.open(l.ov.revive(t),i))}$close(e,t){const i=this._getFsProvider(e);if(!i.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(i.close(t))}$read(e,t,i,r){const n=this._getFsProvider(e);if(!n.read)throw new Error('FileSystemProvider does not implement "read"');const s=Ve.KN.alloc(r);return Promise.resolve(n.read(t,i,s.buffer,0,r)).then((e=>s.slice(0,e)))}$write(e,t,i,r){const n=this._getFsProvider(e);if(!n.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(n.write(t,i,r.buffer,0,r.byteLength))}_getFsProvider(e){const t=this._fsProvider.get(e);if(!t){const e=new Error;throw e.name="ENOPRO",e.message="no provider",e}return t}}var Qe=i(77600),Ge=i(22200),Je=i(40048);class Ye{get ignoreCreateEvents(){return Boolean(1&this._config)}get ignoreChangeEvents(){return Boolean(2&this._config)}get ignoreDeleteEvents(){return Boolean(4&this._config)}constructor(e,t,i,r,n,o){this.session=Math.random(),this._onDidCreate=new s.Q5,this._onDidChange=new s.Q5,this._onDidDelete=new s.Q5,this._config=0,o?.ignoreCreateEvents&&(this._config+=1),o?.ignoreChangeEvents&&(this._config+=2),o?.ignoreDeleteEvents&&(this._config+=4);const a=(0,Ge.Qc)(n),c="string"==typeof n,d=o?.correlate,u=r((e=>{if(!("number"==typeof e.session&&e.session!==this.session||d&&void 0===e.session)){if(!o?.ignoreCreateEvents)for(const i of e.created){const e=l.ov.revive(i);!a(e.fsPath)||c&&!t.getWorkspaceFolder(e)||this._onDidCreate.fire(e)}if(!o?.ignoreChangeEvents)for(const i of e.changed){const e=l.ov.revive(i);!a(e.fsPath)||c&&!t.getWorkspaceFolder(e)||this._onDidChange.fire(e)}if(!o?.ignoreDeleteEvents)for(const i of e.deleted){const e=l.ov.revive(i);!a(e.fsPath)||c&&!t.getWorkspaceFolder(e)||this._onDidDelete.fire(e)}}}));this._disposable=x.JTr.from(this.ensureWatching(e,i,n,o,o?.correlate),this._onDidCreate,this._onDidChange,this._onDidDelete,u)}ensureWatching(e,t,i,r,n){const s=x.JTr.from();if("string"==typeof i)return s;if(r?.ignoreChangeEvents&&r?.ignoreCreateEvents&&r?.ignoreDeleteEvents)return s;const o=e.getProxy(y.Tr.MainThreadFileSystemEventService);let a,c=!1;return(i.pattern.includes(Ge.k1)||i.pattern.includes(Ge.dn))&&(c=!0),n&&(r?.ignoreChangeEvents||r?.ignoreCreateEvents||r?.ignoreDeleteEvents)&&(a=14,r?.ignoreChangeEvents&&(a&=-3),r?.ignoreCreateEvents&&(a&=-5),r?.ignoreDeleteEvents&&(a&=-9)),o.$watch(t.identifier.value,this.session,i.baseUri,{recursive:c,excludes:r?.excludes??[],filter:a},Boolean(n)),x.JTr.from({dispose:()=>o.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}}class Xe{constructor(e){this._events=e,this.session=this._events.session,this._created=new Je.o((()=>this._events.created.map(l.ov.revive))),this._changed=new Je.o((()=>this._events.changed.map(l.ov.revive))),this._deleted=new Je.o((()=>this._events.deleted.map(l.ov.revive)))}get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}}class Ze{constructor(e,t,i){this._mainContext=e,this._logService=t,this._extHostDocumentsAndEditors=i,this._onFileSystemEvent=new s.Q5,this._onDidRenameFile=new s.Q5,this._onDidCreateFile=new s.Q5,this._onDidDeleteFile=new s.Q5,this._onWillRenameFile=new s.Qz,this._onWillCreateFile=new s.Qz,this._onWillDeleteFile=new s.Qz,this.onDidRenameFile=this._onDidRenameFile.event,this.onDidCreateFile=this._onDidCreateFile.event,this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,t,i,r){return new Ye(this._mainContext,e,t,this._onFileSystemEvent.event,P.RW.from(i),r)}$onFileEvent(e){this._onFileSystemEvent.fire(new Xe(e))}$onDidRunFileOperation(e,t){switch(e){case 2:this._onDidRenameFile.fire(Object.freeze({files:t.map((e=>({oldUri:l.ov.revive(e.source),newUri:l.ov.revive(e.target)})))}));break;case 1:this._onDidDeleteFile.fire(Object.freeze({files:t.map((e=>l.ov.revive(e.target)))}));break;case 0:case 3:this._onDidCreateFile.fire(Object.freeze({files:t.map((e=>l.ov.revive(e.target)))}))}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,t){return(i,r,n)=>{const s=function(e){i.call(r,e)};return s.extension=e,t.event(s,void 0,n)}}async $onWillRunFileOperation(e,t,i,r){switch(e){case 2:return await this._fireWillEvent(this._onWillRenameFile,{files:t.map((e=>({oldUri:l.ov.revive(e.source),newUri:l.ov.revive(e.target)})))},i,r);case 1:return await this._fireWillEvent(this._onWillDeleteFile,{files:t.map((e=>l.ov.revive(e.target)))},i,r);case 0:case 3:return await this._fireWillEvent(this._onWillCreateFile,{files:t.map((e=>l.ov.revive(e.target)))},i,r)}}async _fireWillEvent(e,t,i,r){const n=new Set,s=[];if(await e.fireAsync(t,r,(async(e,t)=>{const r=Date.now(),o=await Promise.resolve(e);o instanceof x.DbP&&(s.push([t.extension,o]),n.add(t.extension.displayName??t.extension.identifier.value)),Date.now()-r>i&&this._logService.warn("SLOW file-participant",t.extension.identifier)})),r.isCancellationRequested)return;if(0===s.length)return;const o={edits:[]};for(const[,e]of s){const{edits:t}=P.Db.from(e,{getTextDocumentVersion:e=>this._extHostDocumentsAndEditors.getDocument(e)?.version,getNotebookDocumentVersion:()=>{}});o.edits=o.edits.concat(t)}return{edit:o,extensionNames:Array.from(n)}}}var et=i(73820);class tt{static{this._pool=0}constructor(e,t){this.extension=e,this.provider=t,this.handle=tt._pool++}}class it{constructor(e){this.session=e,this.responses=[]}}class rt{static{this._nextId=0}constructor(e,t,i,r){this._documents=i,this._logService=r,this._inputProvider=new Map,this._inputSessions=new Map,this._proxy=e.getProxy(y.Tr.MainThreadInlineChat),t.registerApiCommand(new I.b9("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new I.SF("Run arguments","",(e=>!0),(e=>{if(e)return{initialRange:e.initialRange?P.e6.from(e.initialRange):void 0,initialSelection:x.Y19.isSelection(e.initialSelection)?P.Y1.from(e.initialSelection):void 0,message:e.message,autoSend:e.autoSend,position:e.position?P.Ly.from(e.position):void 0}}))],I._m.Void))}registerProvider(e,t,i){const r=new tt(e,t);return this._inputProvider.set(r.handle,r),this._proxy.$registerInteractiveEditorProvider(r.handle,i?.label??e.displayName??e.name,e.identifier,"function"==typeof t.handleInteractiveEditorResponseFeedback,"function"==typeof t.provideFollowups,i?.supportReportIssue??!1),(0,o.OF)((()=>{this._proxy.$unregisterInteractiveEditorProvider(r.handle),this._inputProvider.delete(r.handle)}))}async $prepareSession(e,t,i,r){const n=this._inputProvider.get(e);if(!n)return void this._logService.warn("CANNOT prepare session because the PROVIDER IS GONE");const s=this._documents.getDocument(l.ov.revive(t)),o=P.Y1.to(i),a=await n.provider.prepareInteractiveEditorSession({document:s,selection:o},r);if(!a)return;if(a.wholeRange&&!a.wholeRange.contains(o))throw new Error("InteractiveEditorSessionProvider returned a wholeRange that does not contain the selection.");const c=rt._nextId++;return this._inputSessions.set(c,new it(a)),{id:c,placeholder:a.placeholder,input:a.input,slashCommands:a.slashCommands?.map((e=>({command:e.command,detail:e.detail,refer:e.refer,executeImmediately:e.executeImmediately}))),wholeRange:P.e6.from(a.wholeRange),message:a.message}}async $provideResponse(e,t,i,r){const n=this._inputProvider.get(e);if(!n)return;const s=this._inputSessions.get(t.id);if(!s)return;const o={prompt:i.prompt,selection:P.Y1.to(i.selection),wholeRange:P.e6.to(i.wholeRange),attempt:i.attempt,live:i.live,previewDocument:this._documents.getDocument(l.ov.revive(i.previewDocument)),withIntentDetection:i.withIntentDetection};let a=!1;const c={report:async e=>{if(!i.live&&e.edits?.length)throw new Error("Progress reporting is only supported for live sessions");a||r.isCancellationRequested||await this._proxy.$handleProgressChunk(i.requestId,{message:e.message,edits:e.edits?.map(P.PY.from),editsShouldBeInstant:e.editsShouldBeInstant,slashCommand:e.slashCommand?.command,markdownFragment:x.W5C.isMarkdownString(e.content)?e.content.value:e.content})}},d=Promise.resolve(n.provider.provideInteractiveEditorResponse(s.session,o,c,r));let u;try{u=await(0,H.eP)(d,r)}finally{a=!0}if(!u)return;const h=s.responses.push(u)-1,p={wholeRange:P.e6.from(u.wholeRange),placeholder:u.placeholder};if(!rt._isEditResponse(u))return{...p,id:h,type:"editorEdit",message:P.W5.from(u.contents),edits:[]};const{edits:m,contents:f}=u,g=void 0!==f?P.W5.from(f):void 0;return m instanceof x.DbP?{...p,id:h,type:"bulkEdit",edits:P.Db.from(m),message:g}:{...p,id:h,type:"editorEdit",edits:m.map(P.PY.from),message:g}}async $provideFollowups(e,t,i,r){const n=this._inputProvider.get(e),s=this._inputSessions.get(t),o=s?.responses[i];if(n&&o&&n.provider.provideFollowups){const e=Promise.resolve(n.provider.provideFollowups(s.session,o,r)),t=await(0,H.eP)(e,r);return t?.map(P.oy.from)}}$handleFeedback(e,t,i,r){const n=this._inputProvider.get(e),s=this._inputSessions.get(t),o=s?.responses[i];if(n&&o){const e=P.yS.to(r);n.provider.handleInteractiveEditorResponseFeedback?.(s.session,o,e)}}$releaseSession(e,t){}static _isEditResponse(e){return"object"==typeof e&&"object"==typeof e.edits}}class nt{constructor(e,t,i,r,n){this._extHostNotebooks=t,this._textDocumentsAndEditors=i,this._commands=r;const s=new I.b9("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new I.SF("showOptions","Show Options",(e=>!0),(e=>e)),new I.SF("resource","Interactive resource Uri",(e=>!0),(e=>e)),new I.SF("controllerId","Notebook controller Id",(e=>!0),(e=>e)),new I.SF("title","Interactive editor title",(e=>!0),(e=>e))],new I._m("Notebook and input URI",(e=>{if(n.debug("[ExtHostInteractive] open iw with notebook editor id",e.notebookEditorId),void 0!==e.notebookEditorId){const t=this._extHostNotebooks.getEditorById(e.notebookEditorId);return n.debug("[ExtHostInteractive] notebook editor found",t.id),{notebookUri:l.ov.revive(e.notebookUri),inputUri:l.ov.revive(e.inputUri),notebookEditor:t.apiEditor}}return n.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",e.notebookUri,e.inputUri),{notebookUri:l.ov.revive(e.notebookUri),inputUri:l.ov.revive(e.inputUri)}})));this._commands.registerApiCommand(s)}$willAddInteractiveDocument(e,t,i,r){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:i,uri:e,isDirty:!1,versionId:1}]})}$willRemoveInteractiveDocument(e,t){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}}class st{constructor(e){this._handlePool=0,this._proxy=e.getProxy(y.Tr.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this._handlePool++;return this._proxy.$registerResourceLabelFormatter(t,e),(0,o.OF)((()=>{this._proxy.$unregisterResourceLabelFormatter(t)}))}}var ot=i(73053),at=i(3918),ct=i(23775);const lt="vs/workbench/api/common/extHostLanguageFeatures";class dt{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentSymbols(e,t){const i=this._documents.getDocument(e),r=await this._provider.provideDocumentSymbols(i,t);return(0,S.XY)(r)?void 0:r[0]instanceof x.w6Q?r.map(P.w6.from):dt._asDocumentSymbolTree(r)}static _asDocumentSymbolTree(e){e=e.slice(0).sort(((e,t)=>{let i=e.location.range.start.compareTo(t.location.range.start);return 0===i&&(i=t.location.range.end.compareTo(e.location.range.end)),i}));const t=[],i=[];for(const r of e){const e={name:r.name||"!!MISSING: name!!",kind:P.cR.from(r.kind),tags:r.tags?.map(P.r4.from)||[],detail:"",containerName:r.containerName,range:P.e6.from(r.location.range),selectionRange:P.e6.from(r.location.range),children:[]};for(;;){if(0===i.length){i.push(e),t.push(e);break}const r=i[i.length-1];if(at.e.containsRange(r.range,e.range)&&!at.e.equalsRange(r.range,e.range)){r.children?.push(e),i.push(e);break}i.pop()}}return t}}class ut{constructor(e,t,i,r,n,s){this._documents=e,this._commands=t,this._provider=i,this._extension=r,this._extTelemetry=n,this._logService=s,this._cache=new ve("CodeLens"),this._disposables=new Map}async provideCodeLenses(e,t){const i=this._documents.getDocument(e),r=await this._provider.provideCodeLenses(i,t);if(!r||t.isCancellationRequested)return;const n=this._cache.add(r),s=new o.SL;this._disposables.set(n,s);const a={cacheId:n,lenses:[]};for(let e=0;e<r.length;e++)a.lenses.push({cacheId:[n,e],range:P.e6.from(r[e].range),command:this._commands.toInternal(r[e].command,s)});return a}async resolveCodeLens(e,t){const i=e.cacheId&&this._cache.get(...e.cacheId);if(!i)return;let r;if(r="function"!=typeof this._provider.resolveCodeLens||i.isResolved?i:await this._provider.resolveCodeLens(i,t),r||(r=i),t.isCancellationRequested)return;const n=e.cacheId&&this._disposables.get(e.cacheId[0]);if(n){if(!r.command){const e=new Error("INVALID code lens resolved, lacks command: "+this._extension.identifier.value);return this._extTelemetry.onExtensionError(this._extension.identifier,e),void this._logService.error(e)}return e.command=this._commands.toInternal(r.command,n),e}}releaseCodeLenses(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}}function ht(e){return Array.isArray(e)?e.map(P.nc.from):e?[P.nc.from(e)]:[]}class pt{constructor(e,t){this._documents=e,this._provider=t}async provideDefinition(e,t,i){const r=this._documents.getDocument(e),n=P.Ly.to(t);return ht(await this._provider.provideDefinition(r,n,i))}}class mt{constructor(e,t){this._documents=e,this._provider=t}async provideDeclaration(e,t,i){const r=this._documents.getDocument(e),n=P.Ly.to(t);return ht(await this._provider.provideDeclaration(r,n,i))}}class ft{constructor(e,t){this._documents=e,this._provider=t}async provideImplementation(e,t,i){const r=this._documents.getDocument(e),n=P.Ly.to(t);return ht(await this._provider.provideImplementation(r,n,i))}}class gt{constructor(e,t){this._documents=e,this._provider=t}async provideTypeDefinition(e,t,i){const r=this._documents.getDocument(e),n=P.Ly.to(t);return ht(await this._provider.provideTypeDefinition(r,n,i))}}class vt{static{this.HOVER_MAP_MAX_SIZE=10}constructor(e,t){this._documents=e,this._provider=t,this._hoverCounter=0,this._hoverMap=new Map}async provideHover(e,t,i,r){const n=this._documents.getDocument(e),s=P.Ly.to(t);let o;if(i&&i.verbosityRequest){const e=i.verbosityRequest.previousHover.id,t=this._hoverMap.get(e);if(!t)throw new Error(`Hover with id ${e} not found`);const a={action:i.verbosityRequest.action,previousHover:t};o=await this._provider.provideHover(n,s,r,a)}else o=await this._provider.provideHover(n,s,r);if(!o||(0,S.XY)(o.contents))return;o.range||(o.range=n.getWordRangeAtPosition(s)),o.range||(o.range=new x.e6w(s,s));const a=P.TM.from(o),c=this._hoverCounter;if(this._hoverMap.size===vt.HOVER_MAP_MAX_SIZE){const e=Math.min(...this._hoverMap.keys());this._hoverMap.delete(e)}this._hoverMap.set(c,o),this._hoverCounter+=1;return{...a,id:c}}releaseHover(e){this._hoverMap.delete(e)}}class _t{constructor(e,t){this._documents=e,this._provider=t}async provideEvaluatableExpression(e,t,i){const r=this._documents.getDocument(e),n=P.Ly.to(t),s=await this._provider.provideEvaluatableExpression(r,n,i);if(s)return P.hf.from(s)}}class bt{constructor(e,t){this._documents=e,this._provider=t}async provideInlineValues(e,t,i,r){const n=this._documents.getDocument(e),s=await this._provider.provideInlineValues(n,P.e6.to(t),P.GS.to(i),r);if(Array.isArray(s))return s.map((e=>P.CR.from(e)))}}class wt{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentHighlights(e,t,i){const r=this._documents.getDocument(e),n=P.Ly.to(t),s=await this._provider.provideDocumentHighlights(r,n,i);if(Array.isArray(s))return s.map(P.eh.from)}}class yt{constructor(e,t){this._documents=e,this._provider=t}async provideMultiDocumentHighlights(e,t,i,r){const n=this._documents.getDocument(e),s=i.map((e=>this._documents.getDocument(e))),o=P.Ly.to(t),a=await this._provider.provideMultiDocumentHighlights(n,o,s,r);if(Array.isArray(a))return a.map(P.lM.from)}}class xt{constructor(e,t){this._documents=e,this._provider=t}async provideLinkedEditingRanges(e,t,i){const r=this._documents.getDocument(e),n=P.Ly.to(t),s=await this._provider.provideLinkedEditingRanges(r,n,i);if(s&&Array.isArray(s.ranges))return{ranges:(0,S.kX)(s.ranges.map(P.e6.from)),wordPattern:s.wordPattern}}}class Ct{constructor(e,t){this._documents=e,this._provider=t}async provideReferences(e,t,i,r){const n=this._documents.getDocument(e),s=P.Ly.to(t),o=await this._provider.provideReferences(n,s,i,r);if(Array.isArray(o))return o.map(P.xh.from)}}class St{static{this._maxCodeActionsPerFile=1e3}constructor(e,t,i,r,n,s,o){this._documents=e,this._commands=t,this._diagnostics=i,this._provider=r,this._logService=n,this._extension=s,this._apiDeprecation=o,this._cache=new ve("CodeAction"),this._disposables=new Map}async provideCodeActions(e,t,i,r){const n=this._documents.getDocument(e),s=ct.Y.isISelection(t)?P.Y1.to(t):P.e6.to(t),a=[];for(const t of this._diagnostics.getDiagnostics(e))if(s.intersection(t.range)){if(a.push(t)>St._maxCodeActionsPerFile)break}const c={diagnostics:a,only:i.only?new x.yNd(i.only):void 0,triggerKind:P.CD.to(i.trigger)},l=await this._provider.provideCodeActions(n,s,c,r);if(!(0,S.Of)(l)||r.isCancellationRequested)return;const d=this._cache.add(l),u=new o.SL;this._disposables.set(d,u);const h=[];for(let e=0;e<l.length;e++){const t=l[e];if(t)if(St._isCommand(t))this._apiDeprecation.report("CodeActionProvider.provideCodeActions - return commands",this._extension,"Return 'CodeAction' instances instead."),h.push({_isSynthetic:!0,title:t.title,command:this._commands.toInternal(t,u)});else{c.only&&(t.kind?c.only.contains(t.kind)||this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value} 'requested but returned code action is of kind '${t.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value} 'requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const i=t.ranges??[];h.push({cacheId:[d,e],title:t.title,command:t.command&&this._commands.toInternal(t.command,u),diagnostics:t.diagnostics&&t.diagnostics.map(P.R9.from),edit:t.edit&&P.Db.from(t.edit,void 0),kind:t.kind&&t.kind.value,isPreferred:t.isPreferred,isAI:!!(0,j.$x)(this._extension,"codeActionAI")&&t.isAI,ranges:(0,j.$x)(this._extension,"codeActionRanges")?(0,S.kX)(i.map(P.e6.from)):void 0,disabled:t.disabled?.reason})}}return{cacheId:d,actions:h}}async resolveCodeAction(e,t){const[i,r]=e,n=this._cache.get(i,r);if(!n||St._isCommand(n))return{};if(!this._provider.resolveCodeAction)return{};const s=await this._provider.resolveCodeAction(n,t)??n;let o,a;if(s.edit&&(o=P.Db.from(s.edit,void 0)),s.command){const e=this._disposables.get(i);e&&(a=this._commands.toInternal(s.command,e))}return{edit:o,command:a}}releaseCodeActions(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}static _isCommand(e){return"string"==typeof e.command&&"string"==typeof e.title}}class Et{constructor(e,t,i,r,n){this._proxy=e,this._documents=t,this._provider=i,this._handle=r,this._extension=n,this._cache=new ve("DocumentPasteEdit")}async prepareDocumentPaste(e,t,i,r){if(!this._provider.prepareDocumentPaste)return;const s=this._documents.getDocument(e),o=t.map((e=>P.e6.to(e))),a=P.tn.toDataTransfer(i,(()=>{throw new n.nj}));if(await this._provider.prepareDocumentPaste(s,o,a,r),r.isCancellationRequested)return;const c=Array.from(a).filter((([,e])=>!(e instanceof x.qDr)));return P.tn.from(c)}async providePasteEdits(e,t,i,r,n,s){if(!this._provider.provideDocumentPasteEdits)return[];const o=this._documents.getDocument(t),a=i.map((e=>P.e6.to(e))),c=P.tn.toDataTransfer(r,(async t=>(await this._proxy.$resolvePasteFileData(this._handle,e,t)).buffer)),l=await this._provider.provideDocumentPasteEdits(o,a,c,{only:n.only?new x.MXZ(n.only):void 0,triggerKind:n.triggerKind},s);if(!l||s.isCancellationRequested)return[];const d=this._cache.add(l);return l.map(((e,t)=>({_cacheId:[d,t],title:e.title??(0,De.C$)(lt,0,"Paste using '{0}' extension",this._extension.displayName||this._extension.name),kind:e.kind,yieldTo:e.yieldTo?.map((e=>e.value)),insertText:"string"==typeof e.insertText?e.insertText:{snippet:e.insertText.value},additionalEdit:e.additionalEdit?P.Db.from(e.additionalEdit,void 0):void 0})))}async resolvePasteEdit(e,t){const[i,r]=e,n=this._cache.get(i,r);if(!n||!this._provider.resolveDocumentPasteEdit)return{};const s=await this._provider.resolveDocumentPasteEdit(n,t)??n;return{additionalEdit:s.additionalEdit?P.Db.from(s.additionalEdit,void 0):void 0}}releasePasteEdits(e){this._cache.delete(e)}}class Dt{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentFormattingEdits(e,t,i){const r=this._documents.getDocument(e),n=await this._provider.provideDocumentFormattingEdits(r,t,i);if(Array.isArray(n))return n.map(P.PY.from)}}class kt{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeFormattingEdits(e,t,i,r){const n=this._documents.getDocument(e),s=P.e6.to(t),o=await this._provider.provideDocumentRangeFormattingEdits(n,s,i,r);if(Array.isArray(o))return o.map(P.PY.from)}async provideDocumentRangesFormattingEdits(e,t,i,r){(0,V.p_)("function"==typeof this._provider.provideDocumentRangesFormattingEdits,"INVALID invocation of `provideDocumentRangesFormattingEdits`");const n=this._documents.getDocument(e),s=t.map(P.e6.to),o=await this._provider.provideDocumentRangesFormattingEdits(n,s,i,r);if(Array.isArray(o))return o.map(P.PY.from)}}class It{constructor(e,t){this._documents=e,this._provider=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,i,r,n){const s=this._documents.getDocument(e),o=P.Ly.to(t),a=await this._provider.provideOnTypeFormattingEdits(s,o,i,r,n);if(Array.isArray(a))return a.map(P.PY.from)}}class Pt{constructor(e,t){this._provider=e,this._logService=t,this._cache=new ve("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const i=await this._provider.provideWorkspaceSymbols(e,t);if(!(0,S.Of)(i))return{symbols:[]};const r=this._cache.add(i),n={cacheId:r,symbols:[]};for(let e=0;e<i.length;e++){const t=i[e];t&&t.name?n.symbols.push({...P.$P.from(t),cacheId:[r,e]}):this._logService.warn("INVALID SymbolInformation",t)}return n}async resolveWorkspaceSymbol(e,t){if("function"!=typeof this._provider.resolveWorkspaceSymbol)return e;if(!e.cacheId)return e;const i=this._cache.get(...e.cacheId);if(i){const r=await this._provider.resolveWorkspaceSymbol(i,t);return r&&(0,ce.jB)(e,P.$P.from(r),!0)}}releaseWorkspaceSymbols(e){this._cache.delete(e)}}class Tt{static supportsResolving(e){return"function"==typeof e.prepareRename}constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideRenameEdits(e,t,i,r){const n=this._documents.getDocument(e),s=P.Ly.to(t);try{const e=await this._provider.provideRenameEdits(n,s,i,r);if(!e)return;return P.Db.from(e)}catch(e){const t=Tt._asMessage(e);return t?{rejectReason:t,edits:void 0}:Promise.reject(e)}}async resolveRenameLocation(e,t,i){if("function"!=typeof this._provider.prepareRename)return Promise.resolve(void 0);const r=this._documents.getDocument(e),n=P.Ly.to(t);try{const e=await this._provider.prepareRename(r,n,i);let t,s;if(x.e6w.isRange(e)?(t=e,s=r.getText(e)):(0,V.Kn)(e)&&(t=e.range,s=e.placeholder),!t||!s)return;return t.start.line>n.line||t.end.line<n.line?void this._logService.warn("INVALID rename location: position line must be within range start/end lines"):{range:P.e6.from(t),text:s}}catch(e){const t=Tt._asMessage(e);return t?{rejectReason:t,range:void 0,text:void 0}:Promise.reject(e)}}static _asMessage(e){return"string"==typeof e?e:e instanceof Error&&"string"==typeof e.message?e.message:void 0}}class At{static{this.languageTriggerKindToVSCodeTriggerKind={[E.Ll.Invoke]:x.Llw.Invoke,[E.Ll.Automatic]:x.Llw.Automatic}}constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async supportsAutomaticNewSymbolNamesTriggerKind(){return this._provider.supportsAutomaticTriggerKind}async provideNewSymbolNames(e,t,i,r){const n=this._documents.getDocument(e),s=P.e6.to(t);try{const e=At.languageTriggerKindToVSCodeTriggerKind[i],t=await this._provider.provideNewSymbolNames(n,s,e,r);if(!t)return;return t.map((e=>"string"==typeof e?{newSymbolName:e}:{newSymbolName:e.newSymbolName,tags:e.tags}))}catch(e){return void this._logService.error(At._asMessage(e)??JSON.stringify(e,null,"\t"))}}static _asMessage(e){return"string"==typeof e?e:e instanceof Error&&"string"==typeof e.message?e.message:void 0}}class Rt{constructor(e,t){this.resultId=e,this.tokens=t}}class $t{constructor(e,t){this._documents=e,this._provider=t,this._nextResultId=1,this._previousResults=new Map}async provideDocumentSemanticTokens(e,t,i){const r=this._documents.getDocument(e),n=0!==t?this._previousResults.get(t):null;let s="string"==typeof n?.resultId&&"function"==typeof this._provider.provideDocumentSemanticTokensEdits?await this._provider.provideDocumentSemanticTokensEdits(r,n.resultId,i):await this._provider.provideDocumentSemanticTokens(r,i);return n&&this._previousResults.delete(t),s?(s=$t._fixProvidedSemanticTokens(s),this._send($t._convertToEdits(n,s),s)):null}async releaseDocumentSemanticColoring(e){this._previousResults.delete(e)}static _fixProvidedSemanticTokens(e){return $t._isSemanticTokens(e)?$t._isCorrectSemanticTokens(e)?e:new x.Uzh(new Uint32Array(e.data),e.resultId):$t._isSemanticTokensEdits(e)?$t._isCorrectSemanticTokensEdits(e)?e:new x.JQb(e.edits.map((e=>new x.FR$(e.start,e.deleteCount,e.data?new Uint32Array(e.data):e.data))),e.resultId):e}static _isSemanticTokens(e){return e&&!!e.data}static _isCorrectSemanticTokens(e){return e.data instanceof Uint32Array}static _isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}static _isCorrectSemanticTokensEdits(e){for(const t of e.edits)if(!(t.data instanceof Uint32Array))return!1;return!0}static _convertToEdits(e,t){if(!$t._isSemanticTokens(t))return t;if(!e||!e.tokens)return t;const i=e.tokens,r=i.length,n=t.data,s=n.length;let o=0;const a=Math.min(r,s);for(;o<a&&i[o]===n[o];)o++;if(o===r&&o===s)return new x.JQb([],t.resultId);let c=0;const l=a-o;for(;c<l&&i[r-c-1]===n[s-c-1];)c++;return new x.JQb([{start:o,deleteCount:r-o-c,data:n.subarray(o,s-c)}],t.resultId)}_send(e,t){if($t._isSemanticTokens(e)){const t=this._nextResultId++;return this._previousResults.set(t,new Rt(e.resultId,e.data)),(0,D.C)({id:t,type:"full",data:e.data})}if($t._isSemanticTokensEdits(e)){const i=this._nextResultId++;return $t._isSemanticTokens(t)?this._previousResults.set(i,new Rt(t.resultId,t.data)):this._previousResults.set(i,new Rt(e.resultId)),(0,D.C)({id:i,type:"delta",deltas:(e.edits||[]).map((e=>({start:e.start,deleteCount:e.deleteCount,data:e.data})))})}return null}}class Lt{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeSemanticTokens(e,t,i){const r=this._documents.getDocument(e),n=await this._provider.provideDocumentRangeSemanticTokens(r,P.e6.to(t),i);return n?this._send(n):null}_send(e){return(0,D.C)({id:0,type:"full",data:e.data})}}class Nt{static supportsResolving(e){return"function"==typeof e.resolveCompletionItem}constructor(e,t,i,r,n){this._documents=e,this._commands=t,this._provider=i,this._apiDeprecation=r,this._extension=n,this._cache=new ve("CompletionItem"),this._disposables=new Map}async provideCompletionItems(e,t,i,r){const n=this._documents.getDocument(e),s=P.Ly.to(t),a=n.getWordRangeAtPosition(s)||new x.e6w(s,s),c=a.with({end:s}),l=new W.G,d=await this._provider.provideCompletionItems(n,s,r,P.TK.to(i));if(!d)return;if(r.isCancellationRequested)return;const u=Array.isArray(d)?new x.Ub$(d):d,h=Nt.supportsResolving(this._provider)?this._cache.add(u.items):this._cache.add([]),p=new o.SL;this._disposables.set(h,p);const m=[],f={x:h,b:m,a:{replace:P.e6.from(a),insert:P.e6.from(c)},c:u.isIncomplete||void 0,d:l.elapsed()};for(let e=0;e<u.items.length;e++){const t=u.items[e],i=this._convertCompletionItem(t,[h,e],c,a);m.push(i)}return f}async resolveCompletionItem(e,t){if("function"!=typeof this._provider.resolveCompletionItem)return;const i=this._cache.get(...e);if(!i)return;const r=this._convertCompletionItem(i,e),n=await this._provider.resolveCompletionItem(i,t);if(!n)return;const s=this._convertCompletionItem(n,e);return r.h===s.h&&r.i===s.i||this._apiDeprecation.report("CompletionItem.insertText",this._extension,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),r.n===s.n&&r.o===s.o&&(0,ce.fS)(r.p,s.p)||this._apiDeprecation.report("CompletionItem.command",this._extension,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...r,d:s.d,c:s.c,l:s.l,h:s.h,i:s.i,n:s.n,o:s.o,p:s.p}}releaseCompletionItems(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}_convertCompletionItem(e,t,i,r){const n=this._disposables.get(t[0]);if(!n)throw Error("DisposableStore is missing...");const s=this._commands.toInternal(e.command,n),o={x:t,a:e.label,b:void 0!==e.kind?P.cm.from(e.kind):void 0,m:e.tags&&e.tags.map(P.we.from),c:e.detail,d:void 0===e.documentation?void 0:P.W5.fromStrict(e.documentation),e:e.sortText!==e.label?e.sortText:void 0,f:e.filterText!==e.label?e.filterText:void 0,g:e.preselect||void 0,i:e.keepWhitespace?1:0,k:e.commitCharacters?.join(""),l:e.additionalTextEdits&&e.additionalTextEdits.map(P.PY.from),n:s?.$ident,o:s?.id,p:s?.$ident?void 0:s?.arguments};let a;return e.textEdit?(this._apiDeprecation.report("CompletionItem.textEdit",this._extension,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),o.h=e.textEdit.newText):"string"==typeof e.insertText?o.h=e.insertText:e.insertText instanceof x.EG5&&(o.h=e.insertText.value,o.i|=4),e.textEdit?a=e.textEdit.range:e.range&&(a=e.range),x.e6w.isRange(a)?o.j=P.e6.from(a):!a||i?.isEqual(a.inserting)&&r?.isEqual(a.replacing)||(o.j={insert:P.e6.from(a.inserting),replace:P.e6.from(a.replacing)}),o}}class zt{async provideInlineCompletions(e,t,i,r){}disposeCompletions(e){}handleDidShowCompletionItem(e,t,i){}handlePartialAccept(e,t,i,r){}}class Ft extends zt{constructor(e,t,i,r){super(),this._extension=e,this._documents=t,this._provider=i,this._commands=r,this._references=new Ot,this._isAdditionsProposedApiEnabled=(0,j.$x)(this._extension,"inlineCompletionsAdditions"),this.languageTriggerKindToVSCodeTriggerKind={[E.bw.Automatic]:x.bwv.Automatic,[E.bw.Explicit]:x.bwv.Invoke}}get supportsHandleEvents(){return(0,j.$x)(this._extension,"inlineCompletionsAdditions")&&("function"==typeof this._provider.handleDidShowCompletionItem||"function"==typeof this._provider.handleDidPartiallyAcceptCompletionItem)}async provideInlineCompletions(e,t,i,r){const n=this._documents.getDocument(e),s=P.Ly.to(t),a=await this._provider.provideInlineCompletionItems(n,s,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:P.e6.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[i.triggerKind]},r);if(!a)return;if(r.isCancellationRequested)return;const c=Array.isArray(a)?a:a.items,l=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[],d=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let u;return{pid:this._references.createReferenceId({dispose(){u?.dispose()},items:c}),items:c.map(((e,t)=>{let i;e.command&&(u||(u=new o.SL),i=this._commands.toInternal(e.command,u));const r=e.insertText;return{insertText:"string"==typeof r?r:{snippet:r.value},filterText:e.filterText,range:e.range?P.e6.from(e.range):void 0,command:i,idx:t,completeBracketPairs:!!this._isAdditionsProposedApiEnabled&&e.completeBracketPairs}})),commands:l.map((e=>(u||(u=new o.SL),this._commands.toInternal(e,u)))),suppressSuggestions:!1,enableForwardStability:d}}disposeCompletions(e){const t=this._references.disposeReferenceId(e);t?.dispose()}handleDidShowCompletionItem(e,t,i){const r=this._references.get(e)?.items[t];r&&this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidShowCompletionItem(r,i)}handlePartialAccept(e,t,i,r){const n=this._references.get(e)?.items[t];n&&this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled&&(this._provider.handleDidPartiallyAcceptCompletionItem(n,i),this._provider.handleDidPartiallyAcceptCompletionItem(n,P.hI.to(r)))}}class Mt{async provideInlineEdits(e,t,i){const r=this._documents.getDocument(e),n=await this._provider.provideInlineEdit(r,{triggerKind:this.languageTriggerKindToVSCodeTriggerKind[t.triggerKind]},i);if(!n)return;if(i.isCancellationRequested)return;let s;const a=this._references.createReferenceId({dispose(){s?.dispose()},item:n});let c,l;n.accepted&&(s||(s=new o.SL),c=this._commands.toInternal(n.accepted,s)),n.rejected&&(s||(s=new o.SL),l=this._commands.toInternal(n.rejected,s));return{pid:a,text:n.text,range:P.e6.from(n.range),accepted:c,rejected:l}}disposeEdit(e){const t=this._references.disposeReferenceId(e);t?.dispose()}constructor(e,t,i,r){this._documents=t,this._provider=i,this._commands=r,this._references=new Ot,this.languageTriggerKindToVSCodeTriggerKind={[E.rn.Automatic]:x.rnR.Automatic,[E.rn.Invoke]:x.rnR.Invoke}}}class Ot{constructor(){this._references=new Map,this._idPool=1}createReferenceId(e){const t=this._idPool++;return this._references.set(t,e),t}disposeReferenceId(e){const t=this._references.get(e);return this._references.delete(e),t}get(e){return this._references.get(e)}}class Ht{constructor(e,t){this._documents=e,this._provider=t,this._cache=new ve("SignatureHelp")}async provideSignatureHelp(e,t,i,r){const n=this._documents.getDocument(e),s=P.Ly.to(t),o=this.reviveContext(i),a=await this._provider.provideSignatureHelp(n,s,r,o);if(a){const e=this._cache.add([a]);return{...P.vy.from(a),id:e}}}reviveContext(e){let t;if(e.activeSignatureHelp){const i=P.vy.to(e.activeSignatureHelp),r=this._cache.get(e.activeSignatureHelp.id,0);r?(t=r,t.activeSignature=i.activeSignature,t.activeParameter=i.activeParameter):t=i}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this._cache.delete(e)}}class Ut{constructor(e,t,i,r,n){this._documents=e,this._commands=t,this._provider=i,this._logService=r,this._extension=n,this._cache=new ve("InlayHints"),this._disposables=new Map}async provideInlayHints(e,t,i){const r=this._documents.getDocument(e),n=P.e6.to(t),s=await this._provider.provideInlayHints(r,n,i);if(!Array.isArray(s)||0===s.length)return void this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`);if(i.isCancellationRequested)return;const a=this._cache.add(s);this._disposables.set(a,new o.SL);const c={hints:[],cacheId:a};for(let e=0;e<s.length;e++)this._isValidInlayHint(s[e],n)&&c.hints.push(this._convertInlayHint(s[e],[a,e]));return this._logService.trace(`[InlayHints] ${c.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`),c}async resolveInlayHint(e,t){if("function"!=typeof this._provider.resolveInlayHint)return;const i=this._cache.get(...e);if(!i)return;const r=await this._provider.resolveInlayHint(i,t);return r&&this._isValidInlayHint(r)?this._convertInlayHint(r,e):void 0}releaseHints(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}_isValidInlayHint(e,t){return 0===e.label.length||Array.isArray(e.label)&&e.label.every((e=>0===e.value.length))?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}_convertInlayHint(e,t){const i=this._disposables.get(t[0]);if(!i)throw Error("DisposableStore is missing...");const r={label:"",cacheId:t,tooltip:P.W5.fromStrict(e.tooltip),position:P.Ly.from(e.position),textEdits:e.textEdits&&e.textEdits.map(P.PY.from),kind:e.kind&&P.gl.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if("string"==typeof e.label)r.label=e.label;else{const t=[];r.label=t;for(const r of e.label){if(!r.value){console.warn("INVALID inlay hint, empty label part",this._extension.identifier.value);continue}const e={label:r.value,tooltip:P.W5.fromStrict(r.tooltip)};x.YeX.isLocation(r.location)&&(e.location=P.xh.from(r.location)),r.command&&(e.command=this._commands.toInternal(r.command,i)),t.push(e)}}return r}}class Bt{constructor(e,t){this._documents=e,this._provider=t,this._cache=new ve("DocumentLink")}async provideLinks(e,t){const i=this._documents.getDocument(e),r=await this._provider.provideDocumentLinks(i,t);if(Array.isArray(r)&&0!==r.length&&!t.isCancellationRequested){if("function"!=typeof this._provider.resolveDocumentLink)return{links:r.filter(Bt._validateLink).map(P.jW.from)};{const e=this._cache.add(r),t={links:[],cacheId:e};for(let i=0;i<r.length;i++){if(!Bt._validateLink(r[i]))continue;const n=P.jW.from(r[i]);n.cacheId=[e,i],t.links.push(n)}return t}}}static _validateLink(e){return!(e.target&&e.target.path.length>5e4)||(console.warn("DROPPING link because it is too long"),!1)}async resolveLink(e,t){if("function"!=typeof this._provider.resolveDocumentLink)return;const i=this._cache.get(...e);if(!i)return;const r=await this._provider.resolveDocumentLink(i,t);return r&&Bt._validateLink(r)?P.jW.from(r):void 0}releaseLinks(e){this._cache.delete(e)}}class Wt{constructor(e,t){this._documents=e,this._provider=t}async provideColors(e,t){const i=this._documents.getDocument(e),r=await this._provider.provideDocumentColors(i,t);if(!Array.isArray(r))return[];return r.map((e=>({color:P.Il.from(e.color),range:P.e6.from(e.range)})))}async provideColorPresentations(e,t,i){const r=this._documents.getDocument(e),n=P.e6.to(t.range),s=P.Il.to(t.color),o=await this._provider.provideColorPresentations(s,{document:r,range:n},i);if(Array.isArray(o))return o.map(P.oi.from)}}class Vt{constructor(e,t){this._documents=e,this._provider=t}async provideFoldingRanges(e,t,i){const r=this._documents.getDocument(e),n=await this._provider.provideFoldingRanges(r,t,i);if(Array.isArray(n))return n.map(P.so.from)}}class qt{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideSelectionRanges(e,t,i){const r=this._documents.getDocument(e),n=t.map(P.Ly.to),s=await this._provider.provideSelectionRanges(r,n,i);if(!(0,S.Of)(s))return[];if(s.length!==n.length)return this._logService.warn("BAD selection ranges, provider must return ranges for each position"),[];const o=[];for(let e=0;e<n.length;e++){const t=[];o.push(t);let i=n[e],r=s[e];for(;;){if(!r.range.contains(i))throw new Error("INVALID selection range, must contain the previous range");if(t.push(P.xm.from(r)),!r.parent)break;i=r.range,r=r.parent}}return o}}class jt{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new ot.R(""),this._cache=new Map}async prepareSession(e,t,i){const r=this._documents.getDocument(e),n=P.Ly.to(t),s=await this._provider.prepareCallHierarchy(r,n,i);if(!s)return;const o=this._idPool.nextId();return this._cache.set(o,new Map),Array.isArray(s)?s.map((e=>this._cacheAndConvertItem(o,e))):[this._cacheAndConvertItem(o,s)]}async provideCallsTo(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing call hierarchy item");const n=await this._provider.provideCallHierarchyIncomingCalls(r,i);if(n)return n.map((t=>({from:this._cacheAndConvertItem(e,t.from),fromRanges:t.fromRanges.map((e=>P.e6.from(e)))})))}async provideCallsFrom(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing call hierarchy item");const n=await this._provider.provideCallHierarchyOutgoingCalls(r,i);if(n)return n.map((t=>({to:this._cacheAndConvertItem(e,t.to),fromRanges:t.fromRanges.map((e=>P.e6.from(e)))})))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),r=P.ll.from(t,e,i.size.toString(36));return i.set(r._itemId,t),r}_itemFromCache(e,t){const i=this._cache.get(e);return i?.get(t)}}class Kt{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new ot.R(""),this._cache=new Map}async prepareSession(e,t,i){const r=this._documents.getDocument(e),n=P.Ly.to(t),s=await this._provider.prepareTypeHierarchy(r,n,i);if(!s)return;const o=this._idPool.nextId();return this._cache.set(o,new Map),Array.isArray(s)?s.map((e=>this._cacheAndConvertItem(o,e))):[this._cacheAndConvertItem(o,s)]}async provideSupertypes(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing type hierarchy item");const n=await this._provider.provideTypeHierarchySupertypes(r,i);if(n)return n.map((t=>this._cacheAndConvertItem(e,t)))}async provideSubtypes(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing type hierarchy item");const n=await this._provider.provideTypeHierarchySubtypes(r,i);if(n)return n.map((t=>this._cacheAndConvertItem(e,t)))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),r=P.fQ.from(t,e,i.size.toString(36));return i.set(r._itemId,t),r}_itemFromCache(e,t){const i=this._cache.get(e);return i?.get(t)}}class Qt{constructor(e,t,i,r,n){this._proxy=e,this._documents=t,this._provider=i,this._handle=r,this._extension=n,this._cache=new ve("DocumentDropEdit")}async provideDocumentOnDropEdits(e,t,i,r,n){const s=this._documents.getDocument(t),o=P.Ly.to(i),a=P.tn.toDataTransfer(r,(async t=>(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,t)).buffer)),c=await this._provider.provideDocumentDropEdits(s,o,a,n);if(!c)return;const l=(0,S._2)(c),d=this._cache.add(l);return l.map(((e,t)=>({_cacheId:[d,t],title:e.title??(0,De.C$)(lt,1,"Drop using '{0}' extension",this._extension.displayName||this._extension.name),kind:e.kind?.value,yieldTo:e.yieldTo?.map((e=>e.value)),insertText:"string"==typeof e.insertText?e.insertText:{snippet:e.insertText.value},additionalEdit:e.additionalEdit?P.Db.from(e.additionalEdit,void 0):void 0})))}async resolveDropEdit(e,t){const[i,r]=e,n=this._cache.get(i,r);if(!n||!this._provider.resolveDocumentDropEdit)return{};const s=await this._provider.resolveDocumentDropEdit(n,t)??n;return{additionalEdit:s.additionalEdit?P.Db.from(s.additionalEdit,void 0):void 0}}releaseDropEdits(e){this._cache.delete(e)}}class Gt{constructor(e,t){this._documents=e,this._provider=t}async provideMappedEdits(e,t,i,r){const n=l.ov.revive(e),s=this._documents.getDocument(n),o=i.documents.map((e=>e.map((e=>({uri:l.ov.revive(e.uri),version:e.version,ranges:e.ranges.map((e=>P.e6.to(e)))}))))),a={documents:o,selections:o[0]?.[0]?.ranges??[]},c=await this._provider.provideMappedEdits(s,t,a,r);return c?P.Db.from(c):null}}class Jt{constructor(e,t){this.adapter=e,this.extension=t}}class Yt{static{this._handlePool=0}constructor(e,t,i,r,n,s,o,a){this._uriTransformer=t,this._documents=i,this._commands=r,this._diagnostics=n,this._logService=s,this._apiDeprecation=o,this._extensionTelemetry=a,this._adapter=new Map,this._proxy=e.getProxy(y.Tr.MainThreadLanguageFeatures)}_transformDocumentSelector(e,t){return P.Lq.from(e,this._uriTransformer,t)}_createDisposable(e){return new x.JTr((()=>{this._adapter.delete(e),this._proxy.$unregister(e)}))}_nextHandle(){return Yt._handlePool++}async _withAdapter(e,t,i,s,o,a=!1){const c=this._adapter.get(e);if(!(c&&c.adapter instanceof t))return s;const l=Date.now();a||this._logService.trace(`[${c.extension.identifier.value}] INVOKE provider '${i.toString().replace(/[\r\n]/g,"")}'`);const d=i(c.adapter,c.extension);return Promise.resolve(d).catch((e=>{(0,n.n2)(e)||(this._logService.error(`[${c.extension.identifier.value}] provider FAILED`),this._logService.error(e),this._extensionTelemetry.onExtensionError(c.extension.identifier,e))})).finally((()=>{a||this._logService.trace(`[${c.extension.identifier.value}] provider DONE after ${Date.now()-l}ms`)})),r.Ts.isCancellationToken(o)?(0,H.k0)(d,o):d}_addNewAdapter(e,t){const i=this._nextHandle();return this._adapter.set(i,new Jt(e,t)),i}static _extLabel(e){return e.displayName||e.name}registerDocumentSymbolProvider(e,t,i,r){const n=this._addNewAdapter(new dt(this._documents,i),e),s=r&&r.label||Yt._extLabel(e);return this._proxy.$registerDocumentSymbolProvider(n,this._transformDocumentSelector(t,e),s),this._createDisposable(n)}$provideDocumentSymbols(e,t,i){return this._withAdapter(e,dt,(e=>e.provideDocumentSymbols(l.ov.revive(t),i)),void 0,i)}registerCodeLensProvider(e,t,i){const r=this._nextHandle(),n="function"==typeof i.onDidChangeCodeLenses?this._nextHandle():void 0;this._adapter.set(r,new Jt(new ut(this._documents,this._commands.converter,i,e,this._extensionTelemetry,this._logService),e)),this._proxy.$registerCodeLensSupport(r,this._transformDocumentSelector(t,e),n);let s=this._createDisposable(r);if(void 0!==n){const e=i.onDidChangeCodeLenses((e=>this._proxy.$emitCodeLensEvent(n)));s=x.JTr.from(s,e)}return s}$provideCodeLenses(e,t,i){return this._withAdapter(e,ut,(e=>e.provideCodeLenses(l.ov.revive(t),i)),void 0,i)}$resolveCodeLens(e,t,i){return this._withAdapter(e,ut,(e=>e.resolveCodeLens(t,i)),void 0,void 0)}$releaseCodeLenses(e,t){this._withAdapter(e,ut,(e=>Promise.resolve(e.releaseCodeLenses(t))),void 0,void 0)}registerDefinitionProvider(e,t,i){const r=this._addNewAdapter(new pt(this._documents,i),e);return this._proxy.$registerDefinitionSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDefinition(e,t,i,r){return this._withAdapter(e,pt,(e=>e.provideDefinition(l.ov.revive(t),i,r)),[],r)}registerDeclarationProvider(e,t,i){const r=this._addNewAdapter(new mt(this._documents,i),e);return this._proxy.$registerDeclarationSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDeclaration(e,t,i,r){return this._withAdapter(e,mt,(e=>e.provideDeclaration(l.ov.revive(t),i,r)),[],r)}registerImplementationProvider(e,t,i){const r=this._addNewAdapter(new ft(this._documents,i),e);return this._proxy.$registerImplementationSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideImplementation(e,t,i,r){return this._withAdapter(e,ft,(e=>e.provideImplementation(l.ov.revive(t),i,r)),[],r)}registerTypeDefinitionProvider(e,t,i){const r=this._addNewAdapter(new gt(this._documents,i),e);return this._proxy.$registerTypeDefinitionSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideTypeDefinition(e,t,i,r){return this._withAdapter(e,gt,(e=>e.provideTypeDefinition(l.ov.revive(t),i,r)),[],r)}registerHoverProvider(e,t,i,r){const n=this._addNewAdapter(new vt(this._documents,i),e);return this._proxy.$registerHoverProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideHover(e,t,i,r,n){return this._withAdapter(e,vt,(e=>e.provideHover(l.ov.revive(t),i,r,n)),void 0,n)}$releaseHover(e,t){this._withAdapter(e,vt,(e=>Promise.resolve(e.releaseHover(t))),void 0,void 0)}registerEvaluatableExpressionProvider(e,t,i,r){const n=this._addNewAdapter(new _t(this._documents,i),e);return this._proxy.$registerEvaluatableExpressionProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideEvaluatableExpression(e,t,i,r){return this._withAdapter(e,_t,(e=>e.provideEvaluatableExpression(l.ov.revive(t),i,r)),void 0,r)}registerInlineValuesProvider(e,t,i,r){const n="function"==typeof i.onDidChangeInlineValues?this._nextHandle():void 0,s=this._addNewAdapter(new bt(this._documents,i),e);this._proxy.$registerInlineValuesProvider(s,this._transformDocumentSelector(t,e),n);let o=this._createDisposable(s);if(void 0!==n){const e=i.onDidChangeInlineValues((e=>this._proxy.$emitInlineValuesEvent(n)));o=x.JTr.from(o,e)}return o}$provideInlineValues(e,t,i,r,n){return this._withAdapter(e,bt,(e=>e.provideInlineValues(l.ov.revive(t),i,r,n)),void 0,n)}registerDocumentHighlightProvider(e,t,i){const r=this._addNewAdapter(new wt(this._documents,i),e);return this._proxy.$registerDocumentHighlightProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}registerMultiDocumentHighlightProvider(e,t,i){const r=this._addNewAdapter(new yt(this._documents,i),e);return this._proxy.$registerMultiDocumentHighlightProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDocumentHighlights(e,t,i,r){return this._withAdapter(e,wt,(e=>e.provideDocumentHighlights(l.ov.revive(t),i,r)),void 0,r)}$provideMultiDocumentHighlights(e,t,i,r,n){return this._withAdapter(e,yt,(e=>e.provideMultiDocumentHighlights(l.ov.revive(t),i,r.map((e=>l.ov.revive(e))),n)),void 0,n)}registerLinkedEditingRangeProvider(e,t,i){const r=this._addNewAdapter(new xt(this._documents,i),e);return this._proxy.$registerLinkedEditingRangeProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideLinkedEditingRanges(e,t,i,r){return this._withAdapter(e,xt,(async e=>{const n=await e.provideLinkedEditingRanges(l.ov.revive(t),i,r);if(n)return{ranges:n.ranges,wordPattern:n.wordPattern?Yt._serializeRegExp(n.wordPattern):void 0}}),void 0,r)}registerReferenceProvider(e,t,i){const r=this._addNewAdapter(new Ct(this._documents,i),e);return this._proxy.$registerReferenceSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideReferences(e,t,i,r,n){return this._withAdapter(e,Ct,(e=>e.provideReferences(l.ov.revive(t),i,r,n)),void 0,n)}registerCodeActionProvider(e,t,i,r){const n=new o.SL,s=this._addNewAdapter(new St(this._documents,this._commands.converter,this._diagnostics,i,this._logService,e,this._apiDeprecation),e);return this._proxy.$registerQuickFixSupport(s,this._transformDocumentSelector(t,e),{providedKinds:r?.providedCodeActionKinds?.map((e=>e.value)),documentation:r?.documentation?.map((e=>({kind:e.kind.value,command:this._commands.converter.toInternal(e.command,n)})))},Yt._extLabel(e),Boolean(i.resolveCodeAction)),n.add(this._createDisposable(s)),n}$provideCodeActions(e,t,i,r,n){return this._withAdapter(e,St,(e=>e.provideCodeActions(l.ov.revive(t),i,r,n)),void 0,n)}$resolveCodeAction(e,t,i){return this._withAdapter(e,St,(e=>e.resolveCodeAction(t,i)),{},void 0)}$releaseCodeActions(e,t){this._withAdapter(e,St,(e=>Promise.resolve(e.releaseCodeActions(t))),void 0,void 0)}registerDocumentFormattingEditProvider(e,t,i){const r=this._addNewAdapter(new Dt(this._documents,i),e);return this._proxy.$registerDocumentFormattingSupport(r,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name),this._createDisposable(r)}$provideDocumentFormattingEdits(e,t,i,r){return this._withAdapter(e,Dt,(e=>e.provideDocumentFormattingEdits(l.ov.revive(t),i,r)),void 0,r)}registerDocumentRangeFormattingEditProvider(e,t,i){const r="function"==typeof i.provideDocumentRangesFormattingEdits,n=this._addNewAdapter(new kt(this._documents,i),e);return this._proxy.$registerRangeFormattingSupport(n,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name,r),this._createDisposable(n)}$provideDocumentRangeFormattingEdits(e,t,i,r,n){return this._withAdapter(e,kt,(e=>e.provideDocumentRangeFormattingEdits(l.ov.revive(t),i,r,n)),void 0,n)}$provideDocumentRangesFormattingEdits(e,t,i,r,n){return this._withAdapter(e,kt,(e=>e.provideDocumentRangesFormattingEdits(l.ov.revive(t),i,r,n)),void 0,n)}registerOnTypeFormattingEditProvider(e,t,i,r){const n=this._addNewAdapter(new It(this._documents,i),e);return this._proxy.$registerOnTypeFormattingSupport(n,this._transformDocumentSelector(t,e),r,e.identifier),this._createDisposable(n)}$provideOnTypeFormattingEdits(e,t,i,r,n,s){return this._withAdapter(e,It,(e=>e.provideOnTypeFormattingEdits(l.ov.revive(t),i,r,n,s)),void 0,s)}registerWorkspaceSymbolProvider(e,t){const i=this._addNewAdapter(new Pt(t,this._logService),e);return this._proxy.$registerNavigateTypeSupport(i,"function"==typeof t.resolveWorkspaceSymbol),this._createDisposable(i)}$provideWorkspaceSymbols(e,t,i){return this._withAdapter(e,Pt,(e=>e.provideWorkspaceSymbols(t,i)),{symbols:[]},i)}$resolveWorkspaceSymbol(e,t,i){return this._withAdapter(e,Pt,(e=>e.resolveWorkspaceSymbol(t,i)),void 0,void 0)}$releaseWorkspaceSymbols(e,t){this._withAdapter(e,Pt,(e=>e.releaseWorkspaceSymbols(t)),void 0,void 0)}registerRenameProvider(e,t,i){const r=this._addNewAdapter(new Tt(this._documents,i,this._logService),e);return this._proxy.$registerRenameSupport(r,this._transformDocumentSelector(t,e),Tt.supportsResolving(i)),this._createDisposable(r)}$provideRenameEdits(e,t,i,r,n){return this._withAdapter(e,Tt,(e=>e.provideRenameEdits(l.ov.revive(t),i,r,n)),void 0,n)}$resolveRenameLocation(e,t,i,r){return this._withAdapter(e,Tt,(e=>e.resolveRenameLocation(l.ov.revive(t),i,r)),void 0,r)}registerNewSymbolNamesProvider(e,t,i){const r=this._addNewAdapter(new At(this._documents,i,this._logService),e);return this._proxy.$registerNewSymbolNamesProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$supportsAutomaticNewSymbolNamesTriggerKind(e){return this._withAdapter(e,At,(e=>e.supportsAutomaticNewSymbolNamesTriggerKind()),!1,void 0)}$provideNewSymbolNames(e,t,i,r,n){return this._withAdapter(e,At,(e=>e.provideNewSymbolNames(l.ov.revive(t),i,r,n)),void 0,n)}registerDocumentSemanticTokensProvider(e,t,i,r){const n=this._addNewAdapter(new $t(this._documents,i),e),s="function"==typeof i.onDidChangeSemanticTokens?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(n,this._transformDocumentSelector(t,e),r,s);let o=this._createDisposable(n);if(s){const e=i.onDidChangeSemanticTokens((e=>this._proxy.$emitDocumentSemanticTokensEvent(s)));o=x.JTr.from(o,e)}return o}$provideDocumentSemanticTokens(e,t,i,r){return this._withAdapter(e,$t,(e=>e.provideDocumentSemanticTokens(l.ov.revive(t),i,r)),null,r)}$releaseDocumentSemanticTokens(e,t){this._withAdapter(e,$t,(e=>e.releaseDocumentSemanticColoring(t)),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(e,t,i,r){const n=this._addNewAdapter(new Lt(this._documents,i),e);return this._proxy.$registerDocumentRangeSemanticTokensProvider(n,this._transformDocumentSelector(t,e),r),this._createDisposable(n)}$provideDocumentRangeSemanticTokens(e,t,i,r){return this._withAdapter(e,Lt,(e=>e.provideDocumentRangeSemanticTokens(l.ov.revive(t),i,r)),null,r)}registerCompletionItemProvider(e,t,i,r){const n=this._addNewAdapter(new Nt(this._documents,this._commands.converter,i,this._apiDeprecation,e),e);return this._proxy.$registerCompletionsProvider(n,this._transformDocumentSelector(t,e),r,Nt.supportsResolving(i),e.identifier),this._createDisposable(n)}$provideCompletionItems(e,t,i,r,n){return this._withAdapter(e,Nt,(e=>e.provideCompletionItems(l.ov.revive(t),i,r,n)),void 0,n)}$resolveCompletionItem(e,t,i){return this._withAdapter(e,Nt,(e=>e.resolveCompletionItem(t,i)),void 0,i)}$releaseCompletionItems(e,t){this._withAdapter(e,Nt,(e=>e.releaseCompletionItems(t)),void 0,void 0)}registerInlineCompletionsProvider(e,t,i,r){const n=new Ft(e,this._documents,i,this._commands.converter),s=this._addNewAdapter(n,e);return this._proxy.$registerInlineCompletionsSupport(s,this._transformDocumentSelector(t,e),n.supportsHandleEvents,m.kP.toKey(e.identifier.value),r?.yieldTo?.map((e=>m.kP.toKey(e)))||[]),this._createDisposable(s)}$provideInlineCompletions(e,t,i,r,n){return this._withAdapter(e,zt,(e=>e.provideInlineCompletions(l.ov.revive(t),i,r,n)),void 0,n)}$handleInlineCompletionDidShow(e,t,i,r){this._withAdapter(e,zt,(async e=>{e.handleDidShowCompletionItem(t,i,r)}),void 0,void 0)}$handleInlineCompletionPartialAccept(e,t,i,r,n){this._withAdapter(e,zt,(async e=>{e.handlePartialAccept(t,i,r,n)}),void 0,void 0)}$freeInlineCompletionsList(e,t){this._withAdapter(e,zt,(async e=>{e.disposeCompletions(t)}),void 0,void 0)}registerInlineEditProvider(e,t,i){const r=new Mt(e,this._documents,i,this._commands.converter),n=this._addNewAdapter(r,e);return this._proxy.$registerInlineEditProvider(n,this._transformDocumentSelector(t,e),e.identifier),this._createDisposable(n)}$provideInlineEdit(e,t,i,r){return this._withAdapter(e,Mt,(e=>e.provideInlineEdits(l.ov.revive(t),i,r)),void 0,r)}$freeInlineEdit(e,t){this._withAdapter(e,Mt,(async e=>{e.disposeEdit(t)}),void 0,void 0)}registerSignatureHelpProvider(e,t,i,r){const n=Array.isArray(r)?{triggerCharacters:r,retriggerCharacters:[]}:r,s=this._addNewAdapter(new Ht(this._documents,i),e);return this._proxy.$registerSignatureHelpProvider(s,this._transformDocumentSelector(t,e),n),this._createDisposable(s)}$provideSignatureHelp(e,t,i,r,n){return this._withAdapter(e,Ht,(e=>e.provideSignatureHelp(l.ov.revive(t),i,r,n)),void 0,n)}$releaseSignatureHelp(e,t){this._withAdapter(e,Ht,(e=>e.releaseSignatureHelp(t)),void 0,void 0)}registerInlayHintsProvider(e,t,i){const r="function"==typeof i.onDidChangeInlayHints?this._nextHandle():void 0,n=this._addNewAdapter(new Ut(this._documents,this._commands.converter,i,this._logService,e),e);this._proxy.$registerInlayHintsProvider(n,this._transformDocumentSelector(t,e),"function"==typeof i.resolveInlayHint,r,Yt._extLabel(e));let s=this._createDisposable(n);if(void 0!==r){const e=i.onDidChangeInlayHints((e=>this._proxy.$emitInlayHintsEvent(r)));s=x.JTr.from(s,e)}return s}$provideInlayHints(e,t,i,r){return this._withAdapter(e,Ut,(e=>e.provideInlayHints(l.ov.revive(t),i,r)),void 0,r)}$resolveInlayHint(e,t,i){return this._withAdapter(e,Ut,(e=>e.resolveInlayHint(t,i)),void 0,i)}$releaseInlayHints(e,t){this._withAdapter(e,Ut,(e=>e.releaseHints(t)),void 0,void 0)}registerDocumentLinkProvider(e,t,i){const r=this._addNewAdapter(new Bt(this._documents,i),e);return this._proxy.$registerDocumentLinkProvider(r,this._transformDocumentSelector(t,e),"function"==typeof i.resolveDocumentLink),this._createDisposable(r)}$provideDocumentLinks(e,t,i){return this._withAdapter(e,Bt,(e=>e.provideLinks(l.ov.revive(t),i)),void 0,i,"output"===t.scheme)}$resolveDocumentLink(e,t,i){return this._withAdapter(e,Bt,(e=>e.resolveLink(t,i)),void 0,void 0,!0)}$releaseDocumentLinks(e,t){this._withAdapter(e,Bt,(e=>e.releaseLinks(t)),void 0,void 0,!0)}registerColorProvider(e,t,i){const r=this._addNewAdapter(new Wt(this._documents,i),e);return this._proxy.$registerDocumentColorProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDocumentColors(e,t,i){return this._withAdapter(e,Wt,(e=>e.provideColors(l.ov.revive(t),i)),[],i)}$provideColorPresentations(e,t,i,r){return this._withAdapter(e,Wt,(e=>e.provideColorPresentations(l.ov.revive(t),i,r)),void 0,r)}registerFoldingRangeProvider(e,t,i){const r=this._nextHandle(),n="function"==typeof i.onDidChangeFoldingRanges?this._nextHandle():void 0;this._adapter.set(r,new Jt(new Vt(this._documents,i),e)),this._proxy.$registerFoldingRangeProvider(r,this._transformDocumentSelector(t,e),e.identifier,n);let s=this._createDisposable(r);if(void 0!==n){const e=i.onDidChangeFoldingRanges((()=>this._proxy.$emitFoldingRangeEvent(n)));s=x.JTr.from(s,e)}return s}$provideFoldingRanges(e,t,i,r){return this._withAdapter(e,Vt,(e=>e.provideFoldingRanges(l.ov.revive(t),i,r)),void 0,r)}registerSelectionRangeProvider(e,t,i){const r=this._addNewAdapter(new qt(this._documents,i,this._logService),e);return this._proxy.$registerSelectionRangeProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideSelectionRanges(e,t,i,r){return this._withAdapter(e,qt,(e=>e.provideSelectionRanges(l.ov.revive(t),i,r)),[],r)}registerCallHierarchyProvider(e,t,i){const r=this._addNewAdapter(new jt(this._documents,i),e);return this._proxy.$registerCallHierarchyProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$prepareCallHierarchy(e,t,i,r){return this._withAdapter(e,jt,(e=>Promise.resolve(e.prepareSession(l.ov.revive(t),i,r))),void 0,r)}$provideCallHierarchyIncomingCalls(e,t,i,r){return this._withAdapter(e,jt,(e=>e.provideCallsTo(t,i,r)),void 0,r)}$provideCallHierarchyOutgoingCalls(e,t,i,r){return this._withAdapter(e,jt,(e=>e.provideCallsFrom(t,i,r)),void 0,r)}$releaseCallHierarchy(e,t){this._withAdapter(e,jt,(e=>Promise.resolve(e.releaseSession(t))),void 0,void 0)}registerTypeHierarchyProvider(e,t,i){const r=this._addNewAdapter(new Kt(this._documents,i),e);return this._proxy.$registerTypeHierarchyProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$prepareTypeHierarchy(e,t,i,r){return this._withAdapter(e,Kt,(e=>Promise.resolve(e.prepareSession(l.ov.revive(t),i,r))),void 0,r)}$provideTypeHierarchySupertypes(e,t,i,r){return this._withAdapter(e,Kt,(e=>e.provideSupertypes(t,i,r)),void 0,r)}$provideTypeHierarchySubtypes(e,t,i,r){return this._withAdapter(e,Kt,(e=>e.provideSubtypes(t,i,r)),void 0,r)}$releaseTypeHierarchy(e,t){this._withAdapter(e,Kt,(e=>Promise.resolve(e.releaseSession(t))),void 0,void 0)}registerDocumentOnDropEditProvider(e,t,i,r){const n=this._nextHandle();return this._adapter.set(n,new Jt(new Qt(this._proxy,this._documents,i,n,e),e)),this._proxy.$registerDocumentOnDropEditProvider(n,this._transformDocumentSelector(t,e),(0,j.$x)(e,"documentPaste")&&r?{supportsResolve:!!i.resolveDocumentDropEdit,dropMimeTypes:r.dropMimeTypes}:void 0),this._createDisposable(n)}$provideDocumentOnDropEdits(e,t,i,r,n,s){return this._withAdapter(e,Qt,(e=>Promise.resolve(e.provideDocumentOnDropEdits(t,l.ov.revive(i),r,n,s))),void 0,void 0)}$resolveDropEdit(e,t,i){return this._withAdapter(e,Qt,(e=>e.resolveDropEdit(t,i)),{},void 0)}$releaseDropEdits(e,t){this._withAdapter(e,Qt,(e=>Promise.resolve(e.releaseDropEdits(t))),void 0,void 0)}registerMappedEditsProvider(e,t,i){const r=this._addNewAdapter(new Gt(this._documents,i),e);return this._proxy.$registerMappedEditsProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideMappedEdits(e,t,i,r,n){return this._withAdapter(e,Gt,(e=>Promise.resolve(e.provideMappedEdits(t,i,r,n))),null,n)}registerDocumentPasteEditProvider(e,t,i,r){const n=this._nextHandle();return this._adapter.set(n,new Jt(new Et(this._proxy,this._documents,i,n,e),e)),this._proxy.$registerPasteEditProvider(n,this._transformDocumentSelector(t,e),{supportsCopy:!!i.prepareDocumentPaste,supportsPaste:!!i.provideDocumentPasteEdits,supportsResolve:!!i.resolveDocumentPasteEdit,providedPasteEditKinds:r.providedPasteEditKinds?.map((e=>e.value)),copyMimeTypes:r.copyMimeTypes,pasteMimeTypes:r.pasteMimeTypes}),this._createDisposable(n)}$prepareDocumentPaste(e,t,i,r,n){return this._withAdapter(e,Et,(e=>e.prepareDocumentPaste(l.ov.revive(t),i,r,n)),void 0,n)}$providePasteEdits(e,t,i,r,n,s,o){return this._withAdapter(e,Et,(e=>e.providePasteEdits(t,l.ov.revive(i),r,n,s,o)),void 0,o)}$resolvePasteEdit(e,t,i){return this._withAdapter(e,Et,(e=>e.resolvePasteEdit(t,i)),{},void 0)}$releasePasteEdits(e,t){this._withAdapter(e,Et,(e=>Promise.resolve(e.releasePasteEdits(t))),void 0,void 0)}static _serializeRegExp(e){return{pattern:e.source,flags:e.flags}}static _serializeIndentationRule(e){return{decreaseIndentPattern:Yt._serializeRegExp(e.decreaseIndentPattern),increaseIndentPattern:Yt._serializeRegExp(e.increaseIndentPattern),indentNextLinePattern:e.indentNextLinePattern?Yt._serializeRegExp(e.indentNextLinePattern):void 0,unIndentedLinePattern:e.unIndentedLinePattern?Yt._serializeRegExp(e.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(e){return{beforeText:Yt._serializeRegExp(e.beforeText),afterText:e.afterText?Yt._serializeRegExp(e.afterText):void 0,previousLineText:e.previousLineText?Yt._serializeRegExp(e.previousLineText):void 0,action:e.action}}static _serializeOnEnterRules(e){return e.map(Yt._serializeOnEnterRule)}static _serializeAutoClosingPair(e){return{open:e.open,close:e.close,notIn:e.notIn?e.notIn.map((e=>x.wxO.toString(e))):void 0}}static _serializeAutoClosingPairs(e){return e.map(Yt._serializeAutoClosingPair)}setLanguageConfiguration(e,t,i){const{wordPattern:r}=i;if(r&&(0,$e.IO)(r))throw new Error(`Invalid language configuration: wordPattern '${r}' is not allowed to match the empty string.`);r?this._documents.setWordDefinitionFor(t,r):this._documents.setWordDefinitionFor(t,void 0),i.__electricCharacterSupport&&this._apiDeprecation.report("LanguageConfiguration.__electricCharacterSupport",e,"Do not use."),i.__characterPairSupport&&this._apiDeprecation.report("LanguageConfiguration.__characterPairSupport",e,"Do not use.");const n=this._nextHandle(),s={comments:i.comments,brackets:i.brackets,wordPattern:i.wordPattern?Yt._serializeRegExp(i.wordPattern):void 0,indentationRules:i.indentationRules?Yt._serializeIndentationRule(i.indentationRules):void 0,onEnterRules:i.onEnterRules?Yt._serializeOnEnterRules(i.onEnterRules):void 0,__electricCharacterSupport:i.__electricCharacterSupport,__characterPairSupport:i.__characterPairSupport,autoClosingPairs:i.autoClosingPairs?Yt._serializeAutoClosingPairs(i.autoClosingPairs):void 0};return this._proxy.$setLanguageConfiguration(n,t,s),this._createDisposable(n)}$setWordDefinitions(e){for(const t of e)this._documents.setWordDefinitionFor(t.languageId,new RegExp(t.regexSource,t.regexFlags))}}var Xt=i(76870);class Zt{constructor(e,t,i,r){this._documents=t,this._commands=i,this._uriTransformer=r,this._languageIds=[],this._handlePool=0,this._ids=new Set,this._proxy=e.getProxy(y.Tr.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,t){await this._proxy.$changeLanguage(e,t);const i=this._documents.getDocumentData(e);if(!i)throw new Error(`document '${e.toString()}' NOT found`);return i.document}async tokenAtPosition(e,t){const i=e.version,r=P.Ly.from(t),n=await this._proxy.$tokensAtPosition(e.uri,r),s={type:x.xJH.Other,range:e.getWordRangeAtPosition(t)??new x.e6w(t.line,t.character,t.line,t.character)};if(!n)return s;const o={range:P.e6.to(n.range),type:P.iv.to(n.type)};return o.range.contains(t)?i!==e.version?s:o:s}createLanguageStatusItem(e,t,i){const r=this._handlePool++,n=this._proxy,s=this._ids,a=`${e.identifier.value}/${t}`;if(s.has(a))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);s.add(a);const l={selector:i,id:t,name:e.displayName??e.name,severity:x.Rxm.Information,command:void 0,text:"",detail:"",busy:!1};let d;const u=new o.SL,h=()=>{d?.dispose(),s.has(a)?d=(0,H.Vg)((()=>{u.clear(),this._proxy.$setLanguageStatus(r,{id:a,name:l.name??e.displayName??e.name,source:e.displayName??e.name,selector:P.Lq.from(l.selector,this._uriTransformer),label:l.text,detail:l.detail??"",severity:l.severity===x.Rxm.Error?c.Z.Error:l.severity===x.Rxm.Warning?c.Z.Warning:c.Z.Info,command:l.command&&this._commands.toInternal(l.command,u),accessibilityInfo:l.accessibilityInformation,busy:l.busy})}),0):console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`)},p={dispose(){u.dispose(),d?.dispose(),n.$removeLanguageStatus(r),s.delete(a)},get id(){return l.id},get name(){return l.name},set name(e){l.name=e,h()},get selector(){return l.selector},set selector(e){l.selector=e,h()},get text(){return l.text},set text(e){l.text=e,h()},set text2(t){(0,j.H5)(e,"languageStatusText"),l.text=t,h()},get text2(){return(0,j.H5)(e,"languageStatusText"),l.text},get detail(){return l.detail},set detail(e){l.detail=e,h()},get severity(){return l.severity},set severity(e){l.severity=e,h()},get accessibilityInformation(){return l.accessibilityInformation},set accessibilityInformation(e){l.accessibilityInformation=e,h()},get command(){return l.command},set command(e){l.command=e,h()},get busy(){return l.busy},set busy(e){l.busy=e,h()}};return h(),p}}var ei=i(86540),ti=i(6263);let ii=class{constructor(e,t){this._logService=t,this._proxy=e.getProxy(y.Tr.MainThreadMessageService)}showMessage(e,t,i,r,n){const s={source:{identifier:e.identifier,label:e.displayName||e.name}};let o;var a;"string"==typeof r||(a=r)&&a.title?o=[r,...n]:(s.modal=r?.modal,s.useCustom=r?.useCustom,s.detail=r?.detail,o=n),s.useCustom&&(0,j.H5)(e,"resolvers");const c=[];let l=!1;for(let t=0;t<o.length;t++){const i=o[t];if("string"==typeof i)c.push({title:i,handle:t,isCloseAffordance:!1});else if("object"==typeof i){const{title:r,isCloseAffordance:n}=i;c.push({title:r,isCloseAffordance:!!n,handle:t}),n&&(l?this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,i):l=!0)}else this._logService.warn(`[${e.identifier}] Invalid message item:`,i)}return this._proxy.$showMessage(t,i,s,c).then((e=>{if("number"==typeof e)return o[e]}))}};ii=(0,z.g)([(0,z.f)(1,v.V)],ii);var ri=i(30170);class ni{constructor(e,t,i,r){this.start=e,this.deletedCount=t,this.deletedItems=i,this.items=r}asApiEvent(){return{range:new x.XsU(this.start,this.start+this.deletedCount),addedCells:this.items.map((e=>e.apiCell)),removedCells:this.deletedItems}}}class si{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1}}constructor(e,t,i){this.notebook=e,this._extHostDocument=t,this._cellData=i,this.handle=i.handle,this.uri=l.ov.revive(i.uri),this.cellKind=i.cellKind,this._outputs=i.outputs.map(P.JO.to),this._internalMetadata=i.internalMetadata??{},this._metadata=Object.freeze(i.metadata??{}),this._previousResult=Object.freeze(P._2.to(i.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){const e=this,t=this._extHostDocument.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const i={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:P.wU.to(this._cellData.cellKind),document:t.document,get mime(){return e._mime},set mime(t){e._mime=t},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(i)}return this._apiCell}setOutputs(e){this._outputs=e.map(P.JO.to)}setOutputItems(e,t,i){const r=i.map(P.x$.to),n=this._outputs.find((t=>t.id===e));if(n&&(t||(n.items.length=0),n.items.push(...r),n.items.length>1&&n.items.every((e=>(0,ri.OT)(e.mime))))){const e=new Map,t=[];n.items.forEach((i=>{let r;e.has(i.mime)?r=e.get(i.mime):(r=[],e.set(i.mime,r),t.push(i.mime)),r.push(i.data)})),n.items.length=0,t.forEach((t=>{const i=(0,ri.Jp)(e.get(t));n.items.push({mime:t,data:i.data.buffer})}))}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e,this._previousResult=Object.freeze(P._2.to(e))}setMime(e){}}class oi{static{this._handlePool=0}constructor(e,t,i,r,n){this._proxy=e,this._textDocumentsAndEditors=t,this._textDocuments=i,this.uri=r,this.handle=oi._handlePool++,this._cells=[],this._versionId=0,this._isDirty=!1,this._disposed=!1,this._notebookType=n.viewType,this._metadata=Object.freeze(n.metadata??Object.create(null)),this._spliceNotebookCells([[0,0,n.cells]],!0,void 0),this._versionId=n.versionId}dispose(){this._disposed=!0}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){const e=this,t={get uri(){return e.uri},get version(){return e._versionId},get notebookType(){return e._notebookType},get isDirty(){return e._isDirty},get isUntitled(){return e.uri.scheme===a.lg.untitled},get isClosed(){return e._disposed},get metadata(){return e._metadata},get cellCount(){return e._cells.length},cellAt(t){return t=e._validateIndex(t),e._cells[t].apiCell},getCells(t){return(t?e._getCells(t):e._cells).map((e=>e.apiCell))},save(){return e._save()}};this._notebook=Object.freeze(t)}return this._notebook}acceptDocumentPropertiesChanged(e){e.metadata&&(this._metadata=Object.freeze({...this._metadata,...e.metadata}))}acceptDirty(e){this._isDirty=e}acceptModelChanged(e,t,i){this._versionId=e.versionId,this._isDirty=t,this.acceptDocumentPropertiesChanged({metadata:i});const r={notebook:this.apiNotebook,metadata:i,cellChanges:[],contentChanges:[]},n=[];for(const t of e.rawEvents)t.kind===ri.s5.ModelChange?this._spliceNotebookCells(t.changes,!1,r.contentChanges):t.kind===ri.s5.Move?this._moveCells(t.index,t.length,t.newIdx,r.contentChanges):t.kind===ri.s5.Output?(this._setCellOutputs(t.index,t.outputs),n.push({cell:this._cells[t.index].apiCell,outputs:this._cells[t.index].apiCell.outputs})):t.kind===ri.s5.OutputItem?(this._setCellOutputItems(t.index,t.outputId,t.append,t.outputItems),n.push({cell:this._cells[t.index].apiCell,outputs:this._cells[t.index].apiCell.outputs})):t.kind===ri.s5.ChangeCellLanguage?(this._changeCellLanguage(t.index,t.language),n.push({cell:this._cells[t.index].apiCell,document:this._cells[t.index].apiCell.document})):t.kind===ri.s5.ChangeCellContent?n.push({cell:this._cells[t.index].apiCell,document:this._cells[t.index].apiCell.document}):t.kind===ri.s5.ChangeCellMime?this._changeCellMime(t.index,t.mime):t.kind===ri.s5.ChangeCellMetadata?(this._changeCellMetadata(t.index,t.metadata),n.push({cell:this._cells[t.index].apiCell,metadata:this._cells[t.index].apiCell.metadata})):t.kind===ri.s5.ChangeCellInternalMetadata&&(this._changeCellInternalMetadata(t.index,t.internalMetadata),n.push({cell:this._cells[t.index].apiCell,executionSummary:this._cells[t.index].apiCell.executionSummary}));const s=new Map;for(let e=0;e<n.length;e++){const t=n[e],i=s.get(t.cell);if(void 0===i){const e=r.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...t});s.set(t.cell,e-1)}else r.cellChanges[i]={...r.cellChanges[i],...t}}return r}_validateIndex(e){return(e|=0)<0?0:e>=this._cells.length?this._cells.length-1:e}_validateRange(e){let t=0|e.start,i=0|e.end;return t<0&&(t=0),i>this._cells.length&&(i=this._cells.length),e.with({start:t,end:i})}_getCells(e){const t=[];for(let i=(e=this._validateRange(e)).start;i<e.end;i++)t.push(this._cells[i]);return t}async _save(){return this._disposed?Promise.reject(new Error("Notebook has been closed")):this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(e,t,i){if(this._disposed)return;const r=[],n=[],s=[];if(e.reverse().forEach((e=>{const i=e[2].map((e=>{const i=new si(this,this._textDocumentsAndEditors,e);return t||n.push(si.asModelAddData(e)),i})),o=new ni(e[0],e[1],[],i),a=this._cells.splice(e[0],e[1],...i);for(const e of a)s.push(e.uri),o.deletedItems.push(e.apiCell);r.push(o)})),this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:n,removedDocuments:s}),i)for(const e of r)i.push(e.asApiEvent())}_moveCells(e,t,i,r){const n=this._cells.splice(e,t);this._cells.splice(i,0,...n);const s=[new ni(e,t,n.map((e=>e.apiCell)),[]),new ni(i,0,[],n)];for(const e of s)r.push(e.asApiEvent())}_setCellOutputs(e,t){this._cells[e].setOutputs(t)}_setCellOutputItems(e,t,i,r){this._cells[e].setOutputItems(t,i,r)}_changeCellLanguage(e,t){const i=this._cells[e];i.apiCell.document.languageId!==t&&this._textDocuments.$acceptModelLanguageChanged(i.uri,t)}_changeCellMime(e,t){this._cells[e].apiCell.mime=t}_changeCellMetadata(e,t){this._cells[e].setMetadata(t)}_changeCellInternalMetadata(e,t){this._cells[e].setInternalMetadata(t)}getCellFromApiCell(e){return this._cells.find((t=>t.apiCell===e))}getCellFromIndex(e){return this._cells[e]}getCell(e){return this._cells.find((t=>t.handle===e))}getCellIndex(e){return this._cells.indexOf(e)}}class ai{static{this.apiEditorsToExtHost=new WeakMap}constructor(e,t,i,r,n,s){this.id=e,this._proxy=t,this.notebookData=i,this._selections=[],this._visibleRanges=[],this._visible=!1,this._selections=n,this._visibleRanges=r,this._viewColumn=s}get apiEditor(){if(!this._editor){const e=this;this._editor={get notebook(){return e.notebookData.apiNotebook},get selection(){return e._selections[0]},set selection(e){this.selections=[e]},get selections(){return e._selections},set selections(t){if(!Array.isArray(t)||!t.every(x.XsU.isNotebookRange))throw(0,n.b1)("selections");e._selections=t,e._trySetSelections(t)},get visibleRanges(){return e._visibleRanges},revealRange(t,i){e._proxy.$tryRevealRange(e.id,P.Xs.from(t),i??x.Ay.Default)},get viewColumn(){return e._viewColumn}},ai.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(e){this._visible=e}_acceptVisibleRanges(e){this._visibleRanges=e}_acceptSelections(e){this._selections=e}_trySetSelections(e){this._proxy.$trySetSelections(this.id,e.map(P.Xs.from))}_acceptViewColumn(e){this._viewColumn=e}}var ci=i(894),li=i(75396);class di extends o.JT{constructor(e,t,i){super(),this._source=e,this._inputTextBuffer=t,this._outputs=i,this._outputTextBuffers=void 0}_getFullModelRange(e){const t=e.getLineCount();return new at.e(1,1,t,this._getLineMaxColumn(e,t))}_getLineMaxColumn(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this._inputTextBuffer){const e=new ci.M;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:i,disposable:r}=t.create(1);this._inputTextBuffer=i,this._register(r)}return this._inputTextBuffer}get outputTextBuffers(){return this._outputTextBuffers||(this._outputTextBuffers=this._outputs.map((e=>{const t=new ci.M;t.acceptChunk(e);const i=t.finish(!0),{textBuffer:r,disposable:n}=i.create(1);return this._register(n),r}))),this._outputTextBuffers}findInInputs(e){const t=new li.bc(e,!1,!1,null).parseSearchRequest();if(!t)return[];const i=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(i,t,!0,5e3)}findInOutputs(e){const t=new li.bc(e,!1,!1,null).parseSearchRequest();return t?this.outputTextBuffers.map((e=>{const i=e.findMatchesLineByLine(this._getFullModelRange(e),t,!0,5e3);if(0!==i.length)return{textBuffer:e,matches:i}})).filter((e=>!!e)):[]}}var ui=i(45630);function hi(e,t){let i=-1;const r=[];let n=[];e.forEach((e=>{e.range.startLineNumber!==i&&n.length>0&&(r.push([...n]),n=[]),n.push(e),i=e.range.endLineNumber})),n.length>0&&r.push([...n]);return r.map((e=>{const i=[],r=e[0].range.startLineNumber,n=e[e.length-1].range.endLineNumber;for(let e=r;e<=n;e++)i.push(t.getLineContent(e));return new ui.Aw(i.join("\n")+"\n",e.map((e=>new at.e(e.range.startLineNumber-1,e.range.startColumn-1,e.range.endLineNumber-1,e.range.endColumn-1))))}))}var pi=i(35908);const mi="vs/workbench/api/common/extHostNotebook";class fi{static{this._notebookStatusBarItemProviderHandlePool=0}get activeNotebookEditor(){return this._activeNotebookEditor?.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map((e=>e.apiEditor))}constructor(e,t,i,r,n,o){this._textDocumentsAndEditors=i,this._textDocuments=r,this._extHostFileSystem=n,this._extHostSearch=o,this._notebookStatusBarItemProviders=new Map,this._documents=new Ie.Y9,this._editors=new Map,this._onDidChangeActiveNotebookEditor=new s.Q5,this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event,this._visibleNotebookEditors=[],this._onDidOpenNotebookDocument=new s.Q5,this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event,this._onDidCloseNotebookDocument=new s.Q5,this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event,this._onDidChangeVisibleNotebookEditors=new s.Q5,this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event,this._statusBarCache=new ve("NotebookCellStatusBarCache"),this._handlePool=0,this._notebookSerializer=new Map,this._notebookProxy=e.getProxy(y.Tr.MainThreadNotebook),this._notebookDocumentsProxy=e.getProxy(y.Tr.MainThreadNotebookDocuments),this._notebookEditorsProxy=e.getProxy(y.Tr.MainThreadNotebookEditors),this._commandsConverter=t.converter,t.registerArgumentProcessor({processArgument:e=>{if(e&&13===e.$mid){const t=e.notebookEditor?.notebookUri,i=e.cell.handle,r=this._documents.get(t),n=r?.getCell(i);if(n)return n.apiCell}if(e&&14===e.$mid){const t=e.uri,i=this._documents.get(t);if(i)return i.apiNotebook}return e}}),fi._registerApiCommands(t)}getEditorById(e){const t=this._editors.get(e);if(!t)throw new Error(`unknown text editor: ${e}. known editors: ${[...this._editors.keys()]} `);return t}getIdByEditor(e){for(const[t,i]of this._editors)if(i.apiEditor===e)return t}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(e,t){const i=this._documents.get(e);if(!i&&!t)throw new Error(`NO notebook document for '${e}'`);return i}static _convertNotebookRegistrationData(e,t){if(!t)return;const i=t.filenamePattern.map((e=>P.wN.from(e))).filter((e=>void 0!==e));if(!t.filenamePattern||i)return{extension:e.identifier,providerDisplayName:e.displayName||e.name,displayName:t.displayName,filenamePattern:i,exclusive:t.exclusive||!1};console.warn(`Notebook content provider view options file name pattern is invalid ${t.filenamePattern}`)}registerNotebookCellStatusBarItemProvider(e,t,i){const r=fi._notebookStatusBarItemProviderHandlePool++,n="function"==typeof i.onDidChangeCellStatusBarItems?fi._notebookStatusBarItemProviderHandlePool++:void 0;let s;return this._notebookStatusBarItemProviders.set(r,i),this._notebookProxy.$registerNotebookCellStatusBarItemProvider(r,n,t),void 0!==n&&(s=i.onDidChangeCellStatusBarItems((e=>this._notebookProxy.$emitCellStatusBarEvent(n)))),new x.JTr((()=>{this._notebookStatusBarItemProviders.delete(r),this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(r,n),s?.dispose()}))}async createNotebookDocument(e){const t=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:e.viewType,content:e.content&&P.c4.from(e.content)});return l.ov.revive(t)}async openNotebookDocument(e){const t=this._documents.get(e);if(t)return t.apiNotebook;const i=await this._notebookDocumentsProxy.$tryOpenNotebook(e),r=this._documents.get(l.ov.revive(i));return(0,V.cW)(r?.apiNotebook)}async showNotebookDocument(e,t){let i;l.ov.isUri(e)&&(e=await this.openNotebookDocument(e)),i="object"==typeof t?{position:P.eI.from(t.viewColumn),preserveFocus:t.preserveFocus,selections:t.selections&&t.selections.map(P.Xs.from),pinned:"boolean"==typeof t.preview?!t.preview:void 0}:{preserveFocus:!1};const r=await this._notebookEditorsProxy.$tryShowNotebookDocument(e.uri,e.notebookType,i),n=r&&this._editors.get(r)?.apiEditor;if(n)return n;throw r?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(e,t,i,r){const n=this._notebookStatusBarItemProviders.get(e),s=l.ov.revive(t),a=this._documents.get(s);if(!a||!n)return;const c=a.getCellFromIndex(i);if(!c)return;const d=await n.provideCellStatusBarItems(c.apiCell,r);if(!d)return;const u=new o.SL;return{cacheId:this._statusBarCache.add([u]),items:(Array.isArray(d)?d:[d]).map((e=>P.b$.from(e,this._commandsConverter,u)))}}$releaseNotebookCellStatusBarItems(e){this._statusBarCache.delete(e)}registerNotebookSerializer(e,t,i,r,n){if((0,$e.m5)(t))throw new Error("viewType cannot be empty or just whitespace");const s=this._handlePool++;return this._notebookSerializer.set(s,{viewType:t,serializer:i,options:r}),this._notebookProxy.$registerNotebookSerializer(s,{id:e.identifier,location:e.extensionLocation},t,P.RG.from(r),fi._convertNotebookRegistrationData(e,n)),(0,o.OF)((()=>{this._notebookProxy.$unregisterNotebookSerializer(s)}))}async $dataToNotebook(e,t,i){const r=this._notebookSerializer.get(e);if(!r)throw new Error("NO serializer found");const n=await r.serializer.deserializeNotebook(t.buffer,i);return new M.ky(P.c4.from(n))}async $notebookToData(e,t,i){const r=this._notebookSerializer.get(e);if(!r)throw new Error("NO serializer found");const n=await r.serializer.serializeNotebook(P.c4.to(t.value),i);return Ve.KN.wrap(n)}async $saveNotebook(e,t,i,r,n){const s=l.ov.revive(t),o=this._notebookSerializer.get(e);if(!o)throw new Error("NO serializer found");const a=this._documents.get(s);if(!a)throw new Error("Document NOT found");if(a.versionId!==i)throw new Error("Document version mismatch");if(!this._extHostFileSystem.value.isWritableFileSystem(s.scheme))throw new f.Ym((0,De.C$)(mi,0,"Unable to modify read-only file '{0}'",this._resourceForError(s)),6);await this._validateWriteFile(s,r);const c={metadata:(0,ce.hX)(a.apiNotebook.metadata,(e=>!(o.options?.transientDocumentMetadata??{})[e])),cells:[]};for(const e of a.apiNotebook.getCells()){const t=new x.Ul(e.kind,e.document.getText(),e.document.languageId,e.mime,o.options?.transientOutputs?[]:[...e.outputs],e.metadata,e.executionSummary);t.metadata=(0,ce.hX)(e.metadata,(e=>!(o.options?.transientCellMetadata??{})[e])),c.cells.push(t)}const d=await o.serializer.serializeNotebook(c,n);await this._extHostFileSystem.value.writeFile(s,d);const u=this._extHostFileSystem.getFileSystemProviderExtUri(s.scheme),h=await this._extHostFileSystem.value.stat(s);return{name:u.basename(s),isFile:!!(h.type&f.Tv.File),isDirectory:!!(h.type&f.Tv.Directory),isSymbolicLink:!!(h.type&f.Tv.SymbolicLink),mtime:h.mtime,ctime:h.ctime,size:h.size,readonly:Boolean((h.permissions??0)&f.rM.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(s.scheme),locked:Boolean((h.permissions??0)&f.rM.Locked),etag:(0,f.AT)({mtime:h.mtime,size:h.size}),children:void 0}}async $searchInNotebooks(e,t,i,r,n){const s=this._notebookSerializer.get(e)?.serializer;if(!s)return{limitHit:!1,results:[]};const o=new Ie.XV;await(async(e,t,i)=>{await Promise.all(e.map((async e=>await Promise.all(e.filenamePatterns.map((n=>{const s={_reason:i._reason,folderQueries:i.folderQueries,includePattern:i.includePattern,excludePattern:i.excludePattern,maxResults:i.maxResults,type:1,filePattern:n};return this._extHostSearch.doInternalFileSearchWithCustomCallback(s,t,(t=>{t.forEach((t=>{if(o.has(t))return;r.some((i=>!(e.isFromSettings&&!i.isFromSettings)&&i.filenamePatterns.some((e=>(0,pi.M9)(e,t)))))||o.add(t)}))})).catch((e=>{if("ENOENT"===e.code)return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw e}))}))))))})(i,n,t);const a=new Ie.Y9;let c=!1;const l=Array.from(o).map((async e=>{const i=[];try{if(n.isCancellationRequested)return;if(t.maxResults&&[...a.values()].reduce(((e,t)=>e+t.cellResults.length),0)>t.maxResults)return void(c=!0);const r=[],o=this._documents.get(e);if(o){o.apiNotebook.getCells().forEach((e=>r.push({input:e.document.getText(),outputs:e.outputs.flatMap((e=>e.items.map((e=>e.data.toString()))))})))}else{const t=await this._extHostFileSystem.value.readFile(e),i=Ve.KN.fromString(t.toString()),o=await s.deserializeNotebook(i.buffer,n);if(n.isCancellationRequested)return;P.c4.from(o).cells.forEach((e=>r.push({input:e.source,outputs:e.outputs.flatMap((e=>e.items.map((e=>e.valueBytes.toString()))))})))}if(n.isCancellationRequested)return;r.forEach(((e,r)=>{const n=t.contentPattern.pattern,s=new di(e.input,void 0,e.outputs),o=s.findInInputs(n),a=s.findInOutputs(n),c=a.flatMap((e=>hi(e.matches,e.textBuffer))).map(((e,t)=>(e.webviewIndex=t,e)));if(o.length>0||a.length>0){const e={index:r,contentResults:hi(o,s.inputTextBuffer),webviewResults:c};i.push(e)}}));const l={resource:e,cellResults:i};return void a.set(e,l)}catch(e){return}}));return await Promise.all(l),{limitHit:c,results:[...a.values()]}}async _validateWriteFile(e,t){const i=await this._extHostFileSystem.value.stat(e);if("number"==typeof t?.mtime&&"string"==typeof t.etag&&t.etag!==f.jG&&"number"==typeof i.mtime&&"number"==typeof i.size&&t.mtime<i.mtime&&t.etag!==(0,f.AT)({mtime:t.mtime,size:i.size}))throw new f.Ym((0,De.C$)(mi,1,"File Modified Since"),3,t)}_resourceForError(e){return e.scheme===a.lg.file?e.fsPath:e.toString()}_createExtHostEditor(e,t,i){if(this._editors.has(t))throw new Error(`editor with id ALREADY EXSIST: ${t}`);const r=new ai(t,this._notebookEditorsProxy,e,i.visibleRanges.map(P.Xs.to),i.selections.map(P.Xs.to),"number"==typeof i.viewColumn?P.eI.to(i.viewColumn):void 0);this._editors.set(t,r)}$acceptDocumentAndEditorsDelta(e){if(e.value.removedDocuments)for(const t of e.value.removedDocuments){const e=l.ov.revive(t),i=this._documents.get(e);i&&(i.dispose(),this._documents.delete(e),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:i.apiNotebook.getCells().map((e=>e.document.uri))}),this._onDidCloseNotebookDocument.fire(i.apiNotebook));for(const t of this._editors.values())t.notebookData.uri.toString()===e.toString()&&this._editors.delete(t.id)}if(e.value.addedDocuments){const t=[];for(const i of e.value.addedDocuments){const e=l.ov.revive(i.uri);if(this._documents.has(e))throw new Error(`adding EXISTING notebook ${e} `);const r=new oi(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,e,i);t.push(...i.cells.map((e=>si.asModelAddData(e)))),this._documents.get(e)?.dispose(),this._documents.set(e,r),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:t}),this._onDidOpenNotebookDocument.fire(r.apiNotebook)}}if(e.value.addedEditors)for(const t of e.value.addedEditors){if(this._editors.has(t.id))return;const e=l.ov.revive(t.documentUri),i=this._documents.get(e);i&&this._createExtHostEditor(i,t.id,t)}if(e.value.removedEditors)for(const t of e.value.removedEditors){const e=this._editors.get(t);e&&(this._editors.delete(t),this._activeNotebookEditor?.id===e.id&&(this._activeNotebookEditor=void 0))}if(e.value.visibleEditors){this._visibleNotebookEditors=e.value.visibleEditors.map((e=>this._editors.get(e))).filter((e=>!!e));const t=new Set;this._visibleNotebookEditors.forEach((e=>t.add(e.id)));for(const e of this._editors.values()){const i=t.has(e.id);e._acceptVisibility(i)}this._visibleNotebookEditors=[...this._editors.values()].map((e=>e)).filter((e=>e.visible)),this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}if(null===e.value.newActiveEditor)this._activeNotebookEditor=void 0;else if(e.value.newActiveEditor){this._editors.get(e.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${e.value.newActiveEditor}`),this._activeNotebookEditor=this._editors.get(e.value.newActiveEditor)}void 0!==e.value.newActiveEditor&&this._onDidChangeActiveNotebookEditor.fire(this._activeNotebookEditor?.apiEditor)}static _registerApiCommands(e){const t=I.SF.String.with("notebookType","A notebook type"),i=new I.b9("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[t,new I.SF("data","Bytes to convert to data",(e=>e instanceof Uint8Array),(e=>Ve.KN.wrap(e)))],new I._m("Notebook Data",(e=>P.c4.to(e.value)))),r=new I.b9("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[t,new I.SF("NotebookData","Notebook data to convert to bytes",(e=>!0),(e=>new M.ky(P.c4.from(e))))],new I._m("Bytes",(e=>e.buffer)));e.registerApiCommand(i),e.registerApiCommand(r)}}class gi{constructor(e,t,i,r={timeout:1500,errors:3}){this._logService=e,this._notebooksAndEditors=t,this._mainThreadBulkEdits=i,this._thresholds=r,this._onWillSaveNotebookDocumentEvent=new s.Qz}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,i,r)=>{const n=function(e){t.call(i,e)};return n.extension=e,this._onWillSaveNotebookDocumentEvent.event(n,void 0,r)}}async $participateInSave(e,t,i){const r=l.ov.revive(e),n=this._notebooksAndEditors.getNotebookDocument(r);if(!n)throw new Error("Unable to resolve notebook document");const s=[];if(await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:n.apiNotebook,reason:P.wD.to(t)},i,(async(e,t)=>{const r=Date.now(),n=await await Promise.resolve(e);Date.now()-r>this._thresholds.timeout&&this._logService.warn("onWillSaveNotebookDocument-listener from extension",t.extension.identifier),i.isCancellationRequested||n&&(n instanceof x.DbP?s.push(n):this._logService.warn("onWillSaveNotebookDocument-listener from extension",t.extension.identifier,"ignored due to invalid data"))})),i.isCancellationRequested)return!1;if(0===s.length)return!0;const o={edits:[]};for(const e of s){const{edits:t}=P.Db.from(e);o.edits=o.edits.concat(t)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new M.ky(o))}}class vi{constructor(e){this._notebooksAndEditors=e,this._onDidSaveNotebookDocument=new s.Q5,this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event,this._onDidChangeNotebookDocument=new s.Q5,this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,t,i,r){const n=this._notebooksAndEditors.getNotebookDocument(l.ov.revive(e)).acceptModelChanged(t.value,i,r);this._onDidChangeNotebookDocument.fire(n)}$acceptDirtyStateChanged(e,t){this._notebooksAndEditors.getNotebookDocument(l.ov.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this._notebooksAndEditors.getNotebookDocument(l.ov.revive(e));this._onDidSaveNotebookDocument.fire(t.apiNotebook)}}let _i=class{constructor(e,t){this._logService=e,this._notebooksAndEditors=t,this._onDidChangeNotebookEditorSelection=new s.Q5,this._onDidChangeNotebookEditorVisibleRanges=new s.Q5,this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event,this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(e,t){this._logService.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",e,t);const i=this._notebooksAndEditors.getEditorById(e);t.visibleRanges&&i._acceptVisibleRanges(t.visibleRanges.ranges.map(P.Xs.to)),t.selections&&i._acceptSelections(t.selections.selections.map(P.Xs.to)),t.visibleRanges&&this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:i.apiEditor,visibleRanges:i.apiEditor.visibleRanges}),t.selections&&this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:i.apiEditor,selections:i.apiEditor.selections}))}$acceptEditorViewColumns(e){for(const t in e){this._notebooksAndEditors.getEditorById(t)._acceptViewColumn(P.eI.to(e[t]))}}};_i=(0,z.g)([(0,z.f)(0,v.V)],_i);var bi=i(17248);let wi=class{constructor(e,t,i,r,n){this._initData=t,this._extHostNotebook=i,this._commands=r,this._logService=n,this._activeExecutions=new Ie.Y9,this._activeNotebookExecutions=new Ie.Y9,this._kernelDetectionTask=new Map,this._kernelDetectionTaskHandlePool=0,this._kernelSourceActionProviders=new Map,this._kernelSourceActionProviderHandlePool=0,this._kernelData=new Map,this._handlePool=0,this._onDidChangeCellExecutionState=new s.Q5,this.onDidChangeNotebookCellExecutionState=this._onDidChangeCellExecutionState.event,this.id=0,this.variableStore={},this._proxy=e.getProxy(y.Tr.MainThreadNotebookKernels);const o=new I.b9("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new I.SF("options","Select kernel options",(e=>!0),(e=>{if(e&&"notebookEditor"in e&&"id"in e){const t=this._extHostNotebook.getIdByEditor(e.notebookEditor);return{id:e.id,extension:e.extension,notebookEditorId:t}}if(e&&"notebookEditor"in e){const t=this._extHostNotebook.getIdByEditor(e.notebookEditor);if(void 0===t)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${e.notebookEditor.notebook.uri.toString()}`);return{notebookEditorId:t}}return e}))],I._m.Void),a=new I.b9("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[I.SF.Uri],new I._m("A promise that resolves to an array of variables",((e,t)=>e.map((e=>({variable:{name:e.name,value:e.value,expression:e.expression,type:e.type,language:e.language},hasNamedChildren:e.hasNamedChildren,indexedChildrenCount:e.indexedChildrenCount}))))));this._commands.registerApiCommand(o),this._commands.registerApiCommand(a)}createNotebookController(e,t,i,r,n,o){for(const i of this._kernelData.values())if(i.controller.id===t&&m.kP.equals(e.identifier,i.extensionId))throw new Error(`notebook controller with id '${t}' ALREADY exist`);const a=this._handlePool++,c=this;this._logService.trace(`NotebookController[${a}], CREATED by ${e.identifier.value}, ${t}`);const l=()=>console.warn(`NO execute handler from notebook controller '${p.id}' of extension: '${e.identifier}'`);let d=!1;const u=new s.Q5,h=new s.Q5,p={id:Di(e.identifier,t),notebookType:i,extensionId:e.identifier,extensionLocation:e.extensionLocation,label:r||e.identifier.value,preloads:o?o.map(P.xT.from):[]};let f,g,v=n??l;this._proxy.$addKernel(a,p).catch((e=>{console.log(e),d=!0}));let _=0;const b=()=>{if(d)return;const e=++_;Promise.resolve().then((()=>{e===_&&this._proxy.$updateKernel(a,p)}))},w=new Ie.Y9,y={get id(){return t},get notebookType(){return p.notebookType},onDidChangeSelectedNotebooks:u.event,get label(){return p.label},set label(t){p.label=t??e.displayName??e.name,b()},get detail(){return p.detail??""},set detail(e){p.detail=e,b()},get description(){return p.description??""},set description(e){p.description=e,b()},get supportedLanguages(){return p.supportedLanguages},set supportedLanguages(e){p.supportedLanguages=e,b()},get supportsExecutionOrder(){return p.supportsExecutionOrder??!1},set supportsExecutionOrder(e){p.supportsExecutionOrder=e,b()},get rendererScripts(){return p.preloads?p.preloads.map(P.xT.to):[]},get executeHandler(){return v},set executeHandler(e){v=e??l},get interruptHandler(){return f},set interruptHandler(e){f=e,p.supportsInterrupt=Boolean(e),b()},set variableProvider(t){(0,j.H5)(e,"notebookVariableProvider"),g=t,p.hasVariableProvider=!!t,t?.onDidChangeVariables((e=>c._proxy.$variablesUpdated(e.uri))),b()},get variableProvider(){return g},createNotebookCellExecution(t){if(d)throw new Error("notebook controller is DISPOSED");if(!w.has(t.notebook.uri))throw c._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(w.keys()).map((e=>e.toString()))),new Error(`notebook controller is NOT associated to notebook: ${t.notebook.uri.toString()}`);return c._createNotebookCellExecution(t,Di(e.identifier,this.id))},createNotebookExecution(t){if((0,j.H5)(e,"notebookExecution"),d)throw new Error("notebook controller is DISPOSED");if(!w.has(t.uri))throw c._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(w.keys()).map((e=>e.toString()))),new Error(`notebook controller is NOT associated to notebook: ${t.uri.toString()}`);return c._createNotebookExecution(t,Di(e.identifier,this.id))},dispose:()=>{d||(this._logService.trace(`NotebookController[${a}], DISPOSED`),d=!0,this._kernelData.delete(a),u.dispose(),h.dispose(),this._proxy.$removeKernel(a))},updateNotebookAffinity(t,i){i===x.Hu0.Hidden&&(0,j.H5)(e,"notebookControllerAffinityHidden"),c._proxy.$updateNotebookPriority(a,t.uri,i)},onDidReceiveMessage:h.event,postMessage(t,i){return(0,j.H5)(e,"notebookMessaging"),c._proxy.$postMessage(a,i&&c._extHostNotebook.getIdByEditor(i),t)},asWebviewUri(t){return(0,j.H5)(e,"notebookMessaging"),ie(t,c._initData.remote)}};return this._kernelData.set(a,{extensionId:e.identifier,controller:y,onDidReceiveMessage:h,onDidChangeSelection:u,associatedNotebooks:w}),y}getIdByController(e){for(const[t,i]of this._kernelData)if(i.controller===e)return Di(i.extensionId,e.id);return null}createNotebookControllerDetectionTask(e,t){const i=this._kernelDetectionTaskHandlePool++,r=this;this._logService.trace(`NotebookControllerDetectionTask[${i}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelDetectionTask(i,t);const n={dispose:()=>{this._kernelDetectionTask.delete(i),r._proxy.$removeKernelDetectionTask(i)}};return this._kernelDetectionTask.set(i,n),n}registerKernelSourceActionProvider(e,t,i){const r=this._kernelSourceActionProviderHandlePool++,n="function"==typeof i.onDidChangeNotebookKernelSourceActions?r:void 0,s=this;let o;return this._kernelSourceActionProviders.set(r,i),this._logService.trace(`NotebookKernelSourceActionProvider[${r}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelSourceActionProvider(r,r,t),void 0!==n&&(o=i.onDidChangeNotebookKernelSourceActions((e=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(n)))),{dispose:()=>{this._kernelSourceActionProviders.delete(r),s._proxy.$removeKernelSourceActionProvider(r,r),o?.dispose()}}}async $provideKernelSourceActions(e,t){const i=this._kernelSourceActionProviders.get(e);if(i){const e=new o.SL;return(await i.provideNotebookKernelSourceActions(t)??[]).map((t=>P.ac.from(t,this._commands.converter,e)))}return[]}$acceptNotebookAssociation(e,t,i){const r=this._kernelData.get(e);if(r){const n=this._extHostNotebook.getNotebookDocument(l.ov.revive(t));i?r.associatedNotebooks.set(n.uri,!0):r.associatedNotebooks.delete(n.uri),this._logService.trace(`NotebookController[${e}] ASSOCIATE notebook`,n.uri.toString(),i),r.onDidChangeSelection.fire({selected:i,notebook:n.apiNotebook})}}async $executeCells(e,t,i){const r=this._kernelData.get(e);if(!r)return;const n=this._extHostNotebook.getNotebookDocument(l.ov.revive(t)),s=[];for(const e of i){const t=n.getCell(e);t&&s.push(t.apiCell)}try{this._logService.trace(`NotebookController[${e}] EXECUTE cells`,n.uri.toString(),s.length),await r.controller.executeHandler.call(r.controller,s,n.apiNotebook,r.controller)}catch(t){this._logService.error(`NotebookController[${e}] execute cells FAILED`,t),console.error(t)}}async $cancelCells(e,t,i){const r=this._kernelData.get(e);if(!r)return;const n=this._extHostNotebook.getNotebookDocument(l.ov.revive(t));if(r.controller.interruptHandler)await r.controller.interruptHandler.call(r.controller,n.apiNotebook);else for(const e of i){const t=n.getCell(e);t&&this._activeExecutions.get(t.uri)?.cancel()}if(r.controller.interruptHandler){const e=this._activeNotebookExecutions.get(n.uri);i.length&&Array.isArray(e)&&e.length&&e.forEach((e=>e.dispose()))}}async $provideVariables(e,t,i,r,n,s,o){const a=this._kernelData.get(e);if(!a)return;const c=this._extHostNotebook.getNotebookDocument(l.ov.revive(i)),d=a.controller.variableProvider;if(!d)return;let u;if(void 0!==r){if(u=this.variableStore[r],!u)return}else this.variableStore={};const h="named"===n?x.rbC.Named:x.rbC.Indexed,p=d.provideVariables(c.apiNotebook,u,h,s,o);let m=0;for await(const e of p){if(o.isCancellationRequested)return;const i={id:this.id++,name:e.variable.name,value:e.variable.value,type:e.variable.type,interfaces:e.variable.interfaces,language:e.variable.language,expression:e.variable.expression,hasNamedChildren:e.hasNamedChildren,indexedChildrenCount:e.indexedChildrenCount,extensionId:a.extensionId.value};if(this.variableStore[i.id]=e.variable,this._proxy.$receiveVariable(t,i),m++>=100)return}}$acceptKernelMessageFromRenderer(e,t,i){const r=this._kernelData.get(e);if(!r)return;const n=this._extHostNotebook.getEditorById(t);r.onDidReceiveMessage.fire(Object.freeze({editor:n.apiEditor,message:i}))}$cellExecutionChanged(e,t,i){const r=this._extHostNotebook.getNotebookDocument(l.ov.revive(e)).getCell(t);if(r){const e=i?P.KP.to(i):x.KPz.Idle;void 0!==e&&this._onDidChangeCellExecutionState.fire({cell:r.apiCell,state:e})}}_createNotebookCellExecution(e,t){if(e.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const i=this._extHostNotebook.getNotebookDocument(e.notebook.uri).getCellFromApiCell(e);if(!i)throw new Error("invalid cell");if(this._activeExecutions.has(i.uri))throw new Error(`duplicate execution for ${i.uri}`);const r=new Ci(t,i,this._proxy);this._activeExecutions.set(i.uri,r);const n=r.onDidChangeState((()=>{r.state===yi.Resolved&&(r.dispose(),n.dispose(),this._activeExecutions.delete(i.uri))}));return r.asApiObject()}_createNotebookExecution(e,t){const i=this._extHostNotebook.getNotebookDocument(e.uri),r=e.getCells().find((e=>{const t=i.getCellFromApiCell(e);return t&&this._activeExecutions.has(t.uri)}));if(r)throw new Error(`duplicate cell execution for ${r.document.uri}`);if(this._activeNotebookExecutions.has(i.uri))throw new Error(`duplicate notebook execution for ${i.uri}`);const n=new Si(t,i,this._proxy),s=n.onDidChangeState((()=>{n.state===xi.Resolved&&(n.dispose(),s.dispose(),this._activeNotebookExecutions.delete(i.uri))}));return this._activeNotebookExecutions.set(i.uri,[n,s]),n.asApiObject()}};var yi,xi;wi=(0,z.g)([(0,z.f)(4,v.V)],wi),function(e){e[e.Init=0]="Init",e[e.Started=1]="Started",e[e.Resolved=2]="Resolved"}(yi||(yi={}));class Ci extends o.JT{static{this.HANDLE=0}get state(){return this._state}constructor(e,t,i){super(),this._cell=t,this._proxy=i,this._handle=Ci.HANDLE++,this._onDidChangeState=new s.Q5,this.onDidChangeState=this._onDidChangeState.event,this._state=yi.Init,this._tokenSource=this._register(new r.AU),this._collector=new Ei(10,(e=>this.update(e))),this._executionOrder=t.internalMetadata.executionOrder,this._proxy.$createExecution(this._handle,e,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(e){await this._collector.addItem(e)}async update(e){const t=Array.isArray(e)?e:[e];return this._proxy.$updateExecution(this._handle,new M.ky(t))}verifyStateForOutput(){if(this._state===yi.Init)throw new Error("Must call start before modifying cell output");if(this._state===yi.Resolved)throw new Error("Cannot modify cell output after calling resolve")}cellIndexToHandle(e){let t=this._cell;if(e&&(t=this._cell.notebook.getCellFromApiCell(e)),!t)throw new Error("INVALID cell");return t.handle}validateAndConvertOutputs(e){return e.map((e=>{const t=x.JOq.ensureUniqueMimeTypes(e.items,!0);return t===e.items?P.JO.from(e):P.JO.from({items:t,id:e.id,metadata:e.metadata})}))}async updateOutputs(e,t,i){const r=this.cellIndexToHandle(t),n=this.validateAndConvertOutputs((0,S._2)(e));return this.updateSoon({editType:bi.W.Output,cellHandle:r,append:i,outputs:n})}async updateOutputItems(e,t,i){return e=x.JOq.ensureUniqueMimeTypes((0,S._2)(e),!0),this.updateSoon({editType:bi.W.OutputItems,items:e.map(P.x$.from),outputId:t.id,append:i})}asApiObject(){const e=this,t={get token(){return e._tokenSource.token},get cell(){return e._cell.apiCell},get executionOrder(){return e._executionOrder},set executionOrder(t){e._executionOrder=t,e.update([{editType:bi.W.ExecutionState,executionOrder:e._executionOrder}])},start(t){if(e._state===yi.Resolved||e._state===yi.Started)throw new Error("Cannot call start again");e._state=yi.Started,e._onDidChangeState.fire(),e.update({editType:bi.W.ExecutionState,runStartTime:t})},end(t,i,r){if(e._state===yi.Resolved)throw new Error("Cannot call resolve twice");e._state=yi.Resolved,e._onDidChangeState.fire(),e._collector.flush();const n=r?{message:r.message,stack:r.stack,location:r?.location?{startLineNumber:r.location.start.line,startColumn:r.location.start.character,endLineNumber:r.location.end.line,endColumn:r.location.end.character}:void 0,uri:r.uri}:void 0;e._proxy.$completeExecution(e._handle,new M.ky({runEndTime:i,lastRunSuccess:t,error:n}))},clearOutput(t){return e.verifyStateForOutput(),e.updateOutputs([],t,!1)},appendOutput(t,i){return e.verifyStateForOutput(),e.updateOutputs(t,i,!0)},replaceOutput(t,i){return e.verifyStateForOutput(),e.updateOutputs(t,i,!1)},appendOutputItems(t,i){return e.verifyStateForOutput(),e.updateOutputItems(t,i,!0)},replaceOutputItems(t,i){return e.verifyStateForOutput(),e.updateOutputItems(t,i,!1)}};return Object.freeze(t)}}!function(e){e[e.Init=0]="Init",e[e.Started=1]="Started",e[e.Resolved=2]="Resolved"}(xi||(xi={}));class Si extends o.JT{static{this.HANDLE=0}get state(){return this._state}constructor(e,t,i){super(),this._notebook=t,this._proxy=i,this._handle=Si.HANDLE++,this._onDidChangeState=new s.Q5,this.onDidChangeState=this._onDidChangeState.event,this._state=xi.Init,this._tokenSource=this._register(new r.AU),this._proxy.$createNotebookExecution(this._handle,e,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){const e={start:()=>{if(this._state===xi.Resolved||this._state===xi.Started)throw new Error("Cannot call start again");this._state=xi.Started,this._onDidChangeState.fire(),this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===xi.Resolved)throw new Error("Cannot call resolve twice");this._state=xi.Resolved,this._onDidChangeState.fire(),this._proxy.$completeNotebookExecution(this._handle)}};return Object.freeze(e)}}class Ei{constructor(e,t){this.delay=e,this.callback=t,this.batch=[],this.startedTimer=Date.now()}addItem(e){return this.batch.push(e),this.currentDeferred||(this.currentDeferred=new H.CR,this.startedTimer=Date.now(),(0,H.Vs)(this.delay).then((()=>this.flush()))),Date.now()-this.startedTimer>this.delay?this.flush():this.currentDeferred.p}flush(){if(0===this.batch.length||!this.currentDeferred)return Promise.resolve();const e=this.currentDeferred;this.currentDeferred=void 0;const t=this.batch;return this.batch=[],this.callback(t).finally((()=>e.complete()))}}function Di(e,t){return`${e.value}/${t}`}class ki{constructor(e,t){this._extHostNotebook=t,this._rendererMessageEmitters=new Map,this.proxy=e.getProxy(y.Tr.MainThreadNotebookRenderers)}$postRendererMessage(e,t,i){const r=this._extHostNotebook.getEditorById(e);this._rendererMessageEmitters.get(t)?.fire({editor:r.apiEditor,message:i})}createRendererMessaging(e,t){if(!e.contributes?.notebookRenderer?.some((e=>e.id===t)))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(e,i,r)=>this.getOrCreateEmitterFor(t).event(e,i,r),postMessage:(e,i)=>{ai.apiEditorsToExtHost.has(e)&&([e,i]=[i,e]);const r=i&&ai.apiEditorsToExtHost.get(i);return this.proxy.$postMessage(r?.id,t,e)}}}getOrCreateEmitterFor(e){let t=this._rendererMessageEmitters.get(e);return t||(t=new s.Q5({onDidRemoveLastListener:()=>{t?.dispose(),this._rendererMessageEmitters.delete(e)}}),this._rendererMessageEmitters.set(e,t),t)}}var Ii=i(92231);class Pi{constructor(e){this.handlers=new Map,this.proxy=e.getProxy(y.Tr.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,i){if((0,j.H5)(e,"profileContentHandlers"),this.handlers.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.handlers.set(t,i),this.proxy.$registerProfileContentHandler(t,i.name,i.description,e.identifier.value),(0,o.OF)((()=>{this.handlers.delete(t),this.proxy.$unregisterProfileContentHandler(t)}))}async $saveProfile(e,t,i,r){const n=this.handlers.get(e);if(!n)throw new Error(`Unknown handler with id: ${e}`);return n.saveProfile(t,i,r)}async $readProfile(e,t,i){const r=this.handlers.get(e);if(!r)throw new Error(`Unknown handler with id: ${e}`);return r.readProfile((0,V.HD)(t)?t:l.ov.revive(t),i)}}var Ti=i(28855),Ai=i(63207);class Ri{constructor(e){this._handles=0,this._mapHandleToCancellationSource=new Map,this._proxy=e}async withProgress(e,t,i){const r=this._handles++,{title:s,location:o,cancellable:a}=t,c={label:e.displayName||e.name,id:e.identifier.value};return this._proxy.$startProgress(r,{location:P.uT.from(o),title:s,source:c,cancellable:a},e.isUnderDevelopment?void 0:e.identifier.value).catch(n.Cp),this._withProgress(r,i,!!a)}_withProgress(e,t,i){let n;i&&(n=new r.AU,this._mapHandleToCancellationSource.set(e,n));const s=e=>{this._proxy.$progressEnd(e),this._mapHandleToCancellationSource.delete(e),n?.dispose()};let o;try{o=t(new $i(this._proxy,e),i&&n?n.token:r.Ts.None)}catch(t){throw s(e),t}return o.then((t=>s(e)),(t=>s(e))),o}$acceptProgressCanceled(e){const t=this._mapHandleToCancellationSource.get(e);t&&(t.cancel(),this._mapHandleToCancellationSource.delete(e))}}class $i extends Ti.Ex{constructor(e,t){super((e=>this.throttledReport(e))),this._proxy=e,this._handle=t}throttledReport(e){this._proxy.$progressReport(this._handle,e)}}$i.__decorator=(0,z.g)([(0,Ai.P2)(100,((e,t)=>function(e,t){return e.message=t.message,"number"==typeof t.increment&&("number"==typeof e.increment?e.increment+=t.increment:e.increment=t.increment),e}(e,t)),(()=>Object.create(null)))],$i.prototype,"throttledReport",null);class Li{static{this.handlePool=0}constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(y.Tr.MainThreadQuickDiff)}$provideOriginalResource(e,t,i){const r=l.ov.revive(t),n=this.providers.get(e);return n?(0,H.OH)((()=>n.provideOriginalResource(r,i))).then((e=>e||null)):Promise.resolve(null)}registerQuickDiffProvider(e,t,i,r){const n=Li.handlePool++;return this.providers.set(n,t),this.proxy.$registerQuickDiffProvider(n,P.Lq.from(e,this.uriTransformer),i,r),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(n),this.providers.delete(n)}}}}var Ni=i(27528);function zi(e,t,i){const a=e.getProxy(y.Tr.MainThreadQuickOpen);class d{static{this._nextId=1}constructor(e,t){this._extensionId=e,this._onDidDispose=t,this._id=h._nextId++,this._visible=!1,this._expectingHide=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!0,this._value="",this._buttons=[],this._handlesToButtons=new Map,this._onDidAcceptEmitter=new s.Q5,this._onDidChangeValueEmitter=new s.Q5,this._onDidTriggerButtonEmitter=new s.Q5,this._onDidHideEmitter=new s.Q5,this._pendingUpdate={id:this._id},this._disposed=!1,this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter],this.onDidChangeValue=this._onDidChangeValueEmitter.event,this.onDidAccept=this._onDidAcceptEmitter.event,this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event,this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update({title:e})}get step(){return this._steps}set step(e){this._steps=e,this.update({step:e})}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update({totalSteps:e})}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update({enabled:e})}get busy(){return this._busy}set busy(e){this._busy=e,this.update({busy:e})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){this._ignoreFocusOut=e,this.update({ignoreFocusOut:e})}get value(){return this._value}set value(e){this._value=e,this.update({value:e})}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update({placeholder:e})}get buttons(){return this._buttons}set buttons(e){this._buttons=e.slice(),this._handlesToButtons.clear(),e.forEach(((e,t)=>{const i=e===x.ApZ.Back?-1:t;this._handlesToButtons.set(i,e)})),this.update({buttons:e.map(((e,t)=>({...u(e.iconPath),tooltip:e.tooltip,handle:e===x.ApZ.Back?-1:t})))})}show(){this._visible=!0,this._expectingHide=!0,this.update({visible:!0})}hide(){this._visible=!1,this.update({visible:!1})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(e){this._value=e,this._onDidChangeValueEmitter.fire(e)}_fireDidTriggerButton(e){const t=this._handlesToButtons.get(e);t&&this._onDidTriggerButtonEmitter.fire(t)}_fireDidHide(){this._expectingHide&&(this._expectingHide=this._visible,this._onDidHideEmitter.fire())}dispose(){this._disposed||(this._disposed=!0,this._fireDidHide(),this._disposables=(0,o.B9)(this._disposables),this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this._onDidDispose(),a.$dispose(this._id))}update(e){if(!this._disposed){for(const t of Object.keys(e)){const i=e[t];this._pendingUpdate[t]=void 0===i?null:i}"visible"in this._pendingUpdate?(this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this.dispatchUpdate()):this._visible&&!this._updateTimeout&&(this._updateTimeout=setTimeout((()=>{this._updateTimeout=void 0,this.dispatchUpdate()}),0))}}dispatchUpdate(){a.$createOrUpdate(this._pendingUpdate),this._pendingUpdate={id:this._id}}}function u(e){const t=function(e){if(e instanceof x.kS8)return{id:e.id};const t=function(e){return"object"==typeof e&&"dark"in e?e.dark:e}(e),i=function(e){return"object"==typeof e&&"light"in e?e.light:e}(e);return{dark:"string"==typeof t?l.ov.file(t):t,light:"string"==typeof i?l.ov.file(i):i}}(e);let i,r;return"id"in t?r=Ni.kS.asClassName(t):i=t,{iconPath:i,iconClass:r}}class h extends d{constructor(e,t){super(e.identifier,t),this.extension=e,this._items=[],this._handlesToItems=new Map,this._itemsToHandles=new Map,this._canSelectMany=!1,this._matchOnDescription=!0,this._matchOnDetail=!0,this._sortByLabel=!0,this._keepScrollPosition=!1,this._activeItems=[],this._onDidChangeActiveEmitter=new s.Q5,this._selectedItems=[],this._onDidChangeSelectionEmitter=new s.Q5,this._onDidTriggerItemButtonEmitter=new s.Q5,this.onDidChangeActive=this._onDidChangeActiveEmitter.event,this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event,this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter),this.update({type:"quickPick"})}get items(){return this._items}set items(e){this._items=e.slice(),this._handlesToItems.clear(),this._itemsToHandles.clear(),e.forEach(((e,t)=>{this._handlesToItems.set(t,e),this._itemsToHandles.set(e,t)}));const t=(0,j.$x)(this.extension,"quickPickItemTooltip"),i=[];for(let r=0;r<e.length;r++){const n=e[r];if(n.kind===x.qlg.Separator)i.push({type:"separator",label:n.label});else{n.tooltip&&!t&&console.warn(`Extension '${this.extension.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this.extension.identifier.value}`);const e=n.iconPath?u(n.iconPath):void 0;i.push({handle:r,label:n.label,iconPath:e?.iconPath,iconClass:e?.iconClass,description:n.description,detail:n.detail,picked:n.picked,alwaysShow:n.alwaysShow,tooltip:t?P.W5.fromStrict(n.tooltip):void 0,buttons:n.buttons?.map(((e,t)=>({...u(e.iconPath),tooltip:e.tooltip,handle:t})))})}}this.update({items:i})}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update({canSelectMany:e})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update({matchOnDescription:e})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update({matchOnDetail:e})}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update({sortByLabel:e})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e,this.update({keepScrollPosition:e})}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e.filter((e=>this._itemsToHandles.has(e))),this.update({activeItems:this._activeItems.map((e=>this._itemsToHandles.get(e)))})}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e.filter((e=>this._itemsToHandles.has(e))),this.update({selectedItems:this._selectedItems.map((e=>this._itemsToHandles.get(e)))})}_fireDidChangeActive(e){const t=(0,S.kX)(e.map((e=>this._handlesToItems.get(e))));this._activeItems=t,this._onDidChangeActiveEmitter.fire(t)}_fireDidChangeSelection(e){const t=(0,S.kX)(e.map((e=>this._handlesToItems.get(e))));this._selectedItems=t,this._onDidChangeSelectionEmitter.fire(t)}_fireDidTriggerItemButton(e,t){const i=this._handlesToItems.get(e);if(!i||!i.buttons||!i.buttons.length)return;const r=i.buttons[t];r&&this._onDidTriggerItemButtonEmitter.fire({button:r,item:i})}}class p extends d{constructor(e,t){super(e.identifier,t),this._password=!1,this.update({type:"inputBox"})}get password(){return this._password}set password(e){this._password=e,this.update({password:e})}get prompt(){return this._prompt}set prompt(e){this._prompt=e,this.update({prompt:e})}get valueSelection(){return this._valueSelection}set valueSelection(e){this._valueSelection=e,this.update({valueSelection:e})}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,e?"string"==typeof e?this.update({validationMessage:e,severity:c.Z.Error}):this.update({validationMessage:e.message,severity:e.severity??c.Z.Error}):this.update({validationMessage:void 0,severity:c.Z.Ignore})}}return new class{constructor(e,t){this._sessions=new Map,this._instances=0,this._workspace=e,this._commands=t}showQuickPick(e,t,i,s=r.Ts.None){this._onDidSelectItem=void 0;const o=Promise.resolve(t),c=++this._instances,l=a.$show(c,{title:i?.title,placeHolder:i?.placeHolder,matchOnDescription:i?.matchOnDescription,matchOnDetail:i?.matchOnDetail,ignoreFocusLost:i?.ignoreFocusOut,canPickMany:i?.canPickMany},s),d={},h=l.then((()=>d));return Promise.race([h,o]).then((t=>{if(t===d)return;const r=(0,j.$x)(e,"quickPickItemTooltip");return o.then((t=>{const n=[];for(let i=0;i<t.length;i++){const s=t[i];if("string"==typeof s)n.push({label:s,handle:i});else if(s.kind===x.qlg.Separator)n.push({type:"separator",label:s.label});else{s.tooltip&&!r&&console.warn(`Extension '${e.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${e.identifier.value}`);const t=s.iconPath?u(s.iconPath):void 0;n.push({label:s.label,iconPath:t?.iconPath,iconClass:t?.iconClass,description:s.description,detail:s.detail,picked:s.picked,alwaysShow:s.alwaysShow,tooltip:r?P.W5.fromStrict(s.tooltip):void 0,handle:i})}}return i&&"function"==typeof i.onDidSelectItem&&(this._onDidSelectItem=e=>{i.onDidSelectItem(t[e])}),a.$setItems(c,n),l.then((e=>"number"==typeof e?t[e]:Array.isArray(e)?e.map((e=>t[e])):void 0))}))})).then(void 0,(e=>{if(!(0,n.n2)(e))return a.$setError(c,e),Promise.reject(e)}))}$onItemSelected(e){this._onDidSelectItem?.(e)}showInput(e,t=r.Ts.None){return this._validateInput=e?.validateInput,a.$input(e,"function"==typeof this._validateInput,t).then(void 0,(e=>{if(!(0,n.n2)(e))return Promise.reject(e)}))}async $validateInput(e){if(!this._validateInput)return;const t=await this._validateInput(e);if(!t||"string"==typeof t)return t;let i;switch(t.severity){case x.S$x.Info:i=c.Z.Info;break;case x.S$x.Warning:i=c.Z.Warning;break;case x.S$x.Error:i=c.Z.Error;break;default:i=t.message?c.Z.Error:c.Z.Ignore}return{content:t.message,severity:i}}async showWorkspaceFolderPick(e,t=r.Ts.None){const i=await this._commands.executeCommand("_workbench.pickWorkspaceFolder",[e]);if(!i)return;const n=await this._workspace.getWorkspaceFolders2();return n?n.find((e=>e.uri.toString()===i.uri.toString())):void 0}createQuickPick(e){const t=new h(e,(()=>this._sessions.delete(t._id)));return this._sessions.set(t._id,t),t}createInputBox(e){const t=new p(e,(()=>this._sessions.delete(t._id)));return this._sessions.set(t._id,t),t}$onDidChangeValue(e,t){const i=this._sessions.get(e);i?._fireDidChangeValue(t)}$onDidAccept(e){const t=this._sessions.get(e);t?._fireDidAccept()}$onDidChangeActive(e,t){const i=this._sessions.get(e);i instanceof h&&i._fireDidChangeActive(t)}$onDidChangeSelection(e,t){const i=this._sessions.get(e);i instanceof h&&i._fireDidChangeSelection(t)}$onDidTriggerButton(e,t){const i=this._sessions.get(e);i?._fireDidTriggerButton(t)}$onDidTriggerItemButton(e,t,i){const r=this._sessions.get(e);r instanceof h&&r._fireDidTriggerItemButton(t,i)}$onDidHide(e){const t=this._sessions.get(e);t?._fireDidHide()}}(t,i)}var Fi,Mi=i(76112),Oi=i(11547);function Hi(e){return e instanceof l.ov}function Ui(e,t){return e.scheme===a.lg.file&&t.scheme===a.lg.file&&Oi.IJ?e.toString()===t.toString():e.toString().toLowerCase()===t.toString().toLowerCase()}function Bi(e){return e?"string"==typeof e.iconPath?l.ov.file(e.iconPath):l.ov.isUri(e.iconPath)||Ni.kS.isThemeIcon(e.iconPath)?e.iconPath:void 0:void 0}function Wi(e){if(e.icon){if(l.ov.isUri(e.icon))return e.icon;if(Ni.kS.isThemeIcon(e.icon))return e.icon;{const t=e.icon;return{light:t.light,dark:t.dark}}}}function Vi(e,t){if(!e.iconPath&&!t.iconPath)return 0;if(!e.iconPath)return-1;if(!t.iconPath)return 1;const i="string"==typeof e.iconPath?e.iconPath:l.ov.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id,r="string"==typeof t.iconPath?t.iconPath:l.ov.isUri(t.iconPath)?t.iconPath.fsPath:t.iconPath.id;return(0,Mi.W7)(i,r)}function qi(e,t){let i=(0,Mi.W7)(e.resourceUri.fsPath,t.resourceUri.fsPath,!0);if(0!==i)return i;if(e.command&&t.command)i=function(e,t){if(e.command!==t.command)return e.command<t.command?-1:1;if(e.title!==t.title)return e.title<t.title?-1:1;if(e.tooltip!==t.tooltip){if(void 0!==e.tooltip&&void 0!==t.tooltip)return e.tooltip<t.tooltip?-1:1;if(void 0!==e.tooltip)return 1;if(void 0!==t.tooltip)return-1}if(e.arguments===t.arguments)return 0;if(!e.arguments)return-1;if(!t.arguments)return 1;if(e.arguments.length!==t.arguments.length)return e.arguments.length-t.arguments.length;for(let i=0;i<e.arguments.length;i++){const r=e.arguments[i],n=t.arguments[i];if(r!==n&&!(Hi(r)&&Hi(n)&&Ui(r,n)))return r<n?-1:1}return 0}(e.command,t.command);else{if(e.command)return 1;if(t.command)return-1}if(0!==i)return i;if(e.decorations&&t.decorations)i=function(e,t){let i=0;if(e.strikeThrough!==t.strikeThrough)return e.strikeThrough?1:-1;if(e.faded!==t.faded)return e.faded?1:-1;if(e.tooltip!==t.tooltip)return(e.tooltip||"").localeCompare(t.tooltip||"");if(i=Vi(e,t),0!==i)return i;if(e.light&&t.light)i=Vi(e.light,t.light);else{if(e.light)return 1;if(t.light)return-1}if(0!==i)return i;if(e.dark&&t.dark)i=Vi(e.dark,t.dark);else{if(e.dark)return 1;if(t.dark)return-1}return i}(e.decorations,t.decorations);else{if(e.decorations)return 1;if(t.decorations)return-1}if(e.multiFileDiffEditorModifiedUri&&t.multiFileDiffEditorModifiedUri)i=(0,Mi.W7)(e.multiFileDiffEditorModifiedUri.fsPath,t.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(e.multiFileDiffEditorModifiedUri)return 1;if(t.multiFileDiffEditorModifiedUri)return-1}if(e.multiDiffEditorOriginalUri&&t.multiDiffEditorOriginalUri)i=(0,Mi.W7)(e.multiDiffEditorOriginalUri.fsPath,t.multiDiffEditorOriginalUri.fsPath,!0);else{if(e.multiDiffEditorOriginalUri)return 1;if(t.multiDiffEditorOriginalUri)return-1}return i}function ji(e,t){return e.command===t.command&&e.title===t.title&&e.tooltip===t.tooltip&&(e.arguments&&t.arguments?function(e,t){for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}(e.arguments,t.arguments):e.arguments===t.arguments)}class Ki{#e;#I;get value(){return this._value}set value(e){e=e??"",this.#e.$setInputBoxValue(this._sourceControlHandle,e),this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){this.#e.$setInputBoxPlaceholder(this._sourceControlHandle,e),this._placeholder=e}get validateInput(){return(0,j.H5)(this._extension,"scmValidation"),this._validateInput}set validateInput(e){if((0,j.H5)(this._extension,"scmValidation"),e&&"function"!=typeof e)throw new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);this._validateInput=e,this.#e.$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,this.#e.$setInputBoxEnablement(this._sourceControlHandle,e))}get visible(){return this._visible}set visible(e){e=!!e,this._visible!==e&&(this._visible=e,this.#e.$setInputBoxVisibility(this._sourceControlHandle,e))}get document(){return(0,j.H5)(this._extension,"scmTextDocument"),this.#I.getDocument(this._documentUri)}constructor(e,t,i,r,n){this._extension=e,this._sourceControlHandle=r,this._documentUri=n,this._value="",this._onDidChange=new s.Q5,this._placeholder="",this._enabled=!0,this._visible=!0,this.#I=t,this.#e=i}showValidationMessage(e,t){(0,j.H5)(this._extension,"scmValidation"),this.#e.$showValidationMessage(this._sourceControlHandle,e,t)}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e,this._onDidChange.fire(e)}}class Qi{static{this._handlePool=0}get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(e){this._label=e,this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,e)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(e){this._hideWhenEmpty=e,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(e){this._resourceStates=[...e],this._onDidUpdateResourceStates.fire()}constructor(e,t,i,r,n,o,a){this._proxy=e,this._commands=t,this._sourceControlHandle=i,this._id=r,this._label=n,this.multiDiffEditorEnableViewChanges=o,this._extension=a,this._resourceHandlePool=0,this._resourceStates=[],this._resourceStatesMap=new Map,this._resourceStatesCommandsMap=new Map,this._resourceStatesDisposablesMap=new Map,this._onDidUpdateResourceStates=new s.Q5,this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event,this._disposed=!1,this._onDidDispose=new s.Q5,this.onDidDispose=this._onDidDispose.event,this._handlesSnapshot=[],this._resourceSnapshot=[],this._hideWhenEmpty=void 0,this.handle=Qi._handlePool++}getResourceState(e){return this._resourceStatesMap.get(e)}$executeResourceCommand(e,t){const i=this._resourceStatesCommandsMap.get(e);return i?(0,H.OH)((()=>this._commands.executeCommand(i.command,...i.arguments||[],t))):Promise.resolve(void 0)}_takeResourceStateSnapshot(){const e=[...this._resourceStates].sort(qi),t=(0,S.XZ)(this._resourceSnapshot,e,qi).map((e=>{const t=e.toInsert.map((e=>{const t=this._resourceHandlePool++;this._resourceStatesMap.set(t,e);const i=e.resourceUri;let r;if(e.command)if("vscode.open"===e.command.command||"vscode.diff"===e.command.command||"vscode.changes"===e.command.command){const i=new o.SL;r=this._commands.converter.toInternal(e.command,i),this._resourceStatesDisposablesMap.set(t,i)}else this._resourceStatesCommandsMap.set(t,e.command);const n=(0,j.$x)(this._extension,"scmMultiDiffEditor"),s=n?e.multiDiffEditorOriginalUri:void 0,a=n?e.multiFileDiffEditorModifiedUri:void 0,c=Bi(e.decorations);return{rawResource:[t,i,[e.decorations&&Bi(e.decorations.light)||c,e.decorations&&Bi(e.decorations.dark)||c],e.decorations&&e.decorations.tooltip||"",e.decorations&&!!e.decorations.strikeThrough,e.decorations&&!!e.decorations.faded,e.contextValue||"",r,s,a],handle:t}}));return{start:e.start,deleteCount:e.deleteCount,toInsert:t}})),i=t.map((({start:e,deleteCount:t,toInsert:i})=>[e,t,i.map((e=>e.rawResource))])),r=t.reverse();for(const{start:e,deleteCount:t,toInsert:i}of r){const r=i.map((e=>e.handle)),n=this._handlesSnapshot.splice(e,t,...r);for(const e of n)this._resourceStatesMap.delete(e),this._resourceStatesCommandsMap.delete(e),this._resourceStatesDisposablesMap.get(e)?.dispose(),this._resourceStatesDisposablesMap.delete(e)}return this._resourceSnapshot=e,i}dispose(){this._disposed=!0,this._onDidDispose.fire()}}class Gi{static{this._handlePool=0}#e;get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get inputBox(){return this._inputBox}get count(){return this._count}set count(e){this._count!==e&&(this._count=e,this.#e.$updateSourceControl(this.handle,{count:e}))}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(e){let t;this._quickDiffProvider=e,(0,j.$x)(this._extension,"quickDiffProvider")&&(t=e?.label),this.#e.$updateSourceControl(this.handle,{hasQuickDiffProvider:!!e,quickDiffLabel:t})}get historyProvider(){return(0,j.H5)(this._extension,"scmHistoryProvider"),this._historyProvider}set historyProvider(e){(0,j.H5)(this._extension,"scmHistoryProvider"),this._historyProvider=e,this._historyProviderDisposable.value=new o.SL,this.#e.$updateSourceControl(this.handle,{hasHistoryProvider:!!e}),e&&this._historyProviderDisposable.value.add(e.onDidChangeCurrentHistoryItemGroup((()=>{this._historyProviderCurrentHistoryItemGroup=e?.currentHistoryItemGroup,this.#e.$onDidChangeHistoryProviderCurrentHistoryItemGroup(this.handle,this._historyProviderCurrentHistoryItemGroup)})))}get commitTemplate(){return this._commitTemplate}set commitTemplate(e){e!==this._commitTemplate&&(this._commitTemplate=e,this.#e.$updateSourceControl(this.handle,{commitTemplate:e}))}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(e){this._acceptInputDisposables.value=new o.SL,this._acceptInputCommand=e;const t=this._commands.converter.toInternal(e,this._acceptInputDisposables.value);this.#e.$updateSourceControl(this.handle,{acceptInputCommand:t})}get actionButton(){return(0,j.H5)(this._extension,"scmActionButton"),this._actionButton}set actionButton(e){(0,j.H5)(this._extension,"scmActionButton"),this._actionButtonDisposables.value=new o.SL,this._actionButton=e;const t=void 0!==e?{command:this._commands.converter.toInternal(e.command,this._actionButtonDisposables.value),secondaryCommands:e.secondaryCommands?.map((e=>e.map((e=>this._commands.converter.toInternal(e,this._actionButtonDisposables.value))))),description:e.description,enabled:e.enabled}:void 0;this.#e.$updateSourceControl(this.handle,{actionButton:t??null})}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(e){if(this._statusBarCommands&&e&&(t=this._statusBarCommands,i=e,(0,S.fS)(t,i,ji)))return;var t,i;this._statusBarDisposables.value=new o.SL,this._statusBarCommands=e;const r=(e||[]).map((e=>this._commands.converter.toInternal(e,this._statusBarDisposables.value)));this.#e.$updateSourceControl(this.handle,{statusBarCommands:r})}get selected(){return this._selected}constructor(e,t,i,r,n,c,d){this._extension=e,this._commands=r,this._id=n,this._label=c,this._rootUri=d,this._groups=new Map,this._count=void 0,this._quickDiffProvider=void 0,this._historyProviderDisposable=new o.XK,this._commitTemplate=void 0,this._acceptInputDisposables=new o.XK,this._acceptInputCommand=void 0,this._actionButtonDisposables=new o.XK,this._statusBarDisposables=new o.XK,this._statusBarCommands=void 0,this._selected=!1,this._onDidChangeSelection=new s.Q5,this.onDidChangeSelection=this._onDidChangeSelection.event,this.handle=Gi._handlePool++,this.createdResourceGroups=new Map,this.updatedResourceGroups=new Set,this.#e=i;const u=l.ov.from({scheme:a.lg.vscodeSourceControl,path:`${n}/scm${this.handle}/input`,query:d?`rootUri=${encodeURIComponent(d.toString())}`:void 0});this._inputBox=new Ki(e,t,this.#e,this.handle,u),this.#e.$registerSourceControl(this.handle,n,c,d,u)}createResourceGroup(e,t,i){const r=(0,j.$x)(this._extension,"scmMultiDiffEditor")&&!0===i?.multiDiffEditorEnableViewChanges,n=new Qi(this.#e,this._commands,this.handle,e,t,r,this._extension),o=s.ju.once(n.onDidDispose)((()=>this.createdResourceGroups.delete(n)));return this.createdResourceGroups.set(n,o),this.eventuallyAddResourceGroups(),n}eventuallyAddResourceGroups(){const e=[],t=[];for(const[i,r]of this.createdResourceGroups){r.dispose();const n=i.onDidUpdateResourceStates((()=>{this.updatedResourceGroups.add(i),this.eventuallyUpdateResourceStates()}));s.ju.once(i.onDidDispose)((()=>{this.updatedResourceGroups.delete(i),n.dispose(),this._groups.delete(i.handle),this.#e.$unregisterGroup(this.handle,i.handle)})),e.push([i.handle,i.id,i.label,i.features,i.multiDiffEditorEnableViewChanges]);const o=i._takeResourceStateSnapshot();o.length>0&&t.push([i.handle,o]),this._groups.set(i.handle,i)}this.#e.$registerGroups(this.handle,e,t),this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){const e=[];this.updatedResourceGroups.forEach((t=>{const i=t._takeResourceStateSnapshot();0!==i.length&&e.push([t.handle,i])})),e.length>0&&this.#e.$spliceResourceStates(this.handle,e),this.updatedResourceGroups.clear()}getResourceGroup(e){return this._groups.get(e)}setSelectionState(e){this._selected=e,this._onDidChangeSelection.fire(e)}dispose(){this._acceptInputDisposables.dispose(),this._actionButtonDisposables.dispose(),this._statusBarDisposables.dispose(),this._groups.forEach((e=>e.dispose())),this.#e.$unregisterSourceControl(this.handle)}}Gi.__decorator=(0,z.g)([(0,Ai.Ds)(100)],Gi.prototype,"eventuallyAddResourceGroups",null),Gi.__decorator=(0,z.g)([(0,Ai.Ds)(100)],Gi.prototype,"eventuallyUpdateResourceStates",null);let Ji=class{static{Fi=this}static{this._handlePool=0}get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(e,t,i,r){this._commands=t,this._extHostDocuments=i,this.logService=r,this._sourceControls=new Map,this._sourceControlsByExtension=new m.C1,this._onDidChangeActiveProvider=new s.Q5,this._proxy=e.getProxy(y.Tr.MainThreadSCM),this._telemetry=e.getProxy(y.Tr.MainThreadTelemetry),t.registerArgumentProcessor({processArgument:e=>{if(e&&3===e.$mid){const t=this._sourceControls.get(e.sourceControlHandle);if(!t)return e;const i=t.getResourceGroup(e.groupHandle);return i?i.getResourceState(e.handle):e}if(e&&4===e.$mid){const t=this._sourceControls.get(e.sourceControlHandle);return t?t.getResourceGroup(e.groupHandle):e}if(e&&5===e.$mid){const t=this._sourceControls.get(e.handle);return t||e}return e}})}createSourceControl(e,t,i,r){this.logService.trace("ExtHostSCM#createSourceControl",e.identifier.value,t,i,r),this._telemetry.$publicLog2("api/scm/createSourceControl",{extensionId:e.identifier.value});const n=Fi._handlePool++,s=new Gi(e,this._extHostDocuments,this._proxy,this._commands,t,i,r);this._sourceControls.set(n,s);const o=this._sourceControlsByExtension.get(e.identifier)||[];return o.push(s),this._sourceControlsByExtension.set(e.identifier,o),s}getLastInputBox(e){this.logService.trace("ExtHostSCM#getLastInputBox",e.identifier.value);const t=this._sourceControlsByExtension.get(e.identifier),i=t&&t[t.length-1];return i&&i.inputBox}$provideOriginalResource(e,t,i){const r=l.ov.revive(t);this.logService.trace("ExtHostSCM#$provideOriginalResource",e,r.toString());const n=this._sourceControls.get(e);return n&&n.quickDiffProvider&&n.quickDiffProvider.provideOriginalResource?(0,H.OH)((()=>n.quickDiffProvider.provideOriginalResource(r,i))).then((e=>e||null)):Promise.resolve(null)}$onInputBoxValueChange(e,t){this.logService.trace("ExtHostSCM#$onInputBoxValueChange",e);const i=this._sourceControls.get(e);return i?(i.inputBox.$onInputBoxValueChange(t),Promise.resolve(void 0)):Promise.resolve(void 0)}$executeResourceCommand(e,t,i,r){this.logService.trace("ExtHostSCM#$executeResourceCommand",e,t,i);const n=this._sourceControls.get(e);if(!n)return Promise.resolve(void 0);const s=n.getResourceGroup(t);return s?s.$executeResourceCommand(i,r):Promise.resolve(void 0)}$validateInput(e,t,i){this.logService.trace("ExtHostSCM#$validateInput",e);const r=this._sourceControls.get(e);return r&&r.inputBox.validateInput?(0,H.OH)((()=>r.inputBox.validateInput(t,i))).then((e=>{if(!e)return Promise.resolve(void 0);const t=P.W5.fromStrict(e.message);return t?Promise.resolve([t,e.type]):Promise.resolve(void 0)})):Promise.resolve(void 0)}$setSelectedSourceControl(e){return this.logService.trace("ExtHostSCM#$setSelectedSourceControl",e),void 0!==e&&this._sourceControls.get(e)?.setSelectionState(!0),void 0!==this._selectedSourceControlHandle&&this._sourceControls.get(this._selectedSourceControlHandle)?.setSelectionState(!1),this._selectedSourceControlHandle=e,Promise.resolve(void 0)}async $resolveHistoryItemGroupCommonAncestor(e,t,i,r){const n=this._sourceControls.get(e)?.historyProvider;return await(n?.resolveHistoryItemGroupCommonAncestor(t,i,r))??void 0}async $provideHistoryItems(e,t,i,r){const n=this._sourceControls.get(e)?.historyProvider,s=await(n?.provideHistoryItems(t,i,r));return s?.map((e=>({...e,icon:Wi(e)})))??void 0}async $provideHistoryItemSummary(e,t,i,r){const n=this._sourceControls.get(e)?.historyProvider;if("function"!=typeof n?.provideHistoryItemSummary)return;const s=await n.provideHistoryItemSummary(t,i,r);return s?{...s,icon:Wi(s)}:void 0}async $provideHistoryItemChanges(e,t,i,r){const n=this._sourceControls.get(e)?.historyProvider;return await(n?.provideHistoryItemChanges(t,i,r))??void 0}};Ji=Fi=(0,z.g)([(0,z.f)(3,v.V)],Ji);var Yi=i(28200),Xi=i(8685);class Zi{static{this.handlePool=0}constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(y.Tr.MainThreadShare)}async $provideShare(e,t,i){const r=this.providers.get(e);return await(r?.provideShare({selection:P.e6.to(t.selection),resourceUri:l.ov.revive(t.resourceUri)},i))??void 0}registerShareProvider(e,t){const i=Zi.handlePool++;return this.providers.set(i,t),this.proxy.$registerShareProvider(i,P.Lq.from(e,this.uriTransformer),t.id,t.label,t.priority),{dispose:()=>{this.proxy.$unregisterShareProvider(i),this.providers.delete(i)}}}}class er{static{this.ID_POOL=1}constructor(e){this.providers=new Map,this.sessions=new Map,this.proxy=e.getProxy(y.Tr.MainThreadSpeech)}async $createSpeechToTextSession(e,t,i){const n=this.providers.get(e);if(!n)return;const s=new o.SL,a=new r.AU;this.sessions.set(t,a);const c=s.add(n.provideSpeechToTextSession(a.token,i?{language:i}:void 0));s.add(c.onDidChange((e=>{a.token.isCancellationRequested||this.proxy.$emitSpeechToTextEvent(t,e)}))),s.add(a.token.onCancellationRequested((()=>s.dispose())))}async $cancelSpeechToTextSession(e){this.sessions.get(e)?.dispose(!0),this.sessions.delete(e)}async $createKeywordRecognitionSession(e,t){const i=this.providers.get(e);if(!i)return;const n=new o.SL,s=new r.AU;this.sessions.set(t,s);const a=n.add(i.provideKeywordRecognitionSession(s.token));n.add(a.onDidChange((e=>{s.token.isCancellationRequested||this.proxy.$emitKeywordRecognitionEvent(t,e)}))),n.add(s.token.onCancellationRequested((()=>n.dispose())))}async $cancelKeywordRecognitionSession(e){this.sessions.get(e)?.dispose(!0),this.sessions.delete(e)}registerProvider(e,t,i){const r=er.ID_POOL++;return this.providers.set(r,i),this.proxy.$registerProvider(r,t,{extension:e,displayName:e.value}),(0,o.OF)((()=>{this.proxy.$unregisterProvider(r),this.providers.delete(r)}))}}const tr="vs/workbench/api/common/extHostStatusBar";class ir{static{this.ID_GEN=0}static{this.ALLOWED_BACKGROUND_COLORS=new Map([["statusBarItem.errorBackground",new x.tPk("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new x.tPk("statusBarItem.warningForeground")]])}#e;#P;constructor(e,t,i,r,n,s=x.MIn.Left,a){if(this._disposed=!1,this._text="",this._staleCommandRegistrations=new o.SL,this.#e=e,this.#P=t,n&&r){this._entryId=(0,x.yHy)(r.identifier,n);const e=i.get(this._entryId);e&&(s=e.alignLeft?x.MIn.Left:x.MIn.Right,a=e.priority,this._visible=!0,this.name=e.name,this.text=e.text,this.tooltip=e.tooltip,this.command=e.command,this.accessibilityInformation=e.accessibilityInformation)}else this._entryId=String(ir.ID_GEN++);this._extension=r,this._id=n,this._alignment=s,this._priority=this.validatePriority(a)}validatePriority(e){if((0,V.hj)(e))return e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:e}get id(){return this._id??this._extension.identifier.value}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){return this._command?.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(e){this._text=e,this.update()}set name(e){this._name=e,this.update()}set tooltip(e){this._tooltip=e,this.update()}set color(e){this._color=e,this.update()}set backgroundColor(e){e&&!ir.ALLOWED_BACKGROUND_COLORS.has(e.id)&&(e=void 0),this._backgroundColor=e,this.update()}set command(e){this._command?.fromApi!==e&&(this._latestCommandRegistration&&this._staleCommandRegistrations.add(this._latestCommandRegistration),this._latestCommandRegistration=new o.SL,this._command="string"==typeof e?{fromApi:e,internal:this.#P.toInternal({title:"",command:e},this._latestCommandRegistration)}:e?{fromApi:e,internal:this.#P.toInternal(e,this._latestCommandRegistration)}:void 0,this.update())}set accessibilityInformation(e){this._accessibilityInformation=e,this.update()}show(){this._visible=!0,this.update()}hide(){clearTimeout(this._timeoutHandle),this._visible=!1,this.#e.$disposeEntry(this._entryId)}update(){!this._disposed&&this._visible&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout((()=>{let e,t;this._timeoutHandle=void 0,e=this._extension?this._id?`${this._extension.identifier.value}.${this._id}`:this._extension.identifier.value:this._id,t=this._name?this._name:(0,De.C$)(tr,0,"{0} (Extension)",this._extension.displayName||this._extension.name);let i=this._color;this._backgroundColor&&(i=ir.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id));const r=P.W5.fromStrict(this._tooltip);this.#e.$setEntry(this._entryId,e,this._extension?.identifier.value,t,this._text,r,this._command?.internal,i,this._backgroundColor,this._alignment===x.MIn.Left,this._priority,this._accessibilityInformation),this._staleCommandRegistrations.clear()}),0))}dispose(){this.hide(),this._disposed=!0}}class rr{constructor(e){this._messages=[],this._item=e.createStatusBarEntry(void 0,"status.extensionMessage",x.MIn.Left,Number.MIN_VALUE),this._item.name=(0,De.C$)(tr,1,"Extension Status")}dispose(){this._messages.length=0,this._item.dispose()}setMessage(e){const t={message:e};return this._messages.unshift(t),this._update(),new x.JTr((()=>{const e=this._messages.indexOf(t);e>=0&&(this._messages.splice(e,1),this._update())}))}_update(){this._messages.length>0?(this._item.text=this._messages[0].message,this._item.show()):this._item.hide()}}class nr{constructor(e,t){this._existingItems=new Map,this._proxy=e.getProxy(y.Tr.MainThreadStatusBar),this._commands=t,this._statusMessage=new rr(this)}$acceptStaticEntries(e){for(const t of e)this._existingItems.set(t.entryId,t)}createStatusBarEntry(e,t,i,r){return new ir(this._proxy,this._commands,this._existingItems,e,t,i,r)}setStatusBarMessage(e,t){const i=this._statusMessage.setMessage(e);let r;return"number"==typeof t?r=setTimeout((()=>i.dispose()),t):void 0!==t&&t.then((()=>i.dispose()),(()=>i.dispose())),new x.JTr((()=>{i.dispose(),clearTimeout(r)}))}}var sr=i(34142),or=i(3621),ar=i(87958),cr=i(3560),lr=i(82209),dr=i(60192),ur=i(21033),hr=i(92004),pr=i(34472),mr=i(45675),fr=i(44383),gr=i(33089);let vr=class extends o.JT{constructor(e,t,i,r){super(),this.editors=r,this.resultsChangedEmitter=this._register(new s.Q5),this.controllers=new Map,this.defaultProfilesChangedEmitter=this._register(new s.Q5),this.onResultsChanged=this.resultsChangedEmitter.event,this.results=[],this.proxy=e.getProxy(y.Tr.MainThreadTesting),this.observer=new Sr(this.proxy),this.runTracker=new br(this.proxy,t),i.registerArgumentProcessor({processArgument:e=>{switch(e?.$mid){case 16:{const t=e,i=t.tests[t.tests.length-1].item.extId,r=this.controllers.get(mr.u.root(i));return r?.collection.tree.get(i)?.actual??(0,pr.n2)(e)}case 18:{const{test:t,message:i}=e,r=t.item.extId;return{test:this.controllers.get(mr.u.root(r))?.collection.tree.get(r)?.actual??(0,pr.n2)({$mid:16,tests:[t]}),message:P.lt.to(i)}}default:return e}}}),i.registerCommand(!1,"testing.getExplorerSelection",(async()=>{const e=await i.executeCommand("_testing.getExplorerSelection"),t=e=>{const t=this.controllers.get(mr.u.root(e));if(t)return mr.u.isRoot(e)?t.controller:t.collection.tree.get(e)?.actual};return{include:e?.include.map(t).filter(V.$K)||[],exclude:e?.exclude.map(t).filter(V.$K)||[]}}))}createTestController(e,t,i,r){if(this.controllers.has(t))throw new Error(`Attempt to insert a duplicate controller with ID "${t}"`);const n=new o.SL,s=n.add(new pr.Hb(t,i,this.editors));s.root.label=i;const a=new Map,c=new Set,l=this.proxy,d={items:s.root.children,get label(){return i},set label(e){i=e,s.root.label=e,l.$updateController(t,{label:i})},get refreshHandler(){return r},set refreshHandler(e){r=e,l.$updateController(t,{canRefresh:!!e})},get id(){return t},createRunProfile:(e,i,r,n,s,o)=>{let l=(0,oe.vp)(e);for(;a.has(l);)l++;return new Dr(this.proxy,a,c,this.defaultProfilesChangedEmitter.event,t,l,e,i,r,n,s,o)},createTestItem(e,i,r){return new pr.SJ(t,e,i,r)},createTestRun:(e,i,r=!0)=>this.runTracker.createTestRun(t,s,e,i,r),invalidateTestResults:e=>{if(void 0===e)this.proxy.$markTestRetired(void 0);else{const i=e instanceof Array?e:[e];this.proxy.$markTestRetired(i.map((e=>mr.u.fromExtHostTestItem(e,t).toString())))}},set resolveHandler(e){s.resolveHandler=e},get resolveHandler(){return s.resolveHandler},dispose:()=>{n.dispose()}};l.$registerTestController(t,i,!!r),n.add((0,o.OF)((()=>l.$unregisterTestController(t))));const u={controller:d,collection:s,profiles:a,extension:e,activeProfiles:c};return this.controllers.set(t,u),n.add((0,o.OF)((()=>this.controllers.delete(t)))),n.add(s.onDidGenerateDiff((e=>l.$publishDiff(t,e.map(gr.cZ.serialize))))),d}createTestObserver(){return this.observer.checkout()}async runTests(e,t=r.Ts.None){const i=wr(e);if(!i)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const n=this.controllers.get(i.controllerId);if(!n)throw new Error("Controller not found");await this.proxy.$runTests({preserveFocus:e.preserveFocus??!0,targets:[{testIds:e.include?.map((e=>mr.u.fromExtHostTestItem(e,n.collection.root.id).toString()))??[n.collection.root.id],profileGroup:kr[i.kind],profileId:i.profileId,controllerId:i.controllerId}],exclude:e.exclude?.map((e=>e.id))},t)}$syncTests(){for(const{collection:e}of this.controllers.values())e.flushDiff();return Promise.resolve()}async $getCoverageDetails(e,t){const i=await this.runTracker.getCoverageDetails(e,t);return i?.map(P.xC.fromDetails)}async $disposeRun(e){this.runTracker.disposeTestRun(e)}$configureRunProfile(e,t){this.controllers.get(e)?.profiles.get(t)?.configureHandler?.()}$setDefaultRunProfiles(e){const t=new Map;for(const[i,r]of Object.entries(e)){const e=this.controllers.get(i);if(!e)continue;const n=new Map,s=r.filter((t=>!e.activeProfiles.has(t))),o=[...e.activeProfiles].filter((e=>!r.includes(e)));for(const t of s)n.set(t,!0),e.activeProfiles.add(t);for(const t of o)n.set(t,!1),e.activeProfiles.delete(t);n.size&&t.set(i,n)}this.defaultProfilesChangedEmitter.fire(t)}async $refreshTests(e,t){await(this.controllers.get(e)?.controller.refreshHandler?.(t))}$publishTestResults(e){this.results=Object.freeze(e.map(P.P1.to).concat(this.results).sort(((e,t)=>t.completedAt-e.completedAt)).slice(0,32)),this.resultsChangedEmitter.fire()}async $expandTest(e,t){const i=this.controllers.get(mr.u.fromString(e).controllerId)?.collection;i&&(await i.expand(e,t<0?1/0:t),i.flushDiff())}$acceptDiff(e){this.observer.applyDiff(e.map((e=>gr.cZ.deserialize({asCanonicalUri:e=>e},e))))}async $runControllerTests(e,t){return Promise.all(e.map((e=>this.runControllerTestRequest(e,!1,t))))}async $startContinuousRun(e,t){const i=new r.AU(t),n=await Promise.all(e.map((e=>this.runControllerTestRequest(e,!0,i.token))));return t.isCancellationRequested||n.some((e=>e.error))||await new Promise((e=>t.onCancellationRequested(e))),i.dispose(!0),n}async runControllerTestRequest(e,t,i){const r=this.controllers.get(e.controllerId);if(!r)return{};const{collection:n,profiles:o}=r,a=o.get(e.profileId);if(!a)return{};const c=e.testIds.map((e=>n.tree.get(e))).filter(V.$K),l=e.excludeExtIds.map((e=>r.collection.tree.get(e))).filter(V.$K).filter((e=>c.some((t=>2===t.fullId.compare(e.fullId)))));if(!c.length)return{};const d=new x.$hL(c.some((e=>e.actual instanceof pr.qN))?void 0:c.map((e=>e.actual)),l.map((e=>e.actual)),a,t),u=(0,gr.Gc)(e)&&this.runTracker.prepareForMainThreadTestRun(d,yr.fromInternal(e,r.collection),a,i);try{return await a.runHandler(d,i),{}}catch(e){return{error:String(e)}}finally{u&&u.hasRunningTasks&&!i.isCancellationRequested&&await s.ju.toPromise(u.onEnd)}}$cancelExtensionTestRun(e){void 0===e?this.runTracker.cancelAllRuns():this.runTracker.cancelRunById(e)}};vr=(0,z.g)([(0,z.f)(0,F.O),(0,z.f)(1,v.V)],vr);class _r extends o.JT{get hasRunningTasks(){return this.running>0}get id(){return this.dto.id}constructor(e,t,i,n,a){super(),this.dto=e,this.proxy=t,this.logService=i,this.profile=n,this.state=0,this.running=0,this.tasks=new Map,this.sharedTestIds=new Set,this.endEmitter=this._register(new s.Q5),this.publishedCoverage=new Map,this.onEnd=this.endEmitter.event,this.cts=this._register(new r.AU(a));const c=this._register(new H.pY((()=>this.forciblyEndTasks()),1e4));this._register(this.cts.token.onCancellationRequested((()=>c.schedule())));const l=new s.Q5;this.onDidDispose=l.event,this._register((0,o.OF)((()=>{l.fire(),l.dispose()})))}cancel(){0===this.state?(this.cts.cancel(),this.state=1):1===this.state&&this.forciblyEndTasks()}getCoverageDetails(e,t){const[,i,r]=mr.u.fromString(e).path,n=this.publishedCoverage.get(r);if(!n)return[];const s=this.tasks.get(i);if(!s)throw new Error("unreachable: run task was not found");return this.profile?.loadDetailedCoverage?.(s.run,n,t)??[]}createRun(e){const t=this.dto.id,i=this.dto.controllerId,r=(0,hr.R)(),n=e=>(t,...i)=>{o?this.logService.warn(`Setting the state of test "${t.id}" is a no-op after the run ends.`):this.dto.isIncluded(t)&&(this.ensureTestIsKnown(t),e(t,...i))},s=(e,n)=>{const s=n instanceof Array?n.map(P.lt.from):[P.lt.from(n)];if(e.uri&&e.range){const t={range:P.e6.from(e.range),uri:e.uri};for(const e of s)e.location=e.location||t}this.proxy.$appendTestMessagesInRun(t,r,mr.u.fromExtHostTestItem(e,i).toString(),s)};let o=!1;const a={isPersisted:this.dto.isPersisted,token:this.cts.token,name:e,onDidDispose:this.onDidDispose,addCoverage:e=>{const i=e.uri.toString(),n=new mr.u([t,r,i]).toString();this.publishedCoverage.set(i,e),this.proxy.$appendCoverage(t,r,P.xC.fromFile(n,e))},enqueued:n((e=>{this.proxy.$updateTestStateInRun(t,r,mr.u.fromExtHostTestItem(e,i).toString(),1)})),skipped:n((e=>{this.proxy.$updateTestStateInRun(t,r,mr.u.fromExtHostTestItem(e,i).toString(),5)})),started:n((e=>{this.proxy.$updateTestStateInRun(t,r,mr.u.fromExtHostTestItem(e,i).toString(),2)})),errored:n(((e,n,o)=>{s(e,n),this.proxy.$updateTestStateInRun(t,r,mr.u.fromExtHostTestItem(e,i).toString(),6,o)})),failed:n(((e,n,o)=>{s(e,n),this.proxy.$updateTestStateInRun(t,r,mr.u.fromExtHostTestItem(e,i).toString(),4,o)})),passed:n(((e,i)=>{this.proxy.$updateTestStateInRun(t,r,mr.u.fromExtHostTestItem(e,this.dto.controllerId).toString(),3,i)})),appendOutput:(e,n,s)=>{o||(s&&(this.dto.isIncluded(s)?this.ensureTestIsKnown(s):s=void 0),this.proxy.$appendOutputToRun(t,r,Ve.KN.fromString(e),n&&P.xh.from(n),s&&mr.u.fromExtHostTestItem(s,i).toString()))},end:()=>{o||(o=!0,this.proxy.$finishedTestRunTask(t,r),--this.running||this.markEnded())}};return this.running++,this.tasks.set(r,{run:a}),this.proxy.$startedTestRunTask(t,{id:r,name:e,running:!0}),a}forciblyEndTasks(){for(const{run:e}of this.tasks.values())e.end()}markEnded(){2!==this.state&&(this.state=2,this.endEmitter.fire())}ensureTestIsKnown(e){if(!(e instanceof pr.SJ))throw new fr.Mh(e.id);if(this.sharedTestIds.has(mr.u.fromExtHostTestItem(e,this.dto.controllerId).toString()))return;const t=[],i=this.dto.colllection.root;for(;;){const r=P.UK.from(e);if(t.unshift(r),this.sharedTestIds.has(r.extId))break;if(this.sharedTestIds.add(r.extId),e===i)break;e=e.parent||i}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,t)}dispose(){this.markEnded(),super.dispose()}}class br{get trackers(){return this.tracked.values()}constructor(e,t){this.proxy=e,this.logService=t,this.tracked=new Map,this.trackedById=new Map}getCoverageDetails(e,t){const i=mr.u.root(e);return this.trackedById.get(i)?.getCoverageDetails(e,t)||[]}disposeTestRun(e){this.trackedById.get(e)?.dispose(),this.trackedById.delete(e);for(const[t,{id:i}]of this.tracked)i===e&&this.tracked.delete(t)}prepareForMainThreadTestRun(e,t,i,r){return this.getTracker(e,t,i,r)}cancelRunById(e){this.trackedById.get(e)?.cancel()}cancelAllRuns(){for(const e of this.tracked.values())e.cancel()}createTestRun(e,t,i,r,n){const o=this.tracked.get(i);if(o)return o.createRun(r);const a=yr.fromPublic(e,t,i,n),c=wr(i);this.proxy.$startedExtensionTestRun({controllerId:e,continuous:!!i.continuous,profile:c&&{group:kr[c.kind],id:c.profileId},exclude:i.exclude?.map((e=>mr.u.fromExtHostTestItem(e,t.root.id).toString()))??[],id:a.id,include:i.include?.map((e=>mr.u.fromExtHostTestItem(e,t.root.id).toString()))??[t.root.id],preserveFocus:i.preserveFocus??!0,persist:n});const l=this.getTracker(i,a,i.profile);return s.ju.once(l.onEnd)((()=>{this.proxy.$finishedExtensionTestRun(a.id)})),l.createRun(r)}getTracker(e,t,i,r){const n=new _r(t,this.proxy,this.logService,i,r);return this.tracked.set(e,n),this.trackedById.set(n.id,n),n}}const wr=e=>{if(e.profile){if(!(e.profile instanceof Dr))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return e.profile}};class yr{static fromPublic(e,t,i,r){return new yr(e,(0,hr.R)(),i.include?.map((t=>mr.u.fromExtHostTestItem(t,e).toString()))??[e],i.exclude?.map((t=>mr.u.fromExtHostTestItem(t,e).toString()))??[],r,t)}static fromInternal(e,t){return new yr(e.controllerId,e.runId,e.testIds,e.excludeExtIds,!0,t)}constructor(e,t,i,r,n,s){this.controllerId=e,this.id=t,this.isPersisted=n,this.colllection=s,this.includePrefix=i.map((e=>e+"\0")),this.excludePrefix=r.map((e=>e+"\0"))}isIncluded(e){const t=mr.u.fromExtHostTestItem(e,this.controllerId).toString()+"\0";for(const e of this.excludePrefix)if(t===e||t.startsWith(e))return!1;for(const e of this.includePrefix)if(t===e||t.startsWith(e))return!0;return!1}}class xr{get isEmpty(){return 0===this.added.size&&0===this.removed.size&&0===this.updated.size}constructor(e){this.emitter=e,this.added=new Set,this.updated=new Set,this.removed=new Set,this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,P.UK.toPlain(e.item)),this.added.has(e)||this.updated.add(e)}remove(e){if(this.added.has(e))return void this.added.delete(e);this.updated.delete(e);const t=mr.u.parentId(e.item.extId);t&&this.alreadyRemoved.has(t.toString())?this.alreadyRemoved.add(e.item.extId):this.removed.add(e)}getChangeEvent(){const{added:e,updated:t,removed:i}=this;return{get added(){return[...e].map((e=>e.revived))},get updated(){return[...t].map((e=>e.revived))},get removed(){return[...i].map((e=>e.revived))}}}complete(){this.isEmpty||this.emitter.fire(this.getChangeEvent())}}class Cr extends gr.oc{constructor(){super(...arguments),this.changeEmitter=new s.Q5,this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,t){return{...e,revived:P.UK.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}createChangeCollector(){return new xr(this.changeEmitter)}}class Sr{constructor(e){this.proxy=e}checkout(){this.current||(this.current=this.createObserverData());const e=this.current;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map((e=>e.revived))},dispose:(0,ur.M)((()=>{0==--e.observers&&(this.proxy.$unsubscribeFromDiffs(),this.current=void 0)}))}}getMirroredTestDataByReference(e){return this.current?.tests.getMirroredTestDataByReference(e)}applyDiff(e){this.current?.tests.apply(e)}createObserverData(){const e=new Cr({asCanonicalUri:e=>e});return this.proxy.$subscribeToDiffs(),{observers:0,tests:e}}}const Er=(e,t,i,r)=>{i?Object.assign(i,r):t.$updateTestRunConfig(e.controllerId,e.profileId,r)};class Dr{#e;#T;#A;#R;#$;get label(){return this._label}set label(e){e!==this._label&&(this._label=e,Er(this,this.#e,this.#R,{label:e}))}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(e){e!==this._supportsContinuousRun&&(this._supportsContinuousRun=e,Er(this,this.#e,this.#R,{supportsContinuousRun:e}))}get isDefault(){return this.#T.has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?this.#T.add(this.profileId):this.#T.delete(this.profileId),Er(this,this.#e,this.#R,{isDefault:e}))}get tag(){return this._tag}set tag(e){e?.id!==this._tag?.id&&(this._tag=e,Er(this,this.#e,this.#R,{tag:e?P.Ld.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this._configureHandler}set configureHandler(e){e!==this._configureHandler&&(this._configureHandler=e,Er(this,this.#e,this.#R,{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return s.ju.chain(this.#A,(e=>e.map((e=>e.get(this.controllerId)?.get(this.profileId))).filter(V.$K)))}constructor(e,t,i,r,n,s,o,a,c,l=!1,d=void 0,u=!1){this.controllerId=n,this.profileId=s,this._label=o,this.kind=a,this.runHandler=c,this._tag=d,this._supportsContinuousRun=u,this.#e=e,this.#$=t,this.#T=i,this.#A=r,t.set(s,this);const h=kr[a];if("number"!=typeof h)throw new Error(`Unknown TestRunProfile.group ${a}`);l&&i.add(s),this.#R={profileId:s,controllerId:n,tag:d?P.Ld.namespace(this.controllerId,d.id):null,label:o,group:h,isDefault:l,hasConfigurationHandler:!1,supportsContinuousRun:u},queueMicrotask((()=>{this.#R&&(this.#e.$publishTestRunProfile(this.#R),this.#R=void 0)}))}dispose(){this.#$?.delete(this.profileId)&&(this.#$=void 0,this.#e.$removeTestProfile(this.controllerId,this.profileId)),this.#R=void 0}}const kr={[x.InX.Coverage]:8,[x.InX.Debug]:4,[x.InX.Run]:2};var Ir=i(45107);class Pr{constructor(e,t){this._extHostDocumentsAndEditors=t,this._onDidChangeTextEditorSelection=new s.Q5,this._onDidChangeTextEditorOptions=new s.Q5,this._onDidChangeTextEditorVisibleRanges=new s.Q5,this._onDidChangeTextEditorViewColumn=new s.Q5,this._onDidChangeActiveTextEditor=new s.Q5,this._onDidChangeVisibleTextEditors=new s.Q5,this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event,this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event,this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event,this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this._proxy=e.getProxy(y.Tr.MainThreadTextEditors),this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors((e=>this._onDidChangeVisibleTextEditors.fire(e))),this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor((e=>this._onDidChangeActiveTextEditor.fire(e)))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){const t=this._extHostDocumentsAndEditors.allEditors();return e?t:t.map((e=>e.value))}async showTextDocument(e,t,i){let r;r="number"==typeof t?{position:P.eI.from(t),preserveFocus:i}:"object"==typeof t?{position:P.eI.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:"object"==typeof t.selection?P.e6.from(t.selection):void 0,pinned:"boolean"==typeof t.preview?!t.preview:void 0}:{preserveFocus:!1};const n=await this._proxy.$tryShowTextDocument(e.uri,r),s=n&&this._extHostDocumentsAndEditors.getEditor(n);if(s)return s.value;throw n?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new Ir.TE(this._proxy,e,t).value}$acceptEditorPropertiesChanged(e,t){const i=this._extHostDocumentsAndEditors.getEditor(e);if(!i)throw new Error("unknown text editor");if(t.options&&i._acceptOptions(t.options),t.selections){const e=t.selections.selections.map(P.Y1.to);i._acceptSelections(e)}if(t.visibleRanges){const e=(0,S.kX)(t.visibleRanges.map(P.e6.to));i._acceptVisibleRanges(e)}if(t.options&&this._onDidChangeTextEditorOptions.fire({textEditor:i.value,options:{...t.options,lineNumbers:P.lP.to(t.options.lineNumbers)}}),t.selections){const e=x.dWA.fromValue(t.selections.source),r=t.selections.selections.map(P.Y1.to);this._onDidChangeTextEditorSelection.fire({textEditor:i.value,selections:r,kind:e})}if(t.visibleRanges){const e=(0,S.kX)(t.visibleRanges.map(P.e6.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:i.value,visibleRanges:e})}}$acceptEditorPositionData(e){for(const t in e){const i=this._extHostDocumentsAndEditors.getEditor(t);if(!i)throw new Error("Unknown text editor");const r=P.eI.to(e[t]);i.value.viewColumn!==r&&(i._acceptViewColumn(r),this._onDidChangeTextEditorViewColumn.fire({textEditor:i.value,viewColumn:r}))}}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}}let Tr=class{constructor(e){this._actual=new x.UPf(x.bZY.Dark),this._onDidChangeActiveColorTheme=new s.Q5}get activeColorTheme(){return this._actual}$onColorThemeChange(e){let t;switch(e){case"light":t=x.bZY.Light;break;case"hcDark":t=x.bZY.HighContrast;break;case"hcLight":t=x.bZY.HighContrastLight;break;default:t=x.bZY.Dark}this._actual=new x.UPf(t),this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};Tr=(0,z.g)([(0,z.f)(0,F.O)],Tr);var Ar=i(28019);class Rr{constructor(e,t){this._providers=new Map,this._itemsBySourceAndUriMap=new Map,this._proxy=e.getProxy(y.Tr.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(e,t)=>{if(!e||12!==e.$mid)return e;if(this._providers.get(e.source)&&m.kP.equals(t,this._providers.get(e.source)?.extension)){const t=void 0===e.uri?void 0:l.ov.revive(e.uri);return this._itemsBySourceAndUriMap.get(e.source)?.get($r(t))?.get(e.handle)}}})}async $getTimeline(e,t,i,r){const n=this._providers.get(e);return n?.provider.provideTimeline(l.ov.revive(t),i,r)}registerTimelineProvider(e,t,i,r){const n=new o.SL,s=this.convertTimelineItem(t.id,r,n).bind(this);let a;t.onDidChange&&(a=t.onDidChange((e=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:!0,...e,id:t.id})),this));const c=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...t,scheme:e,onDidChange:void 0,async provideTimeline(e,i,r){i?.resetCache&&(n.clear(),c.get(t.id)?.clear());const o=await t.provideTimeline(e,i,r);if(null==o)return;const a=s(e,i);return{...o,source:t.id,items:o.items.map(a)}},dispose(){for(const e of c.values())e.get(t.id)?.clear();a?.dispose(),n.dispose()}},i)}convertTimelineItem(e,t,i){return(r,n)=>{let s;if(n?.cacheResults){let t=this._itemsBySourceAndUriMap.get(e);void 0===t&&(t=new Map,this._itemsBySourceAndUriMap.set(e,t));const i=$r(r);s=t.get(i),void 0===s&&(s=new Map,t.set(i,s))}return r=>{const{iconPath:n,...o}=r,a=`${e}|${r.id??r.timestamp}`;let c,d,u,h;return s?.set(a,r),r.iconPath&&(n instanceof x.kS8?u={id:n.id,color:n.color}:l.ov.isUri(n)?(c=n,d=n):({light:c,dark:d}=n)),x.W5C.isMarkdownString(o.tooltip)?h=P.W5.from(o.tooltip):(0,V.HD)(o.tooltip)?h=o.tooltip:x.W5C.isMarkdownString(o.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),h=P.W5.from(o.detail)):(0,V.HD)(o.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),h=o.detail),{...o,id:o.id??void 0,handle:a,source:e,command:r.command?t.toInternal(r.command,i):void 0,icon:c,iconDark:d,themeIcon:u,tooltip:h,accessibilityInformation:r.accessibilityInformation}}}}registerTimelineProviderCore(e,t){if(this._providers.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this._providers.set(e.id,{provider:e,extension:t}),(0,o.OF)((()=>{for(const t of this._itemsBySourceAndUriMap.values())t.get(e.id)?.clear();this._providers.delete(e.id),this._proxy.$unregisterTimelineProvider(e.id),e.dispose()}))}}function $r(e){return e?.toString()}var Lr=i(89623),Nr=i(60807);function zr(e,t){if((0,V.HD)(e))return{label:e};if(e&&"object"==typeof e&&"string"==typeof e.label){let t;return Array.isArray(e.highlights)&&(t=e.highlights.filter((e=>2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1])),t=t.length?t:void 0),{label:e.label,highlights:t}}}class Fr extends o.JT{constructor(e,t,i){function r(e){return e&&e.$treeViewId&&(e.$treeItemHandle||e.$selectedTreeItems||e.$focusedTreeItem)}super(),this._proxy=e,this.commands=t,this.logService=i,this.treeViews=new Map,this.treeDragAndDropService=new Nr.Y,t.registerArgumentProcessor({processArgument:e=>r(e)?this.convertArgument(e):Array.isArray(e)&&e.length>0?e.map((e=>r(e)?this.convertArgument(e):e)):e})}registerTreeDataProvider(e,t,i){const r=this.createTreeView(e,{treeDataProvider:t},i);return{dispose:()=>r.dispose()}}createTreeView(e,t,i){if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const r=t.dragAndDropController?.dropMimeTypes??[],n=t.dragAndDropController?.dragMimeTypes??[],s=!!t.dragAndDropController?.handleDrag,o=!!t.dragAndDropController?.handleDrop,a=this.createExtHostTreeView(e,t,i),c={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:r,dragMimeTypes:n,hasHandleDrag:s,hasHandleDrop:o,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},l=this._proxy.$registerTreeViewDataProvider(e,c),d={get onDidCollapseElement(){return a.onDidCollapseElement},get onDidExpandElement(){return a.onDidExpandElement},get selection(){return a.selectedElements},get onDidChangeSelection(){return a.onDidChangeSelection},get activeItem(){return(0,j.H5)(i,"treeViewActiveItem"),a.focusedElement},get onDidChangeActiveItem(){return(0,j.H5)(i,"treeViewActiveItem"),a.onDidChangeActiveItem},get visible(){return a.visible},get onDidChangeVisibility(){return a.onDidChangeVisibility},get onDidChangeCheckboxState(){return a.onDidChangeCheckboxState},get message(){return a.message},set message(e){(0,qe.Fr)(e)&&(0,j.H5)(i,"treeViewMarkdownMessage"),a.message=e},get title(){return a.title},set title(e){a.title=e},get description(){return a.description},set description(e){a.description=e},get badge(){return a.badge},set badge(e){void 0!==e&&x.z0r.isViewBadge(e)?a.badge={value:Math.floor(Math.abs(e.value)),tooltip:e.tooltip}:void 0===e&&(a.badge=void 0)},reveal:(e,t)=>a.reveal(e,t),dispose:async()=>{await l,this.treeViews.delete(e),a.dispose()}};return this._register(d),d}$getChildren(e,t){const i=this.treeViews.get(e);return i?i.getChildren(t):Promise.reject(new Lr.Ki(e))}async $handleDrop(e,t,i,r,n,s,o,a){const c=this.treeViews.get(e);if(!c)return Promise.reject(new Lr.Ki(e));const l=P.tn.toDataTransfer(i,(async i=>(await this._proxy.$resolveDropFileData(e,t,i)).buffer));return o===e&&a&&await this.addAdditionalTransferItems(l,c,a,n,s),c.onDrop(l,r,n)}async addAdditionalTransferItems(e,t,i,r,n){const s=this.treeDragAndDropService.removeDragOperationTransfer(n);if(s)(await s)?.forEach(((t,i)=>{t&&e.set(i,t)}));else if(n&&t.handleDrag){const s=t.handleDrag(i,e,r);this.treeDragAndDropService.addDragOperationTransfer(n,s),await s}return e}async $handleDrag(e,t,i,r){const n=this.treeViews.get(e);if(!n)return Promise.reject(new Lr.Ki(e));const s=await this.addAdditionalTransferItems(new x.tnH,n,t,r,i);return s&&!r.isCancellationRequested?P.tn.from(s):void 0}async $hasResolve(e){const t=this.treeViews.get(e);if(!t)throw new Lr.Ki(e);return t.hasResolve}$resolve(e,t,i){const r=this.treeViews.get(e);if(!r)throw new Lr.Ki(e);return r.resolveTreeItem(t,i)}$setExpanded(e,t,i){const r=this.treeViews.get(e);if(!r)throw new Lr.Ki(e);r.setExpanded(t,i)}$setSelectionAndFocus(e,t,i){const r=this.treeViews.get(e);if(!r)throw new Lr.Ki(e);r.setSelectionAndFocus(t,i)}$setVisible(e,t){const i=this.treeViews.get(e);if(!i){if(!t)return;throw new Lr.Ki(e)}i.setVisible(t)}$changeCheckboxState(e,t){const i=this.treeViews.get(e);if(!i)throw new Lr.Ki(e);i.setCheckboxState(t)}createExtHostTreeView(e,t,i){const r=this._register(new Mr(e,t,this._proxy,this.commands.converter,this.logService,i));return this.treeViews.set(e,r),r}convertArgument(e){const t=this.treeViews.get(e.$treeViewId);return t&&"$treeItemHandle"in e?t.getExtensionElement(e.$treeItemHandle):t&&"$focusedTreeItem"in e&&e.$focusedTreeItem?t.focusedElement:null}}class Mr extends o.JT{static{this.LABEL_HANDLE_PREFIX="0"}static{this.ID_HANDLE_PREFIX="1"}get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map((e=>this.getExtensionElement(e))).filter((e=>!(0,V.Jp)(e)))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(e,t,i,n,o,a){if(super(),this.viewId=e,this.proxy=i,this.commands=n,this.logService=o,this.extension=a,this.roots=void 0,this.elements=new Map,this.nodes=new Map,this._visible=!1,this._selectedHandles=[],this._focusedHandle=void 0,this._onDidExpandElement=this._register(new s.Q5),this.onDidExpandElement=this._onDidExpandElement.event,this._onDidCollapseElement=this._register(new s.Q5),this.onDidCollapseElement=this._onDidCollapseElement.event,this._onDidChangeSelection=this._register(new s.Q5),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeActiveItem=this._register(new s.Q5),this.onDidChangeActiveItem=this._onDidChangeActiveItem.event,this._onDidChangeVisibility=this._register(new s.Q5),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeCheckboxState=this._register(new s.Q5),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeData=this._register(new s.Q5),this.refreshPromise=Promise.resolve(),this.refreshQueue=Promise.resolve(),this._message="",this._title="",this._refreshCancellationSource=new r.AU,a.contributes&&a.contributes.views)for(const t in a.contributes.views)for(const i of a.contributes.views[t])i.id===e&&(this._title=i.name);let c,l;this.dataProvider=t.treeDataProvider,this.dndController=t.dragAndDropController,this.dataProvider.onDidChangeTreeData&&this._register(this.dataProvider.onDidChangeTreeData((e=>{Array.isArray(e)&&0===e.length||this._onDidChangeData.fire({message:!1,element:e})})));const d=s.ju.debounce(this._onDidChangeData.event,((e,t)=>(e||(e={message:!1,elements:[]}),!1!==t.element&&(c||(c=new Promise((e=>l=e)),this.refreshPromise=this.refreshPromise.then((()=>c))),Array.isArray(t.element)?e.elements.push(...t.element):e.elements.push(t.element)),t.message&&(e.message=!0),e)),200,!0);this._register(d((({message:e,elements:t})=>{t.length&&(this.refreshQueue=this.refreshQueue.then((()=>{const e=l;return c=null,this.refresh(t).then((()=>e()))}))),e&&this.proxy.$setMessage(this.viewId,P.W5.fromStrict(this._message)??"")})))}async getChildren(e){const t=e?this.getExtensionElement(e):void 0;if(e&&!t)return this.logService.error(`No tree item with id '${e}' found.`),Promise.resolve([]);let i=this.getChildrenNodes(e);return i||(i=await this.fetchChildrenNodes(t)),i?i.map((e=>e.item)):void 0}getExtensionElement(e){return this.elements.get(e)}reveal(e,t){t=t||{select:!0,focus:!1};const i=!!(0,V.Jp)(t.select)||t.select,r=!(0,V.Jp)(t.focus)&&t.focus,n=!(0,V.Jp)(t.expand)&&t.expand;return"function"!=typeof this.dataProvider.getParent?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):e?this.refreshPromise.then((()=>this.resolveUnknownParentChain(e))).then((t=>this.resolveTreeNode(e,t[t.length-1]).then((e=>this.proxy.$reveal(this.viewId,{item:e.item,parentChain:t.map((e=>e.item))},{select:i,focus:r,expand:n})))),(e=>this.logService.error(e))):this.proxy.$reveal(this.viewId,void 0,{select:i,focus:r,expand:n})}get message(){return this._message}set message(e){this._message=e,this._onDidChangeData.fire({message:!0,element:!1})}get title(){return this._title}set title(e){this._title=e,this.proxy.$setTitle(this.viewId,e,this._description)}get description(){return this._description}set description(e){this._description=e,this.proxy.$setTitle(this.viewId,this._title,e)}get badge(){return this._badge}set badge(e){this._badge?.value===e?.value&&this._badge?.tooltip===e?.tooltip||(this._badge=P.z0.from(e),this.proxy.$setBadge(this.viewId,e))}setExpanded(e,t){const i=this.getExtensionElement(e);i&&(t?this._onDidExpandElement.fire(Object.freeze({element:i})):this._onDidCollapseElement.fire(Object.freeze({element:i})))}setSelectionAndFocus(e,t){const i=!(0,S.fS)(this._selectedHandles,e);this._selectedHandles=e;const r=this._focusedHandle!==t;this._focusedHandle=t,i&&this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements})),r&&this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(e){e!==this._visible&&(this._visible=e,this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible})))}async setCheckboxState(e){const t=(await Promise.all(e.map((async e=>{const t=this.getExtensionElement(e.treeItemHandle);return t?{extensionItem:t,treeItem:await this.dataProvider.getTreeItem(t),newState:e.newState?x.KHd.Checked:x.KHd.Unchecked}:Promise.resolve(void 0)})))).filter((e=>void 0!==e));t.forEach((e=>{e.treeItem.checkboxState=e.newState?x.KHd.Checked:x.KHd.Unchecked})),this._onDidChangeCheckboxState.fire({items:t.map((e=>[e.extensionItem,e.newState]))})}async handleDrag(e,t,i){const r=[];for(const t of e){const e=this.getExtensionElement(t);e&&r.push(e)}if(this.dndController?.handleDrag&&0!==r.length)return await this.dndController.handleDrag(r,t,i),t}get hasHandleDrag(){return!!this.dndController?.handleDrag}async onDrop(e,t,i){const r=t?this.getExtensionElement(t):void 0;if((r||!t)&&this.dndController?.handleDrop)return(0,H.OH)((()=>this.dndController?.handleDrop?this.dndController.handleDrop(r,e,i):void 0))}get hasResolve(){return!!this.dataProvider.resolveTreeItem}async resolveTreeItem(e,t){if(!this.dataProvider.resolveTreeItem)return;const i=this.elements.get(e);if(i){const e=this.nodes.get(i);if(e){const r=await this.dataProvider.resolveTreeItem(e.extensionItem,i,t)??e.extensionItem;return this.validateTreeItem(r),e.item.tooltip=this.getTooltip(r.tooltip),e.item.command=this.getCommand(e.disposableStore,r.command),e.item}}}resolveUnknownParentChain(e){return this.resolveParent(e).then((e=>e?this.resolveUnknownParentChain(e).then((t=>this.resolveTreeNode(e,t[t.length-1]).then((e=>(t.push(e),t))))):Promise.resolve([])))}resolveParent(e){const t=this.nodes.get(e);return t?Promise.resolve(t.parent?this.elements.get(t.parent.item.handle):void 0):(0,H.OH)((()=>this.dataProvider.getParent(e)))}resolveTreeNode(e,t){const i=this.nodes.get(e);return i?Promise.resolve(i):(0,H.OH)((()=>this.dataProvider.getTreeItem(e))).then((i=>this.createHandle(e,i,t,!0))).then((e=>this.getChildren(t?t.item.handle:void 0).then((()=>{const t=this.getExtensionElement(e);if(t){const e=this.nodes.get(t);if(e)return Promise.resolve(e)}throw new Error(`Cannot resolve tree item for element ${e} from extension ${this.extension.identifier.value}`)}))))}getChildrenNodes(e){if(e){let t;if("string"==typeof e){const i=this.getExtensionElement(e);t=i?this.nodes.get(i):void 0}else t=e;return t&&t.children||void 0}return this.roots}async fetchChildrenNodes(e){this.clearChildren(e);const t=new r.AU(this._refreshCancellationSource.token);try{const i=e?this.nodes.get(e):void 0,r=await this.dataProvider.getChildren(e);if(t.token.isCancellationRequested)return;const n=(0,S.kX)(r||[]),s=await Promise.all((0,S.kX)(n).map((e=>this.dataProvider.getTreeItem(e))));if(t.token.isCancellationRequested)return;const o=s.map(((e,t)=>e?this.createAndRegisterTreeNode(n[t],e,i):null));return(0,S.kX)(o)}finally{t.dispose()}}refresh(e){if(e.some((e=>!e)))return this._refreshCancellationSource.dispose(!0),this._refreshCancellationSource=new r.AU,this.clearAll(),this.proxy.$refresh(this.viewId);{const t=this.getHandlesToRefresh(e);if(t.length)return this.refreshHandles(t)}return Promise.resolve(void 0)}getHandlesToRefresh(e){const t=new Set,i=e.map((e=>this.nodes.get(e)));for(const e of i)if(e&&!t.has(e.item.handle)){let r=e;for(;r&&r.parent&&-1===i.findIndex((e=>r&&r.parent&&e&&e.item.handle===r.parent.item.handle));){const e=this.elements.get(r.parent.item.handle);r=e?this.nodes.get(e):void 0}r&&!r.parent&&t.add(e.item.handle)}const r=[];return t.forEach((e=>{const i=this.elements.get(e);if(i){const n=this.nodes.get(i);!n||n.parent&&t.has(n.parent.item.handle)||r.push(e)}})),r}refreshHandles(e){const t={};return Promise.all(e.map((e=>this.refreshNode(e).then((i=>{i&&(t[e]=i.item)}))))).then((()=>Object.keys(t).length?this.proxy.$refresh(this.viewId,t):void 0))}refreshNode(e){const t=this.getExtensionElement(e);if(t){const e=this.nodes.get(t);if(e)return this.clearChildren(t),(0,H.OH)((()=>this.dataProvider.getTreeItem(t))).then((i=>{if(i){const r=this.createTreeNode(t,i,e.parent);return this.updateNodeCache(t,r,e,e.parent),e.dispose(),r}return null}))}return Promise.resolve(null)}createAndRegisterTreeNode(e,t,i){const r=this.createTreeNode(e,t,i);if(t.id&&this.elements.has(r.item.handle))throw new Error((0,De.C$)("vs/workbench/api/common/extHostTreeViews",0,"Element with id {0} is already registered",t.id));return this.addNodeToCache(e,r),this.addNodeToParentCache(r,i),r}getTooltip(e){return x.W5C.isMarkdownString(e)?P.W5.from(e):e}getCommand(e,t){return t?{...this.commands.toInternal(t,e),originalId:t.command}:void 0}getCheckbox(e){if(void 0===e.checkboxState)return;let t,i,r;return"number"==typeof e.checkboxState?t=e.checkboxState:(t=e.checkboxState.state,i=e.checkboxState.tooltip,r=e.checkboxState.accessibilityInformation),{isChecked:t===x.KHd.Checked,tooltip:i,accessibilityInformation:r}}validateTreeItem(e){if(!x.kfG.isTreeItem(e,this.extension))throw new Error(`Extension ${this.extension.identifier.value} has provided an invalid tree item.`)}createTreeNode(e,t,i){this.validateTreeItem(t);const r=this._register(new o.SL),n=this.createHandle(e,t,i),s=this.getLightIconPath(t);return{item:{handle:n,parentHandle:i?i.item.handle:void 0,label:zr(t.label),description:t.description,resourceUri:t.resourceUri,tooltip:this.getTooltip(t.tooltip),command:this.getCommand(r,t.command),contextValue:t.contextValue,icon:s,iconDark:this.getDarkIconPath(t)||s,themeIcon:this.getThemeIcon(t),collapsibleState:(0,V.Jp)(t.collapsibleState)?x.oCf.None:t.collapsibleState,accessibilityInformation:t.accessibilityInformation,checkbox:this.getCheckbox(t)},extensionItem:t,parent:i,children:void 0,disposableStore:r,dispose(){r.dispose()}}}getThemeIcon(e){return e.iconPath instanceof x.kS8?e.iconPath:void 0}createHandle(e,{id:t,label:i,resourceUri:r},n,s){if(t)return`${Mr.ID_HANDLE_PREFIX}/${t}`;const o=zr(i),a=n?n.item.handle:Mr.LABEL_HANDLE_PREFIX;let c=o?o.label:r?(0,ae.EZ)(r):"";c=-1!==c.indexOf("/")?c.replace("/","//"):c;const l=this.nodes.has(e)?this.nodes.get(e).item.handle:void 0,d=this.getChildrenNodes(n)||[];let u,h=0;do{if(u=`${a}/${h}:${c}`,s||!this.elements.has(u)||l===u)break;h++}while(h<=d.length);return u}getLightIconPath(e){if(e.iconPath&&!(e.iconPath instanceof x.kS8))return"string"==typeof e.iconPath||l.ov.isUri(e.iconPath)?this.getIconPath(e.iconPath):this.getIconPath(e.iconPath.light)}getDarkIconPath(e){if(e.iconPath&&!(e.iconPath instanceof x.kS8)&&e.iconPath.dark)return this.getIconPath(e.iconPath.dark)}getIconPath(e){return l.ov.isUri(e)?e:l.ov.file(e)}addNodeToCache(e,t){this.elements.set(t.item.handle,e),this.nodes.set(e,t)}updateNodeCache(e,t,i,r){this.elements.delete(t.item.handle),this.nodes.delete(e),t.item.handle!==i.item.handle&&this.elements.delete(i.item.handle),this.addNodeToCache(e,t);const n=this.getChildrenNodes(r)||[],s=n.filter((e=>e.item.handle===i.item.handle))[0];s&&n.splice(n.indexOf(s),1,t)}addNodeToParentCache(e,t){t?(t.children||(t.children=[]),t.children.push(e)):(this.roots||(this.roots=[]),this.roots.push(e))}clearChildren(e){if(e){const t=this.nodes.get(e);if(t){if(t.children)for(const e of t.children){const t=this.elements.get(e.item.handle);t&&this.clear(t)}t.children=void 0}}else this.clearAll()}clear(e){const t=this.nodes.get(e);if(t){if(t.children)for(const e of t.children){const t=this.elements.get(e.item.handle);t&&this.clear(t)}this.nodes.delete(e),this.elements.delete(t.item.handle),t.dispose()}}clearAll(){this.roots=void 0,this.elements.clear(),this.nodes.forEach((e=>e.dispose())),this.nodes.clear()}dispose(){super.dispose(),this._refreshCancellationSource.dispose(),this.clearAll(),this.proxy.$disposeTree(this.viewId)}}var Or=i(80974);class Hr{static{this.supportedSchemes=new Set([a.lg.http,a.lg.https])}constructor(e){this._openers=new Map,this._proxy=e.getProxy(y.Tr.MainThreadUriOpeners)}registerExternalUriOpener(e,t,i,r){if(this._openers.has(t))throw new Error(`Opener with id '${t}' already registered`);const n=r.schemes.find((e=>!Hr.supportedSchemes.has(e)));if(n)throw new Error(`Scheme '${n}' is not supported. Only http and https are currently supported.`);return this._openers.set(t,i),this._proxy.$registerUriOpener(t,r.schemes,e,r.label),(0,o.OF)((()=>{this._openers.delete(t),this._proxy.$unregisterUriOpener(t)}))}async $canOpenUri(e,t,i){const r=this._openers.get(e);if(!r)throw new Error(`Unknown opener with id: ${e}`);const n=l.ov.revive(t);return r.canOpenExternalUri(n,i)}async $openUri(e,t,i){const r=this._openers.get(e);if(!r)throw new Error(`Unknown opener id: '${e}'`);return r.openExternalUri(l.ov.revive(t.resolvedUri),{sourceUri:l.ov.revive(t.sourceUri)},i)}}var Ur=i(76221);class Br{static{this.HandlePool=0}constructor(e){this.handles=new m.o$,this.handlers=new Map,this._proxy=e.getProxy(y.Tr.MainThreadUrls)}registerUriHandler(e,t){const i=e.identifier;if(this.handles.has(i))throw new Error(`Protocol handler already registered for extension ${i}`);const r=Br.HandlePool++;return this.handles.add(i),this.handlers.set(r,t),this._proxy.$registerUriHandler(r,i,e.displayName||e.name),(0,o.OF)((()=>{this.handles.delete(i),this.handlers.delete(r),this._proxy.$unregisterUriHandler(r)}))}$handleExternalUri(e,t){const i=this.handlers.get(e);if(!i)return Promise.resolve(void 0);try{i.handleUri(l.ov.revive(t))}catch(e){(0,n.dL)(e)}return Promise.resolve(void 0)}async createAppUri(e){return l.ov.revive(await this._proxy.$createAppUri(e))}}class Wr extends o.JT{#m;#e;#L;#N;#w;#z;#F;#M;#O;#H;#y;#U;#B;constructor(e,t,i,r){super(),this.#M=void 0,this.#O=!0,this.#y=!1,this.#U=this._register(new s.Q5),this.onDidDispose=this.#U.event,this.#B=this._register(new s.Q5),this.onDidChangeViewState=this.#B.event,this.#m=e,this.#e=t,this.#N=i,this.#L=r.viewType,this.#w=r.panelOptions,this.#M=r.viewColumn,this.#z=r.title,this.#H=r.active}dispose(){this.#y||(this.#y=!0,this.#U.fire(),this.#e.$disposeWebview(this.#m),this.#N.dispose(),super.dispose())}get webview(){return this.assertNotDisposed(),this.#N}get viewType(){return this.assertNotDisposed(),this.#L}get title(){return this.assertNotDisposed(),this.#z}set title(e){this.assertNotDisposed(),this.#z!==e&&(this.#z=e,this.#e.$setTitle(this.#m,e))}get iconPath(){return this.assertNotDisposed(),this.#F}set iconPath(e){this.assertNotDisposed(),this.#F!==e&&(this.#F=e,this.#e.$setIconPath(this.#m,l.ov.isUri(e)?{light:e,dark:e}:e))}get options(){return this.#w}get viewColumn(){if(this.assertNotDisposed(),!("number"==typeof this.#M&&this.#M<0))return this.#M}get active(){return this.assertNotDisposed(),this.#H}get visible(){return this.assertNotDisposed(),this.#O}_updateViewState(e){this.#y||this.active===e.active&&this.visible===e.visible&&this.viewColumn===e.viewColumn||(this.#H=e.active,this.#O=e.visible,this.#M=e.viewColumn,this.#B.fire({webviewPanel:this}))}reveal(e,t){this.assertNotDisposed(),this.#e.$reveal(this.#m,{viewColumn:void 0===e?void 0:P.eI.from(e),preserveFocus:!!t})}assertNotDisposed(){if(this.#y)throw new Error("Webview is disposed")}}class Vr extends o.JT{static newHandle(){return(0,hr.R)()}constructor(e,t,i){super(),this.webviews=t,this.workspace=i,this._webviewPanels=new Map,this._serializers=new Map,this._proxy=e.getProxy(y.Tr.MainThreadWebviewPanels)}dispose(){super.dispose(),this._webviewPanels.forEach((e=>e.dispose())),this._webviewPanels.clear()}createWebviewPanel(e,t,i,r,n={}){const s="object"==typeof r?r.viewColumn:r,o={viewColumn:P.eI.from(s),preserveFocus:"object"==typeof r&&!!r.preserveFocus},a=he(e),c=Vr.newHandle();this._proxy.$createWebviewPanel(me(e),c,t,{title:i,panelOptions:qr(n),webviewOptions:fe(e,this.workspace,n),serializeBuffersForPostMessage:a},o);const l=this.webviews.createNewWebview(c,n,e);return this.createNewWebviewPanel(c,t,i,s,n,l,!0)}$onDidChangeWebviewPanelViewStates(e){const t=Object.keys(e);t.sort(((t,i)=>{const r=e[t],n=e[i];return r.active?1:n.active?-1:+r.visible-+n.visible}));for(const i of t){const t=this.getWebviewPanel(i);if(!t)continue;const r=e[i];t._updateViewState({active:r.active,visible:r.visible,viewColumn:P.eI.to(r.position)})}}async $onDidDisposeWebviewPanel(e){const t=this.getWebviewPanel(e);t?.dispose(),this._webviewPanels.delete(e),this.webviews.deleteWebview(e)}registerWebviewPanelSerializer(e,t,i){if(this._serializers.has(t))throw new Error(`Serializer for '${t}' already registered`);return this._serializers.set(t,{serializer:i,extension:e}),this._proxy.$registerSerializer(t,{serializeBuffersForPostMessage:he(e)}),new x.JTr((()=>{this._serializers.delete(t),this._proxy.$unregisterSerializer(t)}))}async $deserializeWebviewPanel(e,t,i,r){const n=this._serializers.get(t);if(!n)throw new Error(`No serializer found for '${t}'`);const{serializer:s,extension:o}=n,a=this.webviews.createNewWebview(e,i.webviewOptions,o),c=this.createNewWebviewPanel(e,t,i.title,r,i.panelOptions,a,i.active);await s.deserializeWebviewPanel(c,i.state)}createNewWebviewPanel(e,t,i,r,n,s,o){const a=new Wr(e,this._proxy,s,{viewType:t,title:i,viewColumn:r,panelOptions:n,active:o});return this._webviewPanels.set(e,a),a}getWebviewPanel(e){return this._webviewPanels.get(e)}}function qr(e){return{enableFindWidget:e.enableFindWidget,retainContextWhenHidden:e.retainContextWhenHidden}}class jr extends o.JT{#m;#e;#L;#N;#y;#W;#z;#V;#q;constructor(e,t,i,r,n,o){super(),this.#y=!1,this.#j=this._register(new s.Q5),this.onDidChangeVisibility=this.#j.event,this.#U=this._register(new s.Q5),this.onDidDispose=this.#U.event,this.#L=i,this.#z=r,this.#m=e,this.#e=t,this.#N=n,this.#W=o}dispose(){this.#y||(this.#y=!0,this.#U.fire(),this.#N.dispose(),super.dispose())}#j;#U;get title(){return this.assertNotDisposed(),this.#z}set title(e){this.assertNotDisposed(),this.#z!==e&&(this.#z=e,this.#e.$setWebviewViewTitle(this.#m,e))}get description(){return this.assertNotDisposed(),this.#V}set description(e){this.assertNotDisposed(),this.#V!==e&&(this.#V=e,this.#e.$setWebviewViewDescription(this.#m,e))}get visible(){return this.#W}get webview(){return this.#N}get viewType(){return this.#L}_setVisible(e){e===this.#W||this.#y||(this.#W=e,this.#j.fire())}get badge(){return this.assertNotDisposed(),this.#q}set badge(e){this.assertNotDisposed(),e?.value===this.#q?.value&&e?.tooltip===this.#q?.tooltip||(this.#q=P.z0.from(e),this.#e.$setWebviewViewBadge(this.#m,e))}show(e){this.assertNotDisposed(),this.#e.$show(this.#m,!!e)}assertNotDisposed(){if(this.#y)throw new Error("Webview is disposed")}}class Kr{constructor(e,t){this._extHostWebview=t,this._viewProviders=new Map,this._webviewViews=new Map,this._proxy=e.getProxy(y.Tr.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,i,r){if(this._viewProviders.has(t))throw new Error(`View provider for '${t}' already registered`);return this._viewProviders.set(t,{provider:i,extension:e}),this._proxy.$registerWebviewViewProvider(me(e),t,{retainContextWhenHidden:r?.retainContextWhenHidden,serializeBuffersForPostMessage:he(e)}),new x.JTr((()=>{this._viewProviders.delete(t),this._proxy.$unregisterWebviewViewProvider(t)}))}async $resolveWebviewView(e,t,i,r,n){const s=this._viewProviders.get(t);if(!s)throw new Error(`No view provider found for '${t}'`);const{provider:o,extension:a}=s,c=this._extHostWebview.createNewWebview(e,{},a),l=new jr(e,this._proxy,t,i,c,!0);this._webviewViews.set(e,l),await o.resolveWebviewView(l,{state:r},n)}async $onDidChangeWebviewViewVisibility(e,t){this.getWebviewView(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.getWebviewView(e);this._webviewViews.delete(e),t.dispose(),this._extHostWebview.deleteWebview(e)}getWebviewView(e){const t=this._webviewViews.get(e);if(!t)throw new Error("No webview found");return t}}var Qr=i(72124),Gr=i(89608),Jr=i(13973),Yr=i(14879),Xr=i(97258);function Zr(e){const t=e.get(et.$),i=e.get(Pe.G),S=e.get(Qe.a),E=e.get(Be.k2),D=e.get(Gr.w),k=e.get(cr.fv),T=e.get(se.E1),R=e.get(Ur.F),$=e.get(F.O),z=e.get(sr.W),M=e.get(or.L),H=e.get(v.y),U=e.get(v.V),B=e.get(Or.rd),W=e.get(L.J),V=e.get(Qr.V),q=e.get(Xi.Z),K=e.get(He.v),G=e.get(ti.W),Y=e.get(N.E),Z=e.get(Xt.X);$.set(y.D.ExtHostFileSystemInfo,i),$.set(y.D.ExtHostLogLevelServiceShape,H),$.set(y.D.ExtHostWorkspace,D),$.set(y.D.ExtHostConfiguration,T),$.set(y.D.ExtHostExtensionService,E),$.set(y.D.ExtHostStorage,z),$.set(y.D.ExtHostTunnelService,B),$.set(y.D.ExtHostWindow,V),$.set(y.D.ExtHostSecretState,q),$.set(y.D.ExtHostTelemetry,k),$.set(y.D.ExtHostEditorTabs,K),$.set(y.D.ExtHostManagedSockets,G),$.set(y.D.ExtHostAuthentication,Y),$.set(y.D.ExtHostChatProvider,Z);const ee=$.set(y.D.ExtHostDecorations,e.get(Ee.W)),te=$.set(y.D.ExtHostDocumentsAndEditors,e.get(Oe.T)),ie=$.set(y.D.ExtHostCommands,e.get(I.f7)),oe=$.set(y.D.ExtHostTerminalService,e.get(lr.$3)),ae=$.set(y.D.ExtHostTerminalShellIntegration,e.get(dr.P)),ce=$.set(y.D.ExtHostDebugService,e.get(Se.gM)),le=$.set(y.D.ExtHostSearch,e.get(Yi.FR)),de=$.set(y.D.ExtHostTask,e.get(ar.h2)),ue=$.set(y.D.ExtHostOutputService,e.get(Ii.U)),he=$.set(y.D.ExtHostLocalization,e.get(ei.O)),me=$.set(y.D.ExtHostUrls,new Br($)),fe=$.set(y.D.ExtHostDocuments,new Me($,te)),ge=$.set(y.D.ExtHostDocumentContentProviders,new Le($,te,U)),ve=$.set(y.D.ExtHostDocumentSaveParticipant,new ze(U,fe,$.getProxy(y.Tr.MainThreadBulkEdits))),_e=$.set(y.D.ExtHostNotebook,new fi($,ie,te,fe,S,le)),be=$.set(y.D.ExtHostNotebookDocuments,new vi(_e)),we=$.set(y.D.ExtHostNotebookEditors,new _i(U,_e)),xe=$.set(y.D.ExtHostNotebookKernels,new wi($,t,_e,ie,U)),Ce=$.set(y.D.ExtHostNotebookRenderers,new ki($,_e)),De=$.set(y.D.ExtHostNotebookDocumentSaveParticipant,new gi(U,_e,$.getProxy(y.Tr.MainThreadBulkEdits))),ke=$.set(y.D.ExtHostEditors,new Pr($,te)),Ie=$.set(y.D.ExtHostTreeViews,new Fr($.getProxy(y.Tr.MainThreadTreeViews),ie,U)),Te=$.set(y.D.ExtHostEditorInsets,new re($.getProxy(y.Tr.MainThreadEditorInsets),ke,t.remote)),$e=$.set(y.D.ExtHostDiagnostics,new Ae($,U,i,te)),Ne=$.set(y.D.ExtHostLanguages,new Zt($,fe,ie.converter,R)),Fe=$.set(y.D.ExtHostLanguageFeatures,new Yt($,R,fe,ie,$e,U,W,k)),We=$.set(y.D.ExtHostFileSystem,new Ke($,Fe)),Ve=$.set(y.D.ExtHostFileSystemEventService,new Ze($,U,te)),qe=$.set(y.D.ExtHostQuickOpen,zi($,D,ie)),je=$.set(y.D.ExtHostSCM,new Ji($,ie,fe,U)),Ge=$.set(y.D.ExtHostQuickDiff,new Li($,R)),Je=$.set(y.D.ExtHostShare,new Zi($,R)),Ye=$.set(y.D.ExtHostComments,ne($,ie,fe)),Xe=$.set(y.D.ExtHostProgress,new Ri($.getProxy(y.Tr.MainThreadProgress))),tt=$.set(y.D.ExtHostLabelService,new st($)),it=$.set(y.D.ExtHostTheming,new Tr($)),ot=$.set(y.D.ExtHostTimeline,new Rr($,ie)),at=$.set(y.D.ExtHostWebviews,new pe($,t.remote,D,U,W)),ct=$.set(y.D.ExtHostWebviewPanels,new Vr($,at,D)),lt=$.set(y.D.ExtHostCustomEditors,new ye($,fe,M,at,ct)),dt=$.set(y.D.ExtHostWebviewViews,new Kr($,at)),ut=$.set(y.D.ExtHostTesting,new vr($,U,ie,te)),ht=$.set(y.D.ExtHostUriOpeners,new Hr($)),pt=$.set(y.D.ExtHostProfileContentHandlers,new Pi($));$.set(y.D.ExtHostInteractive,new nt($,_e,te,ie,U));const mt=$.set(y.D.ExtHostInlineChat,new rt($,ie,fe,U)),ft=$.set(y.D.ExtHostChatAgents2,new Q($,U,ie)),gt=$.set(y.D.ExtHostChatVariables,new J($)),vt=$.set(y.D.ExtHostAiRelatedInformation,new C($)),_t=$.set(y.D.ExtHostAiEmbeddingVector,new Ue($)),bt=$.set(y.D.ExtHostStatusBar,new nr($,ie.converter)),wt=$.set(y.D.ExtHostSpeech,new er($)),yt=Object.values(y.D);$.assertRegistered(yt);const xt=new O($,te),Ct=new X($),St=new ii($,U),Et=new Re($);return A.register(ie),function(e,i,v){function C(t){return(i,r,s)=>{const o=t((t=>{try{i.call(r,t)}catch(t){(0,n.Cp)(new Error(`[ExtensionListenerError] Extension '${e.identifier.value}' FAILED to handle event: ${t.toString()}`,{cause:t})),k.onExtensionError(e.identifier,t)}}));return s?.push(o),o}}const I=function(){let t=!e.isUnderDevelopment;function i(){t||(U.info(`Extension '${e.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),t=!0)}return function t(r){if(Array.isArray(r))r.forEach(t);else if("string"==typeof r)i();else{const t=r;void 0===t.scheme&&i(),"boolean"==typeof t.exclusive&&(0,j.H5)(e,"documentFiltersExclusive")}return r}}(),T={getSession(t,i,r){return"object"==typeof r?.forceNewSession&&r.forceNewSession.learnMore&&(0,j.H5)(e,"authLearnMore"),Y.getSession(e,t,i,r)},getSessions(t,i){return(0,j.H5)(e,"authGetSessions"),Y.getSessions(e,t,i)},async hasSession(t,i){return(0,j.H5)(e,"authSession"),!!await Y.getSession(e,t,i,{silent:!0})},get onDidChangeSessions(){return C(Y.onDidChangeSessions)},registerAuthenticationProvider(e,t,i,r){return Y.registerAuthenticationProvider(e,t,i,r)}},A={registerCommand(t,i,r){return ie.registerCommand(!0,t,i,r,void 0,e)},registerTextEditorCommand(t,i,r){return ie.registerCommand(!0,t,((...e)=>{const n=ke.getActiveTextEditor();if(n)return n.edit((t=>{i.apply(r,[n,t,...e])})).then((e=>{e||U.warn("Edits from command "+t+" were not applied.")}),(e=>{U.warn("An error occurred while running command "+t,e)}));U.warn("Cannot execute "+t+" because there is no active text editor.")}),void 0,void 0,e)},registerDiffInformationCommand:(t,i,r)=>((0,j.H5)(e,"diffCommand"),ie.registerCommand(!0,t,(async(...e)=>{const n=te.activeEditor(!0);if(!n)return void U.warn("Cannot execute "+t+" because there is no active text editor.");const s=await ke.getDiffInformation(n.id);i.apply(r,[s,...e])}),void 0,void 0,e)),executeCommand(e,...t){return ie.executeCommand(e,...t)},getCommands(e=!1){return ie.getCommands(e)}},R={get machineId(){return t.telemetryInfo.machineId},get sessionId(){return t.telemetryInfo.sessionId},get language(){return t.environment.appLanguage},get appName(){return t.environment.appName},get appRoot(){return t.environment.appRoot?.fsPath??""},get appHost(){return t.environment.appHost},get uriScheme(){return t.environment.appUriScheme},get clipboard(){return Ct.value},get shell(){return oe.getDefaultShell(!1)},get onDidChangeShell(){return C(oe.onDidChangeShell)},get isTelemetryEnabled(){return k.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return C(k.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return(0,j.H5)(e,"telemetry"),k.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return(0,j.H5)(e,"telemetry"),C(k.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return(0,cr.oI)(t.telemetryInfo.firstSessionDate)},createTelemetryLogger(t,i){return cr.jQ.validateSender(t),k.instantiateLogger(e,t,i)},openExternal(e,i){return V.openUri(e,{allowTunneling:!!t.remote.authority,allowContributedOpeners:i?.allowContributedOpeners})},async asExternalUri(e){if(e.scheme===t.environment.appUriScheme)return me.createAppUri(e);try{return await V.asExternalUri(e,{allowTunneling:!!t.remote.authority})}catch(t){if((0,a.xn)(e,a.lg.http)||(0,a.xn)(e,a.lg.https))return e;throw t}},get remoteName(){return(0,_.WX)(t.remote.authority)},get remoteAuthority(){return(0,j.H5)(e,"resolvers"),t.remote.authority},get uiKind(){return t.uiKind},get logLevel(){return U.getLevel()},get onDidChangeLogLevel(){return C(U.onDidChangeLogLevel)},get appQuality(){return(0,j.H5)(e,"resolvers"),t.quality},get appCommit(){return(0,j.H5)(e,"resolvers"),t.commit}},$={createTestController(t,i,r){return ut.createTestController(e,t,i,r)},createTestObserver(){return(0,j.H5)(e,"testObserver"),ut.createTestObserver()},runTests(t){return(0,j.H5)(e,"testObserver"),ut.runTests(t)},get onDidChangeTestResults(){return(0,j.H5)(e,"testObserver"),C(ut.onResultsChanged)},get testResults(){return(0,j.H5)(e,"testObserver"),ut.results}},L=t.remote.isRemote?x.TPH.Workspace:x.TPH.UI,N={getExtension(t,r){(0,j.$x)(e,"extensionsAny")||(r=!1);const n=i.mine.getExtensionDescription(t);if(n)return new Be.hj(E,e.identifier,n,L,!1);if(r){const r=i.all.getExtensionDescription(t);if(r)return new Be.hj(E,e.identifier,r,L,!0)}},get all(){const t=[];for(const r of i.mine.getAllExtensionDescriptions())t.push(new Be.hj(E,e.identifier,r,L,!1));return t},get allAcrossExtensionHosts(){(0,j.H5)(e,"extensionsAny");const t=new m.o$(i.mine.getAllExtensionDescriptions().map((e=>e.identifier))),r=[];for(const n of i.all.getAllExtensionDescriptions()){const i=!t.has(n.identifier);r.push(new Be.hj(E,e.identifier,n,L,i))}return r},get onDidChange(){return(0,j.$x)(e,"extensionsAny")?C(s.ju.any(i.mine.onDidChange,i.all.onDidChange)):C(i.mine.onDidChange)}},z={createDiagnosticCollection(t){return $e.createDiagnosticCollection(e.identifier,t)},get onDidChangeDiagnostics(){return C($e.onDidChangeDiagnostics)},getDiagnostics:e=>$e.getDiagnostics(e),getLanguages(){return Ne.getLanguages()},setTextDocumentLanguage(e,t){return Ne.changeLanguage(e.uri,t)},match(e,t){const i=P.$z.from(e);let r;return(0,u.J)(i)&&(r=_e.notebookDocuments.find((e=>e.apiNotebook.getCells().find((e=>e.document===t))))?.apiNotebook),(0,u.G)(i,t.uri,t.languageId,!0,r?.uri,r?.notebookType)},registerCodeActionsProvider(t,i,r){return Fe.registerCodeActionProvider(e,I(t),i,r)},registerDocumentPasteEditProvider(t,i,r){return(0,j.H5)(e,"documentPaste"),Fe.registerDocumentPasteEditProvider(e,I(t),i,r)},registerCodeLensProvider(t,i){return Fe.registerCodeLensProvider(e,I(t),i)},registerDefinitionProvider(t,i){return Fe.registerDefinitionProvider(e,I(t),i)},registerDeclarationProvider(t,i){return Fe.registerDeclarationProvider(e,I(t),i)},registerImplementationProvider(t,i){return Fe.registerImplementationProvider(e,I(t),i)},registerTypeDefinitionProvider(t,i){return Fe.registerTypeDefinitionProvider(e,I(t),i)},registerHoverProvider(t,i){return Fe.registerHoverProvider(e,I(t),i,e.identifier)},registerEvaluatableExpressionProvider(t,i){return Fe.registerEvaluatableExpressionProvider(e,I(t),i,e.identifier)},registerInlineValuesProvider(t,i){return Fe.registerInlineValuesProvider(e,I(t),i,e.identifier)},registerDocumentHighlightProvider(t,i){return Fe.registerDocumentHighlightProvider(e,I(t),i)},registerMultiDocumentHighlightProvider(t,i){return Fe.registerMultiDocumentHighlightProvider(e,I(t),i)},registerLinkedEditingRangeProvider(t,i){return Fe.registerLinkedEditingRangeProvider(e,I(t),i)},registerReferenceProvider(t,i){return Fe.registerReferenceProvider(e,I(t),i)},registerRenameProvider(t,i){return Fe.registerRenameProvider(e,I(t),i)},registerNewSymbolNamesProvider(t,i){return(0,j.H5)(e,"newSymbolNamesProvider"),Fe.registerNewSymbolNamesProvider(e,I(t),i)},registerDocumentSymbolProvider(t,i,r){return Fe.registerDocumentSymbolProvider(e,I(t),i,r)},registerWorkspaceSymbolProvider(t){return Fe.registerWorkspaceSymbolProvider(e,t)},registerDocumentFormattingEditProvider(t,i){return Fe.registerDocumentFormattingEditProvider(e,I(t),i)},registerDocumentRangeFormattingEditProvider(t,i){return Fe.registerDocumentRangeFormattingEditProvider(e,I(t),i)},registerOnTypeFormattingEditProvider(t,i,r,...n){return Fe.registerOnTypeFormattingEditProvider(e,I(t),i,[r].concat(n))},registerDocumentSemanticTokensProvider(t,i,r){return Fe.registerDocumentSemanticTokensProvider(e,I(t),i,r)},registerDocumentRangeSemanticTokensProvider(t,i,r){return Fe.registerDocumentRangeSemanticTokensProvider(e,I(t),i,r)},registerSignatureHelpProvider(t,i,r,...n){return"object"==typeof r?Fe.registerSignatureHelpProvider(e,I(t),i,r):Fe.registerSignatureHelpProvider(e,I(t),i,void 0===r?[]:[r,...n])},registerCompletionItemProvider(t,i,...r){return Fe.registerCompletionItemProvider(e,I(t),i,r)},registerInlineCompletionItemProvider(t,i,r){return i.handleDidShowCompletionItem&&(0,j.H5)(e,"inlineCompletionsAdditions"),i.handleDidPartiallyAcceptCompletionItem&&(0,j.H5)(e,"inlineCompletionsAdditions"),r&&(0,j.H5)(e,"inlineCompletionsAdditions"),Fe.registerInlineCompletionsProvider(e,I(t),i,r)},registerInlineEditProvider(t,i){return(0,j.H5)(e,"inlineEdit"),Fe.registerInlineEditProvider(e,I(t),i)},registerDocumentLinkProvider(t,i){return Fe.registerDocumentLinkProvider(e,I(t),i)},registerColorProvider(t,i){return Fe.registerColorProvider(e,I(t),i)},registerFoldingRangeProvider(t,i){return Fe.registerFoldingRangeProvider(e,I(t),i)},registerSelectionRangeProvider(t,i){return Fe.registerSelectionRangeProvider(e,t,i)},registerCallHierarchyProvider(t,i){return Fe.registerCallHierarchyProvider(e,t,i)},registerTypeHierarchyProvider(t,i){return Fe.registerTypeHierarchyProvider(e,t,i)},setLanguageConfiguration:(t,i)=>Fe.setLanguageConfiguration(e,t,i),getTokenInformationAtPosition(t,i){return(0,j.H5)(e,"tokenInformation"),Ne.tokenAtPosition(t,i)},registerInlayHintsProvider(t,i){return Fe.registerInlayHintsProvider(e,t,i)},createLanguageStatusItem(t,i){return Ne.createLanguageStatusItem(e,t,i)},registerDocumentDropEditProvider(t,i,r){return Fe.registerDocumentOnDropEditProvider(e,t,i,(0,j.$x)(e,"documentPaste")?r:void 0)}},F={get activeTextEditor(){return ke.getActiveTextEditor()},get visibleTextEditors(){return ke.getVisibleTextEditors()},get activeTerminal(){return oe.activeTerminal},get terminals(){return oe.terminals},async showTextDocument(t,i,r){l.ov.isUri(t)&&t.scheme===a.lg.vscodeRemote&&!t.authority&&W.report("workspace.showTextDocument",e,"A URI of 'vscode-remote' scheme requires an authority.");const n=await(l.ov.isUri(t)?Promise.resolve(M.openTextDocument(t)):Promise.resolve(t));return ke.showTextDocument(n,i,r)},createTextEditorDecorationType(t){return ke.createTextEditorDecorationType(e,t)},onDidChangeActiveTextEditor(e,t,i){return C(ke.onDidChangeActiveTextEditor)(e,t,i)},onDidChangeVisibleTextEditors(e,t,i){return C(ke.onDidChangeVisibleTextEditors)(e,t,i)},onDidChangeTextEditorSelection(e,t,i){return C(ke.onDidChangeTextEditorSelection)(e,t,i)},onDidChangeTextEditorOptions(e,t,i){return C(ke.onDidChangeTextEditorOptions)(e,t,i)},onDidChangeTextEditorVisibleRanges(e,t,i){return C(ke.onDidChangeTextEditorVisibleRanges)(e,t,i)},onDidChangeTextEditorViewColumn(e,t,i){return C(ke.onDidChangeTextEditorViewColumn)(e,t,i)},onDidCloseTerminal(e,t,i){return C(oe.onDidCloseTerminal)(e,t,i)},onDidOpenTerminal(e,t,i){return C(oe.onDidOpenTerminal)(e,t,i)},onDidChangeActiveTerminal(e,t,i){return C(oe.onDidChangeActiveTerminal)(e,t,i)},onDidChangeTerminalDimensions(t,i,r){return(0,j.H5)(e,"terminalDimensions"),C(oe.onDidChangeTerminalDimensions)(t,i,r)},onDidChangeTerminalState(e,t,i){return C(oe.onDidChangeTerminalState)(e,t,i)},onDidWriteTerminalData(t,i,r){return(0,j.H5)(e,"terminalDataWriteEvent"),C(oe.onDidWriteTerminalData)(t,i,r)},onDidExecuteTerminalCommand(t,i,r){return(0,j.H5)(e,"terminalExecuteCommandEvent"),C(oe.onDidExecuteTerminalCommand)(t,i,r)},onDidChangeTerminalShellIntegration(t,i,r){return(0,j.H5)(e,"terminalShellIntegration"),C(ae.onDidChangeTerminalShellIntegration)(t,i,r)},onDidStartTerminalShellExecution(t,i,r){return(0,j.H5)(e,"terminalShellIntegration"),C(ae.onDidStartTerminalShellExecution)(t,i,r)},onDidEndTerminalShellExecution(t,i,r){return(0,j.H5)(e,"terminalShellIntegration"),C(ae.onDidEndTerminalShellExecution)(t,i,r)},get state(){return V.getState()},onDidChangeWindowState(e,t,i){return C(V.onDidChangeWindowState)(e,t,i)},showInformationMessage(t,...i){return St.showMessage(e,c.Z.Info,t,i[0],i.slice(1))},showWarningMessage(t,...i){return St.showMessage(e,c.Z.Warning,t,i[0],i.slice(1))},showErrorMessage(t,...i){return St.showMessage(e,c.Z.Error,t,i[0],i.slice(1))},showQuickPick(t,i,r){return qe.showQuickPick(e,t,i,r)},showWorkspaceFolderPick(e){return qe.showWorkspaceFolderPick(e)},showInputBox(e,t){return qe.showInput(e,t)},showOpenDialog(t){return Et.showOpenDialog(e,t)},showSaveDialog(e){return Et.showSaveDialog(e)},createStatusBarItem(t,i,r){let n,s,o;return"string"==typeof t?(n=t,s=i,o=r):(s=t,o=i),bt.createStatusBarEntry(e,n,s,o)},setStatusBarMessage(e,t){return bt.setStatusBarMessage(e,t)},withScmProgress(t){return W.report("window.withScmProgress",e,"Use 'withProgress' instead."),Xe.withProgress(e,{location:x.uTI.SourceControl},((e,i)=>t({report(e){}})))},withProgress(t,i){return Xe.withProgress(e,t,i)},createOutputChannel(t,i){return ue.createOutputChannel(t,i,e)},createWebviewPanel(t,i,r,n){return ct.createWebviewPanel(e,t,i,r,n)},createWebviewTextEditorInset(t,i,r,n){return(0,j.H5)(e,"editorInsets"),Te.createWebviewEditorInset(t,i,r,n,e)},createTerminal(e,t,i){return"object"==typeof e?"pty"in e?oe.createExtensionTerminal(e):oe.createTerminalFromOptions(e):oe.createTerminal(e,t,i)},registerTerminalLinkProvider(e){return oe.registerLinkProvider(e)},registerTerminalProfileProvider(t,i){return oe.registerProfileProvider(e,t,i)},registerTerminalQuickFixProvider(t,i){return(0,j.H5)(e,"terminalQuickFixProvider"),oe.registerTerminalQuickFixProvider(t,e.identifier.value,i)},registerTreeDataProvider(t,i){return Ie.registerTreeDataProvider(t,i,e)},createTreeView(t,i){return Ie.createTreeView(t,i,e)},registerWebviewPanelSerializer:(t,i)=>ct.registerWebviewPanelSerializer(e,t,i),registerCustomEditorProvider:(t,i,r={})=>lt.registerCustomEditorProvider(e,t,i,r),registerFileDecorationProvider(t){return ee.registerFileDecorationProvider(t,e)},registerUriHandler(t){return me.registerUriHandler(e,t)},createQuickPick(){return qe.createQuickPick(e)},createInputBox(){return qe.createInputBox(e)},get activeColorTheme(){return it.activeColorTheme},onDidChangeActiveColorTheme(e,t,i){return C(it.onDidChangeActiveColorTheme)(e,t,i)},registerWebviewViewProvider(t,i,r){return dt.registerWebviewViewProvider(e,t,i,r?.webviewOptions)},get activeNotebookEditor(){return _e.activeNotebookEditor},onDidChangeActiveNotebookEditor(e,t,i){return C(_e.onDidChangeActiveNotebookEditor)(e,t,i)},get visibleNotebookEditors(){return _e.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return C(_e.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(e,t,i){return C(we.onDidChangeNotebookEditorSelection)(e,t,i)},onDidChangeNotebookEditorVisibleRanges(e,t,i){return C(we.onDidChangeNotebookEditorVisibleRanges)(e,t,i)},showNotebookDocument(e,t){return _e.showNotebookDocument(e,t)},registerExternalUriOpener(t,i,r){return(0,j.H5)(e,"externalUriOpener"),ht.registerExternalUriOpener(e.identifier,t,i,r)},registerProfileContentHandler(t,i){return(0,j.H5)(e,"profileContentHandlers"),pt.registerProfileContentHandler(e,t,i)},registerQuickDiffProvider(t,i,r,n){return(0,j.H5)(e,"quickDiffProvider"),Ge.registerQuickDiffProvider(I(t),i,r,n)},get tabGroups(){return K.tabGroups},registerShareProvider(t,i){return(0,j.H5)(e,"shareProvider"),Je.registerShareProvider(I(t),i)}},M={get rootPath(){return W.report("workspace.rootPath",e,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),D.getPath()},set rootPath(e){throw new n.Tu("rootPath")},getWorkspaceFolder(e){return D.getWorkspaceFolder(e)},get workspaceFolders(){return D.getWorkspaceFolders()},get name(){return D.name},set name(e){throw new n.Tu("name")},get workspaceFile(){return D.workspaceFile},set workspaceFile(e){throw new n.Tu("workspaceFile")},updateWorkspaceFolders:(t,i,...r)=>D.updateWorkspaceFolders(e,t,i||0,...r),onDidChangeWorkspaceFolders:function(e,t,i){return C(D.onDidChangeWorkspace)(e,t,i)},asRelativePath:(e,t)=>D.getRelativePath(e,t),findFiles:(t,i,r,n)=>D.findFiles(t,i,r,e.identifier,n),findFiles2:(t,i,r)=>((0,j.H5)(e,"findFiles2"),D.findFiles2(t,i,e.identifier,r)),findTextInFiles:(t,i,r,n)=>{let s,o;return(0,j.H5)(e,"findTextInFiles"),"object"==typeof i?(s=i,o=r):(s={},o=i,n=r),D.findTextInFiles(t,s||{},o,e.identifier,n)},save:e=>D.save(e),saveAs:e=>D.saveAs(e),saveAll:e=>D.saveAll(e),applyEdit(t,i){return xt.applyWorkspaceEdit(t,e,i)},createFileSystemWatcher:(t,i,r,n)=>{let s;return"boolean"==typeof i?s={ignoreCreateEvents:Boolean(i),ignoreChangeEvents:Boolean(r),ignoreDeleteEvents:Boolean(n),correlate:!1}:i&&((0,j.H5)(e,"createFileSystemWatcher"),s={...i,correlate:!0}),Ve.createFileSystemWatcher(D,e,t,s)},get textDocuments(){return fe.getAllDocumentData().map((e=>e.document))},set textDocuments(e){throw new n.Tu("textDocuments")},openTextDocument(t){let i;const r=t;if("string"==typeof t)i=Promise.resolve(l.ov.file(t));else if(l.ov.isUri(t))i=Promise.resolve(t);else{if(r&&"object"!=typeof r)throw new Error("illegal argument - uriOrFileNameOrOptions");i=fe.createDocumentData(r)}return i.then((t=>(t.scheme!==a.lg.vscodeRemote||t.authority||W.report("workspace.openTextDocument",e,"A URI of 'vscode-remote' scheme requires an authority."),fe.ensureDocumentData(t).then((e=>e.document)))))},onDidOpenTextDocument:(e,t,i)=>C(fe.onDidAddDocument)(e,t,i),onDidCloseTextDocument:(e,t,i)=>C(fe.onDidRemoveDocument)(e,t,i),onDidChangeTextDocument:(e,t,i)=>C(fe.onDidChangeDocument)(e,t,i),onDidSaveTextDocument:(e,t,i)=>C(fe.onDidSaveDocument)(e,t,i),onWillSaveTextDocument:(t,i,r)=>C(ve.getOnWillSaveTextDocumentEvent(e))(t,i,r),get notebookDocuments(){return _e.notebookDocuments.map((e=>e.apiNotebook))},async openNotebookDocument(e,t){let i;if(l.ov.isUri(e))i=e,await _e.openNotebookDocument(e);else{if("string"!=typeof e)throw new Error("Invalid arguments");i=l.ov.revive(await _e.createNotebookDocument({viewType:e,content:t}))}return _e.getNotebookDocument(i).apiNotebook},onDidSaveNotebookDocument(e,t,i){return C(be.onDidSaveNotebookDocument)(e,t,i)},onDidChangeNotebookDocument(e,t,i){return C(be.onDidChangeNotebookDocument)(e,t,i)},onWillSaveNotebookDocument(t,i,r){return C(De.getOnWillSaveNotebookDocumentEvent(e))(t,i,r)},get onDidOpenNotebookDocument(){return C(_e.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return C(_e.onDidCloseNotebookDocument)},registerNotebookSerializer(t,i,r,n){return _e.registerNotebookSerializer(e,t,i,r,(0,j.$x)(e,"notebookLiveShare")?n:void 0)},onDidChangeConfiguration:(e,t,i)=>C(v.onDidChangeConfiguration)(e,t,i),getConfiguration(t,i){return i=1===arguments.length?void 0:i,v.getConfiguration(t,i,e)},registerTextDocumentContentProvider(e,t){return ge.registerTextDocumentContentProvider(e,t)},registerTaskProvider:(t,i)=>(W.report("window.registerTaskProvider",e,"Use the corresponding function on the 'tasks' namespace instead"),de.registerTaskProvider(e,t,i)),registerFileSystemProvider(t,i,r){return(0,o.F8)(We.registerFileSystemProvider(e,t,i,r),S.addFileSystemProvider(t,i,r))},get fs(){return S.value},registerFileSearchProvider:(t,i)=>((0,j.H5)(e,"fileSearchProvider"),le.registerFileSearchProvider(t,i)),registerTextSearchProvider:(t,i)=>((0,j.H5)(e,"textSearchProvider"),le.registerTextSearchProvider(t,i)),registerAITextSearchProvider:(t,i)=>((0,j.H5)(e,"aiTextSearchProvider"),(0,j.H5)(e,"textSearchProvider"),le.registerAITextSearchProvider(t,i)),registerRemoteAuthorityResolver:(t,i)=>((0,j.H5)(e,"resolvers"),E.registerRemoteAuthorityResolver(t,i)),registerResourceLabelFormatter:t=>((0,j.H5)(e,"resolvers"),tt.$registerResourceLabelFormatter(t)),getRemoteExecServer:t=>((0,j.H5)(e,"resolvers"),E.getRemoteExecServer(t)),onDidCreateFiles:(e,t,i)=>C(Ve.onDidCreateFile)(e,t,i),onDidDeleteFiles:(e,t,i)=>C(Ve.onDidDeleteFile)(e,t,i),onDidRenameFiles:(e,t,i)=>C(Ve.onDidRenameFile)(e,t,i),onWillCreateFiles:(t,i,r)=>C(Ve.getOnWillCreateFileEvent(e))(t,i,r),onWillDeleteFiles:(t,i,r)=>C(Ve.getOnWillDeleteFileEvent(e))(t,i,r),onWillRenameFiles:(t,i,r)=>C(Ve.getOnWillRenameFileEvent(e))(t,i,r),openTunnel:t=>((0,j.H5)(e,"tunnels"),B.openTunnel(e,t).then((e=>{if(!e)throw new Error("cannot open tunnel");return e}))),get tunnels(){return(0,j.H5)(e,"tunnels"),B.getTunnels()},onDidChangeTunnels:(t,i,r)=>((0,j.H5)(e,"tunnels"),C(B.onDidChangeTunnels)(t,i,r)),registerPortAttributesProvider:(t,i)=>((0,j.H5)(e,"portsAttributes"),B.registerPortsAttributesProvider(t,i)),registerTunnelProvider:(t,i)=>((0,j.H5)(e,"tunnelFactory"),B.registerTunnelProvider(t,i)),registerTimelineProvider:(t,i)=>((0,j.H5)(e,"timeline"),ot.registerTimelineProvider(t,i,e.identifier,ie.converter)),get isTrusted(){return D.trusted},requestWorkspaceTrust:t=>((0,j.H5)(e,"workspaceTrust"),D.requestWorkspaceTrust(t)),onDidGrantWorkspaceTrust:(e,t,i)=>C(D.onDidGrantWorkspaceTrust)(e,t,i),registerEditSessionIdentityProvider:(t,i)=>((0,j.H5)(e,"editSessionIdentityProvider"),D.registerEditSessionIdentityProvider(t,i)),onWillCreateEditSessionIdentity:(t,i,r)=>((0,j.H5)(e,"editSessionIdentityProvider"),C(D.getOnWillCreateEditSessionIdentityEvent(e))(t,i,r)),registerCanonicalUriProvider:(t,i)=>((0,j.H5)(e,"canonicalUriProvider"),D.registerCanonicalUriProvider(t,i)),getCanonicalUri:(t,i,r)=>((0,j.H5)(e,"canonicalUriProvider"),D.provideCanonicalUri(t,i,r))},O={get inputBox(){return W.report("scm.inputBox",e,"Use 'SourceControl.inputBox' instead"),je.getLastInputBox(e)},createSourceControl(t,i,r){return je.createSourceControl(e,t,i,r)}},H={createCommentController(t,i){return Ye.createCommentController(e,t,i)}},q={get activeDebugSession(){return ce.activeDebugSession},get activeDebugConsole(){return ce.activeDebugConsole},get breakpoints(){return ce.breakpoints},get activeStackItem(){if((0,j.$x)(e,"debugFocus"))return ce.activeStackItem},registerDebugVisualizationProvider(t,i){return(0,j.H5)(e,"debugVisualization"),ce.registerDebugVisualizationProvider(e,t,i)},registerDebugVisualizationTreeProvider(t,i){return(0,j.H5)(e,"debugVisualization"),ce.registerDebugVisualizationTree(e,t,i)},onDidStartDebugSession(e,t,i){return C(ce.onDidStartDebugSession)(e,t,i)},onDidTerminateDebugSession(e,t,i){return C(ce.onDidTerminateDebugSession)(e,t,i)},onDidChangeActiveDebugSession(e,t,i){return C(ce.onDidChangeActiveDebugSession)(e,t,i)},onDidReceiveDebugSessionCustomEvent(e,t,i){return C(ce.onDidReceiveDebugSessionCustomEvent)(e,t,i)},onDidChangeBreakpoints(e,t,i){return C(ce.onDidChangeBreakpoints)(e,t,i)},onDidChangeActiveStackItem(t,i,r){return(0,j.H5)(e,"debugFocus"),C(ce.onDidChangeActiveStackItem)(t,i,r)},registerDebugConfigurationProvider(e,t,i){return ce.registerDebugConfigurationProvider(e,t,i||Jr.j4.Initial)},registerDebugAdapterDescriptorFactory(t,i){return ce.registerDebugAdapterDescriptorFactory(e,t,i)},registerDebugAdapterTrackerFactory(e,t){return ce.registerDebugAdapterTrackerFactory(e,t)},startDebugging(e,t,i){return!i||"object"==typeof i&&"configuration"in i?ce.startDebugging(e,t,{parentSession:i}):ce.startDebugging(e,t,i||{})},stopDebugging(e){return ce.stopDebugging(e)},addBreakpoints(e){return ce.addBreakpoints(e)},removeBreakpoints(e){return ce.removeBreakpoints(e)},asDebugSourceUri(e,t){return ce.asDebugSourceUri(e,t)}},Q={registerTaskProvider:(t,i)=>de.registerTaskProvider(e,t,i),fetchTasks:e=>de.fetchTasks(e),executeTask:t=>de.executeTask(e,t),get taskExecutions(){return de.taskExecutions},onDidStartTask:(e,t,i)=>C(de.onDidStartTask)(e,t,i),onDidEndTask:(e,t,i)=>C(de.onDidEndTask)(e,t,i),onDidStartTaskProcess:(e,t,i)=>C(de.onDidStartTaskProcess)(e,t,i),onDidEndTaskProcess:(e,t,i)=>C(de.onDidEndTaskProcess)(e,t,i)},G={createNotebookController(t,i,r,n,s){return xe.createNotebookController(e,t,i,r,n,(0,j.$x)(e,"notebookMessaging")?s:void 0)},registerNotebookCellStatusBarItemProvider:(t,i)=>_e.registerNotebookCellStatusBarItemProvider(e,t,i),createRendererMessaging(t){return Ce.createRendererMessaging(e,t)},createNotebookControllerDetectionTask(t){return(0,j.H5)(e,"notebookKernelSource"),xe.createNotebookControllerDetectionTask(e,t)},registerKernelSourceActionProvider(t,i){return(0,j.H5)(e,"notebookKernelSource"),xe.registerKernelSourceActionProvider(e,t,i)},onDidChangeNotebookCellExecutionState(t,i,r){return(0,j.H5)(e,"notebookCellExecutionState"),C(xe.onDidChangeNotebookCellExecutionState)(t,i,r)}},J={t(...t){if("string"==typeof t[0]){const i=t.shift(),r=t&&"object"==typeof t[0]?t[0]:t;return he.getMessage(e.identifier.value,{message:i,args:r})}return he.getMessage(e.identifier.value,t[0])},get bundle(){return he.getBundle(e.identifier.value)},get uri(){return he.getBundleUri(e.identifier.value)}},X={_version:1,registerInteractiveEditorSessionProvider(t,i){return(0,j.H5)(e,"interactive"),mt.registerProvider(e,t,i)},transferActiveChat(t){return(0,j.H5)(e,"interactive"),ft.transferActiveChat(t)}},re={getRelatedInformation(t,i){return(0,j.H5)(e,"aiRelatedInformation"),vt.getRelatedInformation(e,t,i)},registerRelatedInformationProvider(t,i){return(0,j.H5)(e,"aiRelatedInformation"),vt.registerRelatedInformationProvider(e,t,i)},registerEmbeddingVectorProvider(t,i){return(0,j.H5)(e,"aiRelatedInformation"),_t.registerEmbeddingVectorProvider(e,t,i)}},ne={registerChatResponseProvider(t,i,r){return(0,j.H5)(e,"chatProvider"),Z.registerLanguageModel(e,t,i,r)},registerChatVariableResolver(t,i,r){return(0,j.H5)(e,"chatVariableResolver"),gt.registerVariableResolver(e,t,i,r)},registerMappedEditsProvider(t,i){return(0,j.H5)(e,"mappedEditsProvider"),Fe.registerMappedEditsProvider(e,t,i)},createChatParticipant(t,i){return(0,j.H5)(e,"chatParticipant"),ft.createChatAgent(e,t,i)},createDynamicChatParticipant(t,i,r,n){return(0,j.H5)(e,"chatParticipantAdditions"),ft.createDynamicChatAgent(e,t,i,r,n)}},se={get languageModels(){return(0,j.H5)(e,"languageModels"),Z.getLanguageModelIds()},onDidChangeLanguageModels:(t,i,r)=>((0,j.H5)(e,"languageModels"),Z.onDidChangeProviders(t,i,r)),sendChatRequest(t,i,r,n){return(0,j.H5)(e,"languageModels"),Z.sendChatRequest(e,t,i,r,n)},computeTokenLength(t,i,n){return(0,j.H5)(e,"languageModels"),n??=r.Ts.None,Z.computeTokenLength(t,i,n)},getLanguageModelInformation(t){return(0,j.H5)(e,"languageModels"),Z.getLanguageModelInfo(t)}},pe={registerSpeechProvider(t,i){return(0,j.H5)(e,"speech"),wt.registerProvider(e.identifier,t,i)}};return{version:t.version,ai:re,authentication:T,commands:A,comments:H,chat:ne,debug:q,env:R,extensions:N,interactive:X,l10n:J,languages:z,lm:se,notebooks:G,scm:O,speech:pe,tasks:Q,tests:$,window:F,workspace:M,Breakpoint:x.UoH,TerminalOutputAnchor:x.vvd,ChatResultFeedbackKind:x.u8m,ChatVariableLevel:x.Xfu,ChatCompletionItem:x.uOQ,CallHierarchyIncomingCall:x.MPI,CallHierarchyItem:x.llk,CallHierarchyOutgoingCall:x.RVV,CancellationError:n.FU,CancellationTokenSource:r.AU,CandidatePortSource:y.H_,CodeAction:x.B2n,CodeActionKind:x.yNd,CodeActionTriggerKind:x.CDv,CodeLens:x.JFR,Color:x.Ilk,ColorInformation:x.pr0,ColorPresentation:x.oi2,ColorThemeKind:x.bZY,CommentMode:x._AT,CommentState:x.N$N,CommentThreadCollapsibleState:x.xKz,CommentThreadState:x.OTk,CommentThreadApplicability:x.dql,CompletionItem:x.FGT,CompletionItemKind:x.cmM,CompletionItemTag:x.weh,CompletionList:x.Ub$,CompletionTriggerKind:x.IjA,ConfigurationTarget:x.JDx,CustomExecution:x.mgN,DebugAdapterExecutable:x.FLm,DebugAdapterInlineImplementation:x.yr7,DebugAdapterNamedPipeServer:x.HGt,DebugAdapterServer:x.cZI,DebugConfigurationProviderTriggerKind:Jr.j4,DebugConsoleMode:x.lZM,DebugVisualization:x.yzl,DecorationRangeBehavior:x.TED,Diagnostic:x.R9_,DiagnosticRelatedInformation:x.va0,DiagnosticSeverity:x.H_B,DiagnosticTag:x.$uQ,Disposable:x.JTr,DocumentHighlight:x.ehQ,DocumentHighlightKind:x.MYA,MultiDocumentHighlight:x.lMH,DocumentLink:x.jWy,DocumentSymbol:x.w6Q,EndOfLine:x.b6q,EnvironmentVariableMutatorType:x.vGG,EvaluatableExpression:x.hfl,InlineValueText:x.$KE,InlineValueVariableLookup:x.wJF,InlineValueEvaluatableExpression:x.rLr,InlineCompletionTriggerKind:x.bwv,EventEmitter:s.Q5,ExtensionKind:x.TPH,ExtensionMode:x.UCC,ExternalUriOpenerPriority:x.cYW,FileChangeType:x.zR2,FileDecoration:x.unW,FileDecoration2:x.unW,FileSystemError:x.yNx,FileType:f.Tv,FilePermission:f.rM,FoldingRange:x.sof,FoldingRangeKind:x.ADb,FunctionBreakpoint:x.TpX,InlineCompletionItem:x.Coj,InlineCompletionList:x.tfP,Hover:x.TMw,VerboseHover:x.GLX,HoverVerbosityAction:x.bqK,IndentAction:h.wU,Location:x.YeX,MarkdownString:x.W5C,OverviewRulerLane:p.sh,ParameterInformation:x.M$5,PortAutoForwardAction:x.pdQ,Position:x.Lyo,ProcessExecution:x.OLe,ProgressLocation:x.uTI,QuickInputButtons:x.ApZ,Range:x.e6w,RelativePattern:x.sUC,Selection:x.Y19,SelectionRange:x.xm7,SemanticTokens:x.Uzh,SemanticTokensBuilder:x.n2H,SemanticTokensEdit:x.FR$,SemanticTokensEdits:x.JQb,SemanticTokensLegend:x.Pts,ShellExecution:x.yGk,ShellQuoting:x.WBl,SignatureHelp:x.vyX,SignatureHelpTriggerKind:x.WW0,SignatureInformation:x.qIz,SnippetString:x.EG5,SourceBreakpoint:x.TGJ,StandardTokenType:x.xJH,StatusBarAlignment:x.MIn,SymbolInformation:x.JNW,SymbolKind:x.cRn,SymbolTag:x.r4c,Task:x.iQE,TaskGroup:x.p5U,TaskPanelKind:x.e2j,TaskRevealKind:x.FZl,TaskScope:x.qNe,TerminalLink:x.TWf,TerminalQuickFixTerminalCommand:x.t5,TerminalQuickFixOpener:x.QII,TerminalLocation:x.i23,TerminalProfile:x.JCu,TerminalExitReason:x._x0,TerminalShellExecutionCommandLineConfidence:x.I82,TextDocumentSaveReason:x.wDJ,TextEdit:x.PYv,SnippetTextEdit:x.M0$,TextEditorCursorStyle:d.d2,TextEditorLineNumbersStyle:x.lP6,TextEditorRevealType:x._VK,TextEditorSelectionChangeKind:x.dWA,SyntaxTokenType:x.wxO,TextDocumentChangeReason:x.bur,ThemeColor:x.tPk,ThemeIcon:x.kS8,TreeItem:x.kfG,TreeItemCheckboxState:x.KHd,TreeItemCollapsibleState:x.oCf,TypeHierarchyItem:x.fQK,UIKind:Yr.D$,Uri:l.ov,ViewColumn:x.eIC,WorkspaceEdit:x.DbP,DocumentPasteTriggerKind:x.NqL,DocumentDropEdit:x.DKv,DocumentDropOrPasteEditKind:x.MXZ,DocumentPasteEdit:x.xwm,InlayHint:x.t7_,InlayHintLabelPart:x.qR,InlayHintKind:x.gl,RemoteAuthorityResolverError:x.qaI,ResolvedAuthority:x.sz_,ManagedResolvedAuthority:x.ryi,SourceControlInputBoxValidationType:x.TMt,ExtensionRuntime:x.Usx,TimelineItem:x.jqr,NotebookRange:x.XsU,NotebookCellKind:x.wUy,NotebookCellExecutionState:x.KPz,NotebookCellData:x.Ul,NotebookData:x.c4G,NotebookRendererScript:x.xTW,NotebookCellStatusBarAlignment:x.F3Y,NotebookEditorRevealType:x.Ay,NotebookCellOutput:x.JOq,NotebookCellOutputItem:x.x$B,NotebookCellStatusBarItem:x.sfZ,NotebookControllerAffinity:x.YjK,NotebookControllerAffinity2:x.Hu0,NotebookEdit:x.HCM,NotebookKernelSourceAction:x.acJ,NotebookVariablesRequestKind:x.rbC,PortAttributes:x.AIo,LinkedEditingRanges:x.YED,TestResultState:x.ZMD,TestRunRequest:x.$hL,TestRunRequest2:x.$hL,TestMessage:x.ltp,TestTag:x.LdD,TestRunProfileKind:x.InX,TextSearchCompleteMessageType:Xr.a,DataTransfer:x.tnH,DataTransferItem:x.lSh,TestCoverageCount:x.qRu,FileCoverage:x.XuI,StatementCoverage:x.xmj,BranchCoverage:x.fyj,DeclarationCoverage:x.dEe,WorkspaceTrustState:x.Y0F,LanguageStatusSeverity:x.Rxm,QuickPickItemKind:x.qlg,InputBoxValidationSeverity:x.S$x,TabInputText:x.Y_o,TabInputTextDiff:x.lF4,TabInputTextMerge:x.kiP,TabInputCustom:x.zwE,TabInputNotebook:x.IAb,TabInputNotebookDiff:x.ogl,TabInputWebview:x.kU2,TabInputTerminal:x.UyC,TabInputInteractiveWindow:x.Ngc,TabInputChat:x.XgO,TabInputTextMultiDiff:x.UwW,TelemetryTrustedValue:b.NE,LogLevel:g.in,EditSessionIdentityMatch:w.i,InteractiveSessionVoteDirection:x.IAe,ChatCopyKind:x.EU7,InteractiveEditorResponseFeedbackKind:x.ySx,DebugStackFrame:x.U07,DebugThread:x.hNq,RelatedInformationType:x.azK,SpeechToTextStatus:x.xJu,PartialAcceptTriggerKind:x.NAb,KeywordRecognitionStatus:x.$R,ChatResponseMarkdownPart:x.HYr,ChatResponseFileTreePart:x.Y08,ChatResponseAnchorPart:x.trJ,ChatResponseProgressPart:x.Gli,ChatResponseReferencePart:x.Ht3,ChatResponseTextEditPart:x.cGf,ChatResponseMarkdownWithVulnerabilitiesPart:x.Zgy,ChatResponseCommandButtonPart:x.WTw,ChatResponseDetectedParticipantPart:x.s8P,ChatRequestTurn:x.eg0,ChatResponseTurn:x.IQN,ChatLocation:x.oYl,LanguageModelChatSystemMessage:x.ORh,LanguageModelChatUserMessage:x.Tax,LanguageModelChatAssistantMessage:x.I01,LanguageModelSystemMessage:x.ORh,LanguageModelUserMessage:x.Tax,LanguageModelAssistantMessage:x.I01,LanguageModelError:x.tHl,NewSymbolName:x.Xdk,NewSymbolNameTag:x.wa0,NewSymbolNameTriggerKind:x.Llw,InlineEdit:x.Cgf,InlineEditTriggerKind:x.rnR}}}var en,tn=i(61826);let rn=class{constructor(e,t,i,r,n,s,o){this._apiFactory=e,this._extensionRegistry=t,this._instaService=i,this._extHostConfiguration=r,this._extHostExtensionService=n,this._initData=s,this._logService=o,this._factories=new Map,this._alternatives=[]}async install(){this._installInterceptor(),(0,tn.B)("code/extHost/willWaitForConfig");const e=await this._extHostConfiguration.getConfigProvider();(0,tn.B)("code/extHost/didWaitForConfig");const t=await this._extHostExtensionService.getExtensionPathIndex();this.register(new sn(this._apiFactory,t,this._extensionRegistry,e,this._logService)),this.register(this._instaService.createInstance(nn)),this._initData.remote.isRemote&&this.register(this._instaService.createInstance(on,t,this._initData.environment.appUriScheme))}register(e){if("nodeModuleName"in e)if(Array.isArray(e.nodeModuleName))for(const t of e.nodeModuleName)this._factories.set(t,e);else this._factories.set(e.nodeModuleName,e);"function"==typeof e.alternativeModuleName&&this._alternatives.push((t=>e.alternativeModuleName(t)))}};rn=(0,z.g)([(0,z.f)(2,Ar.TG),(0,z.f)(3,se.E1),(0,z.f)(4,Be.k2),(0,z.f)(5,et.$),(0,z.f)(6,v.V)],rn);let nn=class{static{en=this}static{this.aliased=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]])}constructor(e){if(e.environment.appRoot&&en.aliased.size){const t=(0,$e.ec)(this.forceForwardSlashes(e.environment.appRoot.fsPath)),i="[a-z0-9_.-]",r=`@${i}+\\/${i}+|${i}+`,n="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.re=new RegExp(`^(${t}/${n}\\/)(${r})(.*)$`,"i")}}alternativeModuleName(e){if(!this.re)return;const t=this.re.exec(this.forceForwardSlashes(e));if(!t)return;const[,i,r,n]=t,s=en.aliased.get(r);return void 0!==s?(console.warn(`${r} as been renamed to ${s}, please update your imports`),i+s+n):void 0}forceForwardSlashes(e){return e.replace(/\\/g,"/")}};nn=en=(0,z.g)([(0,z.f)(0,et.$)],nn);class sn{constructor(e,t,i,r,n){this._apiFactory=e,this._extensionPaths=t,this._extensionRegistry=i,this._configProvider=r,this._logService=n,this.nodeModuleName="vscode",this._extApiImpl=new m.C1}load(e,t){const i=this._extensionPaths.findSubstr(t);if(i){let e=this._extApiImpl.get(i.identifier);return e||(e=this._apiFactory(i,this._extensionRegistry,this._configProvider),this._extApiImpl.set(i.identifier,e)),e}if(!this._defaultApiImpl){let e="";this._extensionPaths.forEach(((t,i)=>e+=`\t${i} -> ${t.identifier.value}\n`)),this._logService.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: \n${e}`),this._defaultApiImpl=this._apiFactory(j.nF,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}}let on=class{constructor(e,t,i){this._extensionPaths=e,this._appUriScheme=t,this.nodeModuleName=["open","opn"],this._mainThreadTelemetry=i.getProxy(y.Tr.MainThreadTelemetry);const r=i.getProxy(y.Tr.MainThreadWindow);this._impl=(e,t)=>{const i=l.ov.parse(e);return t?this.callOriginal(e,t):"http"===i.scheme||"https"===i.scheme?r.$openUri(i,e,{allowTunneling:!0}):"mailto"===i.scheme||i.scheme===this._appUriScheme?r.$openUri(i,e,{}):this.callOriginal(e,t)}}load(e,t,i){const r=this._extensionPaths.findSubstr(t);return r&&(this._extensionId=r.identifier.value,this.sendShimmingTelemetry()),this._original=i(e),this._impl}callOriginal(e,t){return this.sendNoForwardTelemetry(),this._original(e,t)}sendShimmingTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open",{extension:this._extensionId})}sendNoForwardTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open.call.noForward",{extension:this._extensionId})}};on=(0,z.g)([(0,z.f)(2,F.O)],on);let an=class{constructor(e,t){this._mainThreadConsole=e.getProxy(y.Tr.MainThreadConsole),this._includeStack=t.consoleForward.includeStack,this._logNative=t.consoleForward.logNative,this._wrapConsoleMethod("info","log"),this._wrapConsoleMethod("log","log"),this._wrapConsoleMethod("warn","warn"),this._wrapConsoleMethod("debug","debug"),this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(e,t){const i=this,r=console[e];Object.defineProperty(console,e,{set:()=>{},get:()=>function(){i._handleConsoleCall(e,t,r,arguments)}})}_handleConsoleCall(e,t,i,r){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:t,arguments:ln(r,this._includeStack)}),this._logNative&&this._nativeConsoleLogMessage(e,i,r)}};an=(0,z.g)([(0,z.f)(0,F.O),(0,z.f)(1,et.$)],an);const cn=1e5;function ln(e,t){const i=[];if(e.length)for(let t=0;t<e.length;t++){let r=e[t];if(void 0===r)r="undefined";else if(r instanceof Error){const e=r;r=e.stack?e.stack:e.toString()}i.push(r)}if(t){const e=(new Error).stack;e&&i.push({__$stack:e.split("\n").slice(3).join("\n")})}try{const e=(0,ce.or)(i);return e.length>cn?"Output omitted for a large object that exceeds the limits":e}catch(e){return`Output omitted for an object that cannot be inspected ('${e.toString()}')`}}let dn=class extends an{constructor(e,t){super(e,t)}_nativeConsoleLogMessage(e,t,i){t.apply(console,i)}};dn=(0,z.g)([(0,z.f)(0,F.O),(0,z.f)(1,et.$)],dn);class un extends rn{_installInterceptor(){}getModule(e,t){for(const t of this._alternatives){const i=t(e);if(i){e=i;break}}if(this._factories.has(e))return this._factories.get(e).load(e,t,(()=>{throw new Error("CANNOT LOAD MODULE from here.")}))}}class hn extends Be.Qx{constructor(){super(...arguments),this.extensionRuntime=x.Usx.Webworker}async _beforeAlmostReadyToRunExtensions(){Oi.n2&&this._instaService.createInstance(dn),this._apiFactory=this._instaService.invokeFunction(Zr),this._fakeModules=this._instaService.createInstance(un,this._apiFactory,{mine:this._myRegistry,all:this._globalRegistry}),await this._fakeModules.install(),performance.mark("code/extHost/didInitAPI"),await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,t,i){var r,n;t=t.with({path:(r=t.path,n=".js",r.endsWith(n)?r:r+n)});const s=e?.identifier.value;s&&performance.mark(`code/extHost/willFetchExtensionCode/${s}`);const o=l.ov.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(t)),a=await fetch(o.toString(!0));if(s&&performance.mark(`code/extHost/didFetchExtensionCode/${s}`),200!==a.status)throw new Error(a.statusText);const c=`${await a.text()}\n//# sourceURL=${`${t.toString(!0)}#vscode-extension`}`;let d;try{d=new Function("module","exports","require",c)}catch(e){throw s?console.error(`Loading code for extension ${s} failed: ${e.message}`):console.error(`Loading code failed: ${e.message}`),console.error(`${t.toString(!0)}${"number"==typeof e.line?` line ${e.line}`:""}${"number"==typeof e.column?` column ${e.column}`:""}`),console.error(e),e}e&&await this._extHostLocalizationService.initializeLocalizedMessages(e);const u={},h={exports:u},p=e=>{const i=this._fakeModules.getModule(e,t);if(void 0===i)throw new Error(`Cannot load module '${e}'`);return i};try{return i.codeLoadingStart(),s&&performance.mark(`code/extHost/willLoadExtensionCode/${s}`),d(h,u,p),h.exports!==u?h.exports:u}finally{s&&performance.mark(`code/extHost/didLoadExtensionCode/${s}`),i.codeLoadingStop()}}async $setRemoteEnvironment(e){}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug)return;const t=Date.now()+e;for(;Date.now()<t&&!("__jsDebugIsReady"in globalThis);)await(0,H.Vs)(10)}}},47862:function(e,t,i){i.d(t,{o:function(){return o}});var r=i(81557),n=i(35820),s=i(67525);class o{constructor(){this.pendingRequests=new Map,this.queue=[],this._onError=new r.Q5,this._onExit=new r.Q5,this.sequence=1}get onError(){return this._onError.event}get onExit(){return this._onExit.event}onMessage(e){this.messageCallback&&this._onError.fire(new Error("attempt to set more than one 'Message' callback")),this.messageCallback=e}onEvent(e){this.eventCallback&&this._onError.fire(new Error("attempt to set more than one 'Event' callback")),this.eventCallback=e}onRequest(e){this.requestCallback&&this._onError.fire(new Error("attempt to set more than one 'Request' callback")),this.requestCallback=e}sendResponse(e){e.seq>0?this._onError.fire(new Error(`attempt to send more than one response for command ${e.command}`)):this.internalSend("response",e)}sendRequest(e,t,i,r){const n={command:e};if(t&&Object.keys(t).length>0&&(n.arguments=t),this.internalSend("request",n),"number"==typeof r){const t=setTimeout((()=>{clearTimeout(t);const i=this.pendingRequests.get(n.seq);if(i){this.pendingRequests.delete(n.seq);i({type:"response",seq:0,request_seq:n.seq,success:!1,command:e,message:(0,s.C$)("vs/workbench/contrib/debug/common/abstractDebugAdapter",0,"Timeout after {0} ms for '{1}'",r,e)})}}),r)}return i&&this.pendingRequests.set(n.seq,i),n.seq}acceptMessage(e){this.messageCallback?this.messageCallback(e):(this.queue.push(e),1===this.queue.length&&this.processQueue())}needsTaskBoundaryBetween(e,t){return"event"!==e.type||"event"!==t.type}async processQueue(){let e;for(;this.queue.length;){if(e&&!this.needsTaskBoundaryBetween(this.queue[0],e)||await(0,n.Vs)(0),e=this.queue.shift(),!e)return;switch(e.type){case"event":this.eventCallback?.(e);break;case"request":this.requestCallback?.(e);break;case"response":{const t=e,i=this.pendingRequests.get(t.request_seq);i&&(this.pendingRequests.delete(t.request_seq),i(t));break}}}}internalSend(e,t){t.type=e,t.seq=this.sequence++,this.sendMessage(t)}async cancelPendingRequests(){if(0===this.pendingRequests.size)return Promise.resolve();const e=new Map;this.pendingRequests.forEach(((t,i)=>e.set(i,t))),await(0,n.Vs)(500),e.forEach(((e,t)=>{e({type:"response",seq:0,request_seq:t,success:!1,command:"canceled",message:"canceled"}),this.pendingRequests.delete(t)}))}getPendingRequestIds(){return Array.from(this.pendingRequests.keys())}dispose(){this.queue=[]}}},17248:function(e,t,i){var r;i.d(t,{W:function(){return r}}),function(e){e[e.Output=1]="Output",e[e.OutputItems=2]="OutputItems",e[e.ExecutionState=3]="ExecutionState"}(r||(r={}))},21455:function(e,t,i){i.d(t,{Z:function(){return p}});var r=i(67525),n=i(47635),s=i(82998),o=i(23783),a=i(83101),c=i(81557);const l="vs/workbench/contrib/tasks/common/taskDefinitionRegistry",d={type:"object",additionalProperties:!1,properties:{type:{type:"string",description:(0,r.C$)(l,0,"The actual task type. Please note that types starting with a '$' are reserved for internal usage.")},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:(0,r.C$)(l,1,"Additional properties of the task type"),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:(0,r.C$)(l,2,"Condition which must be true to enable this type of task. Consider using `shellExecutionSupported`, `processExecutionSupported`, and `customExecutionSupported` as appropriate for this task definition. See the [API documentation](https://code.visualstudio.com/api/extension-guides/task-provider#when-clause) for more information."),default:""}}};var u;!function(e){e.from=function(e,t,i){if(!e)return;const o=(0,n.HD)(e.type)?e.type:void 0;if(!o||0===o.length)return void i.error((0,r.C$)(l,3,"The task type configuration is missing the required 'taskType' property"));const c=[];if(Array.isArray(e.required))for(const t of e.required)(0,n.HD)(t)&&c.push(t);return{extensionId:t.value,taskType:o,required:c,properties:e.properties?(0,s.I8)(e.properties):{},when:e.when?a.Ao.deserialize(e.when):void 0}}}(u||(u={}));const h=o.ut.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:(e,t)=>{for(const i of e)i.type&&t.push(`onTaskType:${i.type}`)},jsonSchema:{description:(0,r.C$)(l,4,"Contributes task kinds"),type:"array",items:d}});const p=new class{constructor(){this._onDefinitionsChanged=new c.Q5,this.onDefinitionsChanged=this._onDefinitionsChanged.event,this.taskTypes=Object.create(null),this.readyPromise=new Promise(((e,t)=>{h.setHandler(((t,i)=>{this._schema=void 0;try{for(const e of i.removed){const t=e.value;for(const e of t)this.taskTypes&&e.type&&this.taskTypes[e.type]&&delete this.taskTypes[e.type]}for(const e of i.added){const t=e.value;for(const i of t){const t=u.from(i,e.description.identifier,e.collector);t&&(this.taskTypes[t.taskType]=t)}}(i.removed.length>0||i.added.length>0)&&this._onDefinitionsChanged.fire()}catch(e){}e(void 0)}))}))}onReady(){return this.readyPromise}get(e){return this.taskTypes[e]}all(){return Object.keys(this.taskTypes).map((e=>this.taskTypes[e]))}getJsonSchema(){if(void 0===this._schema){const e=[];for(const t of this.all()){const i={type:"object",additionalProperties:!1};t.required.length>0&&(i.required=t.required.slice(0)),void 0!==t.properties?i.properties=(0,s.I8)(t.properties):i.properties=Object.create(null),i.properties.type={type:"string",enum:[t.taskType]},e.push(i)}this._schema={oneOf:e}}return this._schema}}},45675:function(e,t,i){i.d(t,{u:function(){return r}});class r{static fromExtHostTestItem(e,t,i=e.parent){if(e._isRoot)return new r([t]);const n=[e.id];for(let e=i;e&&e.id!==t;e=e.parent)n.push(e.id);return n.push(t),new r(n.reverse())}static isRoot(e){return!e.includes("\0")}static root(e){const t=e.indexOf("\0");return-1===t?e:e.slice(0,t)}static fromString(e){return new r(e.split("\0"))}static join(e,t){return new r([...e.path,t])}static joinToString(e,t){return e.toString()+"\0"+t}static parentId(e){const t=e.lastIndexOf("\0");return-1===t?void 0:e.slice(0,t)}static localId(e){const t=e.lastIndexOf("\0");return-1===t?e:e.slice(t+1)}static isChild(e,t){return t.startsWith(e)&&"\0"===t[e.length]}static compare(e,t){return e===t?0:r.isChild(e,t)?2:r.isChild(t,e)?3:1}constructor(e,t=e.length){if(this.path=e,this.viewEnd=t,0===e.length||t<1)throw new Error("cannot create test with empty path")}get rootId(){return new r(this.path,1)}get parentId(){return this.viewEnd>1?new r(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return 1===this.viewEnd}*idsFromRoot(){for(let e=1;e<=this.viewEnd;e++)yield new r(this.path,e)}*idsToRoot(){for(let e=this.viewEnd;e>0;e--)yield new r(this.path,e)}compare(e){if("string"==typeof e)return r.compare(this.toString(),e);for(let t=0;t<e.viewEnd&&t<this.viewEnd;t++)if(e.path[t]!==this.path[t])return 1;return e.viewEnd>this.viewEnd?2:e.viewEnd<this.viewEnd?3:0}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let e=1;e<this.viewEnd;e++)this.stringifed+="\0",this.stringifed+=this.path[e]}return this.stringifed}}},44383:function(e,t,i){i.d(t,{$z:function(){return h},Hx:function(){return g},Mh:function(){return m}});var r=i(35820),n=i(81557),s=i(7428),o=i(23088),a=i(33089),c=i(45675);const l=(e,t)=>e===t,d={range:(e,t)=>e===t||!(!e||!t)&&e.equalsRange(t),busy:l,label:l,description:l,error:l,sortText:l,tags:(e,t)=>e.length===t.length&&!e.some((e=>!t.includes(e)))},u=Object.entries(d);class h extends s.JT{get root(){return this.options.root}constructor(e){super(),this.options=e,this.debounceSendDiff=this._register(new r.pY((()=>this.flushDiff()),200)),this.diffOpEmitter=this._register(new n.Q5),this.tree=new Map,this.tags=new Map,this.diff=[],this.onDidGenerateDiff=this.diffOpEmitter.event,this.root.canResolveChildren=!0,this.upsertItem(this.root,void 0)}set resolveHandler(e){this._resolveHandler=e;for(const e of this.tree.values())this.updateExpandability(e)}get resolveHandler(){return this._resolveHandler}collectDiff(){const e=this.diff;return this.diff=[],e}pushDiff(e){switch(e.op){case 2:for(const t of this.diff)if(2===t.op&&t.uri===e.uri)return void(t.docv=e.docv);break;case 1:{const t=this.diff[this.diff.length-1];if(t){if(1===t.op&&t.item.extId===e.item.extId)return void(0,a.Gn)(t.item,e.item);if(0===t.op&&t.item.item.extId===e.item.extId)return void(0,a.Gn)(t.item,e.item)}break}}this.diff.push(e),this.debounceSendDiff.isScheduled()||this.debounceSendDiff.schedule()}expand(e,t){const i=this.tree.get(e);if(i){if((void 0===i.expandLevels||t>i.expandLevels)&&(i.expandLevels=t),1===i.expand){const e=this.resolveChildren(i);return e.isOpen()?this.expandChildren(i,t-1):e.wait().then((()=>this.expandChildren(i,t-1)))}return 3===i.expand?!1===i.resolveBarrier?.isOpen()?i.resolveBarrier.wait().then((()=>this.expandChildren(i,t-1))):this.expandChildren(i,t-1):void 0}}dispose(){for(const e of this.tree.values())this.options.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.diff=[],super.dispose()}onTestItemEvent(e,t){switch(t.op){case 3:this.removeItem(c.u.joinToString(e.fullId,t.id));break;case 0:this.upsertItem(t.item,e);break;case 5:for(const i of t.ops)this.onTestItemEvent(e,i);break;case 1:this.diffTagRefs(t.new,t.old,e.fullId.toString());break;case 2:this.updateExpandability(e);break;case 4:this.pushDiff({op:1,item:{extId:e.fullId.toString(),item:t.update}});break;case 6:this.documentSynced(e.actual.uri);break;default:(0,o.vE)()}}documentSynced(e){e&&this.pushDiff({op:2,uri:e,docv:this.options.getDocumentVersion(e)})}upsertItem(e,t){const i=c.u.fromExtHostTestItem(e,this.root.id,t?.actual),r=this.options.getApiFor(e);r.parent&&r.parent!==t?.actual&&this.options.getChildren(r.parent).delete(e.id);let n=this.tree.get(i.toString());if(!n)return n={fullId:i,actual:e,expandLevels:t?.expandLevels?t.expandLevels-1:void 0,expand:0},e.tags.forEach(this.incrementTagRefs,this),this.tree.set(n.fullId.toString(),n),this.setItemParent(e,t),this.pushDiff({op:0,item:{controllerId:this.options.controllerId,expand:n.expand,item:this.options.toITestItem(e)}}),void this.connectItemAndChildren(e,n,t);if(n.actual===e)return void this.connectItem(e,n,t);if(n.actual.uri?.toString()!==e.uri?.toString())return this.removeItem(i.toString()),this.upsertItem(e,t);const s=this.options.getChildren(n.actual),o=n.actual,a=((e,t)=>{let i;for(const[r,n]of u)n(e[r],t[r])||(i?i[r]=t[r]:i={[r]:t[r]});return i})(this.options.toITestItem(o),this.options.toITestItem(e));this.options.getApiFor(o).listener=void 0,n.actual=e,n.resolveBarrier=void 0,n.expand=0,a&&(a.hasOwnProperty("tags")&&(this.diffTagRefs(e.tags,o.tags,i.toString()),delete a.tags),this.onTestItemEvent(n,{op:4,update:a})),this.connectItemAndChildren(e,n,t);for(const[t,r]of s)this.options.getChildren(e).get(r.id)||this.removeItem(c.u.joinToString(i,r.id));const l=n.expandLevels;void 0!==l&&queueMicrotask((()=>{1===n.expand&&(n.expandLevels=void 0,this.expand(i.toString(),l))})),this.documentSynced(n.actual.uri)}diffTagRefs(e,t,i){const r=new Set(t.map((e=>e.id)));for(const t of e)r.delete(t.id)||this.incrementTagRefs(t);this.pushDiff({op:1,item:{extId:i,item:{tags:e.map((e=>(0,a.B2)(this.options.controllerId,e.id)))}}}),r.forEach(this.decrementTagRefs,this)}incrementTagRefs(e){const t=this.tags.get(e.id);t?t.refCount++:(this.tags.set(e.id,{refCount:1}),this.pushDiff({op:6,tag:{id:(0,a.B2)(this.options.controllerId,e.id)}}))}decrementTagRefs(e){const t=this.tags.get(e);t&&! --t.refCount&&(this.tags.delete(e),this.pushDiff({op:7,id:(0,a.B2)(this.options.controllerId,e)}))}setItemParent(e,t){this.options.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}connectItem(e,t,i){this.setItemParent(e,i);const r=this.options.getApiFor(e);r.parent=i?.actual,r.listener=e=>this.onTestItemEvent(t,e),this.updateExpandability(t)}connectItemAndChildren(e,t,i){this.connectItem(e,t,i);for(const[i,r]of this.options.getChildren(e))this.upsertItem(r,t)}updateExpandability(e){let t;t=this._resolveHandler?e.resolveBarrier?e.resolveBarrier.isOpen()?3:2:e.actual.canResolveChildren?1:0:0,t!==e.expand&&(e.expand=t,this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:t}}),1===t&&void 0!==e.expandLevels&&this.resolveChildren(e))}expandChildren(e,t){if(t<0)return;const i=[];for(const[n,s]of this.options.getChildren(e.actual)){const n=this.expand(c.u.joinToString(e.fullId,s.id),t);(0,r.J8)(n)&&i.push(n)}return i.length?Promise.all(i).then((()=>{})):void 0}resolveChildren(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this._resolveHandler){const e=new r.U8;return e.open(),e}e.expand=2,this.pushExpandStateUpdate(e);const t=e.resolveBarrier=new r.U8,i=e=>{console.error(`Unhandled error in resolveHandler of test controller "${this.options.controllerId}"`,e)};let n;try{n=this._resolveHandler(e.actual===this.root?void 0:e.actual)}catch(e){i(e)}return(0,r.J8)(n)?n.catch(i).then((()=>{t.open(),this.updateExpandability(e)})):(t.open(),this.updateExpandability(e)),e.resolveBarrier}pushExpandStateUpdate(e){this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:e.expand}})}removeItem(e){const t=this.tree.get(e);if(!t)throw new Error("attempting to remove non-existent child");this.pushDiff({op:3,itemId:e});const i=[t];for(;i.length;){const e=i.pop();if(e){this.options.getApiFor(e.actual).listener=void 0;for(const t of e.actual.tags)this.decrementTagRefs(t.id);this.tree.delete(e.fullId.toString());for(const[t,r]of this.options.getChildren(e.actual))i.push(this.tree.get(c.u.joinToString(e.fullId,r.id)))}}}flushDiff(){const e=this.collectDiff();e.length&&this.diffOpEmitter.fire(e)}}class p extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}}class m extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}}class f extends Error{constructor(e,t,i){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${i}".`)}}const g=(e,t,i)=>{let r=new Map;return{get size(){return r.size},forEach(e,t){for(const i of r.values())e.call(t,i,this)},[Symbol.iterator](){return r.entries()},replace(n){const s=new Map,o=new Set(r.keys()),a={op:5,ops:[]};for(const r of n){if(!(r instanceof i))throw new m(r.id);const n=t(r).controllerId;if(n!==e.controllerId)throw new f(r.id,n,e.controllerId);if(s.has(r.id))throw new p(r.id);s.set(r.id,r),o.delete(r.id),a.ops.push({op:0,item:r})}for(const e of o.keys())a.ops.push({op:3,id:e});e.listener?.(a),r=s},add(t){if(!(t instanceof i))throw new m(t.id);r.set(t.id,t),e.listener?.({op:0,item:t})},delete(t){r.delete(t)&&e.listener?.({op:3,id:t})},get(e){return r.get(e)},toJSON(){return Array.from(r.values())}}}},22837:function(e,t,i){i.d(t,{b:function(){return r}});const r="__"},14879:function(e,t,i){i.d(t,{D$:function(){return r},RR:function(){return o},WQ:function(){return s}});var r,n=i(53976);function s(e){const t=n.KN.alloc(1);switch(e){case 0:t.writeUInt8(1,0);break;case 1:t.writeUInt8(2,0);break;case 2:t.writeUInt8(3,0)}return t}function o(e,t){if(1!==e.byteLength)return!1;switch(e.readUInt8(0)){case 1:return 0===t;case 2:return 1===t;case 3:return 2===t;default:return!1}}!function(e){e[e.Desktop=1]="Desktop",e[e.Web=2]="Web"}(r||(r={}))},19810:function(e,t,i){i.d(t,{m:function(){return r}});const r=Object.freeze({activeComment:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts",aiRelatedInformation:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts",aiTextSearchProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts",authGetSessions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authGetSessions.d.ts",authLearnMore:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts",authSession:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts",canonicalUriProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts",chatParticipant:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipant.d.ts",chatParticipantAdditions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts",chatProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts",chatTab:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts",chatVariableResolver:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatVariableResolver.d.ts",codeActionAI:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts",codeActionRanges:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts",codiconDecoration:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts",commentReactor:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts",commentThreadApplicability:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts",commentingRangeHint:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts",commentsDraftState:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts",contribAccessibilityHelpContent:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts",contribCommentEditorActionsMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts",contribCommentPeekContext:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts",contribCommentThreadAdditionalMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts",contribCommentsViewThreadMenus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts",contribDiffEditorGutterToolBarMenus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts",contribEditSessions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts",contribEditorContentMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts",contribIssueReporter:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribIssueReporter.d.ts",contribLabelFormatterWorkspaceTooltip:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts",contribMenuBarHome:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts",contribMergeEditorMenus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts",contribMultiDiffEditorMenus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts",contribNotebookStaticPreloads:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts",contribRemoteHelp:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts",contribShareMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts",contribSourceControlHistoryItemGroupMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemGroupMenu.d.ts",contribSourceControlHistoryItemMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts",contribSourceControlInputBoxMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts",contribSourceControlTitleMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts",contribStatusBarItems:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts",contribViewsRemote:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts",contribViewsWelcome:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts",createFileSystemWatcher:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.createFileSystemWatcher.d.ts",customEditorMove:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts",debugFocus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugFocus.d.ts",debugVisualization:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts",defaultChatParticipant:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts",diffCommand:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts",diffContentOptions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts",documentFiltersExclusive:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts",documentPaste:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentPaste.d.ts",editSessionIdentityProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts",editorHoverVerbosityLevel:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts",editorInsets:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts",extensionRuntime:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts",extensionsAny:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts",externalUriOpener:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts",fileComments:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileComments.d.ts",fileSearchProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts",findFiles2:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts",findTextInFiles:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts",fsChunks:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts",idToken:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts",inlineCompletionsAdditions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts",inlineEdit:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts",interactive:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts",interactiveWindow:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts",ipc:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts",languageModels:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModels.d.ts",languageStatusText:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts",mappedEditsProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts",multiDocumentHighlightProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts",newSymbolNamesProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts",notebookCellExecution:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts",notebookCellExecutionState:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts",notebookControllerAffinityHidden:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts",notebookDeprecated:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts",notebookExecution:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts",notebookKernelSource:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts",notebookLiveShare:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts",notebookMessaging:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts",notebookMime:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts",notebookVariableProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts",portsAttributes:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts",profileContentHandlers:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts",quickDiffProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts",quickPickItemTooltip:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts",quickPickSortByLabel:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts",resolvers:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts",scmActionButton:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts",scmHistoryProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts",scmMultiDiffEditor:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts",scmSelectedProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts",scmTextDocument:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts",scmValidation:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts",shareProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts",showLocal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.showLocal.d.ts",speech:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts",tabInputMultiDiff:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts",tabInputTextMerge:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts",taskPresentationGroup:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts",telemetry:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts",terminalDataWriteEvent:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts",terminalDimensions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts",terminalExecuteCommandEvent:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts",terminalQuickFixProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts",terminalSelection:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts",terminalShellIntegration:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellIntegration.d.ts",testObserver:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts",testPreserveFocus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testPreserveFocus.d.ts",textSearchProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts",timeline:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts",tokenInformation:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts",treeViewActiveItem:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts",treeViewMarkdownMessage:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts",treeViewReveal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts",tunnelFactory:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts",tunnels:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts",workspaceTrust:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"})},92962:function(e,t,i){i.d(t,{CU:function(){return s},IB:function(){return o},ky:function(){return a},uv:function(){return r}});class r{static{this.count=0}constructor(e){this._proxyIdentifierBrand=void 0,this.sid=e,this.nid=++r.count}}const n=[];function s(e){const t=new r(e);return n[t.nid]=t,t}function o(e){return n[e].sid}class a{constructor(e){this.value=e}}},17315:function(e,t,i){i.d(t,{Ui:function(){return E}});var r=i(35820),n=i(53976),s=i(17126),o=i(54316),a=i(81557),c=i(7428),l=i(42731);new class{transformIncoming(e){return e}transformOutgoing(e){return e}transformOutgoingURI(e){return e}transformOutgoingScheme(e){return e}};function d(e,t,i,r){if(!e||r>200)return null;if("object"==typeof e){if(1===e.$mid)return i?l.ov.revive(t.transformIncoming(e)):t.transformIncoming(e);if(e instanceof n.KN)return null;for(const n in e)if(Object.hasOwnProperty.call(e,n)){const s=d(e[n],t,i,r+1);null!==s&&(e[n]=s)}}return null}function u(e,t){const i=d(e,t,!1,0);return null===i?e:i}class h{constructor(){this._actual=null,this._actualOk=null,this._actualErr=null,this._hasValue=!1,this._value=null,this._hasErr=!1,this._err=null}get[Symbol.toStringTag](){return this.toString()}_ensureActual(){return this._actual||(this._actual=new Promise(((e,t)=>{this._actualOk=e,this._actualErr=t,this._hasValue&&this._actualOk(this._value),this._hasErr&&this._actualErr(this._err)}))),this._actual}resolveOk(e){this._hasValue||this._hasErr||(this._hasValue=!0,this._value=e,this._actual&&this._actualOk(e))}resolveErr(e){this._hasValue||this._hasErr||(this._hasErr=!0,this._err=e,this._actual?this._actualErr(e):(0,o.dL)(e))}then(e,t){return this._ensureActual().then(e,t)}catch(e){return this._ensureActual().then(void 0,e)}finally(e){return this._ensureActual().finally(e)}}class p extends h{constructor(){super(),this._hasErr=!0,this._err=new o.FU}}var m,f=i(92962);function g(e,t){try{return JSON.stringify(e,t)}catch(e){return"null"}}const v="$$ref$$",_={[v]:-1};function b(e,t=null,i=!1){const r=[];return{jsonString:(i?g:JSON.stringify)(e,((e,i)=>{if(void 0===i)return _;if("object"==typeof i){if(i instanceof n.KN){const e=r.push(i)-1;return{[v]:e}}if(t)return t(e,i)}return i})),referencedBuffers:r}}function w(e,t,i){return JSON.parse(e,((e,r)=>{if(r){const e=r[v];if("number"==typeof e)return t[e];if(i&&1===r.$mid)return i.transformIncoming(r)}return r}))}function y(e,t){return JSON.stringify(e,t)}const x=()=>{},C=Symbol.for("rpcProtocol"),S=Symbol.for("rpcProxy");class E extends c.JT{static{m=C}static{this.UNRESPONSIVE_TIME=3e3}constructor(e,t=null,i=null){super(),this[m]=!0,this._onDidChangeResponsiveState=this._register(new a.Q5),this.onDidChangeResponsiveState=this._onDidChangeResponsiveState.event,this._protocol=e,this._logger=t,this._uriTransformer=i,this._uriReplacer=function(e){return e?(t,i)=>i&&1===i.$mid?e.transformOutgoing(i):i:null}(this._uriTransformer),this._isDisposed=!1,this._locals=[],this._proxies=[];for(let e=0,t=f.uv.count;e<t;e++)this._locals[e]=null,this._proxies[e]=null;this._lastMessageId=0,this._cancelInvokedHandlers=Object.create(null),this._pendingRPCReplies={},this._responsiveState=0,this._unacknowledgedCount=0,this._unresponsiveTime=0,this._asyncCheckUresponsive=this._register(new r.pY((()=>this._checkUnresponsive()),1e3)),this._protocol.onMessage((e=>this._receiveOneMessage(e)))}dispose(){this._isDisposed=!0,Object.keys(this._pendingRPCReplies).forEach((e=>{const t=this._pendingRPCReplies[e];delete this._pendingRPCReplies[e],t.resolveErr((0,o.F0)())})),super.dispose()}drain(){return"function"==typeof this._protocol.drain?this._protocol.drain():Promise.resolve()}_onWillSendRequest(e){0===this._unacknowledgedCount&&(this._unresponsiveTime=Date.now()+E.UNRESPONSIVE_TIME),this._unacknowledgedCount++,this._asyncCheckUresponsive.isScheduled()||this._asyncCheckUresponsive.schedule()}_onDidReceiveAcknowledge(e){this._unresponsiveTime=Date.now()+E.UNRESPONSIVE_TIME,this._unacknowledgedCount--,0===this._unacknowledgedCount&&this._asyncCheckUresponsive.cancel(),this._setResponsiveState(0)}_checkUnresponsive(){0!==this._unacknowledgedCount&&(Date.now()>this._unresponsiveTime?this._setResponsiveState(1):this._asyncCheckUresponsive.schedule())}_setResponsiveState(e){this._responsiveState!==e&&(this._responsiveState=e,this._onDidChangeResponsiveState.fire(this._responsiveState))}get responsiveState(){return this._responsiveState}transformIncomingURIs(e){return this._uriTransformer?u(e,this._uriTransformer):e}getProxy(e){const{nid:t,sid:i}=e;return this._proxies[t]||(this._proxies[t]=this._createProxy(t,i)),this._proxies[t]}_createProxy(e,t){const i={get:(i,r)=>("string"!=typeof r||i[r]||36!==r.charCodeAt(0)||(i[r]=(...t)=>this._remoteCall(e,r,t)),r===S?t:i[r])};return new Proxy(Object.create(null),i)}set(e,t){return this._locals[e.nid]=t,t}assertRegistered(e){for(let t=0,i=e.length;t<i;t++){const i=e[t];if(!this._locals[i.nid])throw new Error(`Missing proxy instance ${i.sid}`)}}_receiveOneMessage(e){if(this._isDisposed)return;const t=e.byteLength,i=k.read(e,0),r=i.readUInt8(),n=i.readUInt32();switch(r){case 1:case 2:{let{rpcId:e,method:s,args:o}=I.deserializeRequestJSONArgs(i);this._uriTransformer&&(o=u(o,this._uriTransformer)),this._receiveRequest(t,n,e,s,o,2===r);break}case 3:case 4:{let{rpcId:e,method:s,args:o}=I.deserializeRequestMixedArgs(i);this._uriTransformer&&(o=u(o,this._uriTransformer)),this._receiveRequest(t,n,e,s,o,4===r);break}case 5:this._logger?.logIncoming(t,n,0,"ack"),this._onDidReceiveAcknowledge(n);break;case 6:this._receiveCancel(t,n);break;case 7:this._receiveReply(t,n,void 0);break;case 9:{let e=I.deserializeReplyOKJSON(i);this._uriTransformer&&(e=u(e,this._uriTransformer)),this._receiveReply(t,n,e);break}case 10:{const e=I.deserializeReplyOKJSONWithBuffers(i,this._uriTransformer);this._receiveReply(t,n,e);break}case 8:{const e=I.deserializeReplyOKVSBuffer(i);this._receiveReply(t,n,e);break}case 11:{let e=I.deserializeReplyErrError(i);this._uriTransformer&&(e=u(e,this._uriTransformer)),this._receiveReplyErr(t,n,e);break}case 12:this._receiveReplyErr(t,n,void 0);break;default:console.error("received unexpected message"),console.error(e)}}_receiveRequest(e,t,i,r,n,o){this._logger?.logIncoming(e,t,1,`receiveRequest ${(0,f.IB)(i)}.${r}(`,n);const a=String(t);let c,l;if(o){const e=new s.AU;n.push(e.token),c=this._invokeHandler(i,r,n),l=()=>e.cancel()}else c=this._invokeHandler(i,r,n),l=x;this._cancelInvokedHandlers[a]=l;const d=I.serializeAcknowledged(t);this._logger?.logOutgoing(d.byteLength,t,1,"ack"),this._protocol.send(d),c.then((e=>{delete this._cancelInvokedHandlers[a];const i=I.serializeReplyOK(t,e,this._uriReplacer);this._logger?.logOutgoing(i.byteLength,t,1,"reply:",e),this._protocol.send(i)}),(e=>{delete this._cancelInvokedHandlers[a];const i=I.serializeReplyErr(t,e);this._logger?.logOutgoing(i.byteLength,t,1,"replyErr:",e),this._protocol.send(i)}))}_receiveCancel(e,t){this._logger?.logIncoming(e,t,1,"receiveCancel");const i=String(t);this._cancelInvokedHandlers[i]?.()}_receiveReply(e,t,i){this._logger?.logIncoming(e,t,0,"receiveReply:",i);const r=String(t);if(!this._pendingRPCReplies.hasOwnProperty(r))return;const n=this._pendingRPCReplies[r];delete this._pendingRPCReplies[r],n.resolveOk(i)}_receiveReplyErr(e,t,i){this._logger?.logIncoming(e,t,0,"receiveReplyErr:",i);const r=String(t);if(!this._pendingRPCReplies.hasOwnProperty(r))return;const n=this._pendingRPCReplies[r];let s;delete this._pendingRPCReplies[r],i&&(i.$isError?(s=new Error,s.name=i.name,s.message=i.message,s.stack=i.stack):s=i),n.resolveErr(s)}_invokeHandler(e,t,i){try{return Promise.resolve(this._doInvokeHandler(e,t,i))}catch(e){return Promise.reject(e)}}_doInvokeHandler(e,t,i){const r=this._locals[e];if(!r)throw new Error("Unknown actor "+(0,f.IB)(e));const n=r[t];if("function"!=typeof n)throw new Error("Unknown method "+t+" on actor "+(0,f.IB)(e));return n.apply(r,i)}_remoteCall(e,t,i){if(this._isDisposed)return new p;let r=null;if(i.length>0&&s.Ts.isCancellationToken(i[i.length-1])&&(r=i.pop()),r&&r.isCancellationRequested)return Promise.reject((0,o.F0)());const n=I.serializeRequestArguments(i,this._uriReplacer),a=++this._lastMessageId,l=String(a),d=new h,u=new c.SL;r&&u.add(r.onCancellationRequested((()=>{const e=I.serializeCancel(a);this._logger?.logOutgoing(e.byteLength,a,0,"cancel"),this._protocol.send(I.serializeCancel(a))}))),this._pendingRPCReplies[l]=new D(d,u),this._onWillSendRequest(a);const m=I.serializeRequest(a,e,t,n,!!r);return this._logger?.logOutgoing(m.byteLength,a,0,`request: ${(0,f.IB)(e)}.${t}(`,i),this._protocol.send(m),d}}class D{constructor(e,t){this._promise=e,this._disposable=t}resolveOk(e){this._promise.resolveOk(e),this._disposable.dispose()}resolveErr(e){this._promise.resolveErr(e),this._disposable.dispose()}}class k{static alloc(e,t,i){const r=new k(n.KN.alloc(i+1+4),0);return r.writeUInt8(e),r.writeUInt32(t),r}static read(e,t){return new k(e,t)}get buffer(){return this._buff}constructor(e,t){this._buff=e,this._offset=t}static sizeUInt8(){return 1}static{this.sizeUInt32=4}writeUInt8(e){this._buff.writeUInt8(e,this._offset),this._offset+=1}readUInt8(){const e=this._buff.readUInt8(this._offset);return this._offset+=1,e}writeUInt32(e){this._buff.writeUInt32BE(e,this._offset),this._offset+=4}readUInt32(){const e=this._buff.readUInt32BE(this._offset);return this._offset+=4,e}static sizeShortString(e){return 1+e.byteLength}writeShortString(e){this._buff.writeUInt8(e.byteLength,this._offset),this._offset+=1,this._buff.set(e,this._offset),this._offset+=e.byteLength}readShortString(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const t=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,t}static sizeLongString(e){return 4+e.byteLength}writeLongString(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readLongString(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const t=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,t}writeBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}static sizeVSBuffer(e){return 4+e.byteLength}writeVSBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readVSBuffer(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const t=this._buff.slice(this._offset,this._offset+e);return this._offset+=e,t}static sizeMixedArray(e){let t=0;t+=1;for(let i=0,r=e.length;i<r;i++){const r=e[i];switch(t+=1,r.type){case 1:t+=this.sizeLongString(r.value);break;case 2:t+=this.sizeVSBuffer(r.value);break;case 3:t+=this.sizeUInt32,t+=this.sizeLongString(r.value);for(let e=0;e<r.buffers.length;++e)t+=this.sizeVSBuffer(r.buffers[e])}}return t}writeMixedArray(e){this._buff.writeUInt8(e.length,this._offset),this._offset+=1;for(let t=0,i=e.length;t<i;t++){const i=e[t];switch(i.type){case 1:this.writeUInt8(1),this.writeLongString(i.value);break;case 2:this.writeUInt8(2),this.writeVSBuffer(i.value);break;case 3:this.writeUInt8(3),this.writeUInt32(i.buffers.length),this.writeLongString(i.value);for(let e=0;e<i.buffers.length;++e)this.writeBuffer(i.buffers[e]);break;case 4:this.writeUInt8(4)}}}readMixedArray(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const t=new Array(e);for(let i=0;i<e;i++){switch(this.readUInt8()){case 1:t[i]=this.readLongString();break;case 2:t[i]=this.readVSBuffer();break;case 3:{const e=this.readUInt32(),r=this.readLongString(),n=[];for(let t=0;t<e;++t)n.push(this.readVSBuffer());t[i]=new f.ky(w(r,n,null));break}case 4:t[i]=void 0}}return t}}class I{static _useMixedArgSerialization(e){for(let t=0,i=e.length;t<i;t++){if(e[t]instanceof n.KN)return!0;if(e[t]instanceof f.ky)return!0;if(void 0===e[t])return!0}return!1}static serializeRequestArguments(e,t){if(this._useMixedArgSerialization(e)){const i=[];for(let r=0,s=e.length;r<s;r++){const s=e[r];if(s instanceof n.KN)i[r]={type:2,value:s};else if(void 0===s)i[r]={type:4};else if(s instanceof f.ky){const{jsonString:e,referencedBuffers:o}=b(s.value,t);i[r]={type:3,value:n.KN.fromString(e),buffers:o}}else i[r]={type:1,value:n.KN.fromString(y(s,t))}}return{type:1,args:i}}return{type:0,args:y(e,t)}}static serializeRequest(e,t,i,r,n){switch(r.type){case 0:return this._requestJSONArgs(e,t,i,r.args,n);case 1:return this._requestMixedArgs(e,t,i,r.args,n)}}static _requestJSONArgs(e,t,i,r,s){const o=n.KN.fromString(i),a=n.KN.fromString(r);let c=0;c+=k.sizeUInt8(),c+=k.sizeShortString(o),c+=k.sizeLongString(a);const l=k.alloc(s?2:1,e,c);return l.writeUInt8(t),l.writeShortString(o),l.writeLongString(a),l.buffer}static deserializeRequestJSONArgs(e){const t=e.readUInt8(),i=e.readShortString(),r=e.readLongString();return{rpcId:t,method:i,args:JSON.parse(r)}}static _requestMixedArgs(e,t,i,r,s){const o=n.KN.fromString(i);let a=0;a+=k.sizeUInt8(),a+=k.sizeShortString(o),a+=k.sizeMixedArray(r);const c=k.alloc(s?4:3,e,a);return c.writeUInt8(t),c.writeShortString(o),c.writeMixedArray(r),c.buffer}static deserializeRequestMixedArgs(e){const t=e.readUInt8(),i=e.readShortString(),r=e.readMixedArray(),n=new Array(r.length);for(let e=0,t=r.length;e<t;e++){const t=r[e];n[e]="string"==typeof t?JSON.parse(t):t}return{rpcId:t,method:i,args:n}}static serializeAcknowledged(e){return k.alloc(5,e,0).buffer}static serializeCancel(e){return k.alloc(6,e,0).buffer}static serializeReplyOK(e,t,i){if(void 0===t)return this._serializeReplyOKEmpty(e);if(t instanceof n.KN)return this._serializeReplyOKVSBuffer(e,t);if(t instanceof f.ky){const{jsonString:r,referencedBuffers:n}=b(t.value,i,!0);return this._serializeReplyOKJSONWithBuffers(e,r,n)}return this._serializeReplyOKJSON(e,g(t,i))}static _serializeReplyOKEmpty(e){return k.alloc(7,e,0).buffer}static _serializeReplyOKVSBuffer(e,t){let i=0;i+=k.sizeVSBuffer(t);const r=k.alloc(8,e,i);return r.writeVSBuffer(t),r.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static _serializeReplyOKJSON(e,t){const i=n.KN.fromString(t);let r=0;r+=k.sizeLongString(i);const s=k.alloc(9,e,r);return s.writeLongString(i),s.buffer}static _serializeReplyOKJSONWithBuffers(e,t,i){const r=n.KN.fromString(t);let s=0;s+=k.sizeUInt32,s+=k.sizeLongString(r);for(const e of i)s+=k.sizeVSBuffer(e);const o=k.alloc(10,e,s);o.writeUInt32(i.length),o.writeLongString(r);for(const e of i)o.writeBuffer(e);return o.buffer}static deserializeReplyOKJSON(e){const t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){const i=e.readUInt32(),r=e.readLongString(),n=[];for(let t=0;t<i;++t)n.push(e.readVSBuffer());return new f.ky(w(r,n,t))}static serializeReplyErr(e,t){const i=t?g((0,o.ri)(t),null):void 0;if("string"!=typeof i)return this._serializeReplyErrEmpty(e);const r=n.KN.fromString(i);let s=0;s+=k.sizeLongString(r);const a=k.alloc(11,e,s);return a.writeLongString(r),a.buffer}static deserializeReplyErrError(e){const t=e.readLongString();return JSON.parse(t)}static _serializeReplyErrEmpty(e){return k.alloc(12,e,0).buffer}}},83464:function(e,t,i){i.d(t,{Qc:function(){return c},R_:function(){return l}});var r=i(53976),n=(i(18910),i(59301));i(28019);const s=["W","X","Y","Z","a","b","c","d","e","f"],o=new RegExp(`^[${s.join("")}]+`),a=7;function c(e){if(e.scheme!==n.lg.vscodeNotebookCell)return;const t=e.fragment.indexOf("s");if(t<0)return;const i=parseInt(e.fragment.substring(0,t).replace(o,""),a),s=(0,r.NV)(e.fragment.substring(t+1)).toString();return isNaN(i)?void 0:{handle:i,notebook:e.with({scheme:s,fragment:null})}}function l(e,t){const i=t.toString(a),o=`${i.length<s.length?s[i.length-1]:"z"}${i}s${(0,r.oF)(r.KN.fromString(e.scheme),!0,!0)}`;return e.with({scheme:n.lg.vscodeNotebookCell,fragment:o})}},45630:function(e,t,i){i.d(t,{$C:function(){return f},Aw:function(){return h},fV:function(){return _},k5:function(){return u},tQ:function(){return g},tZ:function(){return w},u2:function(){return b},x2:function(){return y}});var r=i(78074),n=i(22200),s=i(82998),o=i(24363),a=i(88023),c=i(15229),l=(i(54316),i(97258),i(35820));const d=" characters skipped ⟫";function u(e){return!!e.preview}class h{constructor(e,t,i,n){this.ranges=t,this.webviewIndex=n;const s=Array.isArray(t)?t:[t];if(i&&1===i.matchLines&&function(e){const t=e[0].startLineNumber;for(const i of e)if(i.startLineNumber!==t||i.endLineNumber!==t)return!1;return!0}(s)){e=(0,a.En)(e,i.matchLines);let t="",r=0,n=0;const o=Math.floor(i.charsPerLine/5),c=[];for(const a of s){const s=Math.max(a.startColumn-o,0),l=a.startColumn+i.charsPerLine;if(s>n+o+56){const i="⟪ "+(s-n)+d;t+=i+e.slice(s,l),r+=s-(n+i.length)}else t+=e.slice(n,l);c.push(new m(0,a.startColumn-r,a.endColumn-r)),n=l}this.preview={text:t,matches:Array.isArray(this.ranges)?c:c[0]}}else{const i=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber;this.preview={text:e,matches:(0,r.Gb)(t,(e=>new p(e.startLineNumber-i,e.startColumn,e.endLineNumber-i,e.endColumn)))}}}}class p{constructor(e,t,i,r){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=r}}class m extends p{constructor(e,t,i){super(e,t,e,i)}}function f(e,t=!0){const i=e&&e.files&&e.files.exclude,r=t&&e&&e.search&&e.search.exclude;if(!i&&!r)return;if(!i||!r)return i||r;let n=Object.create(null);return n=(0,s.jB)(n,(0,s.I8)(i)),n=(0,s.jB)(n,(0,s.I8)(r),!0),n}function g(e,t){return(!e.excludePattern||!(0,n.EQ)(e.excludePattern,t))&&(!e.includePattern&&!e.usingSearchPaths||(!(!e.includePattern||!(0,n.EQ)(e.includePattern,t))||!!e.usingSearchPaths&&(!!e.folderQueries&&e.folderQueries.some((e=>{const i=e.folder.fsPath;if((0,o.KM)(t,i)){const r=(0,c.Gf)(i,t);return!e.includePattern||!!(0,n.EQ)(e.includePattern,r)}return!1})))))}var v;!function(e){e[e.unknownEncoding=1]="unknownEncoding",e[e.regexParseError=2]="regexParseError",e[e.globParseError=3]="globParseError",e[e.invalidLiteral=4]="invalidLiteral",e[e.rgProcessError=5]="rgProcessError",e[e.other=6]="other",e[e.canceled=7]="canceled"}(v||(v={}));Error;function _(e,t){const i={...e||{},...t||{}};return Object.keys(i).filter((e=>{const t=i[e];return"boolean"==typeof t&&t}))}class b{constructor(e,t){this._parsedIncludeExpression=null,this._excludeExpression={...e.excludePattern||{},...t.excludePattern||{}},this._parsedExcludeExpression=(0,n.Qc)(this._excludeExpression);let i=e.includePattern;t.includePattern&&(i=i?{...i,...t.includePattern}:t.includePattern),i&&(this._parsedIncludeExpression=(0,n.Qc)(i))}matchesExcludesSync(e,t,i){return!(!this._parsedExcludeExpression||!this._parsedExcludeExpression(e,t,i))}includedInQuerySync(e,t,i){return(!this._parsedExcludeExpression||!this._parsedExcludeExpression(e,t,i))&&!(this._parsedIncludeExpression&&!this._parsedIncludeExpression(e,t,i))}includedInQuery(e,t,i){const r=this._parsedExcludeExpression(e,t,i),n=()=>!this._parsedIncludeExpression||!!this._parsedIncludeExpression(e,t,i);return(0,l.J8)(r)?r.then((e=>!e&&n())):n()}hasSiblingExcludeClauses(){return function(e){for(const t in e)if("boolean"!=typeof e[t])return!0;return!1}(this._excludeExpression)}}function w(e){if(!e)return;let t;return i=>(t||(t=(e()||Promise.resolve([])).then((e=>e?x(e):{}))),t.then((e=>!!e[i])))}function y(e){if(!e)return;let t;return i=>{if(!t){const i=e();t=i?x(i):{}}return!!t[i]}}function x(e){const t={};for(const i of e)t[i]=!0;return t}},97258:function(e,t,i){var r;i.d(t,{a:function(){return r}}),function(e){e[e.Information=1]="Information",e[e.Warning=2]="Warning"}(r||(r={}))}}]);