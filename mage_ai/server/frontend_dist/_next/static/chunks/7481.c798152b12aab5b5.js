"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7481],{25501:function(t,e,n){n.d(e,{Z:function(){return g}});var r=n(21831),i=n(82394),o=n(82684),u=n(91204),s=n(42034),c=n(5285),l=n(59714),a=class extends c.l{#t;#e=void 0;#n;#r;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,l.VS)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,l.Ym)(e.mutationKey)!==(0,l.Ym)(this.options.mutationKey)?this.reset():"pending"===this.#n?.state.status&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(t){this.#i(),this.#o(t)}getCurrentResult(){return this.#e}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#i(),this.#o()}mutate(t,e){return this.#r=e,this.#n?.removeObserver(this),this.#n=this.#t.getMutationCache().build(this.#t,this.options),this.#n.addObserver(this),this.#n.execute(t)}#i(){const t=this.#n?.state??(0,u.R)();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#o(t){s.V.batch((()=>{if(this.#r&&this.hasListeners()){const e=this.#e.variables,n=this.#e.context;"success"===t?.type?(this.#r.onSuccess?.(t.data,e,n),this.#r.onSettled?.(t.data,null,e,n)):"error"===t?.type&&(this.#r.onError?.(t.error,e,n),this.#r.onSettled?.(void 0,t.error,e,n))}this.listeners.forEach((t=>{t(this.#e)}))}))}},d=n(30210);function p(){}function v(t,e){const n=(0,d.NL)(e),[r]=o.useState((()=>new a(n,t)));o.useEffect((()=>{r.setOptions(t)}),[r,t]);const i=o.useSyncExternalStore(o.useCallback((t=>r.subscribe(s.V.batchCalls(t))),[r]),(()=>r.getCurrentResult()),(()=>r.getCurrentResult())),u=o.useCallback(((t,e)=>{r.mutate(t,e).catch(p)}),[r]);if(i.error&&(c=r.options.throwOnError,l=[i.error],"function"==typeof c?c(...l):c))throw i.error;var c,l;return{...i,mutate:u,mutateAsync:i.mutate}}var f=n(35686),h=n(11498),y=n(42122),O=n(81728);function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){(0,i.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t,e){var n=(0,y.t2)(f.ZP,t),u=e||{},s=u.handlers,c=u.parse,l="string"==typeof t?t.split("."):t,a=l[l.length-1],d=(0,O.C5)(a),p=(null==l?void 0:l.length)>=2;function b(t){return(0,i.Z)({},d,t)}function g(t,e){var n=e||{},r=n.onError,i=n.onSuccess;return m(m({},e||{}),{},{onError:function(t,e,n){alert("".concat(JSON.stringify(t))),r&&(null==r||r(t,e,n))},onSuccess:function(e,n,r){var o=(e||{}).data;i&&(null==i||i("function"==typeof c?c(o):null==o?void 0:o[function(t){return t&&h.TO.LIST===t?a:d}(t)],n,r))}})}function j(t){return m(m({},t||{}),{},{_http_error_codes:!0})}var M=v(m(m({},g(h.TO.CREATE,(null==s?void 0:s.create)||{})),{},{mutationFn:function(t){return n.create.apply(n,(0,r.Z)(Array.isArray(null==t?void 0:t.id)?null==t?void 0:t.id:[null==t?void 0:t.id]).concat([j((null==t?void 0:t.query)||{})]))(b((null==t?void 0:t.payload)||{}))}})),w=v(m(m({},g(h.TO.DELETE,(null==s?void 0:s.delete)||{})),{},{mutationFn:function(t){return n.useDelete.apply(n,(0,r.Z)(Array.isArray(null==t?void 0:t.id)?null==t?void 0:t.id:[null==t?void 0:t.id]).concat([j((null==t?void 0:t.query)||{})]))}})),P=v(m(m({},g(h.TO.DETAIL,(null==s?void 0:s.detail)||{})),{},{mutationFn:function(t){return n.detailAsync.apply(n,(0,r.Z)(Array.isArray(null==t?void 0:t.id)?null==t?void 0:t.id:[null==t?void 0:t.id]).concat([j((null==t?void 0:t.query)||{})]))}})),S=v(m(m({},g(h.TO.LIST,(null==s?void 0:s.list)||{})),{},{mutationFn:function(t){return n.listAsync.apply(n,[].concat((0,r.Z)(p?Array.isArray(null==t?void 0:t.id)?null==t?void 0:t.id:[null==t?void 0:t.id]:[]),[j((null==t?void 0:t.query)||{})]))}})),E=v(m(m({},g(h.TO.UPDATE,(null==s?void 0:s.update)||{})),{},{mutationFn:function(t){return n.useUpdate.apply(n,(0,r.Z)(Array.isArray(null==t?void 0:t.id)?null==t?void 0:t.id:[null==t?void 0:t.id]).concat([j((null==t?void 0:t.query)||{})]))(b((null==t?void 0:t.payload)||{}))}}));return{create:(0,o.useMemo)((function(){return M}),[M]),delete:(0,o.useMemo)((function(){return w}),[w]),detail:(0,o.useMemo)((function(){return P}),[P]),list:(0,o.useMemo)((function(){return S}),[S]),update:(0,o.useMemo)((function(){return E}),[E])}}},67481:function(t,e,n){n.r(e),n.d(e,{default:function(){return w}});var r=n(77837),i=n(82394),o=n(38860),u=n.n(o),s=n(82684),c=n(51774),l=n.n(c),a=n(25501),d=n(53808);function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){(0,i.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f="materia-ide";function h(t){return"".concat(f,"-").concat(t)}function y(t){var e,n,r=(0,d.U2)(h(t))||{},i=r.client,o=r.server;return(null==i||null===(e=i.file)||void 0===e?void 0:e.content)!==(null==o||null===(n=o.file)||void 0===n?void 0:n.content)}function O(t){var e,n,r,i,o,u,s,c,l,a,p=t.client,f=t.server,y=h((null==p?void 0:p.path)||(null==f?void 0:f.path)),O=Number(new Date),b=(0,d.U2)(y),m=!b;(b=b||{},p)&&(b.client=v(v({},(null===(e=b)||void 0===e?void 0:e.client)||{}),{},{cachedAt:m?O:null===(n=b)||void 0===n||null===(r=n.client)||void 0===r?void 0:r.cachedAt,file:v(v({},(null===(i=b)||void 0===i||null===(o=i.client)||void 0===o?void 0:o.file)||{}),p),updatedAt:O}));f&&(b.server=v(v({},(null===(u=b)||void 0===u?void 0:u.server)||{}),{},{cachedAt:m?O:null===(s=b)||void 0===s||null===(c=s.server)||void 0===c?void 0:c.cachedAt,file:v(v({},(null===(l=b)||void 0===l||null===(a=l.server)||void 0===a?void 0:a.file)||{}),f),updatedAt:O}));return(0,d.t8)(y,b),b}var b=n(28598);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){(0,i.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var j=l()((function(){return n.e(9856).then(n.bind(n,79856))}),{loadableGenerated:{webpack:function(){return[79856]}}}),M=l()((function(){return n.e(2424).then(n.bind(n,62424))}),{ssr:!1,loadableGenerated:{webpack:function(){return[62424]}}});function w(t){var e=t.app,i=(0,s.useMemo)((function(){var t;return null==e||null===(t=e.options)||void 0===t?void 0:t.file}),[e]),o=(0,s.useMemo)((function(){return t=null==i?void 0:i.path,(0,d.U2)(h(t))||{};var t}),[i]),c=o.client,l=o.server,p=(0,s.useState)(g(g({},i),(null==c?void 0:c.file)||{})),v=p[0],f=p[1],m=(0,s.useState)(null==l?void 0:l.file),w=m[0],P=m[1],S=(0,s.useState)(y(null==i?void 0:i.path)),E=S[0],A=S[1],R=(0,s.useRef)((null==v?void 0:v.content)||""),C=(0,s.useRef)(null==c?void 0:c.file),D=(0,s.useRef)(0);function Z(t){return k.apply(this,arguments)}function k(){return(k=(0,r.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(3528).then(n.bind(n,3528)).then((function(t){t.Manager.setValue(e),O({client:e,server:e}),f(e),A(y(e.path))}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var T=(0,a.Z)("browser_items",{handlers:{detail:{onSuccess:function(t){P(t);var e=!1;C.current?O({server:t}):(Z(t),e=!0),f(t),t&&(R.current=t.content,!e&&A(y(t.path))),D.current+=1}},update:{onSuccess:function(t){O({server:t}),f(t),t&&(R.current=t.content,A(y(t.path))),D.current+=1}}}});function L(t,e){T.update.mutate({id:encodeURIComponent(t.path),payload:{content:(null==e?void 0:e.content)||(null==R?void 0:R.current),path:(null==e?void 0:e.path)||t.path}})}function U(t,e){var n=t.getModel(),r=n.getValue(),i=n.uri.path;R.current=r,O({client:{content:R.current,path:i}})}return(0,s.useEffect)((function(){var t=null==i?void 0:i.path;0===D.current&&t&&T.detail.mutate({id:encodeURIComponent(t)})}),[c,i]),{main:(0,s.useMemo)((function(){var t;return((null==C?void 0:C.current)||(null==v?void 0:v.content)||D.current>=1)&&(0,b.jsx)(M,{configurations:null==e||null===(t=e.options)||void 0===t?void 0:t.configurations,eventListeners:{onDidChangeModelContent:U},persistManagerOnUnmount:!0,resource:{main:v},uuid:null==e?void 0:e.uuid})}),[e,v]),toolbars:{top:(0,s.useMemo)((function(){return(0,b.jsx)(j,g(g({},t),{},{loading:T.update.isLoading,resource:{main:v,original:w},stale:E,updateLocalContent:Z,updateServerContent:L}))}),[T.update.isLoading,v,w,t,E])}}}}}]);