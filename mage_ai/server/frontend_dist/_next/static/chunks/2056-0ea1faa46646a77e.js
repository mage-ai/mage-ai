"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2056],{74521:function(e,t,n){var i=n(82394),r=n(92083),l=n.n(r),o=n(15338),u=n(97618),d=n(55485),s=n(65956),a=n(38276),c=n(71417),p=n(75499),v=n(30160),m=n(35686),f=n(3917),h=n(70515),g=n(8970),_=n(88422),j=n(10332),x=n(86735),b=n(70320),y=n(28598),E=n(82684);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.disableJobExpansion,n=e.disableStageExpansion,i=e.jobs,r=e.stagesMapping,k=(0,b.qB)();return(0,y.jsx)(p.Z,{apiForFetchingAfterAction:t?null:m.ZP.spark_jobs.detail,buildApiOptionsFromObject:t?null:function(e){var t,n,i,r;return[null===e||void 0===e?void 0:e.job_id,{application_id:null!==e&&void 0!==e&&null!==(t=e.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null===e||void 0===e||null===(n=e.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!==e&&void 0!==e&&null!==(i=e.application)&&void 0!==i&&i.spark_ui_url?encodeURIComponent(null===e||void 0===e||null===(r=e.application)||void 0===r?void 0:r.spark_ui_url):""}]},columnFlex:[null,null,null,null,null,null],columns:[{uuid:"ID"},{uuid:"Name"},{uuid:"Submitted"},{uuid:"Status"},{center:!0,uuid:"Stages"},{center:!0,uuid:"Tasks"}],getObjectAtRowIndex:function(e){return null===i||void 0===i?void 0:i[e]},renderExpandedRowWithObject:t?null:function(e,t){var i=null===t||void 0===t?void 0:t.spark_job;if(i){var l=i.num_active_stages,p=i.num_active_tasks,m=i.num_completed_stages,f=i.num_completed_tasks,g=i.num_failed_stages,_=i.num_failed_tasks,b=i.num_killed_tasks,E=i.num_skipped_stages,k=i.num_skipped_tasks,Z=i.num_tasks,P=i.stage_ids,O=(0,x.YC)(P,(function(e){return e}),{ascending:!1}).reduce((function(e,t){var n,l,o=null===r||void 0===r||null===(n=r[null===i||void 0===i||null===(l=i.application)||void 0===l?void 0:l.calculated_id])||void 0===n?void 0:n[t];return o?e.concat(o):o}),[]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(a.Z,{p:h.cd,children:(0,y.jsxs)(d.ZP,{children:[(0,y.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,y.jsxs)(s.Z,{noPadding:!0,children:[(0,y.jsx)(a.Z,{px:h.cd,py:h.cd,children:(0,y.jsx)(v.ZP,{bold:!0,large:!0,children:"Stage summary"})}),(0,y.jsx)(o.Z,{light:!0,short:!0}),(0,j.s)([["IDs",null===P||void 0===P?void 0:P.join(", ")],["Completed",m],["Active",l],["Skipped",E],["Failed",g]])]})}),(0,y.jsx)(a.Z,{mr:h.cd}),(0,y.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,y.jsxs)(s.Z,{noPadding:!0,children:[(0,y.jsx)(a.Z,{px:h.cd,py:h.cd,children:(0,y.jsx)(v.ZP,{bold:!0,large:!0,children:"Task summary"})}),(0,y.jsx)(o.Z,{light:!0,short:!0}),(0,j.s)([["Total",Z],["Completed",f],["Active",p],["Skipped",k],["Failed",_],["Killed",b]])]})})]})}),(0,y.jsx)(o.Z,{light:!0}),(0,y.jsx)(a.Z,{p:h.cd,children:(0,y.jsxs)(s.Z,{noPadding:!0,children:[(0,y.jsx)(a.Z,{p:h.cd,children:(0,y.jsxs)(v.ZP,{bold:!0,large:!0,children:["Stages\xa0\xa0\xa0",(0,y.jsx)(v.ZP,{default:!0,inline:!0,large:!0,monospace:!0,children:null===O||void 0===O?void 0:O.length})]})}),(0,y.jsx)(o.Z,{light:!0}),(0,y.jsx)(c.Z,{disableStageExpansion:n,stages:O}),(0,y.jsx)(a.Z,{p:h.cd})]})})]})}return(0,y.jsx)(a.Z,{p:h.cd})},rows:null===i||void 0===i?void 0:i.map((function(e){var t=e.job_id,n=e.name,i=e.num_tasks,r=e.stage_ids,o=e.status,u=e.submission_time,d=(null===n||void 0===n?void 0:n.length)>=100?"".concat(null===n||void 0===n?void 0:n.slice(0,97),"..."):n;return[(0,E.createElement)(v.ZP,Z(Z({},g.eB),{},{key:"id"}),t),(0,E.createElement)(v.ZP,Z(Z({},g.eB),{},{key:"name",preWrap:!0,title:n}),d),(0,E.createElement)(v.ZP,Z(Z({},g.eB),{},{key:"submittedAt"}),u?(0,f.XG)(l()(u,f.kE).format(f.BL),k):"-"),(0,E.createElement)(v.ZP,Z(Z({},g.eB),{},{danger:_.CN.FAILED===o,key:"status",success:_.CN.SUCCEEDED===o}),o),(0,E.createElement)(v.ZP,Z(Z({},g.eB),{},{center:!0,key:"stageIds"}),(null===r||void 0===r?void 0:r.length)||"-"),(0,E.createElement)(v.ZP,Z(Z({},g.eB),{},{center:!0,key:"tasks"}),i)]})),uuid:"jobs"})}},72748:function(e,t,n){n.d(t,{Z:function(){return M}});var i=n(21831),r=n(82394),l=n(38626),o=n(82684),u=n(75499),d=n(30160),s=n(44897),a=n(42631),c=n(31608),p=n(70515),v=c.DI,m=2*p.iI,f=5*p.iI+2*m,h=l.default.div.withConfig({displayName:"indexstyle__NodeStyle",componentId:"sc-9bk2jw-0"})(["border-radius:","px;"," ",""],a.n_,(function(e){return"\n    background-color: ".concat((e.theme||s.Z).background.dashboard,";\n    border: 1px solid ").concat((e.theme||s.Z).borders.light,";\n  ")}),(function(e){return e.height&&"\n    height: ".concat(e.height,"px;\n  ")})),g=l.default.div.withConfig({displayName:"indexstyle__NodeHeaderStyle",componentId:"sc-9bk2jw-1"})(["padding-left:","px;padding-right:","px;padding-top:","px;padding-bottom:","px;",""],v,v,m,m,(function(e){return"\n    border-bottom: 1px solid ".concat((e.theme||s.Z).borders.light,";\n  ")})),_=n(8970),j=n(28598);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){var t=e.height,n=e.node,i=(0,o.useMemo)((function(){return(null===n||void 0===n?void 0:n.metrics)||[]}),n),r=(0,o.useMemo)((function(){return(0,j.jsx)(u.Z,{columnFlex:[null,null],columns:[{uuid:"Metric"},{rightAligned:!0,uuid:"Value"}],rows:null===i||void 0===i?void 0:i.map((function(e){var t=e.name,n=e.value;return[(0,o.createElement)(d.ZP,b(b({},_.eB),{},{key:"name"}),t),(0,o.createElement)(d.ZP,b(b({},_.eB),{},{key:"value",rightAligned:!0}),n)]}))})}),[i]);return(0,j.jsxs)(h,{height:t,children:[(0,j.jsx)(g,{children:(0,j.jsx)(d.ZP,{monospace:!0,children:null===n||void 0===n?void 0:n.node_name})}),(null===i||void 0===i?void 0:i.length)>=1&&r]})},E=n(35686),k=n(24138),Z=n(21978),P=n(55187),O=n(99543);function S(e){var t=(null===e||void 0===e?void 0:e.metrics)||[],n=f,i=new RegExp("\n","g"),r=0;null===t||void 0===t||t.forEach((function(e){var t=e.name,n=e.value;r+=1;var l=[];[t,n].forEach((function(e){var t=e.matchAll(i);if(t){for(var n=0;"undefined"!==typeof t.next().value;)n+=1;l.push(n)}})),r+=Math.max.apply(Math,l)}));var l=(null===t||void 0===t?void 0:t.length)||0;return l>=1&&(n+=37,n+=18*(r||0),n+=17*(l||0)),n}function w(e){var t=(null===e||void 0===e?void 0:e.node_name)||"",n=(null===e||void 0===e?void 0:e.metrics)||[],r=Math.max.apply(Math,[(null===t||void 0===t?void 0:t.length)||0].concat((0,i.Z)(null===n||void 0===n?void 0:n.map((function(e){var t=e.name,n=e.value;return((null===t||void 0===t?void 0:t.length)||0)+((null===n||void 0===n?void 0:n.length)||0)}))))),l=2*v+r*(O.YE+.3);return null!==n&&void 0!==n&&n.length&&(l+=4*v),l}var C=n(86735);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(e){var t,n,r,u,d=e.disableGraph,s=e.height,a=e.heightOffset,c=e.model,p=e.overrideScroll,v=e.treeRef,m=(0,o.useRef)(null),f=v||m,h=(0,o.useContext)(l.ThemeContext),g=E.ZP.spark_sqls.detail(null===c||void 0===c?void 0:c.id,{application_id:null!==c&&void 0!==c&&null!==(t=c.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null===c||void 0===c||null===(n=c.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!==c&&void 0!==c&&null!==(r=c.application)&&void 0!==r&&r.spark_ui_url?encodeURIComponent(null===c||void 0===c||null===(u=c.application)||void 0===u?void 0:u.spark_ui_url):"",include_jobs_and_stages:1,_format:"with_jobs_and_stages"}).data,_=(0,o.useMemo)((function(){return null===g||void 0===g?void 0:g.spark_sql}),[g]),x=(0,o.useMemo)((function(){return(0,C.HK)((null===_||void 0===_?void 0:_.jobs)||[],(function(e){return e.job_id}))}),[_]),b=(0,o.useMemo)((function(){return(0,C.HK)((null===_||void 0===_?void 0:_.stages)||[],(function(e){return e.stage_id}))}),[_]),O=(0,o.useMemo)((function(){var e,t=[],n=[],r=(null===_||void 0===_?void 0:_.edges)||[],l=((0,C.vM)(r,(function(e){return e.from_id})),(0,C.vM)(r,(function(e){return e.to_id})),{});return null===r||void 0===r||r.forEach((function(e){var t=e.from_id,i=e.to_id;n.push({from:t,fromPort:"".concat(t,"-").concat(i,"-from"),id:"".concat(t,"-").concat(i),to:i,toPort:"".concat(t,"-").concat(i,"-to")}),t in l||(l[t]=[]),l[t].push(I(I({},Z.bJ),{},{disabled:!0,id:"".concat(t,"-").concat(i,"-from"),side:Z.rl.SOUTH})),i in l||(l[i]=[]),l[i].push(I(I({},Z.bJ),{},{disabled:!0,id:"".concat(t,"-").concat(i,"-to"),side:Z.rl.NORTH}))})),null===_||void 0===_||null===(e=_.nodes)||void 0===e||e.forEach((function(e){var n=null===e||void 0===e?void 0:e.node_id,r=(0,i.Z)((null===l||void 0===l?void 0:l[n])||[]);t.push({data:{sqlNode:e},height:S(e),id:n,ports:r,width:w(e)})})),{edges:n,nodes:t}}),[x,_,b]),R=O.edges,M=O.nodes;(0,o.useEffect)((function(){d||setTimeout((function(){var e,t,n,i,r;0===(null===f||void 0===f||null===(e=f.current)||void 0===e||null===(t=e.containerRef)||void 0===t||null===(n=t.current)||void 0===n?void 0:n.scrollTop)&&(null===f||void 0===f||null===(i=f.current)||void 0===i||null===(r=i.fitCanvas)||void 0===r||r.call(i))}),1e3)}),[f,d]);var A=(0,o.useMemo)((function(){var e=0;return s&&(e+=s),a&&(e-=a),Math.max(0,e)}),[s,a]),T=(0,o.useCallback)((function(e){e.preventDefault()}),[]);(0,o.useEffect)((function(){var e,t,n,i,r,l;d?null===f||void 0===f||null===(e=f.current)||void 0===e||null===(t=e.containerRef)||void 0===t||null===(n=t.current)||void 0===n||n.addEventListener("wheel",T):null===f||void 0===f||null===(i=f.current)||void 0===i||null===(r=i.containerRef)||void 0===r||null===(l=r.current)||void 0===l||l.removeEventListener("wheel",T)}),[d,T]);var D=(0,o.useCallback)((function(e){e.stopPropagation()}),[]);return(0,o.useEffect)((function(){var e,t,n,i,r,l;p?null===f||void 0===f||null===(e=f.current)||void 0===e||null===(t=e.containerRef)||void 0===t||null===(n=t.current)||void 0===n||n.addEventListener("wheel",D):null===f||void 0===f||null===(i=f.current)||void 0===i||null===(r=i.containerRef)||void 0===r||null===(l=r.current)||void 0===l||l.removeEventListener("wheel",D)}),[p,D]),(0,j.jsx)(P.$4,{height:A,onDoubleClick:function(){var e,t;return null===f||void 0===f||null===(e=f.current)||void 0===e||null===(t=e.fitCanvas)||void 0===t?void 0:t.call(e)},children:(0,j.jsx)(k.Xz,{arrow:null,disabled:d,edge:function(e){var t;return(0,j.jsx)(k.kS,I(I({},e),{},{style:{stroke:null===h||void 0===h||null===(t=h.accent)||void 0===t?void 0:t.purple}}))},edges:R,fit:!0,forwardedRef:f,maxHeight:Z.Jo,maxWidth:Z.Jo,maxZoom:1,minZoom:-.7,node:function(e){var t,n;return(0,j.jsx)(k.NB,I(I({},e),{},{dragType:"port",linkable:!0,port:(0,j.jsx)(k.GR,{style:{fill:null===h||void 0===h||null===(t=h.borders)||void 0===t?void 0:t.light,stroke:null===h||void 0===h||null===(n=h.accent)||void 0===n?void 0:n.purple,strokeWidth:"1px"}}),style:{fill:"transparent",stroke:"transparent",strokeWidth:0},children:function(e){var t=e.height,n=e.node.data.sqlNode;return(0,j.jsx)("foreignObject",{height:t,width:e.width,x:0,y:0,children:(0,j.jsx)(y,{height:t,node:n})})}}))},nodes:M})})}},93004:function(e,t,n){var i=n(82394),r=n(92083),l=n.n(r),o=n(82684),u=n(32013),d=n(98777),s=n(15338),a=n(97618),c=n(55485),p=n(74521),v=n(85854),m=n(65956),f=n(38276),h=n(72748),g=n(75499),_=n(30160),j=n(35686),x=n(3917),b=n(70515),y=n(8970),E=n(88422),k=n(81728),Z=n(70320),P=n(28598);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.disableGraph,n=e.disableJobExpansion,i=e.overrideScrollForGraph,r=e.setSelectedSql,O=e.showSparkGraph,w=e.sqls,C=e.stagesMapping,R=(0,Z.qB)(),I=j.ZP.spark_sqls.list({length:9999},{},{pauseFetch:"undefined"!==typeof w&&null!==w}).data,M=(0,o.useMemo)((function(){return w||((null===I||void 0===I?void 0:I.spark_sqls)||[])}),[I,w]),A=(0,o.useMemo)((function(){var e,Z={};null===M||void 0===M||M.forEach((function(e){var t,n,i=null===e||void 0===e?void 0:e.application;(null===i||void 0===i?void 0:i.calculated_id)in Z||(Z[null===i||void 0===i?void 0:i.calculated_id]={application:i,sqls:[]}),null===(t=Z[null===i||void 0===i?void 0:i.calculated_id])||void 0===t||null===(n=t.sqls)||void 0===n||n.push(e)}));var w=null===(e=Object.values(Z))||void 0===e?void 0:e.length;return Object.values(Z).map((function(e){var Z=e.application,I=e.sqls;return(0,P.jsxs)("div",{children:[w>=2&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(f.Z,{p:b.cd,children:(0,P.jsxs)(_.ZP,{default:!0,bold:!0,children:["Application ",null===Z||void 0===Z?void 0:Z.calculated_id]})}),(0,P.jsx)(s.Z,{light:!0})]}),(0,P.jsx)(g.Z,{apiForFetchingAfterAction:j.ZP.spark_sqls.detail,buildApiOptionsFromObject:function(e){var t,n,i,r;return[null===e||void 0===e?void 0:e.id,{application_id:null!==e&&void 0!==e&&null!==(t=e.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null===e||void 0===e||null===(n=e.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!==e&&void 0!==e&&null!==(i=e.application)&&void 0!==i&&i.spark_ui_url?encodeURIComponent(null===e||void 0===e||null===(r=e.application)||void 0===r?void 0:r.spark_ui_url):"",include_jobs_and_stages:1,_format:"with_jobs_and_stages"}]},columnFlex:[null,null,null,null,null,null,null],columns:[{uuid:"ID"},{uuid:"Submitted"},{center:!0,uuid:"Duration"},{uuid:"Status"},{center:!0,uuid:"Successful jobs"},{center:!0,uuid:"Running jobs"},{center:!0,uuid:"Failed jobs"}],getObjectAtRowIndex:function(e){return null===I||void 0===I?void 0:I[e]},onClickRow:function(e){var t=null===I||void 0===I?void 0:I[e];null===r||void 0===r||r((function(e){return e&&(null===e||void 0===e?void 0:e.id)===(null===t||void 0===t?void 0:t.id)?null:t}))},renderExpandedRowWithObject:function(e,r){var l,o=null===r||void 0===r||null===(l=r.spark_sql)||void 0===l?void 0:l.jobs,s=null===I||void 0===I?void 0:I[e];return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(f.Z,{p:b.cd,children:(0,P.jsxs)(m.Z,{noPadding:!0,children:[(0,P.jsx)(f.Z,{p:b.cd,children:(0,P.jsx)(c.ZP,{alignItems:"center",justifyContent:"space-between",children:(0,P.jsxs)(a.Z,{flex:1,flexDirection:"column",children:[(0,P.jsx)(v.Z,{level:5,children:"Description"}),(0,P.jsx)(f.Z,{mt:1,children:(0,P.jsx)(_.ZP,{default:!0,monospace:!0,children:null===s||void 0===s?void 0:s.description})})]})})}),(0,P.jsx)(f.Z,{p:b.cd,children:(0,P.jsxs)(u.Z,{noBoxShadow:!0,children:[(0,P.jsx)(d.Z,{noPaddingContent:!0,title:"Plan",titleXPadding:b.cd*b.iI,titleYPadding:1.5*b.iI,children:(0,P.jsx)(f.Z,{p:b.cd,children:(0,P.jsx)(_.ZP,{default:!0,monospace:!0,preWrap:!0,small:!0,children:null===s||void 0===s?void 0:s.plan_description})})}),O&&(0,P.jsx)(d.Z,{noPaddingContent:!0,title:"Graph",titleXPadding:b.cd*b.iI,titleYPadding:1.5*b.iI,children:(0,P.jsx)(h.Z,{disableGraph:t,height:100*b.iI,model:s,overrideScroll:i})})]})})]})}),(0,P.jsxs)(f.Z,{mb:b.cd,px:b.cd,children:[(0,P.jsx)(f.Z,{mb:b.cd,children:(0,P.jsx)(c.ZP,{alignItems:"center",justifyContent:"space-between",children:(0,P.jsx)(a.Z,{flex:1,flexDirection:"column",children:(0,P.jsx)(v.Z,{level:5,children:"Jobs"})})})}),(0,P.jsxs)(m.Z,{overflowVisible:!0,noPadding:!0,children:[(0,P.jsx)(p.Z,{disableJobExpansion:n,jobs:o,stagesMapping:C}),(0,P.jsx)(f.Z,{pb:b.cd})]})]})]})},rows:null===I||void 0===I?void 0:I.map((function(e){var t=e.duration,n=e.failed_job_ids,i=e.id,r=e.running_job_ids,u=e.status,d=e.submission_time,s=e.success_job_ids;return[(0,o.createElement)(_.ZP,S(S({},y.eB),{},{key:"id"}),i),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{key:"submissionTime"}),d?(0,x.XG)(l()(d,x.kE).format(x.OC),R):"-"),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"duration"}),t?(0,k.NR)(t):0),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{key:"status",success:E.oD.COMPLETED===u}),u),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"successJobIds"}),null===s||void 0===s?void 0:s.length),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"runningJobIds"}),null===r||void 0===r?void 0:r.length),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"failedJobIds"}),null===n||void 0===n?void 0:n.length)]}))})]},null===Z||void 0===Z?void 0:Z.calculated_id)}))}),[t,i,M,C]);return(0,P.jsx)(P.Fragment,{children:A})}},71417:function(e,t,n){n.d(t,{Z:function(){return N}});var i=n(82394),r=n(92083),l=n.n(r),o=n(15338),u=n(97618),d=n(55485),s=n(65956),a=n(38276),c=n(75499),p=n(38626),v=n(82684),m=n(39867),f=n(30160),h=n(12468),g=n(44897),_=n(70515),j=3*_.iI,x=p.default.div.withConfig({displayName:"indexstyle__BarsContainerStyle",componentId:"sc-15hlddf-0"})(["width:100%;"]),b=p.default.div.withConfig({displayName:"indexstyle__BarContainerStyle",componentId:"sc-15hlddf-1"})(["align-items:center;display:flex;height:","px;width:100%;"],j),y=p.default.div.withConfig({displayName:"indexstyle__BarStyle",componentId:"sc-15hlddf-2"})(["height:100%;"," "," "," "," "," "," "," "," ",""],(function(e){return e.widthPercentage&&"\n    width: ".concat(100*e.widthPercentage,"%;\n  ")}),(function(e){return e.blue&&"\n    background-color: ".concat((e.theme||g.Z).accent.blue,";\n  ")}),(function(e){return e.green&&"\n    background-color: ".concat((e.theme||g.Z).accent.positive,";\n  ")}),(function(e){return e.orange&&"\n    background-color: ".concat((e.theme||g.Z).accent.dbt,";\n  ")}),(function(e){return e.purple&&"\n    background-color: ".concat((e.theme||g.Z).accent.purple,";\n  ")}),(function(e){return e.red&&"\n    background-color: ".concat((e.theme||g.Z).accent.negative,";\n  ")}),(function(e){return e.teal&&"\n    background-color: ".concat((e.theme||g.Z).accent.teal,";\n  ")}),(function(e){return e.yellow&&"\n    background-color: ".concat((e.theme||g.Z).accent.yellow,";\n  ")}),(function(e){return e.empty&&"\n    background-color: ".concat((e.theme||g.Z).background.chartBlock,";\n  ")})),E=p.default.div.withConfig({displayName:"indexstyle__FillerStyle",componentId:"sc-15hlddf-3"})(["height:","px;width:100%;"],j),k=p.default.div.withConfig({displayName:"indexstyle__TextStyle",componentId:"sc-15hlddf-4"})(["align-items:center;display:flex;height:","px;justify-content:flex-end;"],j),Z=n(3917),P=n(70320),O=n(86735),S=n(28598);var w=function(e){var t,n=e.stageAttempt,i=(0,v.useContext)(p.ThemeContext),r=(0,P.qB)(),o=(n.submission_time,(0,v.useMemo)((function(){return(0,O.YC)(Object.values((null===n||void 0===n?void 0:n.tasks)||{}),(function(e){return e.launch_time}),{ascending:!0})}),[n])),s=(0,v.useMemo)((function(){var e,t;return null===o||void 0===o||o.forEach((function(n){var i=n.duration,r=n.launch_time,o=l()(r,Z.kE).valueOf();(!t||o<t)&&(t=o);var u=o+i;(!e||u>e)&&(e=u)})),{maxEndTimestamp:e,minLaunchTimestamp:t}}),[o]),c=s.maxEndTimestamp,g=s.minLaunchTimestamp,j=(0,v.useCallback)((function(e){return(0,S.jsx)(h.Z,{appearAbove:!0,block:!0,fullSize:!0,label:(0,S.jsx)(f.ZP,{leftAligned:!0,children:e}),lightBackground:!0,muted:!0,widthFitContent:!0,children:(0,S.jsx)(E,{})})}),[]),w=(0,v.useMemo)((function(){var e=c-g,t=[];return null===o||void 0===o||o.forEach((function(n,i){var r=n.duration,o=n.task_id,u=n.launch_time,d=n.scheduler_delay,s=n.task_metrics,p=s.executor_deserialize_time,v=s.shuffle_read_metrics.fetch_wait_time,m=s.executor_run_time,f=s.shuffle_write_metrics.write_time,h=s.result_serialization_time,_=n.getting_result_time,x=l()(u,Z.kE).valueOf(),E=x+r,k=[(0,S.jsx)(y,{empty:!0,widthPercentage:(x-g)/e,children:j("Waiting to start")},"launchTimestamp"),(0,S.jsx)(y,{blue:!0,widthPercentage:d/e,children:j("Scheduler delay")},"schedulerDelay"),(0,S.jsx)(y,{red:!0,widthPercentage:p/e,children:j("Task deserialization time")},"executorDeserializeTime"),(0,S.jsx)(y,{orange:!0,widthPercentage:v/e,children:j("Shuffle read time")},"fetchWaitTime"),(0,S.jsx)(y,{green:!0,widthPercentage:m/e,children:j("Executor computing time")},"executorRunTime"),(0,S.jsx)(y,{widthPercentage:f/e,yellow:!0,children:j("Shuffle write time")},"writeTime"),(0,S.jsx)(y,{purple:!0,widthPercentage:h/e,children:j("Result serialization time")},"resultSerializationTime"),(0,S.jsx)(y,{teal:!0,widthPercentage:_/e,children:j("Getting result time")},"gettingResultTime"),(0,S.jsx)(y,{empty:!0,widthPercentage:(c-E)/e,children:j("Already finished")},"endTime")];t.push((0,S.jsx)(a.Z,{mt:1},"divider-".concat(o))),t.push((0,S.jsx)(b,{children:k},o))})),(0,S.jsxs)(x,{children:[(0,S.jsx)(b,{children:(0,S.jsxs)(d.ZP,{fullWidth:!0,justifyContent:"space-between",children:[(0,S.jsx)(u.Z,{flex:1,children:(0,S.jsx)(f.ZP,{monospace:!0,muted:!0,children:(0,Z.XG)((0,Z.Mg)(g,{withMilliseconds:!0}).format(Z.OC),r)})}),(0,S.jsx)(u.Z,{flex:1,justifyContent:"flex-end",children:(0,S.jsx)(f.ZP,{monospace:!0,muted:!0,children:(0,Z.XG)((0,Z.Mg)(c,{withMilliseconds:!0}).format(Z.OC),r)})})]})}),t]})}),[c,g,j,o]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(a.Z,{mb:_.cd,children:(0,S.jsx)(f.ZP,{bold:!0,large:!0,children:"Task timeline"})}),(0,S.jsx)(a.Z,{mb:_.cd,children:[{color:null===i||void 0===i||null===(t=i.accent)||void 0===t?void 0:t.blue,uuid:"Scheduler delay"},{color:null===i||void 0===i?void 0:i.accent.negative,uuid:"Task deserialization time"},{color:null===i||void 0===i?void 0:i.accent.dbt,uuid:"Shuffle read time"},{color:null===i||void 0===i?void 0:i.accent.positive,uuid:"Executor computing time"},{color:null===i||void 0===i?void 0:i.accent.yellow,uuid:"Shuffle write time"},{color:null===i||void 0===i?void 0:i.accent.purple,uuid:"Result serialization time"},{color:null===i||void 0===i?void 0:i.accent.teal,uuid:"Getting result time"}].map((function(e,t){var n=e.color,i=e.uuid;return(0,S.jsx)(a.Z,{mt:t>=1?1:0,children:(0,S.jsxs)(d.ZP,{alignItems:"center",children:[(0,S.jsx)(m.Z,{color:n,size:1*_.iI}),(0,S.jsx)(a.Z,{mr:1}),(0,S.jsx)(f.ZP,{default:!0,children:i})]})},i)}))}),(0,S.jsxs)(d.ZP,{children:[(0,S.jsxs)("div",{children:[(0,S.jsx)(k,{children:(0,S.jsx)(f.ZP,{bold:!0,monospace:!0,muted:!0,noWrapping:!0,children:"ID"})}),null===o||void 0===o?void 0:o.map((function(e,t){var n=e.task_id;return(0,S.jsx)(a.Z,{mt:1,children:(0,S.jsx)(k,{children:(0,S.jsx)(f.ZP,{default:!0,monospace:!0,noWrapping:!0,children:n})})},n)}))]}),(0,S.jsx)(a.Z,{mr:2}),w]})]})},C=n(35686),R=n(88422),I=n(8970),M=n(10332),A=n(81728);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=function(e){var t=e.disableStageExpansion,n=e.stages,i=e.tasksContained,r=(0,P.qB)();return(0,S.jsx)(c.Z,{columnFlex:[null,null,null,null,null,null,null,null,null,null,null,null,null],columns:[{uuid:"ID"},{center:!0,uuid:"Attempt"},{uuid:"Name"},{uuid:"Submitted"},{center:!0,uuid:"Duration"},{uuid:"Status"},{center:!0,uuid:"Tasks"},{center:!0,tooltipMessage:"Bytes read from storage in this stage",uuid:"In"},{center:!0,uuid:"In recs"},{center:!0,tooltipMessage:"Bytes written in storage in this stage",uuid:"Out"},{center:!0,uuid:"Out recs"},{center:!0,tooltipMessage:"Total shuffle bytes and records read, includes both data read locally and data read from remote executors.",uuid:"Sh read"},{rightAligned:!0,tooltipMessage:"Bytes and records written to disk in order to be read by a shuffle in a future stage.",uuid:"Sh write"}],getObjectAtRowIndex:function(e){return null===n||void 0===n?void 0:n[e]},buildApiOptionsFromObject:t?null:function(e){var t,n,i,r;return[null===e||void 0===e?void 0:e.stage_id,{application_id:null!==e&&void 0!==e&&null!==(t=e.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null===e||void 0===e||null===(n=e.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!==e&&void 0!==e&&null!==(i=e.application)&&void 0!==i&&i.spark_ui_url?encodeURIComponent(null===e||void 0===e||null===(r=e.application)||void 0===r?void 0:r.spark_ui_url):"",quantiles:R.k$.map((function(e){return e})).join(","),withSummaries:!0}]},apiForFetchingAfterAction:t?null:C.ZP.spark_stages.detail,renderExpandedRowWithObject:t?null:function(e,t){var p,m,g=null===n||void 0===n?void 0:n[e];if(!g)return(0,S.jsx)("div",{});var j=g.details,x=g.num_active_tasks,b=g.num_complete_tasks,y=g.num_failed_tasks,E=g.num_killed_tasks,k=g.num_tasks,P=null===t||void 0===t||null===(p=t.spark_stage)||void 0===p?void 0:p.stage_attempts;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(a.Z,{p:_.cd,children:(0,S.jsxs)(d.ZP,{children:[(0,S.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,S.jsxs)(s.Z,{noPadding:!0,children:[(0,S.jsx)(a.Z,{px:_.cd,py:_.cd,children:(0,S.jsx)(f.ZP,{bold:!0,large:!0,children:"Task summary"})}),(0,S.jsx)(o.Z,{light:!0,short:!0}),(0,M.s)([["Total",k],["Completed",b],["Active",x],["Failed",y],["Killed",E]])]})}),(0,S.jsx)(a.Z,{mr:_.cd}),(0,S.jsx)(u.Z,{flex:2,alignItems:"stretch",children:(0,S.jsxs)(s.Z,{noPadding:!0,children:[(0,S.jsx)(a.Z,{px:_.cd,py:_.cd,children:(0,S.jsx)(f.ZP,{bold:!0,large:!0,children:"Details"})}),(0,S.jsx)(o.Z,{light:!0,short:!0}),(0,S.jsx)(a.Z,{p:_.cd,children:null===j||void 0===j||null===(m=j.split("\n"))||void 0===m?void 0:m.map((function(e){return(0,S.jsx)(f.ZP,{muted:!0,monospace:!0,small:!0,children:e},e)}))})]})})]})}),null===P||void 0===P?void 0:P.map((function(e){e.attempt_id;var t,n=e.task_metrics_distributions,p=e.tasks,m=n||{},g=m.input_metrics,j=m.output_metrics,x=m.quantiles,b=void 0===x?R.k$:x,y=m.shuffle_read_metrics,E=m.shuffle_write_metrics,k=(0,S.jsx)(c.Z,{columnFlex:[null,null,null,null,null,null,null,null,null],columns:[{uuid:"ID"},{center:!0,uuid:"Attempt"},{uuid:"Status"},{uuid:"Locality"},{uuid:"Launch"},{center:!0,uuid:"Duration"},{center:!0,tooltipMessage:"GC time is the total JVM garbage collection time.",uuid:"GC time"},{center:!0,tooltipMessage:"Scheduler delay is the time the task waits to be scheduled for execution.",uuid:"Delayed"},{center:!0,tooltipMessage:"Result serialization time is the time spent serializing the task result on an executor before sending it back to the driver.",uuid:"Result time"}],rows:(0,O.YC)(Object.values(p||{}),(function(e){return e.task_id}),{ascending:!1}).map((function(e){var t=e.attempt,n=e.duration,i=e.launch_time,o=e.scheduler_delay,u=e.status,d=e.task_id,s=e.task_locality,a=e.task_metrics;return[(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"taskId"}),d),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"attempt"}),t),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"status",success:R.q.SUCCESS===u}),u),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"taskLocality"}),s),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"launchTime"}),i?(0,Z.XG)(l()(i,Z.kE).format(Z.BL),r):"-"),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"duration"}),n?(0,A.NR)(n):0),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"jvmGcTime"}),null!==a&&void 0!==a&&a.jvm_gc_time?(0,A.NR)(null===a||void 0===a?void 0:a.jvm_gc_time):0),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"schedulerDelay"}),o?(0,A.NR)(o):0),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"resultSerializationTime"}),null!==a&&void 0!==a&&a.result_serialization_time?(0,A.NR)(null===a||void 0===a?void 0:a.result_serialization_time):0)]}))});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(o.Z,{light:!0}),(0,S.jsx)(a.Z,{p:_.cd,children:(0,S.jsx)(w,{stageAttempt:e})}),(0,S.jsx)(o.Z,{light:!0}),(0,S.jsx)(a.Z,{px:_.cd,mt:_.cd,children:(0,S.jsx)(d.ZP,{children:(0,S.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,S.jsxs)(s.Z,{noPadding:!0,children:[(0,S.jsx)(a.Z,{px:_.cd,py:_.cd,children:(0,S.jsxs)(f.ZP,{bold:!0,large:!0,children:["Summary metrics for ",(0,A._6)("completed task",null===e||void 0===e?void 0:e.num_complete_tasks)]})}),(0,S.jsx)(o.Z,{light:!0,short:!0}),(0,S.jsx)(c.Z,{columnFlex:[null].concat(null===b||void 0===b?void 0:b.map((function(){return null}))),columns:[{uuid:"Metric"}].concat((null===b||void 0===b?void 0:b.map((function(e,t){return{center:!0,label:function(){return 0===t?"Min":t===(null===b||void 0===b?void 0:b.length)-1?"Max":t===Math.floor((null===b||void 0===b?void 0:b.length)/2)?"Median":"".concat(Number(100*e),"th")},uuid:e}})))||[]),rows:[{uuid:"Duration",values:((null===n||void 0===n?void 0:n.duration)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"GC time is the total JVM garbage collection time.",uuid:"GC time",values:((null===n||void 0===n?void 0:n.jvm_gc_time)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Bytes read from storage in this stage.",uuid:"Input read (bytes)",values:(null===g||void 0===g?void 0:g.bytes_read)||[]},{tooltipMessage:"Records read from storage in this stage.",uuid:"Input records read",values:(null===g||void 0===g?void 0:g.records_read)||[]},{tooltipMessage:"Total shuffle bytes read, includes both data read locally and data read from remote executors.",uuid:"Shuffle read (bytes)",values:(null===y||void 0===y?void 0:y.read_bytes)||[]},{tooltipMessage:"Total shuffle records read, includes both data read locally and data read from remote executors.",uuid:"Shuffle read records",values:(null===y||void 0===y?void 0:y.read_records)||[]},{uuid:"Shuffle read fetch time",values:((null===y||void 0===y?void 0:y.fetch_wait_time)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Bytes written to storage in this stage.",uuid:"Input write (bytes)",values:(null===j||void 0===j?void 0:j.bytes_written)||[]},{tooltipMessage:"Records written to storage in this stage.",uuid:"Input records write",values:(null===j||void 0===j?void 0:j.records_written)||[]},{tooltipMessage:"Bytes written to disk in order to be read by a shuffle in a future stage.",uuid:"Shuffle write (bytes)",values:(null===E||void 0===E?void 0:E.write_bytes)||[]},{tooltipMessage:"Records written to disk in order to be read by a shuffle in a future stage.",uuid:"Shuffle write records",values:(null===E||void 0===E?void 0:E.write_records)||[]},{uuid:"Shuffle write time",values:((null===E||void 0===E?void 0:E.write_time)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Scheduler delay is the time the task waits to be scheduled for execution.",uuid:"Scheduler delay",values:(null===n||void 0===n?void 0:n.scheduler_delay)||[]},{uuid:"Task deserialization time",values:((null===n||void 0===n?void 0:n.executor_deserialize_time)||[]).map((function(e){return(0,A.NR)(e)}))},{uuid:"Task deserialization CPU time",values:((null===n||void 0===n?void 0:n.executor_deserialize_cpu_time)||[]).map((function(e){return(0,A.NR)(e)}))},{uuid:"Result size",values:(null===n||void 0===n?void 0:n.result_size)||[]},{tooltipMessage:"Result serialization time is the time spent serializing the task result on an executor before sending it back to the driver.",uuid:"Result serialization time",values:((null===n||void 0===n?void 0:n.result_serialization_time)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Getting result time is the time that the driver spends fetching task results from workers.",uuid:"Getting result time",values:((null===n||void 0===n?void 0:n.getting_result_time)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Scheduler delay is the time the task waits to be scheduled for execution.",uuid:"Scheduler delay",values:((null===n||void 0===n?void 0:n.scheduler_delay)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Peak execution memory is the maximum memory used by the internal data structures created during shuffles, aggregations and joins.",uuid:"Peak execution memory",values:(null===n||void 0===n?void 0:n.peak_execution_memory)||[]},{tooltipMessage:"Shuffle spill (memory) is the size of the deserialized form of the shuffled data in memory.",uuid:"Memory spilled (bytes)",values:(null===n||void 0===n?void 0:n.memory_bytes_spilled)||[]},{tooltipMessage:"Shuffle spill (disk) is the size of the serialized form of the data on disk.",uuid:"Disk spilled (bytes)",values:(null===n||void 0===n?void 0:n.disk_bytes_spilled)||[]}].map((function(e){var t=e.tooltipMessage,n=e.uuid,i=e.values;return[(0,S.jsxs)(d.ZP,{alignItems:"center",children:[(0,S.jsx)(f.ZP,D(D({},I.eB),{},{children:n})),t&&(0,S.jsx)("div",{style:{marginLeft:4},children:(0,S.jsx)(h.Z,{appearAbove:!0,label:(0,S.jsx)(f.ZP,{leftAligned:!0,children:t}),lightBackground:!0,maxWidth:200,muted:!0})})]},n)].concat(null===i||void 0===i?void 0:i.map((function(e,t){return(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"quantile-".concat(b[t],"-").concat(n)}),e)})))}))}),(0,S.jsx)(a.Z,{p:1})]})})})}),(0,S.jsx)(a.Z,{p:_.cd,children:(0,S.jsxs)(f.ZP,{bold:!0,large:!0,children:["Tasks\xa0\xa0\xa0",(0,S.jsx)(f.ZP,{default:!0,inline:!0,large:!0,monospace:!0,children:p?null===(t=Object.keys(p||{}))||void 0===t?void 0:t.length:""})]})}),!i&&k,i&&(0,S.jsx)(a.Z,{px:_.cd,children:(0,S.jsxs)(s.Z,{noPadding:!0,children:[k,(0,S.jsx)(a.Z,{pb:_.cd})]})}),(0,S.jsx)(a.Z,{p:1})]})}))]})},rows:null===n||void 0===n?void 0:n.map((function(e){var t=e.attempt_id,n=e.completion_time,i=e.first_task_launched_time,o=e.input_bytes,u=e.input_records,d=e.name,s=e.output_bytes,a=e.output_records,c=e.shuffle_read_bytes,p=e.shuffle_write_bytes,m=e.stage_id,h=e.status,g=e.submission_time,_=e.tasks,j=i&&l()(i,Z.kE),x=n&&l()(n,Z.kE),b=x&&x.diff(j),y=(null===d||void 0===d?void 0:d.length)>=12?"".concat(null===d||void 0===d?void 0:d.slice(0,9),"..."):d;return[(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"stageID"}),m),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"attemptID"}),t),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"displayName",title:d}),y),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"submissionTime"}),g?(0,Z.XG)(l()(g,Z.kE).format(Z.BL),r):"-"),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"diffDisplayText",center:!0}),b?(0,A.NR)(b):0),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"status",success:R.Dd.COMPLETE===h}),h),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"tasks",center:!0}),Object.keys(_||{}).length||0),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"inputBytes"}),o),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"inputRecords"}),u),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"outputBytes"}),s),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"outputRecords"}),a),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{center:!0,key:"shuffleReadBytes"}),c),(0,v.createElement)(f.ZP,D(D({},I.eB),{},{key:"shuffleWriteBytes",rightAligned:!0}),p)]}))})}},8970:function(e,t,n){n.d(t,{sY:function(){return O},l:function(){return k},Eb:function(){return Z},LF:function(){return P},B2:function(){return y},TD:function(){return E},uK:function(){return x},eB:function(){return S},kI:function(){return w}});var i=n(82394),r=n(28598),l=69.063,o=l/85;var u,d,s,a,c=function(e){var t,n,i=e.height,u=e.size,d=e.width;return u?(t=u/o,n=u):i?(t=i,n=i*o):d&&(t=d/o,n=d),(0,r.jsxs)("svg",{fill:"#fff",fillRule:"evenodd",height:t,stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 ".concat(l," ").concat(85),width:n,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,r.jsx)("use",{xlinkHref:"#A",x:"2.031",y:"2.5"}),(0,r.jsx)("symbol",{id:"A",overflow:"visible",children:(0,r.jsxs)("g",{stroke:"none",children:[(0,r.jsx)("path",{d:"M16.829 39.981L13.086 62.83l-9.812 2.283-3.255-1.659V39.981h16.81z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M65 31.932l-32.5 2.351L0 31.932 32.5 0 65 31.932z",fill:"#6b3b19"}),(0,r.jsx)("path",{d:"M38.971 39.981H3.274v25.132l35.697-8.322v-16.81z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M21.127 39.981l1.168 25.698-11.43 3.298-3.992-2.029V39.981h14.254z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M49.664 39.981H10.865v28.995l38.799-11.22V39.981z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M29.255 39.981v30.507l-8.912 3.317-5.016-2.556V39.981h13.929z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M58.117 39.981H20.342v33.824l37.775-14.078V39.981z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M26.019 76.703V39.981h24.602l11.803 24.771L32.49 80.001l-6.471-3.297z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M32.49 80.001v-40.02h32.5v23.464l-32.5 16.556zM65 31.932l-32.5-5.697V0L65 16.556v15.376z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M0 31.932l32.5-5.697V0L0 16.556v15.376z",fill:"#9d5025"})]})})]})},p=n(55485),v=n(30160),m=n(72473),f=n(74260),h=n(70515),g=n(81728);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x,b=8*h.iI,y=j({},f.GO);!function(e){e.CLUSTERS="clusters",e.MONITORING="monitoring",e.RESOURCES="resources",e.SETUP="setup",e.SYSTEM="system"}(x||(x={}));var E=(u={},(0,i.Z)(u,x.CLUSTERS,"Clusters"),(0,i.Z)(u,x.RESOURCES,"Resources"),(0,i.Z)(u,x.MONITORING,"Monitoring"),(0,i.Z)(u,x.SETUP,"Setup"),(0,i.Z)(u,x.SYSTEM,"System"),u),k=(d={},(0,i.Z)(d,y.AWS_EMR,"AWS EMR"),(0,i.Z)(d,y.STANDALONE_CLUSTER,"Standalone cluster"),d),Z=(s={},(0,i.Z)(s,y.AWS_EMR,"Spark"),(0,i.Z)(s,y.STANDALONE_CLUSTER,"Spark"),s),P=(a={},(0,i.Z)(a,y.AWS_EMR,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b;return(0,r.jsx)(c,{height:e})})),(0,i.Z)(a,y.STANDALONE_CLUSTER,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b;return(0,r.jsx)(m.Hm,{size:e,warning:!0})})),a),O=[{buildPayload:function(e){return{emr_config:null,spark_config:j({app_name:"",spark_master:"local"},null===e||void 0===e?void 0:e.spark_config)}},displayName:k[y.STANDALONE_CLUSTER],documentationHref:"https://docs.mage.ai/integrations/spark-pyspark#standalone-spark-cluster",kicker:Z[y.STANDALONE_CLUSTER],renderIcon:P[y.STANDALONE_CLUSTER],uuid:y.STANDALONE_CLUSTER},{buildPayload:function(e){return{emr_config:j({master_instance_type:""},null===e||void 0===e?void 0:e.emr_config),spark_config:j({app_name:""},null===e||void 0===e?void 0:e.spark_config)}},displayName:k[y.AWS_EMR],documentationHref:"https://docs.mage.ai/integrations/spark-pyspark#aws",kicker:Z[y.AWS_EMR],renderIcon:P[y.AWS_EMR],uuid:y.AWS_EMR}],S={default:!0,monospace:!0,preWrap:!0,small:!0};function w(e){var t=[{Icon:m.Zr,uuid:x.SETUP},{Icon:m.hd,uuid:x.RESOURCES}];return f.GO.AWS_EMR===(null===e||void 0===e?void 0:e.uuid)&&t.push.apply(t,[{Icon:m.su,renderStatus:function(e){var t=e.clusters;return e.clustersLoading?null:(0,r.jsx)(v.ZP,{default:!0,large:!0,monospace:!0,children:null===t||void 0===t?void 0:t.length})},uuid:x.CLUSTERS}]),[f.GO.AWS_EMR,f.GO.STANDALONE_CLUSTER].includes(null===e||void 0===e?void 0:e.uuid)&&t.push.apply(t,[{Icon:m.ug,renderStatus:function(e){var t=e.applications,n=e.applicationsLoading,i=e.jobs;e.jobsLoading;return n?null:(0,r.jsxs)(p.ZP,{flexDirection:"column",justifyContent:"flex-end",children:[(0,r.jsx)(v.ZP,{default:!0,monospace:!0,rightAligned:!0,xsmall:!0,children:(0,g._6)("application",(null===t||void 0===t?void 0:t.length)||0)}),(0,r.jsx)("div",{style:{marginBottom:h.iI/2}}),(0,r.jsx)(v.ZP,{default:!0,monospace:!0,rightAligned:!0,xsmall:!0,children:(0,g._6)("job",(null===i||void 0===i?void 0:i.length)||0)})]})},uuid:x.MONITORING},{Icon:m.m1,uuid:x.SYSTEM}]),t}},10332:function(e,t,n){n.d(t,{d:function(){return d},s:function(){return s}});var i=n(75499),r=n(30160),l=n(74260),o=n(42122),u=n(28598);function d(e){if(!(0,o.Qr)((null===e||void 0===e?void 0:e.spark_config)||{}))return(0,o.Qr)((null===e||void 0===e?void 0:e.emr_config)||{})?l.GO.STANDALONE_CLUSTER:l.GO.AWS_EMR}function s(e){return(0,u.jsx)(i.Z,{columnFlex:[null,1],columns:[{uuid:"Attribute"},{uuid:"Value"}],rows:e.map((function(e){return[(0,u.jsx)(r.ZP,{monospace:!0,muted:!0,small:!0,children:e[0]},"attribute"),(0,u.jsx)(r.ZP,{monospace:!0,muted:!0,small:!0,children:e[1]},"value")]}))})}},74260:function(e,t,n){var i,r,l;n.d(t,{GO:function(){return i},IK:function(){return l},br:function(){return r}}),function(e){e.AWS_EMR="AWS_EMR",e.STANDALONE_CLUSTER="STANDALONE_CLUSTER"}(i||(i={})),function(e){e.COMPLETED="completed",e.ERROR="error",e.INCOMPLETE="incomplete"}(r||(r={})),function(e){e.ACTIVATE_CLUSTER="activate_cluster",e.AWS_ACCESS_KEY_ID="AWS_ACCESS_KEY_ID",e.AWS_SECRET_ACCESS_KEY="AWS_SECRET_ACCESS_KEY",e.CLUSTER_CONNECTION="cluster_connection",e.CONFIGURE="configure",e.CREDENTIALS="credentials",e.EC2_KEY_NAME="ec2_key_name",e.EC2_KEY_PAIR="ec2_key_pair",e.EC2_KEY_PATH="ec2_key_path",e.IAM_PROFILE="iam_instance_profile",e.LAUNCH_CLUSTER="launch_cluster",e.OBSERVABILITY="observability",e.PERMISSIONS="permissions",e.PERMISSIONS_SSH="permissions_ssh",e.REMOTE_VARIABLES_DIR="remote_variables_dir",e.SETUP="setup"}(l||(l={}))},88422:function(e,t,n){var i,r,l,o,u;n.d(t,{CN:function(){return i},Dd:function(){return r},k$:function(){return d},oD:function(){return u},q:function(){return o}}),function(e){e.FAILED="FAILED",e.RUNNING="RUNNING",e.SUCCEEDED="SUCCEEDED"}(i||(i={})),function(e){e.COMPLETE="COMPLETE",e.PENDING="PENDING",e.SKIPPED="SKIPPED"}(r||(r={})),function(e){e.NODE_LOCAL="NODE_LOCAL",e.PROCESS_LOCAL="PROCESS_LOCAL",e.RACK_LOCAL="RACK_LOCAL"}(l||(l={})),function(e){e.SUCCESS="SUCCESS"}(o||(o={})),function(e){e.COMPLETED="COMPLETED"}(u||(u={}));var d=[.01,.25,.5,.75,.99]},35185:function(e,t,n){var i=n(82394),r=n(91835),l=(n(82684),n(38626)),o=n(44897),u=n(42631),d=n(70515),s=n(28598);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=l.default.div.withConfig({displayName:"ProgressBar__ProgressBarContainerStyle",componentId:"sc-10x9ojc-0"})(["border-radius:","px;height:","px;overflow:hidden;position:relative;width:100%;",""],u.BG,.75*d.iI,(function(e){return"\n    background-color: ".concat((e.theme.monotone||o.Z.monotone).grey200,";\n  ")})),v=l.default.div.withConfig({displayName:"ProgressBar__ProgressBarStyle",componentId:"sc-10x9ojc-1"})(["height:inherit;position:absolute;"," "," "," ",""],(function(e){return!e.danger&&"\n    background-color: ".concat((e.theme.progress||o.Z.progress).positive,";\n  ")}),(function(e){return e.progress&&"\n    width: ".concat(e.progress,"%;\n  ")}),(function(e){return e.danger&&"\n    background-color: ".concat((e.theme.progress||o.Z.progress).negative,";\n  ")}),(function(e){return e.animateProgress&&"\n    animation: animate-progress ".concat(e.animateProgress.duration,"ms linear forwards;\n\n    @keyframes animate-progress {\n      0% {\n        width: ").concat(e.animateProgress.start,"%;\n      }\n\n      100% {\n        width: ").concat(e.animateProgress.end,"%;\n      }\n    }\n  ")}));t.Z=function(e){var t=(0,r.Z)({},e);return(0,s.jsx)(p,c(c({},t),{},{children:(0,s.jsx)(v,c({},t))}))}}}]);