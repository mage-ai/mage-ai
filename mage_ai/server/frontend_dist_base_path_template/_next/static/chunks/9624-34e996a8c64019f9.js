"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9624],{29624:function(e,n,t){t.d(n,{Z:function(){return Q}});var i=t(82394),l=t(75582),r=t(12691),u=t.n(r),o=t(82684),c=t(83455),s=t(34376),p=t(71180),d=t(50724),a=t(30160),h=t(44897),f=t(42631),g=t(70515),_=t(9518),x=_.default.div.withConfig({displayName:"indexstyle__ModalStyle",componentId:"sc-qldrgc-0"})(["position:absolute;"," "," display:flex;flex-direction:column;width:","px;overflow:hidden;background-color:",";border:1px solid ",";border-radius:","px;box-shadow:",";"],(function(e){return e.top&&"\n    top: ".concat(e.top,"px;\n  ")}),(function(e){return e.left&&"\n    left: ".concat(e.left,"px;\n  ")}),39*g.iI,(function(e){return(e.theme||h.Z).background.dashboard}),(function(e){return(e.theme||h.Z).borders.darkLight}),f.n_,(function(e){return(e.theme||h.Z).shadow.popup})),y=_.default.div.withConfig({displayName:"indexstyle__ContentStyle",componentId:"sc-qldrgc-1"})(["display:flex;flex-direction:column;gap:","px;padding:","px ","px;"],2*g.iI,2.5*g.iI,2*g.iI),v=_.default.div.withConfig({displayName:"indexstyle__ActionsStyle",componentId:"sc-qldrgc-2"})(["display:flex;gap:","px;padding:","px;background-color:",";border-top:1px solid ",";& > *{flex:1;}"],g.iI,2*g.iI,(function(e){return(e.theme||h.Z).background.panel}),(function(e){return(e.theme||h.Z).borders.darkLight})),j=t(72473),b=t(72191),m=t(79633),Z=t(81728),C=t(28598);var P=function(e){var n=e.inProgressRunsCount,t=e.left,i=void 0===t?0:t,l=e.onAllow,r=e.onStop,u=e.pipelineScheduleId,c=e.pipelineUuid,s=e.top,d=void 0===s?0:s,h=e.topOffset,f=void 0===h?0:h,_=(0,o.useRef)(null),P=(0,o.useState)(d+f),k=P[0],w=P[1];return(0,o.useEffect)((function(){var e=null!=_&&_.current?_.current.getBoundingClientRect().height:32*g.iI,n=d+f+e>window.innerHeight;w(n?d-e:d+f)}),[i,d,f]),(0,C.jsxs)(x,{left:i,ref:_,top:k,children:[(0,C.jsxs)(y,{children:[(0,C.jsx)(j.AlertTriangle,{fill:m.$R,size:b.nz}),(0,C.jsx)(a.ZP,{bold:!0,large:!0,warning:!0,children:"There ".concat(1===n?"is":"are"," currently ").concat((0,Z._6)("run",n,!0)," in progress.")}),(0,C.jsx)(a.ZP,{large:!0,children:"Do you want to stop or allow the ".concat((0,Z._6)("run",n,!0,!0)," to complete?")})]}),(0,C.jsxs)(v,{children:[(0,C.jsx)(p.ZP,{large:!0,onClick:function(){return r(u,c)},children:"Stop"}),(0,C.jsx)(p.ZP,{large:!0,onClick:function(){return l(u)},children:"Allow"})]})]})},k=t(55485),w=t(48670),I=t(30229),O=t(89515),S=t(38276),R=t(75499),E=t(48381),A=t(69650),D=t(12468),N=t(35686),T=t(77417),q=t(19698),L=t(81655),U=t(41143),z=t(31608),B=t(16488),V=t(3917),F=t(50178),H=t(72619),X=t(95924),$=t(70320),G=t(89538);function K(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function M(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?K(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var J=1.5*g.iI;var Q=function(e){var n=e.disableActions,t=e.fetchPipelineSchedules,i=e.highlightRowOnHover,r=e.includeCreatedAtColumn,h=e.includePipelineColumn,f=e.pipeline,_=e.pipelineSchedules,x=e.pipelineTriggersByName,y=e.selectedSchedule,v=e.setErrors,m=e.setSelectedSchedule,Z=e.stickyHeader,K=null==f?void 0:f.uuid,Q=(0,s.useRouter)(),W=(0,T.Z)().projectPlatformActivated,Y=(0,q.Z)().status,ee=(0,o.useRef)({}),ne=(0,o.useRef)({}),te=(0,o.useState)(null),ie=te[0],le=te[1],re=(0,o.useState)(0),ue=re[0],oe=re[1],ce=(0,o.useState)(0),se=ce[0],pe=ce[1],de=(0,$.qB)(),ae=de?L.O$:{},he=(0,c.Db)((function(e){return N.ZP.pipelines.useUpdate(e.uuid)({pipeline:e})}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null==t||t()},onErrorCallback:function(e,n){return null==v?void 0:v({errors:n,response:e})}})}}),fe=(0,l.Z)(he,1)[0],ge=(0,c.Db)((function(e){return N.ZP.pipeline_schedules.useUpdate(e.id)({pipeline_schedule:e})}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null==t||t()},onErrorCallback:function(e,n){return null==v?void 0:v({errors:n,response:e})}})}}),_e=(0,l.Z)(ge,1)[0],xe=(0,c.Db)((function(e){return N.ZP.pipeline_schedules.useDelete(e)()}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null==t||t(),K?Q.push("/pipelines/[pipeline]/triggers","/pipelines/".concat(K,"/triggers")):null==t||t()},onErrorCallback:function(e,n){return v({errors:n,response:e})}})}}),ye=(0,l.Z)(xe,1)[0],ve=[],je=[];n||(ve.push.apply(ve,[null]),je.push.apply(je,[{uuid:"Active"}])),ve.push.apply(ve,[1]),je.push.apply(je,[{uuid:"Name"}]),n||(ve.push.apply(ve,[null]),je.push.apply(je,[{center:!0,uuid:"Logs"}]),W&&(ve.push.apply(ve,[null]),je.push.apply(je,[{uuid:"Project"}])),h&&(ve.push.apply(ve,[1]),je.push.apply(je,[{uuid:"Pipeline"}])),ve.push.apply(ve,[null,null]),je.push.apply(je,[{uuid:"Type"},{uuid:"Frequency"}])),ve.push.apply(ve,[1,1,null,null]),je.push.apply(je,[{uuid:"Latest status"},M(M({},ae),{},{uuid:"Next run date"}),{uuid:"Runs"},{uuid:"Description"}]),n||(ve.push.apply(ve,[1]),je.push.apply(je,[{uuid:"Tags"}]),r&&(ve.push.apply(ve,[null]),je.push.apply(je,[M(M({},ae),{},{uuid:"Created at"})])),(0,F.Ct)(null==Q?void 0:Q.basePath)||(ve.push.apply(ve,[null]),je.push.apply(je,[{label:function(){return""},uuid:"edit/delete"}])));var be=(0,G.dd)((function(e){var n=e.inProgressRunsCount,t=e.left,i=e.pipelineScheduleId,l=e.pipelineUuid,r=e.top,u=e.topOffset;return(0,C.jsx)(P,{inProgressRunsCount:n,left:t,onAllow:function(e){Ce(),_e({id:e,status:I.fq.INACTIVE})},onStop:function(e,n){Ce(),fe({pipeline_schedule_id:e,status:U.V.CANCELLED,uuid:n}),_e({id:e,status:I.fq.INACTIVE})},pipelineScheduleId:i,pipelineUuid:l,top:r,topOffset:u})}),{},[],{background:!0,uuid:"disable_trigger"}),me=(0,l.Z)(be,2),Ze=me[0],Ce=me[1];return(0,C.jsx)(z.cl,{overflowVisible:!0,children:0===_.length?(0,C.jsx)(S.Z,{px:3,py:1,children:(0,C.jsx)(a.ZP,{bold:!0,default:!0,monospace:!0,muted:!0,children:"No triggers available"})}):(0,C.jsx)(R.Z,{columnFlex:ve,columns:je,highlightRowOnHover:i,isSelectedRow:function(e){return _[e].id===(null==y?void 0:y.id)},onClickRow:m?function(e){return null==m?void 0:m(_[e])}:null,rowVerticalPadding:6,rows:_.map((function(e,t){var i=e.id,l=e.created_at,c=e.description,s=e.next_pipeline_run_date,f=e.pipeline_in_progress_runs_count,_=e.pipeline_runs_count,y=e.pipeline_uuid,v=e.last_pipeline_run_status,m=e.name,Z=e.repo_path,P=e.schedule_interval,R=e.status,N=e.tags,T=I.fq.ACTIVE===R,q=(0,B._U)(P),U=K||y;ee.current[i]=(0,o.createRef)(),ne.current[i]=(0,o.createRef)();var z=null!=x&&x[m]?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(S.Z,{mr:1}),(0,C.jsx)(D.Z,{block:!0,label:"This trigger is saved in code.",size:J,widthFitContent:!0,children:(0,C.jsx)(j.Code,{default:!0,size:J})})]}):null,H=[];if(n?H.push.apply(H,[(0,C.jsxs)(k.ZP,{alignItems:"center",children:[(0,C.jsx)(a.ZP,{bold:!0,children:m}),z]},"trigger_name_".concat(t))]):H.push.apply(H,[(0,C.jsx)(D.Z,{block:!0,label:R,size:20,widthFitContent:!0,children:(0,C.jsx)("div",{ref:ee.current[i],style:{position:"relative"},children:(0,C.jsx)(A.Z,{checked:T,compact:!0,onCheck:function(e){return function(e){var n=e.event,t=e.inProgressRunsCount,i=e.pipelineIsActive,l=e.pipelineScheduleId,r=e.pipelineUuid;if((0,X.j)(n),i&&t>0){var u,o=null===(u=ee.current[l])||void 0===u?void 0:u.current,c=null==o?void 0:o.getBoundingClientRect(),s=c.height,p=c.left,d=c.top;Ze({inProgressRunsCount:t,left:p,pipelineScheduleId:l,pipelineUuid:r,top:d,topOffset:s})}else _e({id:l,status:i?I.fq.INACTIVE:I.fq.ACTIVE})}({event:e,inProgressRunsCount:f,pipelineIsActive:T,pipelineScheduleId:i,pipelineUuid:y})},purpleBackground:!0})})},"trigger_enabled_".concat(t)),(0,C.jsxs)(k.ZP,{alignItems:"center",children:[(0,C.jsx)(u(),{as:"/pipelines/".concat(U,"/triggers/").concat(i),href:"/pipelines/[pipeline]/triggers/[...slug]",passHref:!0,children:(0,C.jsx)(w.Z,{bold:!0,onClick:function(e){(0,X.j)(e),Q.push("/pipelines/[pipeline]/triggers/[...slug]","/pipelines/".concat(U,"/triggers/").concat(i))},sky:!0,children:m})}),z]},"trigger_name_".concat(t))]),!n){var $,G;if(H.push((0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return Q.push("/pipelines/".concat(U,"/logs?pipeline_schedule_id[]=").concat(i))},children:(0,C.jsx)(j.Logs,{default:!0,size:b.bL})},"logs_button_".concat(t))),W)H.push.apply(H,[(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:null==Z||null===(G=Z.replace((null==Y?void 0:Y.repo_path_root)||"",""))||void 0===G?void 0:G.slice(1)},"project_".concat(t))]);h&&H.push((0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:U},"pipeline_name_".concat(t))),H.push.apply(H,[(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:null===($=I.Z4[e.schedule_type])||void 0===$?void 0:$.call(I.Z4)},"trigger_type_".concat(t)),(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:de&&q?(0,B.lO)(P):P},"trigger_frequency_".concat(t))])}return H.push.apply(H,[(0,o.createElement)(a.ZP,M(M({},(0,L.NC)(v)),{},{key:"latest_run_status_".concat(t)}),v||"—"),(0,C.jsx)(a.ZP,{monospace:!0,small:!0,title:s?"UTC: ".concat(s.slice(0,19)):null,children:s?de?(0,V.XG)(s,de):(0,V.d$)(s,{includeSeconds:!0,utcFormat:!0}):(0,C.jsx)(C.Fragment,{children:"—"})},"trigger_next_run_date_".concat(t)),(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:_||"0"},"trigger_run_count_".concat(t)),(0,C.jsx)(a.ZP,{default:!0,title:c,width:40*g.iI,children:c},"trigger_description_".concat(t))]),n||(H.push((0,C.jsx)("div",{children:(0,C.jsx)(E.Z,{tags:null==N?void 0:N.map((function(e){return{uuid:e}}))})},"pipeline_tags_".concat(t))),r&&H.push((0,C.jsx)(a.ZP,{default:!0,monospace:!0,small:!0,title:l?(0,V._6)(l):null,children:(0,V.XG)(null==l?void 0:l.slice(0,19),de)},"created_at_".concat(t))),(0,F.Ct)(null==Q?void 0:Q.basePath)||H.push((0,C.jsxs)(k.ZP,{children:[(0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return Q.push("/pipelines/".concat(U,"/triggers/").concat(i,"/edit"))},title:"Edit",children:(0,C.jsx)(j.Edit,{default:!0,size:b.bL})}),(0,C.jsx)(S.Z,{mr:1}),(0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){var e,n,t,l;le(i),oe((null===(e=ne.current[i])||void 0===e||null===(n=e.current)||void 0===n?void 0:n.offsetTop)||0),pe((null===(t=ne.current[i])||void 0===t||null===(l=t.current)||void 0===l?void 0:l.offsetLeft)||0)},ref:ne.current[i],title:"Delete",children:(0,C.jsx)(j.Trash,{default:!0,size:b.bL})}),(0,C.jsx)(d.Z,{onClickOutside:function(){return le(null)},open:ie===i,children:(0,C.jsx)(O.Z,{danger:!0,left:(se||0)-L.nH,onCancel:function(){return le(null)},onClick:function(){le(null),ye(i)},title:"Are you sure you want to delete the trigger ".concat(m,"?"),top:(ue||0)-(t<=1?L.oz:L.OK),width:L.Xx})})]},"edit_delete_buttons_".concat(t)))),H})),stickyHeader:Z,uuid:"pipeline-triggers"})})}}}]);