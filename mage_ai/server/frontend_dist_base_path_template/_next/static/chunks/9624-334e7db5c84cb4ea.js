"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9624],{29624:function(e,n,i){i.d(n,{Z:function(){return M}});var t=i(82394),l=i(75582),r=i(12691),u=i.n(r),o=i(82684),c=i(69864),s=i(34376),d=i(71180),p=i(50724),a=i(30160),f=i(44897),h=i(42631),g=i(70515),x=i(38626),_=x.default.div.withConfig({displayName:"indexstyle__ModalStyle",componentId:"sc-qldrgc-0"})(["position:absolute;"," "," display:flex;flex-direction:column;width:","px;overflow:hidden;background-color:",";border:1px solid ",";border-radius:","px;box-shadow:",";"],(function(e){return e.top&&"\n    top: ".concat(e.top,"px;\n  ")}),(function(e){return e.left&&"\n    left: ".concat(e.left,"px;\n  ")}),39*g.iI,(function(e){return(e.theme||f.Z).background.dashboard}),(function(e){return(e.theme||f.Z).borders.darkLight}),h.n_,(function(e){return(e.theme||f.Z).shadow.popup})),v=x.default.div.withConfig({displayName:"indexstyle__ContentStyle",componentId:"sc-qldrgc-1"})(["display:flex;flex-direction:column;gap:","px;padding:","px ","px;"],2*g.iI,2.5*g.iI,2*g.iI),j=x.default.div.withConfig({displayName:"indexstyle__ActionsStyle",componentId:"sc-qldrgc-2"})(["display:flex;gap:","px;padding:","px;background-color:",";border-top:1px solid ",";& > *{flex:1;}"],g.iI,2*g.iI,(function(e){return(e.theme||f.Z).background.panel}),(function(e){return(e.theme||f.Z).borders.darkLight})),b=i(72473),y=i(72191),m=i(79633),Z=i(81728),C=i(28598);var P=function(e){var n=e.inProgressRunsCount,i=e.left,t=void 0===i?0:i,l=e.onAllow,r=e.onStop,u=e.pipelineScheduleId,c=e.pipelineUuid,s=e.top,p=void 0===s?0:s,f=e.topOffset,h=void 0===f?0:f,x=(0,o.useRef)(null),P=(0,o.useState)(p+h),k=P[0],w=P[1];return(0,o.useEffect)((function(){var e=null!==x&&void 0!==x&&x.current?x.current.getBoundingClientRect().height:32*g.iI,n=p+h+e>window.innerHeight;w(n?p-e:p+h)}),[t,p,h]),(0,C.jsxs)(_,{left:t,ref:x,top:k,children:[(0,C.jsxs)(v,{children:[(0,C.jsx)(b.uy,{fill:m.$R,size:y.nz}),(0,C.jsx)(a.ZP,{bold:!0,large:!0,warning:!0,children:"There ".concat(1===n?"is":"are"," currently ").concat((0,Z._6)("run",n,!0)," in progress.")}),(0,C.jsx)(a.ZP,{large:!0,children:"Do you want to stop or allow the ".concat((0,Z._6)("run",n,!0,!0)," to complete?")})]}),(0,C.jsxs)(j,{children:[(0,C.jsx)(d.ZP,{large:!0,onClick:function(){return r(u,c)},children:"Stop"}),(0,C.jsx)(d.ZP,{large:!0,onClick:function(){return l(u)},children:"Allow"})]})]})},k=i(55485),w=i(48670),I=i(30229),O=i(89515),S=i(38276),R=i(75499),E=i(48381),A=i(69650),D=i(12468),N=i(35686),T=i(81655),q=i(41143),L=i(31608),U=i(16488),z=i(3917),F=i(50178),V=i(72619),B=i(3314),H=i(70320),X=i(89538);function $(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function G(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?$(Object(i),!0).forEach((function(n){(0,t.Z)(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):$(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}var K=1.5*g.iI;var M=function(e){var n=e.disableActions,i=e.fetchPipelineSchedules,t=e.highlightRowOnHover,r=e.includeCreatedAtColumn,f=e.includePipelineColumn,h=e.pipeline,g=e.pipelineSchedules,x=e.pipelineTriggersByName,_=e.selectedSchedule,v=e.setErrors,j=e.setSelectedSchedule,m=e.stickyHeader,Z=null===h||void 0===h?void 0:h.uuid,$=(0,s.useRouter)(),M=(0,o.useRef)({}),J=(0,o.useRef)({}),Q=(0,o.useState)(null),W=Q[0],Y=Q[1],ee=(0,o.useState)(0),ne=ee[0],ie=ee[1],te=(0,o.useState)(0),le=te[0],re=te[1],ue=(0,H.q)(),oe=ue?T.O$:{},ce=(0,c.Db)((function(e){return N.ZP.pipelines.useUpdate(e.uuid)({pipeline:e})}),{onSuccess:function(e){return(0,V.wD)(e,{callback:function(){null===i||void 0===i||i()},onErrorCallback:function(e,n){return null===v||void 0===v?void 0:v({errors:n,response:e})}})}}),se=(0,l.Z)(ce,1)[0],de=(0,c.Db)((function(e){return N.ZP.pipeline_schedules.useUpdate(e.id)({pipeline_schedule:e})}),{onSuccess:function(e){return(0,V.wD)(e,{callback:function(){null===i||void 0===i||i()},onErrorCallback:function(e,n){return null===v||void 0===v?void 0:v({errors:n,response:e})}})}}),pe=(0,l.Z)(de,1)[0],ae=(0,c.Db)((function(e){return N.ZP.pipeline_schedules.useDelete(e)()}),{onSuccess:function(e){return(0,V.wD)(e,{callback:function(){null===i||void 0===i||i(),Z?$.push("/pipelines/[pipeline]/triggers","/pipelines/".concat(Z,"/triggers")):null===i||void 0===i||i()},onErrorCallback:function(e,n){return v({errors:n,response:e})}})}}),fe=(0,l.Z)(ae,1)[0],he=[],ge=[];n||(he.push.apply(he,[null,null]),ge.push.apply(ge,[{uuid:"Active"},{uuid:"Type"}])),he.push.apply(he,[1,2]),ge.push.apply(ge,[{uuid:"Name"},{uuid:"Description"}]),n||(he.push.apply(he,[null]),ge.push({uuid:"Frequency"})),he.push.apply(he,[1,1,null]),ge.push.apply(ge,[G(G({},oe),{},{uuid:"Next run date"}),{uuid:"Latest status"},{uuid:"Runs"}]),n||(he.push.apply(he,[1]),ge.push({uuid:"Tags"})),he.push.apply(he,[null]),ge.push({uuid:"Logs"}),n||(0,F.Ct)()||(he.push.apply(he,[null]),ge.push({label:function(){return""},uuid:"edit/delete"})),!n&&f&&(ge.splice(2,0,{uuid:"Pipeline"}),he.splice(2,0,1)),!n&&r&&(ge.splice(5,0,G(G({},oe),{},{uuid:"Created at"})),he.splice(5,0,null));var xe=(0,X.dd)((function(e){var n=e.inProgressRunsCount,i=e.left,t=e.pipelineScheduleId,l=e.pipelineUuid,r=e.top,u=e.topOffset;return(0,C.jsx)(P,{inProgressRunsCount:n,left:i,onAllow:function(e){je(),pe({id:e,status:I.fq.INACTIVE})},onStop:function(e,n){je(),se({pipeline_schedule_id:e,status:q.V.CANCELLED,uuid:n}),pe({id:e,status:I.fq.INACTIVE})},pipelineScheduleId:t,pipelineUuid:l,top:r,topOffset:u})}),{},[],{background:!0,uuid:"disable_trigger"}),_e=(0,l.Z)(xe,2),ve=_e[0],je=_e[1];return(0,C.jsx)(L.cl,{overflowVisible:!0,children:0===g.length?(0,C.jsx)(S.Z,{px:3,py:1,children:(0,C.jsx)(a.ZP,{bold:!0,default:!0,monospace:!0,muted:!0,children:"No triggers available"})}):(0,C.jsx)(R.Z,{columnFlex:he,columns:ge,highlightRowOnHover:t,isSelectedRow:function(e){return g[e].id===(null===_||void 0===_?void 0:_.id)},onClickRow:j?function(e){return null===j||void 0===j?void 0:j(g[e])}:null,rowVerticalPadding:6,rows:g.map((function(e,i){var t=e.id,l=e.created_at,c=e.description,s=e.next_pipeline_run_date,h=e.pipeline_in_progress_runs_count,g=e.pipeline_runs_count,_=e.pipeline_uuid,v=e.last_pipeline_run_status,j=e.name,m=e.schedule_interval,P=e.status,R=e.tags,N=I.fq.ACTIVE===P,q=(0,U._U)(m),L=Z||_;M.current[t]=(0,o.createRef)(),J.current[t]=(0,o.createRef)();var V,H=null!==x&&void 0!==x&&x[j]?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(S.Z,{mr:1}),(0,C.jsx)(D.Z,{block:!0,label:"This trigger is saved in code.",size:K,widthFitContent:!0,children:(0,C.jsx)(b.EK,{default:!0,size:K})})]}):null,X=[];n?X.push.apply(X,[(0,C.jsxs)(k.ZP,{alignItems:"center",children:[(0,C.jsx)(a.ZP,{bold:!0,children:j}),H]},"trigger_name_".concat(i))]):X.push.apply(X,[(0,C.jsx)(D.Z,{block:!0,label:P,size:20,widthFitContent:!0,children:(0,C.jsx)("div",{ref:M.current[t],style:{position:"relative"},children:(0,C.jsx)(A.Z,{checked:N,compact:!0,onCheck:function(e){return function(e){var n=e.event,i=e.inProgressRunsCount,t=e.pipelineIsActive,l=e.pipelineScheduleId,r=e.pipelineUuid;if((0,B.j)(n),t&&i>0){var u,o=null===(u=M.current[l])||void 0===u?void 0:u.current,c=null===o||void 0===o?void 0:o.getBoundingClientRect(),s=c.height,d=c.left,p=c.top;ve({inProgressRunsCount:i,left:d,pipelineScheduleId:l,pipelineUuid:r,top:p,topOffset:s})}else pe({id:l,status:t?I.fq.INACTIVE:I.fq.ACTIVE})}({event:e,inProgressRunsCount:h,pipelineIsActive:N,pipelineScheduleId:t,pipelineUuid:_})},purpleBackground:!0})})},"trigger_enabled_".concat(i)),(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:null===(V=I.Z4[e.schedule_type])||void 0===V?void 0:V.call(I.Z4)},"trigger_type_".concat(i)),(0,C.jsxs)(k.ZP,{alignItems:"center",children:[(0,C.jsx)(u(),{as:"/pipelines/".concat(L,"/triggers/").concat(t),href:"/pipelines/[pipeline]/triggers/[...slug]",passHref:!0,children:(0,C.jsx)(w.Z,{bold:!0,onClick:function(e){(0,B.j)(e),$.push("/pipelines/[pipeline]/triggers/[...slug]","/pipelines/".concat(L,"/triggers/").concat(t))},sky:!0,children:j})}),H]},"trigger_name_".concat(i))]);return X.push.apply(X,[(0,C.jsx)(a.ZP,{default:!0,children:c},"trigger_description_".concat(i))]),n||X.push((0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:ue&&q?(0,U.lO)(m):m},"trigger_frequency_".concat(i))),X.push.apply(X,[(0,C.jsx)(a.ZP,{monospace:!0,small:!0,title:s?"UTC: ".concat(s.slice(0,19)):null,children:s?ue?(0,z.XG)(s,ue):(0,z.d$)(s,{includeSeconds:!0,utcFormat:!0}):(0,C.jsx)(C.Fragment,{children:"\u2014"})},"trigger_next_run_date_".concat(i)),(0,o.createElement)(a.ZP,G(G({},(0,T.NC)(v)),{},{key:"latest_run_status_".concat(i)}),v||"N/A"),(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:g},"trigger_run_count_".concat(i))]),n||X.push((0,C.jsx)("div",{children:(0,C.jsx)(E.Z,{tags:null===R||void 0===R?void 0:R.map((function(e){return{uuid:e}}))})},"pipeline_tags_".concat(i))),X.push((0,C.jsx)(d.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return $.push("/pipelines/".concat(L,"/logs?pipeline_schedule_id[]=").concat(t))},children:(0,C.jsx)(b.UL,{default:!0,size:y.bL})},"logs_button_".concat(i))),n||(0,F.Ct)()||X.push((0,C.jsxs)(k.ZP,{children:[(0,C.jsx)(d.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return $.push("/pipelines/".concat(L,"/triggers/").concat(t,"/edit"))},title:"Edit",children:(0,C.jsx)(b.I8,{default:!0,size:y.bL})}),(0,C.jsx)(S.Z,{mr:1}),(0,C.jsx)(d.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){var e,n,i,l;Y(t),ie((null===(e=J.current[t])||void 0===e||null===(n=e.current)||void 0===n?void 0:n.offsetTop)||0),re((null===(i=J.current[t])||void 0===i||null===(l=i.current)||void 0===l?void 0:l.offsetLeft)||0)},ref:J.current[t],title:"Delete",children:(0,C.jsx)(b.rF,{default:!0,size:y.bL})}),(0,C.jsx)(p.Z,{onClickOutside:function(){return Y(null)},open:W===t,children:(0,C.jsx)(O.Z,{danger:!0,left:(le||0)-T.nH,onCancel:function(){return Y(null)},onClick:function(){Y(null),fe(t)},title:"Are you sure you want to delete the trigger ".concat(j,"?"),top:(ne||0)-(i<=1?T.oz:T.OK),width:T.Xx})})]},"edit_delete_buttons_".concat(i))),!n&&f&&X.splice(2,0,(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:L},"pipeline_name_".concat(i))),!n&&r&&X.splice(5,0,(0,C.jsx)(a.ZP,{default:!0,monospace:!0,small:!0,title:l?(0,z._6)(l):null,children:(0,z.XG)(null===l||void 0===l?void 0:l.slice(0,19),ue)},"created_at_".concat(i))),X})),stickyHeader:m,uuid:"pipeline-triggers"})})}}}]);