(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8662],{19395:function(e,n,t){"use strict";t.d(n,{IJ:function(){return a},Vx:function(){return p},eI:function(){return d},gU:function(){return b},tL:function(){return f},vJ:function(){return v}});var r,i,u=t(82394),o=t(92083),c=t.n(o);function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){(0,u.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e){return null===e||void 0===e?void 0:e.reduce((function(e,n){var t=n.block_uuid,r=n.completed_at,i=n.started_at,o=n.status,l=null;i&&r&&(l=c()(r).valueOf()-c()(i).valueOf());return s(s({},e),{},(0,u.Z)({},t,{runtime:l,status:o}))}),{})}function d(e){if(!e)return null;var n=new Date(c()(e).valueOf()),t=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds());return new Date(t)}function p(e){return"string"!==typeof e?e:d(e.split("+")[0]).toISOString().split(".")[0]}!function(e){e.DAY="day",e.HOUR="hour",e.MINUTE="minute",e.SECOND="second"}(i||(i={}));var f=(r={},(0,u.Z)(r,i.DAY,86400),(0,u.Z)(r,i.HOUR,3600),(0,u.Z)(r,i.MINUTE,60),(0,u.Z)(r,i.SECOND,1),r);function b(e){var n=i.SECOND,t=e;return e%86400===0?(t/=86400,n=i.DAY):e%3600===0?(t/=3600,n=i.HOUR):e%60===0&&(t/=60,n=i.MINUTE),{time:t,unit:n}}function v(e,n){return e*f[n]}},47409:function(e,n,t){"use strict";t.d(n,{Az:function(){return l},BF:function(){return c},Do:function(){return a},IK:function(){return o},VO:function(){return u},sZ:function(){return s}});var r,i=t(82394),u=t(66050).V,o=[u.FAILED,u.COMPLETED,u.RUNNING,u.CANCELLED,u.INITIAL],c=[u.INITIAL,u.RUNNING],l=[u.CANCELLED,u.COMPLETED,u.FAILED],s="__mage_variables",a=(r={},(0,i.Z)(r,u.CANCELLED,"Cancelled"),(0,i.Z)(r,u.COMPLETED,"Done"),(0,i.Z)(r,u.FAILED,"Failed"),(0,i.Z)(r,u.INITIAL,"Ready"),(0,i.Z)(r,u.RUNNING,"Running"),r)},23588:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return V}});var r=t(77837),i=t(75582),u=t(82394),o=t(38860),c=t.n(o),l=t(82684),s=t(83455),a=t(27125),d=t(60328),p=t(34744),f=t(93461),b=t(67971),v=t(87372),O=t(60547),h=t(47409),j=t(98781),g=t(41788),y=t(86673),m=t(54283),Z=t(19711),D=t(82531),E=t(26304),x=t(32316),P=t(62976),_=t(48952),w=t(82635),k=t(49125),N=t(64155),I=t(56681),T=t(19395),R=t(90211),C=t(28598),S=["blockRuns","columns","dataType","height","heightOffset","loadingData","pipeline","renderColumnHeader","rows","selectedRun","selectedTab","setSelectedTab","textData"];function L(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function A(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?L(Object(t),!0).forEach((function(n){(0,u.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var M={uuid:"Dependency tree"},U={uuid:"Block output"},F=[U,M];var B=t(59920),H=t(96510),G=t(66653);function J(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?J(Object(t),!0).forEach((function(n){(0,u.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):J(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function q(e){var n,t=e.pipeline,r=e.pipelineRun,u=(0,l.useState)(null),o=u[0],c=u[1],g=(0,l.useState)(F[0]),L=g[0],J=g[1],q=(0,l.useState)(null),V=q[0],z=q[1],X=t.uuid,K=D.ZP.pipelines.detail(X,{includes_content:!1,includes_outputs:!1},{revalidateOnFocus:!1}).data,W=(0,l.useMemo)((function(){return Y(Y({},null===K||void 0===K?void 0:K.pipeline),{},{uuid:X})}),[K,X]),$=D.ZP.pipeline_runs.detail(r.id,{},{refreshInterval:3e3,revalidateOnFocus:!0}).data,Q=(0,l.useMemo)((function(){return(null===$||void 0===$?void 0:$.pipeline_run)||{}}),[$]),ee=Q.block_runs,ne=Q.execution_date,te=Q.id,re=Q.status,ie=(0,s.Db)(D.ZP.pipeline_runs.useUpdate(te),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){c(null)},onErrorCallback:function(e,n){return z({errors:n,response:e})}})}}),ue=(0,i.Z)(ie,2),oe=ue[0],ce=ue[1].isLoading,le=D.ZP.outputs.block_runs.list(null===o||void 0===o?void 0:o.id),se=le.data,ae=le.loading,de=(null===se||void 0===se||null===(n=se.outputs)||void 0===n?void 0:n[0])||{},pe=de.sample_data,fe=de.text_data,be=de.type;(0,l.useEffect)((function(){o||(null===L||void 0===L?void 0:L.uuid)!==U.uuid||J(M)}),[o,null===L||void 0===L?void 0:L.uuid]);var ve=(0,l.useMemo)((function(){return ee||[]}),[Q]),Oe=((null===pe||void 0===pe?void 0:pe.columns)||[]).slice(0,40),he=(null===pe||void 0===pe?void 0:pe.rows)||[],je=(0,l.useMemo)((function(){return(0,C.jsx)(a.Z,{blockRuns:ve,onClickRow:function(e){c((function(n){var t=ve[e],r=(null===n||void 0===n?void 0:n.id)!==t.id?t:null;return r&&J((function(e){return e!==U?U:e})),r}))},pipeline:W,selectedRun:o,setErrors:z})}),[ve,W,o]),ge=(null===W||void 0===W?void 0:W.type)!==j.qL.STREAMING&&re&&re!==h.VO.COMPLETED,ye=((null===W||void 0===W?void 0:W.type)===j.qL.PYTHON||(null===W||void 0===W?void 0:W.type)===j.qL.INTEGRATION)&&o&&h.Az.includes(re);return(0,C.jsxs)(O.Z,{breadcrumbs:[{label:function(){return"Runs"},linkProps:{as:"/pipelines/".concat(X,"/runs"),href:"/pipelines/[pipeline]/runs"}},{label:function(){return ne}}],buildSidekick:function(e){return function(e){var n=e.blockRuns,t=e.columns,r=e.dataType,i=e.height,u=e.heightOffset,o=e.loadingData,c=e.pipeline,l=e.renderColumnHeader,s=e.rows,a=e.selectedRun,d=e.selectedTab,p=e.setSelectedTab,f=e.textData,v=A({},(0,E.Z)(e,S));v.blockStatus=(0,T.IJ)(n);var O=(0,C.jsx)(y.Z,{ml:2,children:(0,C.jsx)(Z.ZP,{children:"This block run has no output."})}),h=s&&s.length>0?(0,C.jsx)(P.Z,{columnHeaderHeight:l?N.Eh:0,columns:t,height:i-u-90,noBorderBottom:!0,noBorderLeft:!0,noBorderRight:!0,renderColumnHeader:l,rows:s}):O,j=(0,R.Pb)(f)?JSON.stringify(JSON.parse(f),null,2):f,g=f?(0,C.jsx)(y.Z,{ml:2,children:(0,C.jsx)(Z.ZP,{monospace:!0,children:(0,C.jsx)("pre",{children:j})})}):O,D=d&&p;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:{position:"fixed",top:"50px"},children:D&&(0,C.jsx)(y.Z,{py:k.cd,children:(0,C.jsx)(x.Z,{onClickTab:p,selectedTabUUID:null===d||void 0===d?void 0:d.uuid,tabs:a?F:[M]})})}),(0,C.jsxs)("div",{style:{position:"relative",top:"75px"},children:[(!a||M.uuid===(null===d||void 0===d?void 0:d.uuid))&&(0,C.jsx)(_.Z,A(A({},v),{},{height:i,heightOffset:(u||0)+(D?I.u$:0),pipeline:c})),a&&U.uuid===(null===d||void 0===d?void 0:d.uuid)&&(0,C.jsxs)(C.Fragment,{children:[o&&(0,C.jsx)(y.Z,{mt:2,children:(0,C.jsx)(b.Z,{alignItems:"center",fullWidth:!0,justifyContent:"center",children:(0,C.jsx)(m.Z,{color:"white",large:!0})})}),!o&&r===w.Gi.TABLE&&h,!o&&r!==w.Gi.TABLE&&g]})]})]})}(Y(Y({},e),{},{blockRuns:ve,columns:Oe,dataType:be,loadingData:ae,rows:he,selectedRun:o,selectedTab:L,setSelectedTab:J,showDynamicBlocks:!0,textData:fe}))},errors:V,pageName:B.M.RUNS,pipeline:W,setErrors:z,subheader:(ge||ye)&&(0,C.jsxs)(b.Z,{alignItems:"center",children:[h.BF.includes(re)&&(0,C.jsxs)(f.Z,{children:[(0,C.jsx)(Z.ZP,{bold:!0,default:!0,large:!0,children:"Pipeline is running"}),(0,C.jsx)(y.Z,{mr:1}),(0,C.jsx)(m.Z,{inverted:!0}),(0,C.jsx)(y.Z,{mr:2})]}),ge&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(d.Z,{danger:!0,loading:ce,onClick:function(e){(0,G.j)(e),oe({pipeline_run:{pipeline_run_action:"retry_blocks"}})},outline:!0,children:"Retry incomplete blocks"}),(0,C.jsx)(y.Z,{mr:2})]}),ye&&(0,C.jsxs)(d.Z,{loading:ce,onClick:function(e){(0,G.j)(e),oe({pipeline_run:{from_block_uuid:o.block_uuid,pipeline_run_action:"retry_blocks"}})},outline:!0,primary:!0,children:["Retry from selected block (",o.block_uuid,")"]})]}),title:function(e){var n=e.name;return"".concat(n," runs")},uuid:"".concat(B.M.RUNS,"_").concat(X,"_").concat(te),children:[(0,C.jsx)(y.Z,{mt:k.cd,px:k.cd,children:(0,C.jsx)(v.Z,{level:5,children:"Block runs"})}),(0,C.jsx)(p.Z,{light:!0,mt:k.cd,short:!0}),je]})}q.getInitialProps=function(){var e=(0,r.Z)(c().mark((function e(n){var t,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.query,r=t.pipeline,i=t.run,e.abrupt("return",{pipeline:{uuid:r},pipelineRun:{id:i}});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var V=(0,g.Z)(q)},39525:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pipelines/[pipeline]/runs/[run]",function(){return t(23588)}])}},function(e){e.O(0,[844,9902,426,1774,8792,4259,5896,7849,5872,1424,1005,7815,3654,547,8952,4822,437,2786,9774,2888,179],(function(){return n=39525,e(e.s=n);var n}));var n=e.O();_N_E=n}]);