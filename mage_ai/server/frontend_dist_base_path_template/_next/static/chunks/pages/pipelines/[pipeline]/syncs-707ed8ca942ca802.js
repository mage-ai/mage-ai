(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7803],{16488:function(n,e,t){"use strict";t.d(e,{IJ:function(){return v},M8:function(){return P},Uc:function(){return Z},XM:function(){return _},_U:function(){return p},eI:function(){return x},gU:function(){return O},lO:function(){return w},ri:function(){return b},tL:function(){return g},vJ:function(){return y},xH:function(){return j}});var r,l=t(82394),o=t(92083),u=t.n(o),c=t(3917),i=t(30229),s=t(4383),a=t(42122),d=t(86735);function f(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function m(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?f(Object(t),!0).forEach((function(e){(0,l.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var p=function(n){return!!n&&!Object.values(i.U5).includes(n)};function v(n){return null==n?void 0:n.reduce((function(n,e){var t=e.block_uuid,r=e.completed_at,o=e.started_at,c=e.status,i=null;o&&r&&(i=u()(r).valueOf()-u()(o).valueOf());return m(m({},n),{},(0,l.Z)({},t,{runtime:i,status:c}))}),{})}var h,b=function(n){var e=[{description:function(){return"This pipeline will run continuously on an interval or just once."},label:function(){return"Schedule"},uuid:i.Xm.TIME},{description:function(){return"Run this pipeline when you make an API call."},label:function(){return"API"},uuid:i.Xm.API}];return n?e.slice(0,1):e};function j(n){var e=(0,a.gR)(n,[i.gm.INTERVAL,i.gm.TYPE]),t=n[i.gm.INTERVAL];t&&(e["schedule_interval[]"]=encodeURIComponent(t));var r=n[i.gm.TYPE];return r&&(e["schedule_type[]"]=r),e}function x(n){return n?new Date(u()(n).valueOf()):null}function Z(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e?(0,c.XG)(n,e,t):function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"!=typeof n)return n;var t=n.split("+")[0];return u()(x(t)).format(e||c.Nx)}(n,t)}!function(n){n.DAY="day",n.HOUR="hour",n.MINUTE="minute",n.SECOND="second"}(h||(h={}));var g=(r={},(0,l.Z)(r,h.DAY,86400),(0,l.Z)(r,h.HOUR,3600),(0,l.Z)(r,h.MINUTE,60),(0,l.Z)(r,h.SECOND,1),r);function O(n){var e=h.SECOND,t=n;return n%86400==0?(t/=86400,e=h.DAY):n%3600==0?(t/=3600,e=h.HOUR):n%60==0&&(t/=60,e=h.MINUTE),{time:t,unit:e}}function y(n,e){return n*g[e]}function _(n,e,t){var r,l=u()(n);return l.set("hour",+(null==e?void 0:e.hour)||0),l.set("minute",+(null==e?void 0:e.minute)||0),l.set("second",0),r=l.format(c.TD),null!=t&&t.includeSeconds&&(r=r.concat(":00")),null!=t&&t.localTimezone&&(r=l.format(c.lE),null!=t&&t.convertToUtc&&(r=(0,c.d$)(r,{includeSeconds:null==t?void 0:t.includeSeconds,utcFormat:!0}))),r}function P(n){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t="",r=(0,s.XF)();return e?t="".concat(r,"/api/pipeline_schedules/").concat(null==n?void 0:n.id,"/api_trigger"):(t="".concat(r,"/api/pipeline_schedules/").concat(null==n?void 0:n.id,"/pipeline_runs"),null!=n&&n.token&&(t="".concat(t,"/").concat(n.token))),t}function k(n,e,t){return n.match(/[*,-/]/)?{additionalOffset:0,cronValue:n}:function(n,e,t){var r=t.indexOf(n),l=0;if(e<0)for(var o=0;o>e;o--)0===r?(r=t.length-1,l-=1):r-=1;else if(e>0)for(var u=0;u<e;u++)r===t.length-1?(r=0,l+=1):r+=1;var c="number"==typeof t[r]?t[r]:n;return{additionalOffset:l,cronValue:String(c)}}(+n,e,t)}var I=(0,d.m5)(60),N=(0,d.m5)(24),E=(0,c.Cs)();function w(n,e){if(!n)return n;var t=u()().local().format("Z"),r=t.split(":"),l="-"===t[0],o=3===r[0].length?Number(r[0].slice(1)):Number(r[0]),c=Number(r[1]);(l&&!e||!l&&e)&&(o=-o,c=-c);var i=n.split(" "),s=i[0],a=i[1],d=i[2],f=k(s,c,I),m=k(a,o+f.additionalOffset,N);if(i[0]=f.cronValue,i[1]=m.cronValue,0!==(null==m?void 0:m.additionalOffset)){var p=k(d,m.additionalOffset,E);i[2]=p.cronValue}return i.join(" ")}},25050:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return sn}});var r=t(77837),l=t(38860),o=t.n(l),u=t(82684),c=t(75457),i=t(93808),s=t(75582),a=t(82394),d=t(97618),f=t(55485),m=t(85854),p=t(44265),v=t(38276),h=t(4190),b=t(30160),j=t(44897),x=t(9518),Z=t(42631),g=t(95363),O=t(70515),y=t(61896),_=x.default.div.withConfig({displayName:"indexstyle__RowStyle",componentId:"sc-15svh8z-0"})(["border-radius:","px;margin:","px;overflow:hidden;"," "," "," "," "," "," &:hover{"," "," "," "," ","}"],Z.n_,O.cd*O.iI,(function(n){return"\n    background-color: ".concat((n.theme.background||j.Z.background).panel,";\n    border: 1px solid ").concat((n.theme.borders||j.Z.borders).dark,";\n\n    &:hover {\n      cursor: pointer;\n    }\n  ")}),(function(n){return n.selected&&n.danger&&"\n    border-color: ".concat((n.theme.accent||j.Z.accent).negative,";\n  ")}),(function(n){return n.selected&&n.primary&&"\n    border-color: ".concat((n.theme.interactive||j.Z.interactive).linkPrimary,";\n  ")}),(function(n){return n.selected&&n.default&&"\n    border-color: ".concat((n.theme.interactive||j.Z.interactive).focusBackground,";\n  ")}),(function(n){return n.selected&&n.success&&"\n    border-color: ".concat((n.theme.background||j.Z.background).success,";\n  ")}),(function(n){return n.selected&&n.warning&&"\n    border-color: ".concat((n.theme.accent||j.Z.accent).warning,";\n  ")}),(function(n){return n.danger&&"\n      border-color: ".concat((n.theme.accent||j.Z.accent).negative,";\n    ")}),(function(n){return n.primary&&"\n      border-color: ".concat((n.theme.interactive||j.Z.interactive).linkPrimary,";\n    ")}),(function(n){return n.default&&"\n      border-color: ".concat((n.theme.interactive||j.Z.interactive).focusBackground,";\n    ")}),(function(n){return n.success&&"\n      border-color: ".concat((n.theme.background||j.Z.background).success,";\n    ")}),(function(n){return n.warning&&"\n      border-color: ".concat((n.theme.accent||j.Z.accent).warning,";\n    ")})),P=(0,x.css)([""," "," "," "," ",""],(function(n){return n.danger&&"\n    background-color: ".concat((n.theme.accent||j.Z.accent).negative,";\n  ")}),(function(n){return n.primary&&"\n    background-color: ".concat((n.theme.interactive||j.Z.interactive).linkPrimary,";\n  ")}),(function(n){return n.default&&"\n    background-color: ".concat((n.theme.interactive||j.Z.interactive).defaultBackground,";\n  ")}),(function(n){return n.success&&"\n    background-color: ".concat((n.theme.background||j.Z.background).success,";\n  ")}),(function(n){return n.warning&&"\n    background-color: ".concat((n.theme.accent||j.Z.accent).warning,";\n  ")})),k=x.default.div.withConfig({displayName:"indexstyle__StatusStyle",componentId:"sc-15svh8z-1"})([""," ",";border-radius:","px;display:inline-block;font-family:",";padding:6px;"," "," "," "," "," ",""],P,y.iD,Z.D7,g.ry,(function(n){return n.danger&&"\n    color: ".concat((n.theme.content||j.Z.content).active,";\n  ")}),(function(n){return n.primary&&"\n    color: ".concat((n.theme.content||j.Z.content).active,";\n  ")}),(function(n){return(n.default||n.success)&&"\n  "}),(function(n){return n.default&&"\n    color: ".concat((n.theme.content||j.Z.content).default,";\n  ")}),(function(n){return n.success&&"\n    color: ".concat((n.theme.content||j.Z.content).inverted,";\n  ")}),(function(n){return n.warning&&"\n    color: ".concat((n.theme.content||j.Z.content).inverted,";\n  ")})),I=x.default.div.withConfig({displayName:"indexstyle__BarStyle",componentId:"sc-15svh8z-2"})([""," display:flex;height:auto;width:3px;",""],P,(function(n){return n.default&&"\n    background-color: ".concat((n.theme.interactive||j.Z.interactive).focusBackground,";\n  ")})),N=t(72473),E=t(16488),w=t(92083),S=t.n(w),M=t(41143),C=t(81728),V=t(86735);function D(n){var e;return Object.keys((null==n||null===(e=n.metrics)||void 0===e?void 0:e.blocks)||{}).sort()}function T(n){var e,t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=null,o=null,u=null,c=null,i={},a=(null==n?void 0:n.block_runs)||[],d=(null==n||null===(e=n.metrics)||void 0===e?void 0:e.blocks)||{},f=(null==n||null===(t=n.metrics)||void 0===t?void 0:t.pipeline)||{},m=A(n);return Object.entries(d).forEach((function(n){var e,t=(0,s.Z)(n,2),a=t[0],d=t[1];if(!r||r===a){var p,v=d||{},h=v.destinations,b=void 0===h?{records_affected:null,records_inserted:null,records_updated:null}:h,j=v.sources,x=void 0===j?{records:null}:j,Z=m[a]||[];if(r&&r===a&&Z.every((function(n){var e=n.status;return M.V.COMPLETED===e}))&&null===l&&(l=0),null!=f&&null!==(e=f[a])&&void 0!==e&&e.record_counts)null===l&&(l=0),l+=Number(null==f||null===(p=f[a])||void 0===p?void 0:p.record_counts);else null!=x&&x.records&&(null===l&&(l=0),l+=Number(x.records));null!=b&&b.records_updated?(null===u&&(u=0),u+=Number(b.records_updated),null===c&&(c=0),c+=Number(b.records_updated)):null!=b&&b.records_inserted?(null===u&&(u=0),u+=Number(b.records_inserted),null===o&&(o=0),o+=Number(b.records_inserted)):null!=b&&b.records_affected&&(null===u&&(u=0),u+=Number(b.records_affected)),["destinations","sources"].forEach((function(n){var e=d[n]||{};null!=e&&e.error&&(i[a]||(i[a]={}),i[a][n]={error:null==e?void 0:e.error,errors:null==e?void 0:e.errors,message:null==e?void 0:e.message})}))}})),null==a||a.forEach((function(n){var e=n.block_uuid,t=n.metrics,r=n.status;if(M.V.FAILED===r&&null!=t&&t.error&&e){var l=e.split(":"),o=(0,s.Z)(l,3),u=(o[0],o[1]);o[2];i[u]||(i[u]={}),i[u][""]=t.error}})),{errors:i,records:l,recordsInserted:o,recordsProcessed:u,recordsUpdated:c}}function A(n){var e=n.block_runs,t={};return null==e||e.forEach((function(n){var e=n.block_uuid.split(":"),r=(0,s.Z)(e,3),l=(r[0],r[1]);r[2];t[l]||(t[l]=[]),t[l].push(n)})),t}function L(n){var e=A(n),t={};return Object.entries(e).forEach((function(n){var e=(0,s.Z)(n,2),r=e[0],l=e[1],o=l.filter((function(n){var e=n.status;return M.V.COMPLETED===e})),u=o.map((function(n){var e=n.completed_at,t=n.started_at,r=S().utc(e),l=S().utc(t);return r.diff(l,"second")})),c=o.length,i=l.length;t[r]={completed:c,runtime:u.length>=1?(0,V.Sm)(u)/u.length:null,total:i}})),t}function R(n){var e=n.block_runs,t=(null==e?void 0:e.length)||1,r=function(n){var e=(null==n?void 0:n.block_runs)||[];return null==e?void 0:e.filter((function(n){var e=n.status;return M.V.COMPLETED===e}))}(n).length||0;return r/t}function U(n){var e=n.completed_at,t=n.block_runs,r=void 0===t?[]:t,l=n.status;if(null==r||!r.length)return 0;var o=S().utc();if(e)o=S().utc(e);else if([p.VO.CANCELLED,p.VO.FAILED].includes(l)){var u=(0,V.YC)(r,(function(n){return n.started_at}),{ascending:!1})[0];o=S().utc(u.updated_at)}var c=S().utc(n.created_at);return o.diff(c,"second")}function F(n,e){var t,r,l,o,u,c=A(n),i=L(n),s=(null==n?void 0:n.metrics)||{blocks:null,pipeline:null},a=s.blocks||{},d=s.pipeline||{},f=(a[e],d[e],i[e]||{completed:null,total:null}),m=f.completed,p=f.total,v=m&&p?m/p:0,h=c[e]||[],b=h.every((function(n){var e=n.status;return M.V.COMPLETED===e})),j=(0,V.YC)(h,(function(n){return n.updated_at}),{ascending:!1})[0],x=null===(t=(0,V.YC)(h,(function(n){return n.started_at}),{ascending:!0})[0])||void 0===t?void 0:t.started_at;b?r=null===(u=(0,V.YC)(h,(function(n){return n.completed_at}),{ascending:!1})[0])||void 0===u?void 0:u.completed_at:j&&(o=null==j?void 0:j.updated_at);var Z=b?S().utc(r||o):S().utc(),g=S().utc(x);return{completed:m,completedAt:r,done:b,progress:v,runtime:l=Z.diff(g,"second"),startedAt:x,status:null==j?void 0:j.status,timeText:(0,C.zf)(l),total:p,updatedAt:o}}var z=t(70320),Y=t(28598);function B(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function G(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?B(Object(t),!0).forEach((function(e){(0,a.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):B(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var X=function(n){var e=n.onSelect,t=n.pipelineRun,r=n.selected,l=t.created_at,o=t.status,c=(0,u.useMemo)((function(){return(null==t?void 0:t.metrics)||{blocks:{},destination:null,pipeline:{},source:null}}),[t]),i=(0,u.useMemo)((function(){return c.pipeline||{}}),[c]),a=(0,z.qB)(),x=c.destination,Z=c.source,g=(0,u.useMemo)((function(){return Object.keys(i).length}),[i]),y=(0,u.useMemo)((function(){return T(t)}),[t]),P=y.errors,w=y.records,S=y.recordsProcessed,M=(0,u.useMemo)((function(){return R(t)}),[t]),V=(0,u.useMemo)((function(){return[p.VO.COMPLETED].includes(o)}),[o]),D=(0,u.useMemo)((function(){return{danger:p.VO.FAILED===o,default:p.VO.INITIAL===o,primary:p.VO.RUNNING===o,success:V,warning:p.VO.CANCELLED===o}}),[V,o]),A=(0,u.useMemo)((function(){if(t){var n=U(t);return(0,C.zf)(n)}}),[t]);return(0,Y.jsx)(_,G(G({},D),{},{onClick:function(){return e(r?null:t.id)},selected:r,children:(0,Y.jsxs)(f.ZP,{fullHeight:!0,justifyContent:"space-between",children:[(0,Y.jsx)(I,G({},D)),(0,Y.jsx)(d.Z,{flex:1,flexDirection:"column",children:(0,Y.jsxs)(v.Z,{ml:3,py:3,children:[(0,Y.jsx)(m.Z,{bold:!0,level:5,monospace:!0,children:(0,E.Uc)(l,a)}),(0,Y.jsx)(v.Z,{fullWidth:!1,mt:2,children:(0,Y.jsx)(k,G(G({},D),{},{children:(0,Y.jsxs)(f.ZP,{alignItems:"center",children:[V&&(0,Y.jsx)(N.Check,{inverted:!0,size:2*O.iI}),[p.VO.INITIAL,p.VO.RUNNING].includes(o)&&(0,Y.jsx)(h.Z,{color:p.VO.INITIAL!==o?j.Z.monotone.white:null,inverted:p.VO.INITIAL===o,small:!0})," ",p.VO.RUNNING===o&&(0,Y.jsxs)(Y.Fragment,{children:[" ",Math.round(100*M),"%"]}),![p.VO.INITIAL,p.VO.RUNNING].includes(o)&&p.Do[o],p.VO.INITIAL===o&&"Starting"]})}))}),Object.values(P).length>=1&&(0,Y.jsx)(v.Z,{mt:1,children:Object.entries(P).map((function(n){var e=(0,s.Z)(n,2),t=e[0];e[1];return(0,Y.jsxs)(b.ZP,{monospace:!0,muted:!0,small:!0,children:[t," stream failed"]},t)}))})]})}),(0,Y.jsxs)(d.Z,{flex:1,children:[(0,Y.jsx)(d.Z,{flex:1,flexDirection:"column",children:(0,Y.jsxs)(v.Z,{ml:3,py:3,children:[(0,Y.jsxs)(v.Z,{mb:1,children:[(0,Y.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Rows processed"}),(0,Y.jsx)(b.ZP,{monospace:!0,children:S>=1?(0,C.x6)(S):"-"})]}),(0,Y.jsxs)(v.Z,{mb:1,children:[(0,Y.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Rows remaining"}),(0,Y.jsx)(b.ZP,{monospace:!0,children:w>=1&&w>=S?(0,C.x6)(w-S):"-"})]}),p.VO.RUNNING!==o&&(0,Y.jsxs)(v.Z,{mb:1,children:[(0,Y.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Runtime"}),(0,Y.jsx)(b.ZP,{monospace:!0,children:A})]})]})}),(0,Y.jsx)(d.Z,{flex:1,flexDirection:"column",children:(0,Y.jsxs)(v.Z,{ml:3,py:3,children:[(0,Y.jsxs)(v.Z,{mb:1,children:[(0,Y.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Source"}),(0,Y.jsx)(b.ZP,{monospace:!0,children:Z||"-"})]}),(0,Y.jsxs)(v.Z,{mb:1,children:[(0,Y.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Destination"}),(0,Y.jsx)(b.ZP,{monospace:!0,children:x||"-"})]}),(0,Y.jsxs)(v.Z,{mb:1,children:[(0,Y.jsx)(b.ZP,{bold:!0,muted:!0,small:!0,children:"Streams"}),(0,Y.jsx)(b.ZP,{monospace:!0,children:g>=1?(0,C.x6)(g):"-"})]})]})})]})]})}))},H=t(89565),W=t.n(H),q=t(34376),J=t(71180),$=t(48670),K=t(75499),Q=x.default.div.withConfig({displayName:"indexstyle__BarStyle",componentId:"sc-1thr560-0"})(["display:flex;flex:1;"," "," ",""],(function(n){return n.even&&n.fill&&"\n    background-color: ".concat((n.theme.accent||j.Z.accent).cyan,";\n  ")}),(function(n){return n.even&&!n.fill&&"\n    background-color: ".concat((n.theme.accent||j.Z.accent).cyanTransparent,";\n  ")}),(function(n){return"\n    height: ".concat((n.small?1:2)*O.iI,"px;\n  ")})),nn=t(95924),en=t(3917);var tn=function(n){var e=n.onClickRow,t=n.pipelineRun,r=n.selectedStream,l=(0,q.useRouter)(),o=(0,z.qB)(),c=(0,u.useState)(null),i=c[0],a=c[1],d=(0,u.useState)(null),h=d[0],j=d[1],x=(0,u.useMemo)((function(){return t?A(t):{}}),[t]),Z=(0,u.useMemo)((function(){return t?L(t):{}}),[t]),g=(0,u.useMemo)((function(){var n=0,e=[],t=[];if(Object.entries(Z).forEach((function(r){var l=(0,s.Z)(r,2),o=(l[0],l[1]),u=o.completed,c=o.runtime,i=o.total;null===c?t.push(o):(e.push(c),n+=c*(i-u))})),0===e.length)return null;var r=(0,V.Sm)(e)/e.length;return t.forEach((function(e){var t=e.completed,l=e.total;n+=r*(l-t)})),n}),[Z]),y=(0,u.useMemo)((function(){return r?Z[r]:null}),[Z,r]),_=(0,u.useMemo)((function(){if(r&&Z){var n=Z[r]||{},e=n.completed,l=n.total;if(l>=1)return e/l}else if(t)return R(t);return 0}),[Z,t,r]),P=(0,u.useMemo)((function(){return(0,Y.jsx)(f.ZP,{children:(0,V.w6)(101).map((function(n,e){return(0,Y.jsx)(Q,{even:e%2==0,fill:_>0&&Math.round(100*_)>=e},e)}))})}),[_]),k=(0,u.useMemo)((function(){if(r){var n=x[r]||[],e=n.every((function(n){var e=n.status;return M.V.COMPLETED===e})),l=(0,V.YC)(n,(function(n){return n.updated_at}),{ascending:!1})[0],o=null==l?void 0:l.status,u=y||{},c=u.completed,i=u.runtime,s=u.total;if(e)return"Sync complete for ".concat(r);if([M.V.CANCELLED,M.V.FAILED].includes(o))return p.Do[o];if(i&&s>=1){var a=Math.ceil(i*(s-c)/60);return"".concat((0,C._6)("minute",a,!0)," to completion")}return"Estimating time remaining for stream..."}if(p.VO.COMPLETED===(null==t?void 0:t.status))return"Sync complete";if(t){if([p.VO.CANCELLED,p.VO.FAILED].includes(null==t?void 0:t.status))return p.Do[null==t?void 0:t.status];if(p.VO.INITIAL===(null==t?void 0:t.status))return"Initializing sync (this can take several minutes)";if(null===g)return"Estimating time remaining...";var d=Math.ceil(g/60);return"".concat((0,C._6)("minute",d,!0)," to completion")}return"Select a sync"}),[x,g,y,t,r]),I=(0,u.useMemo)((function(){return t&&r?F(t,r):{completed:null,completedAt:null,done:null,progress:null,runtime:null,startedAt:null,status:null,timeText:null,total:null,updatedAt:null}}),[t,r]);(0,u.useEffect)((function(){var n;if(t){var e=U(t);a(e),n=setInterval((function(){return a((function(n){return n+1}))}),1e3)}return function(){return clearInterval(n)}}),[t]),(0,u.useEffect)((function(){var n;if(t&&r&&I){var e=(null==I?void 0:I.runtime)||0;j(e),n=setInterval((function(){return j((function(n){return n+1}))}),1e3)}return function(){return clearInterval(n)}}),[t,r,I]);var w=(0,u.useMemo)((function(){if(t){if(r)return null==I?void 0:I.timeText;var n=U(t);return(0,C.zf)(n)}}),[t,r,I]),S=(0,u.useMemo)((function(){var n=Math.floor(i%86400/3600),e=Math.floor(i%3600/60),t=Math.floor(i%60/1);return[n>=10?String(n):"0".concat(n),e>=10?String(e):"0".concat(e),t>=10?String(t):"0".concat(t)].join(":")}),[i]),B=(0,u.useMemo)((function(){var n=Math.floor(h%86400/3600),e=Math.floor(h%3600/60),t=Math.floor(h%60/1);return[n>=10?String(n):"0".concat(n),e>=10?String(e):"0".concat(e),t>=10?String(t):"0".concat(t)].join(":")}),[h]),G=(0,u.useMemo)((function(){return t?T(t):{errors:null,records:null,recordsInserted:null,recordsProcessed:null,recordsUpdated:null}}),[t]),X=G.errors,H=G.records,tn=G.recordsInserted,rn=G.recordsProcessed,ln=G.recordsUpdated,on=(0,u.useMemo)((function(){return t&&r?T(t,r):{errors:null,records:null,recordsInserted:null,recordsProcessed:null,recordsUpdated:null}}),[t,r]),un=(0,u.useMemo)((function(){var n=r?null==on?void 0:on.records:H,e=r?null==on?void 0:on.recordsInserted:tn,t=r?null==on?void 0:on.recordsProcessed:rn,l=r?null==on?void 0:on.recordsUpdated:ln,o=[{label:"Rows fetched",value:null===n?"-":(0,C.x6)(n)}];return null===e&&null===l?o.push({label:"Rows processed",value:null===t?"-":(0,C.x6)(t)}):null!==e?o.push({label:"Rows inserted",value:(0,C.x6)(e)}):null!==l&&o.push({label:"Rows updated",value:(0,C.x6)(l)}),o.map((function(n){var e=n.label,t=n.value;return(0,Y.jsxs)("div",{children:[(0,Y.jsx)(b.ZP,{bold:!0,large:!0,muted:!0,children:e}),(0,Y.jsx)(b.ZP,{headline:!0,children:t})]},e)}))}),[H,on,tn,rn,ln,r]),cn=(0,u.useMemo)((function(){if(!t)return(0,Y.jsx)("div",{});var n=D(t);return(0,Y.jsx)(K.Z,{columnFlex:[null,null,null,null,null,null],columns:[{uuid:"Stream"},{uuid:"Start"},{uuid:"End"},{uuid:"Time"},{uuid:"Progress"},{uuid:"Logs"}],isSelectedRow:function(e){return r&&r===n[e]},onClickRow:e,rows:n.map((function(n){var e=F(t,n),r=(e.completed,e.completedAt),u=e.done,c=e.progress,i=e.startedAt,s=e.status,a=e.timeText,d=(e.total,!!X[n]);return[(0,Y.jsx)(b.ZP,{danger:d,default:!d,monospace:!0,children:n},"stream"),(0,Y.jsx)(b.ZP,{default:!0,monospace:!0,title:i?(0,en._6)(i):null,children:i?(0,E.Uc)(i,o):(0,Y.jsx)(Y.Fragment,{children:"—"})},"started_at"),(0,Y.jsx)(b.ZP,{default:!0,monospace:!0,title:r?(0,en._6)(r):null,children:r?(0,E.Uc)(r,o):(0,Y.jsx)(Y.Fragment,{children:"—"})},"completed_at"),(0,Y.jsx)(b.ZP,{default:!0,children:[M.V.INITIAL,M.V.RUNNING].includes(s)?"-":a},"runtime"),(0,Y.jsxs)("div",{children:[u&&(0,Y.jsx)(N.Check,{default:!0,size:2*O.iI}),!u&&(0,Y.jsx)(f.ZP,{children:(0,V.w6)(51).map((function(n,e){return(0,Y.jsx)(Q,{even:e%2==0,fill:c>0&&Math.round(50*c)>=e,small:!0},e)}))})]},"progress"),(0,Y.jsx)(J.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(n){l.push("/pipelines/".concat(t.pipeline_uuid,"/logs?pipeline_run_id[]=").concat(t.id)),(0,nn.j)(n)},children:(0,Y.jsx)(N.Logs,{default:!0,size:2*O.iI})},"logs")]})),uuid:"".concat(null==t?void 0:t.id,"-streams-table")})}),[o,X,e,t,l,r]),sn=(0,u.useMemo)((function(){var n,e,l,o,u,c,i,a;if(t&&r){var d=(null==t?void 0:t.metrics)||{blocks:null,destination:null,pipeline:null,source:null},f=null==d||null===(n=d.pipeline)||void 0===n||null===(e=n[r])||void 0===e||null===(l=e.bookmarks)||void 0===l?void 0:l[r],m=null==d||null===(o=d.blocks)||void 0===o||null===(u=o[r])||void 0===u||null===(c=u.destinations)||void 0===c||null===(i=c.state)||void 0===i||null===(a=i.bookmarks)||void 0===a?void 0:a[r];if(f||m){var p=Array.from(new Set(Object.keys(f||{}).concat(Object.keys(m||{})))).sort(),v=[];p.forEach((function(n){var e=[(0,Y.jsx)(b.ZP,{bold:!0,monospace:!0,muted:!0,small:!0,children:n},n)];[f,m].forEach((function(t,r){t&&e.push((0,Y.jsx)(b.ZP,{monospace:!0,small:!0,children:t[n]},"".concat(n,"-").concat(r)))})),v.push(e)}));var h=[{label:function(){return""},uuid:"column"}];return[[null==d?void 0:d.source,"source",f],[null==d?void 0:d.destination,"destination",m]].forEach((function(n){var e=(0,s.Z)(n,3),t=e[0],r=e[1];e[2]&&h.push({uuid:"".concat(t," (").concat(r,")")})})),(0,Y.jsx)(K.Z,{columnFlex:[null,1,1],columns:h,rows:v,uuid:"".concat(r,"-bookmark-table")})}}}),[t,r]),an=(0,u.useMemo)((function(){var n,e,l,o,u,c;if(t&&r){var i=(null==t?void 0:t.metrics)||{blocks:null,destination:null,pipeline:null,source:null},a=null==i||null===(n=i.blocks)||void 0===n||null===(e=n[r])||void 0===e||null===(l=e.sources)||void 0===l?void 0:l.record,d=null==i||null===(o=i.blocks)||void 0===o||null===(u=o[r])||void 0===u||null===(c=u.destinations)||void 0===c?void 0:c.record;if(a||d){var f=Object.keys(d||a||{}).sort(),m=[];f.forEach((function(n){var e=[(0,Y.jsx)(b.ZP,{bold:!0,monospace:!0,muted:!0,small:!0,children:n},n)];[a,d].forEach((function(t,r){if(t){var l=t[n],o="object"==typeof l;e.push((0,Y.jsxs)(b.ZP,{monospace:!0,small:!0,textOverflow:!0,whiteSpaceNormal:!0,wordBreak:!0,children:[o&&(0,Y.jsx)("pre",{children:JSON.stringify(l,null,2)}),!o&&l]},"".concat(n,"-").concat(r)))}})),m.push(e)}));var p=[{label:function(){return""},uuid:"column"}];return[[null==i?void 0:i.source,"source",a],[null==i?void 0:i.destination,"destination",d]].forEach((function(n){var e=(0,s.Z)(n,3),t=e[0],r=e[1];e[2]&&p.push({uuid:"".concat(t," (").concat(r,")")})})),(0,Y.jsx)(K.Z,{columnFlex:[null,1,1],columns:p,rows:m.map((function(n){return n.map((function(n){return(0,Y.jsx)(b.ZP,{default:!0,monospace:!0,children:n},n)}))})),uuid:"".concat(r,"-bookmark-table")})}}}),[t,r]),dn=(0,u.useMemo)((function(){var n,e,l,o,u,c,i=null==t||null===(n=t.metrics)||void 0===n||null===(e=n.blocks)||void 0===e?void 0:e[r];return(null==i||null===(l=i.sources)||void 0===l||null===(o=l.block_tags)||void 0===o?void 0:o.destination_table)||(null==i||null===(u=i.destinations)||void 0===u||null===(c=u.block_tags)||void 0===c?void 0:c.destination_table)}),[t,r]);return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsxs)(v.Z,{p:3,children:[r&&(0,Y.jsx)(v.Z,{mb:3,children:(0,Y.jsxs)(f.ZP,{alignItems:"center",children:[(0,Y.jsx)($.Z,{block:!0,onClick:function(){return l.push("/pipelines/".concat(t.pipeline_uuid,"/syncs?pipeline_run_id=").concat(t.id))},preventDefault:!0,children:(0,Y.jsxs)(f.ZP,{alignItems:"center",children:[(0,Y.jsx)(N.ArrowLeft,{default:!0,size:1.5*O.iI}),(0,Y.jsx)(v.Z,{mr:1}),(0,Y.jsx)(b.ZP,{default:!0,children:"Syncs"})]})}),(0,Y.jsx)(v.Z,{mx:1,children:(0,Y.jsx)(b.ZP,{default:!0,monospace:!0,children:"/"})}),(0,Y.jsx)(b.ZP,{bold:!0,monospace:!0,children:r})]})}),(0,Y.jsxs)(f.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,Y.jsx)(v.Z,{mr:2,my:1,children:(0,Y.jsx)(m.Z,{level:5,muted:!t,children:k})}),t&&(0,Y.jsx)(J.ZP,{onClick:function(){return l.push("/pipelines/".concat(t.pipeline_uuid,"/logs?pipeline_run_id[]=").concat(t.id))},small:!0,children:"Logs"})]}),(0,Y.jsx)(v.Z,{mt:2,children:P}),t&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(v.Z,{mt:3,children:(0,Y.jsxs)(f.ZP,{justifyContent:"space-between",children:[(0,Y.jsxs)("div",{children:[(0,Y.jsx)(b.ZP,{bold:!0,large:!0,muted:!0,children:"Runtime"}),(0,Y.jsxs)(b.ZP,{headline:!0,children:[r&&[M.V.INITIAL,M.V.RUNNING].includes(null==I?void 0:I.status)&&B,r&&![M.V.INITIAL,M.V.RUNNING].includes(null==I?void 0:I.status)&&(null==I?void 0:I.timeText),!r&&[p.VO.INITIAL,p.VO.RUNNING].includes(null==t?void 0:t.status)&&S,!r&&![p.VO.INITIAL,p.VO.RUNNING].includes(null==t?void 0:t.status)&&w]})]}),un]})}),Object.values(X).length>=1&&(0,Y.jsxs)(v.Z,{mt:3,children:[(0,Y.jsx)(m.Z,{level:5,muted:!0,children:"Errors"}),Object.entries(X).map((function(n,e){var t=(0,s.Z)(n,2),l=t[0],o=t[1];return(!r||r===l)&&(0,Y.jsx)(v.Z,{mt:e>=1?1:0,children:Object.entries(o).map((function(n){var e=(0,s.Z)(n,2),t=e[0],r=e[1],o=r.error,u=r.errors,c=r.message,i=Array.isArray(o)?o.join(" "):o;return(0,Y.jsxs)("div",{children:[(0,Y.jsx)(v.Z,{mb:c||(null==u?void 0:u.length)>=1?2:0,children:(0,Y.jsxs)(b.ZP,{monospace:!0,preWrap:!0,textOverflow:!0,children:[l,!!t&&(0,Y.jsxs)(b.ZP,{inline:!0,monospace:!0,muted:!0,children:[" (",t,")"]}),": ",(0,Y.jsx)(b.ZP,{default:!0,inline:!0,monospace:!0,children:i&&(0,Y.jsx)(W(),{children:i})})]})}),(0,Y.jsx)(b.ZP,{default:!0,monospace:!0,preWrap:!0,small:!0,children:c}),u.map((function(n){return(0,Y.jsx)(b.ZP,{default:!0,monospace:!0,preWrap:!0,small:!0,children:n},n)}))]},"".concat(l,"-").concat(t))}))},l)}))]})]})]}),t&&!r&&(0,Y.jsx)(v.Z,{my:3,children:cn}),t&&r&&(0,Y.jsxs)(Y.Fragment,{children:[dn&&(0,Y.jsx)(v.Z,{my:3,children:(0,Y.jsxs)(v.Z,{px:3,children:[(0,Y.jsx)(m.Z,{level:5,children:"Table name"}),(0,Y.jsx)(v.Z,{mt:1,children:(0,Y.jsx)(b.ZP,{default:!0,monospace:!0,children:dn})})]})}),sn&&(0,Y.jsxs)(v.Z,{my:3,children:[(0,Y.jsx)(v.Z,{px:3,children:(0,Y.jsx)(m.Z,{level:5,children:"Bookmarks"})}),(0,Y.jsx)(v.Z,{px:1,children:sn})]}),an&&(0,Y.jsxs)(v.Z,{my:3,children:[(0,Y.jsx)(v.Z,{px:3,children:(0,Y.jsx)(m.Z,{level:5,children:"Sample row"})}),(0,Y.jsx)(v.Z,{px:1,children:an})]})]})]})},rn=t(35686),ln=t(28795),on=t(15610),un=t(69419);function cn(n){var e=n.pipeline,t=e.uuid,r=rn.ZP.pipeline_runs.list({_limit:20,_offset:0,pipeline_uuid:t},{refreshInterval:5e3}).data,l=(0,u.useMemo)((function(){return(null==r?void 0:r.pipeline_runs)||[]}),[r]),o=(0,un.iV)(),i=(0,u.useState)(null),s=i[0],a=i[1],d=(0,u.useState)(null),f=d[0],m=d[1],p=(0,u.useState)(null),v=p[0],h=p[1];(0,u.useEffect)((function(){null!=o&&o.pipeline_run_id?h(null==l?void 0:l.find((function(n){return n.id===Number(o.pipeline_run_id)}))):v&&h(null),null!=o&&o.stream?m(o.stream):f&&m(null)}),[l,o,v,f]);var b=(0,u.useCallback)((function(){var n=v?D(v):[];return(0,Y.jsx)(tn,{onClickRow:function(e){var t=n[e];(0,on.u)({stream:f===t?null:t})},pipelineRun:v,selectedStream:f})}),[v,f]),j=(0,u.useMemo)((function(){var n="/pipelines/".concat(t,"/syncs");v&&(n="".concat(n,"?pipeline_run_id=").concat(v.id));var e=[{label:function(){return"Syncs"},linkProps:f?{as:n,href:"/pipelines/[pipeline]/syncs"}:null}];return f&&e.push({label:function(){return f}}),e}),[t,v,f]);return(0,Y.jsx)(c.Z,{breadcrumbs:j,buildSidekick:b,errors:s,pageName:ln.M.SYNCS,pipeline:e,setErrors:a,title:function(n){var e=n.name;return"".concat(e," syncs")},uuid:"".concat(ln.M.SYNCS,"_").concat(t),children:l.map((function(n){var e=(null==v?void 0:v.id)===n.id;return(0,Y.jsx)(X,{onSelect:function(n){return(0,on.u)({pipeline_run_id:n,stream:null})},pipelineRun:n,selected:e},n.id)}))})}cn.getInitialProps=function(){var n=(0,r.Z)(o().mark((function n(e){var t;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.query.pipeline,n.abrupt("return",{pipeline:{uuid:t}});case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();var sn=(0,i.Z)(cn)},59416:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pipelines/[pipeline]/syncs",function(){return t(25050)}])},80022:function(n,e,t){"use strict";function r(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}t.d(e,{Z:function(){return r}})},15544:function(n,e,t){"use strict";function r(n){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},r(n)}t.d(e,{Z:function(){return r}})},13692:function(n,e,t){"use strict";t.d(e,{Z:function(){return l}});var r=t(61049);function l(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&(0,r.Z)(n,e)}},93189:function(n,e,t){"use strict";t.d(e,{Z:function(){return o}});var r=t(12539),l=t(80022);function o(n,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return(0,l.Z)(n)}}},function(n){n.O(0,[449,3782,9774,2888,179],(function(){return e=59416,n(n.s=e);var e}));var e=n.O();_N_E=e}]);